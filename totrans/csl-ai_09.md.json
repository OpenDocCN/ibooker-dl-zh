["```py\nimport pandas as pd\ndata_url = (    #1\n    \"https://raw.githubusercontent.com/altdeep/causalML/master/\"     #1\n    \"datasets/sidequests_and_purchases_obs.csv\"    #1\n)     #1\ndf = pd.read_csv(data_url)    #1\nsummary = df.drop('User ID', axis=1).groupby(     #2\n    [\"Side-quest Engagement\"]     #2\n).agg(     #2\n    ['count', 'mean', 'std']     #2\n)     #2\nsummary\n```", "```py\nn1, n2 = summary['In-game Purchases']['count']    #1\nm1, m2 = summary['In-game Purchases']['mean']   #2\ns1, s2 =  summary['In-game Purchases']['std']     #3\npooled_std = (s1**2 / n1 + s2**2 / n2) **.5   #4\nz_score = (m1 - m2) / pooled_std    #5\nabs(z_score) > 2\\.   #6\n```", "```py\nimport pandas as pd\nexp_data_url = (     #1\n    \"https://raw.githubusercontent.com/altdeep/causalML/master/\"   #1\n    \"datasets/sidequests_and_purchases_exp.csv\"     #1\n)    #1\ndf = pd.read_csv(exp_data_url)     #1\nsummary = df.drop('User ID', axis=1).groupby(    #2\n    [\"Side-quest Engagement\"]     #2\n).agg(     #2\n    ['count', 'mean', 'std']    #2\n)\nprint(summary)\n```", "```py\nn1, n2 = summary['In-game Purchases']['count']     #1\nm1, m2 = summary['In-game Purchases']['mean']     #2\ns1, s2 =  summary['In-game Purchases']['std']    #3\npooled_std = (s1**2 / n1 + s2**2 / n2) **.5    #4\nz_score = (m1 - m2) / pooled_std     #5\nabs(z_score) > 2\\.    #6\n```", "```py\nimport pandas as pd\nfull_obs_url = (     #1\n    \"https://raw.githubusercontent.com/altdeep/causalML/master/\"     #1\n    \"datasets/sidequests_and_purchases_full_obs.csv\"    #1\n)    #1\ndf = pd.read_csv(full_obs_url)      #1\nmembership_counts = df['Guild Membership'].value_counts()    #2\ndist_guild_membership = membership_counts / sum(membership_counts)     #2\nprint(dist_guild_membership)    #2\n```", "```py\nnonmember    0.515\nmember       0.485\nName: Guild Membership, dtype: float64\n```", "```py\nmember_subset = df[(df['Guild Membership'] == 'member')]     #1\nmember_engagement_counts = (   #1\n    member_subset['Side-quest Engagement'].value_counts()   #1\n)    #1\ndist_engagement_member = (    #1\n    member_engagement_counts / sum(member_engagement_counts)   #1\n)    #1\nprint(dist_engagement_member)    #1\n\nnonmember_subset = df[(df['Guild Membership'] == 'nonmember')]    #2\nnonmember_engagement_counts = (   #2\n    nonmember_subset['Side-quest Engagement'].value_counts()    #2\n)     #2\ndist_engagement_nonmember = (    #2\n    nonmember_engagement_counts /   #2\nsum(nonmember_engagement_counts)    #2\n)     #2\nprint(dist_engagement_nonmember)     #2\n```", "```py\nhigh    0.797938\nlow     0.202062\n```", "```py\nhigh    0.184466\nlow     0.815534\n```", "```py\npurchase_dist_nonmember_low_engagement = df[     #1\n    (df['Guild Membership'] == 'nonmember') &    #1\n    (df['Side-quest Engagement'] == 'low')    #1\n].drop(     #1\n  ['User ID', 'Side-quest Engagement', 'Guild Membership'], axis=1   #1  \n).agg(['mean', 'std'])    #1\nprint(round(purchase_dist_nonmember_low_engagement, 2))    #1\n\npurchase_dist_nonmember_high_engagement = df[     #2\n    (df['Guild Membership'] == 'nonmember') &    #2\n    (df['Side-quest Engagement'] == 'high')    #2\n].drop(     #2\n  ['User ID', 'Side-quest Engagement', 'Guild Membership'], axis=1     #2\n).agg(['mean', 'std'])    #2\nprint(round(purchase_dist_nonmember_high_engagement, 2))    #2\n\npurchase_dist_member_low_engagement = df[     #3\n    (df['Guild Membership'] == 'member') &    #3\n    (df['Side-quest Engagement'] == 'low')    #3\n].drop(     #3\n  ['User ID', 'Side-quest Engagement', 'Guild Membership'], axis=1     #3\n).agg(['mean', 'std'])     #3\nprint(round(purchase_dist_member_low_engagement, 2))     #3\n\npurchase_dist_member_high_engagement = df[     #4\n    (df['Guild Membership'] == 'member') &    #4\n    (df['Side-quest Engagement'] == 'high')    #4\n].drop(    #4\n  ['User ID', 'Side-quest Engagement', 'Guild Membership'], axis=1    #4\n).agg(['mean', 'std'])     #4\nprint(round(purchase_dist_member_high_engagement, 2))   #4\n```", "```py\n      In-game Purchases\nmean              37.95\nstd               23.80\n```", "```py\n      In-game Purchases\nmean              54.92\nstd                4.92\n```", "```py\n      In-game Purchases\nmean             223.71\nstd                5.30\n```", "```py\n      In-game Purchases\nmean             125.53\nstd               53.44\n```", "```py\nimport pyro\nfrom torch import tensor\nfrom pyro.distributions import Bernoulli, Normal\n\ndef model():\n    p_member = tensor(0.5)    #1\n    is_guild_member = pyro.sample(    #1\n        \"Guild Membership\",     #1\n        Bernoulli(p_member)     #1\n    )     #1\n    p_engaged = (tensor(0.8)*is_guild_member +    #2\n                 tensor(.2)*(1-is_guild_member))    #2\n    is_highly_engaged = pyro.sample(    #2\n        \"Side-quest Engagement\",     #2\n        Bernoulli(p_engaged)     #2\n    )     #2\n    get_purchase_param = lambda param1, param2, param3, param4: (     #3\n        param1 * (1-is_guild_member) * (1-is_highly_engaged) +     #3\n        param2 * (1-is_guild_member) * (is_highly_engaged) +   #3\n        param3 * (is_guild_member)   * (1-is_highly_engaged) +    #3\n        param4 * (is_guild_member)   * (is_highly_engaged)     #3\n    )     #3\n    μ = get_purchase_param(37.95, 54.92, 223.71, 125.50)     #4\n    σ = get_purchase_param(23.80, 4.92, 5.30, 53.49)    #4\n    in_game_purchases = pyro.sample(    #4\n        \"In-game Purchases\",   #4\n        Normal(μ, σ)     #4\n    )   #4\n    guild_membership = \"member\" if is_guild_member else \"nonmember\"     #5\n    engagement = \"high\" if is_highly_engaged else \"low\"   #5\n    in_game_purchases = float(in_game_purchases)     #5\n    return guild_membership, engagement, in_game_purchases     #5\n```", "```py\nint_engaged_model = pyro.do(    #1\n    model,    #1\n    {\"Side-quest Engagement\": tensor(1.)}   #1\n)    #1\nint_unengaged_model = pyro.do(     #2\n    model,    #2\n    {\"Side-quest Engagement\": tensor(0.)}     #2\n)    #2\n```", "```py\npyro.util.set_rng_seed(123)    #1\nsimulated_experimental_data = [    #2\n    int_engaged_model() for _ in range(500)    #2\n] + [     #2\n    int_unengaged_model() for _ in range(500)     #2\n]    #2\nsimulated_experimental_data = pd.DataFrame(    #2\n    simulated_experimental_data,    #2\n    columns=[    #2\n        \"Guild Membership\",    #2\n        \"Side-quest Engagement\",    #2\n        \"In-Game Purchases\"    #2\n    ]    #2\n)     #2\nsim_exp_df = simulated_experimental_data.drop(     #3\n    \"Guild Membership\", axis=1)    #3\nsummary = sim_exp_df.groupby(     #4\n        [\"Side-quest Engagement\"]    #4\n    ).agg(    #4\n        ['count', 'mean', 'std']     #4\n    )     #4\nprint(summary)    #4\n```", "```py\nfrom pgmpy.base import DAG\n\nG = DAG([     #1\n    ('Guild Membership', 'Side-quest Engagement'),     #1\n    ('Side-quest Engagement', 'In-game Purchases'),     #1\n    ('Guild Membership', 'In-game Purchases')    #1\n])     #1\nG_int = G.do('Side-quest Engagement')    #2\n```", "```py\nimport pylab as plt\nimport networkx as nx\n\npos = {     #1\n    'Guild Membership': [0.0, 1.0],     #1\n    'Side-quest Engagement': [-1.0, 0.0],     #1\n    'In-game Purchases': [1.0, -0.5]     #1\n}     #1\n\nax = plt.subplot()     #2\nax.margins(0.3)    #2\nnx.draw(G, ax=ax, pos=pos, node_size=3000,    #2\n        node_color='w', with_labels=True)   #2\nplt.show()    #2\n\nax = plt.subplot()     #3\nax.margins(0.3)     #3\nnx.draw(G_int, ax=ax, pos=pos,    #3\n        node_size=3000, node_color='w', with_labels=True)     #3\nplt.show()     #3\n```", "```py\nint_engaged_model = pyro.do(     #1\n    model,    #1\n    {\"Side-quest Engagement\": tensor(1.)}    #1\n)    #1\nint_unengaged_model = pyro.do(     #2\n    model,     #2\n    {\"Side-quest Engagement\": tensor(0.)}     #2\n)     #2\n```", "```py\nis_highly_engaged = pyro.sample(\"Side-quest Engagement\", Bernoulli(p_engaged))\n```", "```py\nis_highly_engaged = tensor(1.)\n```"]