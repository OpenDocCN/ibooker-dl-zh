["```py\n\"upc\",\"name\",\"manufacturer\",\"short_description\",\"long_description\"\n\"096009010836\",\"Fists of Bruce Lee - Dolby - DVD\", , ,\n\"043396061965\",\"The Professional - Widescreen Uncut - DVD\", , ,\n\"085391862024\",\"Pokemon the Movie: 2000 - DVD\", , ,\n\"067003016025\",\"Summerbreeze - CD\",\"Nettwerk\", ,\n\"731454813822\",\"Back for the First Time [PA] - CD\",\"Def Jam South\", ,\n\"024543008200\",\"Big Momma's House - Widescreen - DVD\", , ,\n\"031398751823\",\"Kids - DVD\", , ,\n\"037628413929\",\"20 Grandes Exitos - CD\",\"Sony Discos Inc.\", ,\n\"060768972223\",\"Power Of Trinity (Box) - CD\",\"Sanctuary Records\", ,\n```", "```py\nproducts_collection = engine.create_collection(\"products\")\nproducts_dataframe = load_dataframe(\"data/retrotech/products.csv\")\nproducts_collection.write(products_dataframe)\n```", "```py\nWiping \"products\" collection\nCreating \"products\" collection\nStatus: Success\nLoading Products\nSchema:\nroot\n |-- upc: long (nullable = true)\n |-- name: string (nullable = true)\n |-- manufacturer: string (nullable = true)\n |-- short_description: string (nullable = true)\n |-- long_description: string (nullable = true)\n\nSuccessfully written 48194 documents\n```", "```py\ndef product_search_request(query, param_overrides={}):\n  request = {\"query\": query,\n             \"query_fields\": [\"name\", \"manufacturer\", \"long_description\"],\n             \"return_fields\": [\"upc\", \"name\", \"manufacturer\",\n                               \"short_description\", \"score\"],\n             \"limit\": 5,\n             \"order_by\": [(\"score\", \"desc\"), (\"upc\", \"asc\")]}\n  return request | param_overrides\n\nquery = \"ipod\"\nrequest = product_search_request(query)\nresponse = products_collection.search(**request)\ndisplay_product_search(query, response[\"docs\"])\n```", "```py\nsignals_collection = engine.create_collection(\"signals\")\nsignals_collection.write(from_csv(\"data/retrotech/signals.csv\"))\n```", "```py\nquery = \"ipad\"\nrequest = product_search_request(query)\nresponse = products_collection.search(**request)\ndisplay_product_search(query, response[\"docs\"])\n```", "```py\nsignals_collection = engine.get_collection(\"signals\")\ncreate_view_from_collection(signals_collection, \"signals\")  #1\n\nsignals_aggregation_query = \"\"\"\nSELECT q.target AS query, c.target AS doc, #2\nCOUNT(c.target) AS boost  #2\nFROM signals c LEFT JOIN signals q ON c.query_id = q.query_id\nWHERE c.type = 'click' AND q.type = 'query'\nGROUP BY q.target, doc #2\nORDER BY boost DESC\"\"\"\n\ndataframe = spark.sql(signals_aggregation_query)  #3\nsignals_boosting_collection = \\  #4\n  engine.create_collection(\"signals_boosting\") #4\nsignals_boosting_collection.write(dataframe)  #4\n```", "```py\ndef search_for_boosts(query, collection, query_field=\"query\"):\n  boosts_request = {\"query\": query,\n                    \"query_fields\": [query_field],\n                    \"return_fields\": [\"query\", \"doc\", \"boost\"],\n                    \"limit\": 10,\n                    \"order_by\": [(\"boost\", \"desc\")]}\n  response = collection.search(**boosts_request)\n  return response[\"docs\"]\n\ndef create_boosts_query(boost_documents):\n  print(f\"Boost Documents: \\n{boost_documents}\")\n  boosts = \" \".join([f'\"{b[\"doc\"]}\"^{b[\"boost\"]}'\n                     for b in boost_documents])\n  print(f\"\\nBoost Query: \\n{boosts}\\n\")\n  return boosts\n\nquery = \"ipad\"\nboost_docs = search_for_boosts(query, signals_boosting_collection)\nboosts_query = create_boosts_query(boost_docs)\nrequest = product_search_request(query)\nrequest[\"query_boosts\"] = boosts_query\n\nresponse = products_collection.search(**request)\ndisplay_product_search(query, response[\"docs\"])\n```", "```py\n[{\"query\": \"ipad\", \"doc\": \"885909457588\", \"boost\": 966},\n {\"query\": \"ipad\", \"doc\": \"885909457595\", \"boost\": 205},\n {\"query\": \"ipad\", \"doc\": \"885909471812\", \"boost\": 202},\n {\"query\": \"ipad\", \"doc\": \"886111287055\", \"boost\": 109},\n {\"query\": \"ipad\", \"doc\": \"843404073153\", \"boost\": 73},\n {\"query\": \"ipad\", \"doc\": \"635753493559\", \"boost\": 62},\n {\"query\": \"ipad\", \"doc\": \"885909457601\", \"boost\": 62},\n {\"query\": \"ipad\", \"doc\": \"885909472376\", \"boost\": 61},\n {\"query\": \"ipad\", \"doc\": \"610839379408\", \"boost\": 29},\n {\"query\": \"ipad\", \"doc\": \"884962753071\", \"boost\": 28}]\n```", "```py\n\"885909457588\"^966 \"885909457595\"^205 \"885909471812\"^202 \"886111287055\"^109\n\"843404073153\"^73 \"635753493559\"^62 \"885909457601\"^62 \"885909472376\"^61\n\"610839379408\"^29 \"884962753071\"^28\n```"]