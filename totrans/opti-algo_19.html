<html><head></head><body>
  <h1 class="tochead" id="heading_id_2">Appendix C. Exercises and solutions</h1>

  <p class="body-ind1">In this appendix, you will find a comprehensive set of exercises and their corresponding solutions, organized by chapter, to enhance your understanding and the application of the material presented in this book. These exercises are designed to reinforce the concepts, theories, and practical skills covered throughout the chapters.</p>

  <div class="calibre11"/>

  <div class="calibre12"/>

  <div class="calibre12"/>

  <div class="calibre12"/><h2 class="fm-head" id="heading_id_3">C.1 Chapter 2: A deeper look at search and optimization</h2>

  <h3 class="fm-head1" id="heading_id_4">C.1.1 Exercises</h3>

  <p class="body-dialog"><span class="gray">  1.</span>   Multiple choice: Choose the correct answer for each of the following questions.</p>

  <p class="body-dialogb"><span class="gray">1.1.</span>   _________ is the class of decision problems that can be solved by nondeterministic polynomial algorithms and whose solutions are hard to find but easy to verify.</p>

  <p class="body-case-b">   a.  P</p>

  <p class="body-case-b">   b.  NP</p>

  <p class="body-case-b">   c.  co-NP</p>

  <p class="body-case-b">   d.  NP-complete</p>

  <p class="body-case-b">   e.  NP-hard</p>

  <p class="body-dialogb"><span class="gray">1.2.</span>   Which of the following benchmark (toy) problems is not NP-complete?</p>

  <p class="body-case-b">   a.  Bin packing</p>

  <p class="body-case-b">   b.  Knapsack problem</p>

  <p class="body-case-b">   c.  Minimum spanning tree</p>

  <p class="body-case-b">   d.  Hamiltonian circuit</p>

  <p class="body-case-b">   e.  Vertex cover problem</p>

  <p class="body-dialogb"><span class="gray">1.3.</span>   _________ is the class of decision problems whose “No” answer can be verified in polynomial time.</p>

  <p class="body-case-b">   a.  P</p>

  <p class="body-case-b">   b.  NP</p>

  <p class="body-case-b">   c.  co-NP</p>

  <p class="body-case-b">   d.  NP-complete</p>

  <p class="body-case-b">   e.  NP-hard</p>

  <p class="body-dialogb"><span class="gray">1.4.</span>   Which of the following real-world problems is NP-hard?</p>

  <p class="body-case-b">   a.  Image matching</p>

  <p class="body-case-b">   b.  Single machine scheduling</p>

  <p class="body-case-b">   c.  Combinational equivalence checking</p>

  <p class="body-case-b">   d.  Capacitated vehicle routing problem (CVRP)</p>

  <p class="body-case-b">   e.  Container/truck loading</p>

  <p class="body-dialogb"><span class="gray">1.5.</span>   _________ is a theory that focuses on classifying computational problems according to their resource usage and relating these classes to each other.</p>

  <p class="body-case-b">   a.  Optimization complexity</p>

  <p class="body-case-b">   b.  Time complexity</p>

  <p class="body-case-b">   c.  Computational complexity</p>

  <p class="body-case-b">   d.  Operation research</p>

  <p class="body-case-b">   e.  Decision complexity</p>

  <p class="body-dialog"><span class="gray">  2.</span>   Describe the following search and optimization problems in terms of decision variable (univariate, bivariate, multivariate); objective functions (mono-objective, multi-objective, no objective function, or constraint-satisfaction problem); constraints; (hard constraints, soft constraints, both hard and soft constraints, unconstrained); and linearity (linear programming (LP), quadratic programming (QP), nonlinear programming (NLP)).</p>

  <p class="body-case-b">   a.  Minimize <span class="times"><i class="fm-italics">y</i> + cos(<i class="fm-italics">x</i><sup class="fm-superscript">2</sup>)</span>, <span class="times">sin(<i class="fm-italics">x</i>) – <i class="fm-italics">x × y</i></span>, and <span class="times">1 / (<i class="fm-italics">x</i> + <i class="fm-italics">y</i>)<sup class="fm-superscript">2</sup></span></p>

  <p class="body-case-b">   b.  Maximize <span class="times">2 – e<sup class="fm-superscript">(1 –</sup> <i class="fm-italics"><sup class="fm-superscript">x</sup></i><sup class="fm-superscript">)</sup></span> subject to <span class="times">–3 ≤ <i class="timesitalic">x</i></span> <i class="timesitalic">&lt; 10</i></p>

  <p class="body-case-b">   c.  Maximize <span class="times">3 <i class="fm-italics">× x</i> – <i class="fm-italics">y</i> / 5</span> subject to <span class="times">–2 ≤ <i class="fm-italics">x</i> &lt; 3</span>, <span class="times">0 &lt; <i class="fm-italics">y</i> ≤ 3</span>, and <span class="times"><i class="fm-italics">x</i> + <i class="fm-italics">y</i> = 4</span></p>

  <p class="body-case-b">   d.  The school districting problem consists of determining the groups of students attending each school of a school board located over a given territory in a way that maximizes the contiguity of school sectors, taking into consideration a number of hard constraints such as school capacity for each grade and class capacity. Walkability and keeping students in the same school from year to year are considered soft constraints in this problem.</p>

  <p class="body-case-b">   e.  The knapsack problem is an example of a combinatorial problem whose solution takes the form of a combination where the order doesn’t matter. As illustrated in figure C.1, given a set of items, each with a utility and a weight, the task is to select a subset of items to maximize the total utility while ensuring that the total weight of the selected items does not exceed a predefined capacity. The decision to include or exclude each item is binary.</p>

  <div class="figure">
    <p class="figuree"><img alt="" class="calibre4" src="../Images/APPC_F01_Khamis.png"/></p>

    <p class="figurecaptione">Figure C.1 Each item has a utility and a weight, and we want to maximize the utility of the contents of the knapsack. The problem is constrained by the capacity of the bag.</p>
  </div>

  <p class="body-dialog"><span class="gray">  3.</span>   For the following optimization problems, state the type of the problem (design, planning, or control problem) based on the permissible time to solve the problem and the expected quality of the solutions. Suggest the appropriate algorithm required to handle the optimization problem (offline versus online).</p>

  <p class="body-case-b">   a.  Find the optimal wind park design where the number and types of wind turbines need to be chosen and placed based on the wind conditions and wind park area.</p>

  <p class="body-case-b">   b.  Find multiple vehicle routes starting and ending at different depots so that all customer demands are fulfilled.</p>

  <p class="body-case-b">   c.  Create a fitness assistant for runners and cyclists that seamlessly automates the multiple tasks involved in planning fitness activities. The planner will assess an athlete’s current fitness level and individual training goals in order to create a fitness plan. The planner will also generate and recommend geographical routes that are both popular and customized to the user’s goals, level, and scheduled time, thus reducing the challenges involved in the planning stage. The suggested fitness plans will continuously adapt based on each user’s progress toward their fitness goals, thus keeping the athlete challenged and motivated.</p>

  <p class="body-case-b">   d.  Find a set of flights with departure and arrival times and aircraft assignments that maximize profits, given demand and revenues for every flight, route information distances, times, operating restrictions, aircraft characteristics and operating costs, and operational and managerial constraints.</p>

  <p class="body-case-b">   e.  Find the optimal schedule for delivery cargo bikes, semi and fully autonomous last-mile delivery trucks, self-driving delivery robots or delivery drones to maximize customer satisfaction and minimize delivery costs, taking into consideration the capacity of the vehicle, type of delivery service (a couple of days delivery, next-day delivery, or same-day delivery with some extra surcharge), delivery time, drop-off locations, and so on.</p>

  <p class="body-case-b">   f.  Plan on-demand responsive transit during pandemics to support the transportation of essential workers and essential trips to pharmacies and grocery stores for the general public, especially the elderly, taking into consideration store operating hours, capacity, and online delivery options.</p>

  <p class="body-case-b">   g.  Find a collision-free path for a vehicle from a start position to a given goal position, amid a collection of obstacles, in such a way that minimizes the estimated time of arrival and the consumed energy.</p>

  <p class="body-case-b">   h.  Develop a trip planner that minimizes total commute time, maximizes the average ratings of attractions, maximizes the duration spent at each of these attractions, and effectively minimizes idle time when someone visits a city.</p>

  <p class="body-case-b">   i.  Find school bus loading patterns and schedules such that the number of routes is minimized, the total distance traveled by all buses is kept to a minimum, no bus is overloaded, and the time required to traverse any route does not exceed a maximum time policy.</p>

  <p class="body-case-b">   j.  Minimize deadheading for shared mobility companies (minimize the miles driven with no passenger) or for delivery services providers (minimize the miles driven without cargo).</p>

  <p class="body-case-b">   k.  Plan or replan transport corridors and city streets to accommodate more pedestrians, cyclists, and riders in shared transportation and fewer cars.</p>

  <p class="body-case-b">   l.  Find the optimal placement for bus stops, traffic sensors, micro mobility stations, EV charging stations, air taxi takeoff and landing locations, walking routes, and cycling lanes for active mobility.</p>

  <p class="body-dialog"><span class="gray">  4.</span>   Modify listing 2.6 to define the animal feed mix problem data using Python dictionaries or to read the problem data from a CSV file.</p>

  <h3 class="fm-head1" id="heading_id_5">C.1.2 Solutions</h3>

  <p class="body-dialog"><span class="gray">  1.</span>   Multiple choice</p>

  <p class="body-dialogb">1.1. b) NP</p>

  <p class="body-dialogb">1.2. c) Minimum spanning tree</p>

  <p class="body-dialogb">1.3. c) co-NP</p>

  <p class="body-dialogb">1.4. d) Capacitated vehicle routing problem (CVRP)</p>

  <p class="body-dialogb">1.5. c) Computational complexity</p>

  <p class="body-dialog"><span class="gray">  2.</span>   Optimization problem description</p>

  <p class="body-case-b">   a.  Bivariate, multi-objective, unconstrained, nonlinear programming</p>

  <p class="body-case-b">   b.  Univariate, mono-objective, hard constraints, nonlinear programming</p>

  <p class="body-case-b">   c.  Bivariate, mono-objective, hard constraints, linear programming</p>

  <p class="body-case-b">   d.  Multivariate, mono-objective, both hard and soft constraints, linear programming (see Jacques A. Ferland and Gilles Guénette, “Decision support system for the school districting problem” [1])</p>

  <p class="body-case-b">   e.  Bivariate, mono-objective, hard constraints, linear programming</p>

  <p class="body-dialog"><span class="gray">  3.</span>   Optimization problem and process</p>

  <p class="body-case-b">   a.  Design problem. Offline optimization.</p>

  <p class="body-case-b">   b.  Planning problem during the process of generating the route, and control problem during rerouting. Offline optimization during planning, and online optimization during rerouting.</p>

  <p class="body-case-b">   c.  Planning problem to generate the plans and control problem for adaptation. Offline optimization during the planning phase, and online during the adaptation phase.</p>

  <p class="body-case-b">   d.  Design problem to generate the flight schedule, and planning problem if adaptation is required, such as in the case of faulty aircraft or cancellation due to weather conditions. Offline optimization, and online optimization if adaptation is required.</p>

  <p class="body-case-b">   e.  Planning problem during path generation, and control problem during rerouting for adaptive motion planning. Online optimization.</p>

  <p class="body-case-b">   f.  Planning problem for scheduling, and control problem if rerouting is involved. Online optimization.</p>

  <p class="body-case-b">   g.  Planning problem to generate the plans, and control problem for adaptation. Online optimization.</p>

  <p class="body-case-b">   h.  Planning problem. Offline optimization.</p>

  <p class="body-case-b">   i.  Design problem. Offline optimization.</p>

  <p class="body-case-b">   j.  Planning problem. Online optimization.</p>

  <p class="body-case-b">   k.  Design problem. Offline optimization.</p>

  <p class="body-case-b">   l.  Design problem. Offline optimization.</p>

  <p class="body-ind1">4. The next listing shows the steps for defining the animal feed mix problem data using Python dictionaries or to read the problem data from a CSV file.</p>

  <p class="fm-code-listing-captione">Listing C.1 Animal feed mix problem—defining data using dictionaries</p>
  <pre class="programlistinge">import pandas as pd
from pulp import *
  
Ingredients = ["Limestone", "Corn", "Soybean meal"]                        <span class="fm-combinumeral">①</span>
  
Price = {"Limestone": 10.0, "Corn": 30.5, "Soybean meal": 90.0,}           <span class="fm-combinumeral">②</span>
Calcium = {"Limestone": 0.38, "Corn": 0.001, "Soybean meal": 0.002,}       <span class="fm-combinumeral">③</span>
Protein = {"Limestone": 0.0, "Corn": 0.09, "Soybean meal": 0.50,}          <span class="fm-combinumeral">④</span>
Fiber = {"Limestone": 0.0, "Corn": 0.02, "Soybean meal": 0.08,} 
  
model = LpProblem("Animal_Feed_Mix_Problem", LpMinimize)                   <span class="fm-combinumeral">⑤</span>
 
ingredient_vars = LpVariable.dicts("Ingr", Ingredients, 0)                 <span class="fm-combinumeral">⑥</span>
 
model += (lpSum([Price[i] * ingredient_vars[i] for i in
<span class="fm-code-continuation-arrow">➥</span> Ingredients]),"Total Cost of Ingredients per kg",)                      <span class="fm-combinumeral">⑦</span>
 
model += (lpSum([Calcium[i] * ingredient_vars[i] for i in Ingredients]) &gt;=
<span class="fm-code-continuation-arrow">➥</span> 0.008, "Minimum calcium",)                                              <span class="fm-combinumeral">⑧</span>
model += (lpSum([Calcium[i] * ingredient_vars[i] for i in Ingredients]) &lt;= <span class="fm-combinumeral">⑧</span>
<span class="fm-code-continuation-arrow">➥</span> 0.012, "Maximum calcium",)                                              <span class="fm-combinumeral">⑧</span>
model += (lpSum([Protein[i] * ingredient_vars[i] for i in Ingredients])    <span class="fm-combinumeral">⑧</span>
<span class="fm-code-continuation-arrow">➥</span> &gt;=0.22, "Minimum protein",)                                             <span class="fm-combinumeral">⑧</span>
model += (lpSum([Fiber[i] * ingredient_vars[i] for i in Ingredients])      <span class="fm-combinumeral">⑧</span>
<span class="fm-code-continuation-arrow">➥</span> &lt;=0.05, "MMaximum fiber",)                                              <span class="fm-combinumeral">⑧</span>
model += lpSum([ingredient_vars[i] for i in Ingredients]) == 1,            <span class="fm-combinumeral">⑧</span>
<span class="fm-code-continuation-arrow">➥</span> "Conservation"                                                          <span class="fm-combinumeral">⑧</span>
 
model.solve()                                                              <span class="fm-combinumeral">⑨</span>
 
for v in model.variables():                                                <span class="fm-combinumeral">⑩</span>
    print(v.name, '=', round(v.varValue,2)*100, '%')                       <span class="fm-combinumeral">⑩</span>
                                                                           <span class="fm-combinumeral">⑩</span>
print('Total cost of the mixture per kg = ', round(value(model.objective), <span class="fm-combinumeral">⑩</span>
<span class="fm-code-continuation-arrow">➥</span> 2), '$')                                                                <span class="fm-combinumeral">⑩</span></pre>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">①</span> Create a list of ingredients.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">②</span> Dictionary of unit cost (cents/kg).</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">③</span> Dictionary of calcium (kg/kg).</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">④</span> Dictionary of protein (kg/kg).</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑤</span> Create a model.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑥</span> Dictionary called 'ingredient_vars' is created to contain the referenced variables.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑦</span> Add the objective function.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑧</span> Add the five constraints.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑨</span> Solve the problem using PuLP's choice of solver.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑩</span> Print the results.</p>

  <p class="body-ind1">We can also read the problem data from a CSV file as follows.</p>

  <p class="fm-code-listing-captione">Listing C.2 Animal feed mix problem—reading problem data from a CSV file</p>
  <pre class="programlistinge">df = pd.read_csv('Blending_problem_data.csv')                              <span class="fm-combinumeral">①</span>
 
data = df.to_dict()                                                        <span class="fm-combinumeral">②</span>
 
model = LpProblem("Animal_Feed_Mix_Problem", LpMinimize)                   <span class="fm-combinumeral">③</span>
 
ingredient_vars = LpVariable.dicts("Ingr", data.get('Ingredients'), 0)     <span class="fm-combinumeral">④</span>
 
model += (lpSum([data.get('Price')[i] * ingredient_vars[i] for i in
<span class="fm-code-continuation-arrow">➥</span> data.get('Ingredients')]),"Total Cost of Ingredients per kg",)          <span class="fm-combinumeral">⑤</span>
 
model += lpSum([ingredient_vars[i] for i in data.get('Ingredients')]) == 1,
<span class="fm-code-continuation-arrow">➥</span> "Conservation"                                                          <span class="fm-combinumeral">⑥</span>
model += (lpSum([data.get('Calcium')[i] * ingredient_vars[i] for i in
<span class="fm-code-continuation-arrow">➥</span> data.get('Ingredients')]) &gt;= 0.008, "Minimum calcium",)                 <span class="fm-combinumeral">⑥</span>
model += (lpSum([data.get('Calcium')[i] * ingredient_vars[i] for i in
<span class="fm-code-continuation-arrow">➥</span> data.get('Ingredients')]) &lt;= 0.012, "Maximum calcium",)                 <span class="fm-combinumeral">⑥</span>
model += (lpSum([data.get('Protein')[i] * ingredient_vars[i] for i in
<span class="fm-code-continuation-arrow">➥</span> data.get('Ingredients')]) &gt;=0.22, "Minimum protein",)                   <span class="fm-combinumeral">⑥</span>
model += (lpSum([data.get('Fiber')[i] * ingredient_vars[i] for i in
<span class="fm-code-continuation-arrow">➥</span> data.get('Ingredients')]) &lt;=0.05, "MMaximum fiber",)                    <span class="fm-combinumeral">⑥</span>
 
model.solve()                                                              <span class="fm-combinumeral">⑦</span>
 
for v in model.variables():                                                <span class="fm-combinumeral">⑧</span>
    print(v.name, '=', round(v.varValue,2)*100, '%')                       <span class="fm-combinumeral">⑧</span>
                                                                           <span class="fm-combinumeral">⑧</span>
print('Total cost of the mixture per kg = ', round(value(model.objective),
<span class="fm-code-continuation-arrow">➥</span> 2), '$')                                                                <span class="fm-combinumeral">⑧</span></pre>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">①</span> Read the CSV file.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">②</span> Convert data frame to a dictionary.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">③</span> Create a model.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">④</span> A dictionary called 'ingredient_vars' is created to contain the referenced variables.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑤</span> Add the objective function.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑥</span> Add the five constraints.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑦</span> Solve the problem using PuLP's choice of solver.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑧</span> Print the results.</p>

  <p class="body-ind1">Running listing C.2 produces the following results:</p>
  <pre class="programlistinge">Ingr_Corn = 65.0 %
Ingr_Limestone = 3.0 %
Ingr_Soybean_meal = 32.0 %
Total cost of the mixture per kg = 49.16 $</pre>

  <div class="calibre11"/>

  <div class="calibre12"/>

  <div class="calibre12"/>

  <div class="calibre12"/><h2 class="fm-head" id="heading_id_6">C.2 Chapter 3: Blind search algorithms</h2>

  <h3 class="fm-head1" id="heading_id_7">C.2.1 Exercises</h3>

  <p class="body-dialog"><span class="gray">  1.</span>   Multiple choice and true/false: Choose the correct answer for each of the following questions.</p>

  <p class="body-dialogb"><span class="gray">1.1.</span>   Big <i class="timesitalic">O</i> specifically describes the limiting behavior of a function (worst-case scenario) when the argument tends toward a particular value or infinity, usually in terms of simpler functions. What is the big <i class="timesitalic">O</i> of this expression: <span class="times">nlog(<i class="fm-italics">n</i>) + log(2<i class="fm-italics">n</i>)</span>?</p>

  <p class="body-case-b">   a.  Linearithmic</p>

  <p class="body-case-b">   b.  Loglinear</p>

  <p class="body-case-b">   c.  Quasilinear</p>

  <p class="body-case-b">   d.  All of the above</p>

  <p class="body-dialogb"><span class="gray">1.2.</span>   Which blind search algorithm implements a stack operation for searching the states?</p>

  <p class="body-case-b">   a.  Breadth-first search (BFS)</p>

  <p class="body-case-b">   b.  Uniform-cost search (UCS)</p>

  <p class="body-case-b">   c.  Bidirectional search (BS)</p>

  <p class="body-case-b">   d.  Depth-first search (DFS)</p>

  <p class="body-case-b">   e.  None of the above</p>

  <p class="body-dialogb"><span class="gray">1.3.</span>   A tree is a connected graph with no circuits and no self-loops.</p>

  <p class="body-case-b">   a.  True</p>

  <p class="body-case-b">   b.  False</p>

  <p class="body-dialogb"><span class="gray">1.4.</span>   For a very large workspace where the goal is deep within the workspace, the number of nodes could expand exponentially, and a depth-first search will demand a very large memory requirement.</p>

  <p class="body-case-b">   a.  True</p>

  <p class="body-case-b">   b.  False</p>

  <p class="body-dialogb"><span class="gray">1.5.</span>   Best-first is a mixed-depth and breadth-first search that uses heuristic values and expands the most desirable unexpanded node.</p>

  <p class="body-case-b">   a.  True</p>

  <p class="body-case-b">   b.  False</p>

  <p class="body-dialogb"><span class="gray">1.6.</span>   In design problems or strategic functions, optimality is usually traded in for speed gains.</p>

  <p class="body-case-b">   a.  True</p>

  <p class="body-case-b">   b.  False</p>

  <p class="body-dialogb"><span class="gray">1.7.</span>   Graph traversal algorithms outperform shortest path algorithms in applications where the weights of edges in a graph are all equal.</p>

  <p class="body-case-b">   a.  True</p>

  <p class="body-case-b">   b.  False</p>

  <p class="body-dialogb"><span class="gray">1.8.</span>   In Dijkstra’s algorithm, the priority queue is implemented using which data structure?.</p>

  <p class="body-case-b">   a.  Stack</p>

  <p class="body-case-b">   b.  Queue</p>

  <p class="body-case-b">   c.  Heap</p>

  <p class="body-case-b">   d.  Array</p>

  <p class="body-dialogb"><span class="gray">1.9.</span>   When is breadth-first search optimal?</p>

  <p class="body-case-b">   a.  When there are fewer nodes</p>

  <p class="body-case-b">   b.  When all step costs are equal</p>

  <p class="body-case-b">   c.  When all step costs are unequal</p>

  <p class="body-case-b">   d.  None of the above</p>

  <p class="body-dialogb"><span class="gray">1.10.</span> Which blind search algorithm combines DFS’s space-efficiency and BFS’s fast search by incrementing the depth limit until the goal is reached?</p>

  <p class="body-case-b">   a.  Depth-limited search (DLS)</p>

  <p class="body-case-b">   b.  Iterative deepening search (IDS)</p>

  <p class="body-case-b">   c.  Uniform-cost search (UCS)</p>

  <p class="body-case-b">   d.  Bidirectional search (BS)</p>

  <p class="body-case-b">   e.  None of the above</p>

  <p class="body-dialogb"><span class="gray">1.11.</span> Which term describes an algorithm with a computational complexity of <span class="times"><i class="fm-italics">O</i>(<i class="fm-italics">n</i> log<i class="fm-italics">n</i>)</span>?</p>

  <p class="body-case-b">   a.  Logarithmic</p>

  <p class="body-case-b">   b.  Exponential</p>

  <p class="body-case-b">   c.  Quasilinear</p>

  <p class="body-case-b">   d.  None of the above</p>

  <p class="body-dialogb"><span class="gray">1.12.</span> Which search algorithm is implemented with an empty first in, first out queue?</p>

  <p class="body-case-b">   a.  Depth-first search</p>

  <p class="body-case-b">   b.  Breadth-first search</p>

  <p class="body-case-b">   c.  Bidirectional search</p>

  <p class="body-case-b">   d.  None of the above</p>

  <p class="body-dialog"><span class="gray">  2.</span>   Consider the simplified map shown in figure C.2, where the edges are labeled with actual distances between the cities. State the path from city A to city M that would be produced by BFS and the path produced by DFS.</p>

  <div class="figure">
    <p class="figuree"><img alt="" class="calibre4" src="../Images/APPC_F02_Khamis.png"/></p>

    <p class="figurecaptione">Figure C.2 A simplified map</p>
  </div>

  <p class="body-dialog"><span class="gray">  3.</span>   Find the big <i class="timesitalic">O</i> notation for the following functions:</p>

  <p class="body-case-b">   a.  <span class="times">10<i class="fm-italics">n</i> + nlog(<i class="fm-italics">n</i>)</span></p>

  <p class="body-case-b">   b.  <span class="times">4 + <i class="fm-italics">n</i>/5</span></p>

  <p class="body-case-b">   c.  <span class="times"><i class="fm-italics">n</i><sup class="fm-superscript">5</sup> – 20<i class="fm-italics">n</i><sup class="fm-superscript">3</sup> + 170<i class="fm-italics">n</i> + 208</span></p>

  <p class="body-case-b">   d.  <span class="times"><i class="fm-italics">n</i> + 10log(<i class="fm-italics">n</i>)</span></p>

  <p class="body-dialog"><span class="gray">  4.</span>   Consider the search space in figure C.3, where S is the start node and G1 and G2 are the goal nodes. Edges are labeled with the value of a cost function; the number gives the cost of traversing the arc. Above each node is the value of a heuristic function; the number gives the estimate of the distance to the goal. Assume that uninformed search algorithms always choose the left branch first when there is a choice. For each of the depth-first search (DFS) and breadth-first search (BFS) strategies</p>

  <p class="body-case-b">   a.  Indicate which goal state is reached first (if any).</p>

  <p class="body-case-b">   b.  List, in order, all the states that are popped off the OPEN list.</p>

  <div class="figure">
    <p class="figuree"><img alt="" class="calibre4" src="../Images/APPC_F03_Khamis.png"/></p>

    <p class="figurecaptione">Figure C.3 A graph search exercise</p>
  </div>

  <p class="body-dialog"><span class="gray">  5.</span>   Solve the crossword puzzle in figure C.4.</p>

  <div class="figure">
    <p class="figuree"><img alt="" class="calibre4" src="../Images/APPC_F04_Khamis.png"/></p>

    <p class="figurecaptione">Figure C.4 Blind search crossword puzzle</p>
  </div>

  <p class="fm-head3">Across</p>

  <p class="body-dialog"><span class="gray">  2.</span>   A depth-first search with a predetermined depth limit</p>

  <p class="body-dialog"><span class="gray">  7.</span>   A blind search algorithm that solves the single-source shortest path problem for a weighted graph with non-negative edge costs</p>

  <p class="body-dialog"><span class="gray">  8.</span>   A search algorithm that combines forward and backward search</p>

  <p class="body-dialog"><span class="gray">10.</span>   A graph traversal algorithm that first explores nodes going through one adjacent to the root, then the next adjacent, until it finds a solution or until it reaches a dead end</p>

  <p class="body-dialog"><span class="gray">11.</span>   A variant of Dijkstra’s algorithm that is appropriate for large graphs</p>

  <p class="body-dialog"><span class="gray">13.</span>   A function that is slightly faster than linear complexity</p>

  <p class="body-dialog"><span class="gray">14.</span>   A graph in which multiple edges may connect the same pair of vertices</p>

  <p class="body-dialog"><span class="gray">15.</span>   A last in, first out (LIFO) data structure</p>

  <p class="fm-head3">Down</p>

  <p class="body-dialog"><span class="gray">  1.</span>   A search algorithm that combines DFS’s space-efficiency and BFS’s fast search by incrementing the depth limit until the goal is reached</p>

  <p class="body-dialog"><span class="gray">  2.</span>   A graph used by Twitter to represent following</p>

  <p class="body-dialog"><span class="gray">  3.</span>   A graph traversal search algorithm that is preferred when the tree is deep</p>

  <p class="body-dialog"><span class="gray">  4.</span>   A generalization of a graph in which generalized edges can join any number of nodes</p>

  <p class="body-dialog"><span class="gray">  5.</span>   The type of graph used in LinkedIn to represent users, groups, unregistered persons, posts, skills, and jobs</p>

  <p class="body-dialog"><span class="gray">  6.</span>   A notation used to describe the performance or complexity of an algorithm</p>

  <p class="body-dialog"><span class="gray">  9.</span>   The process of exploring the structure of a tree or a graph by visiting the nodes following a certain well-defined rule</p>

  <p class="body-dialog"><span class="gray">12.</span>   A first in, first out (FIFO) data structure</p>

  <p class="body-ind1"><b class="fm-bold">Hint:</b> Spaces or dashes <i class="fm-italics">must</i> be used if the answer consists of two or more words.</p>

  <h3 class="fm-head1" id="heading_id_8">C.2.2 Solutions</h3>

  <p class="body-dialog"><span class="gray">  1.</span>   Multiple choice and true/false</p>

  <p class="body-dialogb"><span class="gray">1.1.</span>   d) All of the above</p>

  <p class="body-dialogb"><span class="gray">1.2.</span>   d) Depth-first search (DFS)</p>

  <p class="body-dialogb"><span class="gray">1.3.</span>   a) True</p>

  <p class="body-dialogb"><span class="gray">1.4.</span>   b) False</p>

  <p class="body-dialogb"><span class="gray">1.5.</span>   a) True</p>

  <p class="body-dialogb"><span class="gray">1.6.</span>   b) False</p>

  <p class="body-dialogb"><span class="gray">1.7.</span>   a) True</p>

  <p class="body-dialogb"><span class="gray">1.8.</span>   c) Heap</p>

  <p class="body-dialogb"><span class="gray">1.9.</span>   b) When all step costs are equal</p>

  <p class="body-dialogb"><span class="gray">1.10.</span> b) Iterative deepening search (IDS)</p>

  <p class="body-dialogb"><span class="gray">1.11.</span> c) Quasilinear</p>

  <p class="body-dialogb"><span class="gray">1.12.</span> b) Breadth-first search</p>

  <p class="body-dialog"><span class="gray">  2.</span>   The route obtained by BFS to go from A to M is</p>

  <p class="body-ind1">A<span class="cambria">→</span>B<span class="cambria">→</span>H<span class="cambria">→</span>C<span class="cambria">→</span>E<span class="cambria">→</span>I<span class="cambria">→</span>L<span class="cambria">→</span>D<span class="cambria">→</span>F<span class="cambria">→</span>J<span class="cambria">→</span>K<span class="cambria">→</span>M<span class="cambria">→</span>H<span class="cambria">→</span>G<span class="cambria">→</span>J<span class="cambria">→</span>K<span class="cambria">→</span>M:</p>

  <p class="body-ind1">tracking back, the final route is A<span class="cambria">→</span>H<span class="cambria">→</span>L<span class="cambria">→</span>M.</p>

  <p class="body-ind1">The route obtained by DFS to go from A to M is A<span class="cambria">→</span>B<span class="cambria">→</span>H<span class="cambria">→</span>C<span class="cambria">→</span>E<span class="cambria">→</span>F<span class="cambria">→</span>G<span class="cambria">→</span>J<span class="cambria">→</span>K<span class="cambria">→</span>I<span class="cambria">→</span>M.</p>

  <p class="body-dialog"><span class="gray">  3.</span>   The solutions are the following:</p>

  <p class="body-case-b">   a.  <span class="times"><i class="fm-italics">O</i>(nlogn)</span></p>

  <p class="body-case-b">   b.  <span class="times"><i class="fm-italics">O</i>(<i class="fm-italics">n</i>)</span></p>

  <p class="body-case-b">   c.  <span class="times"><i class="fm-italics">O</i>(<i class="fm-italics">n</i><sup class="fm-superscript">5</sup>)</span></p>

  <p class="body-case-b">   d.  <span class="times"><i class="fm-italics">O</i>(logn)</span></p>

  <p class="body-dialog"><span class="gray">  4.</span>   The solutions are the following:</p>

  <table border="1" class="contenttable-1-table" id="table001" width="100%">
    <colgroup class="contenttable-0-colgroup">
      <col class="contenttable-0-col" span="1" width="60%"/>
      <col class="contenttable-0-col" span="1" width="15%"/>
      <col class="contenttable-0-col" span="1" width="25%"/>
    </colgroup>

    <thead class="calibre6">
      <tr class="contenttable-0-tr">
        <th class="contenttable-1-th">
          <p class="fm-table-head">Search strategy</p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head">a</p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head">b</p>
        </th>
      </tr>
    </thead>

    <tbody class="calibre6">
      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body"><b class="fm-bold">Depth-first search</b> <b class="fm-bold">(DFS)</b></p>

          <p class="fm-table-body">Let’s assume that the nodes are expanded based on their lexicographical order (i.e., among the children of S, A is expanded first, since lexicographically, it is ordered before B and C).</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">G2</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">S, A, D, H, J, G2</p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body"><b class="fm-bold">Breadth-first search</b> <b class="fm-bold">(BFS)</b></p>

          <p class="fm-table-body">The status of the queue evolves such that</p>

          <p class="fm-table-body">[S], [S,A,B,C], [S,A,B,C,D,H], [S,A,B,C,D,H,G1]</p>

          <p class="fm-table-body">Note: Since H is already visited by A, it is not pushed again to the queue when being visited by B. However, it is reached twice.</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">G1</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">S, A, B, C, D, H, H, G1</p>
        </td>
      </tr>
    </tbody>
  </table>

  <p class="body-dialog"><span class="gray">  5.</span>   The crossword puzzle solutions are shown in figure C.5.</p>

  <div class="figure">
    <p class="figuree"><img alt="" class="calibre4" src="../Images/APPC_F05_Khamis.png"/></p>

    <p class="figurecaptione">Figure C.5 Blind search crossword puzzle solution</p>
  </div>

  <div class="calibre11"/>

  <div class="calibre12"/>

  <div class="calibre12"/>

  <div class="calibre12"/><h2 class="fm-head" id="heading_id_9">C.3 Chapter 4: Informed search algorithms</h2>

  <h3 class="fm-head1" id="heading_id_10">C.3.1 Exercises</h3>

  <p class="body-dialog"><span class="gray">  1.</span>   Multiple choice and true/false: Choose the correct answer for each of the following questions.</p>

  <p class="body-dialogb"><span class="gray">1.1</span>   How many shortcuts will we have to add to the augmented graph if we decide to contract node E in figure C.6?</p>

  <div class="figure">
    <p class="figuree"><img alt="" class="calibre4" src="../Images/APPC_F06_Khamis.png"/></p>

    <p class="figurecaptione">Figure C.6 Contracting node E</p>
  </div>

  <p class="body-case-b">   a.  0</p>

  <p class="body-case-b">   b.  1</p>

  <p class="body-case-b">   c.  2</p>

  <p class="body-case-b">   d.  3</p>

  <p class="body-dialogb"><span class="gray">1.2</span>   The A* algorithm is a special version of</p>

  <p class="body-case-b">   a.  Breadth-first search</p>

  <p class="body-case-b">   b.  Depth-first search</p>

  <p class="body-case-b">   c.  Hill climbing</p>

  <p class="body-case-b">   d.  Best-first search</p>

  <p class="body-case-b">   e.  Dijkstra’s algorithm</p>

  <p class="body-dialogb"><span class="gray">1.3</span>   Which of the following is <i class="fm-italics">not</i> a variant of the hill climbing algorithm?</p>

  <p class="body-case-b">   a.  Complex hill climbing</p>

  <p class="body-case-b">   b.  Steepest-ascent hill climbing</p>

  <p class="body-case-b">   c.  Random-restart hill climbing</p>

  <p class="body-case-b">   d.  Steepest-ascent hill climbing</p>

  <p class="body-case-b">   e.  All of the above are variants of hill climbing.</p>

  <p class="body-dialogb"><span class="gray">1.4</span>   If <span class="times"><i class="fm-italics">f</i>(<i class="fm-italics">n</i>)</span> is the evaluation function (cost) of a path through <i class="timesitalic">n</i> to the goal for each node, and <span class="times"><i class="fm-italics">h</i>(<i class="fm-italics">n</i>)</span> is an estimated cost from <i class="timesitalic">n</i> to the goal, such as the straight-line distance from <i class="timesitalic">n</i> to the goal, what is the heuristic function of greedy best-first search?</p>

  <p class="body-case-b">   a.  <span class="times"><i class="fm-italics">f</i>(<i class="fm-italics">n</i>) ≠ <i class="fm-italics">h</i>(<i class="fm-italics">n</i>)</span></p>

  <p class="body-case-b">   b.  <span class="times"><i class="fm-italics">f</i>(<i class="fm-italics">n</i>) &lt; <i class="fm-italics">h</i>(<i class="fm-italics">n</i>)</span></p>

  <p class="body-case-b">   c.  <span class="times"><i class="fm-italics">f</i>(<i class="fm-italics">n</i>) = <i class="fm-italics">h</i>(<i class="fm-italics">n</i>)</span></p>

  <p class="body-case-b">   d.  <span class="times"><i class="fm-italics">f</i>(<i class="fm-italics">n</i>) &gt; <i class="fm-italics">h</i>(<i class="fm-italics">n</i>)</span></p>

  <p class="body-dialogb"><span class="gray">1.5</span>   In the directed weighted graph in figure C.7, how many shortcuts are needed if we contract the white node?</p>

  <div class="figure">
    <p class="figuree"><img alt="" class="calibre4" src="../Images/APPC_F07_Khamis.png"/></p>

    <p class="figurecaptione">Figure C.7 Directed graph</p>
  </div>

  <p class="body-case-b">   a.  0</p>

  <p class="body-case-b">   b.  1</p>

  <p class="body-case-b">   c.  2</p>

  <p class="body-case-b">   d.  3</p>

  <p class="body-case-b">   e.  4</p>

  <p class="body-dialogb"><span class="gray">1.6</span>   The search strategy that uses problem-specific knowledge is known as</p>

  <p class="body-case-b">   a.  Informed search</p>

  <p class="body-case-b">   b.  Best-first search</p>

  <p class="body-case-b">   c.  A* search</p>

  <p class="body-case-b">   d.  Heuristic search</p>

  <p class="body-case-b">   e.  All of the above</p>

  <p class="body-dialogb"><span class="gray">1.7</span>   Which of the following is an algorithm used to solve the MST problem?</p>

  <p class="body-case-b">   a.  Kruskal</p>

  <p class="body-case-b">   b.  Borůvka</p>

  <p class="body-case-b">   c.  Jarník-Prim</p>

  <p class="body-case-b">   d.  Chazelle</p>

  <p class="body-case-b">   e.  All of the above</p>

  <p class="body-dialogb"><span class="gray">1.8</span>   Hill climbing is an informed breadth-first search that demands little in terms of memory and computational overhead.</p>

  <p class="body-case-b">   a.  True</p>

  <p class="body-case-b">   b.  False</p>

  <p class="body-dialogb"><span class="gray">1.9</span>   Node ordering methods for CH include</p>

  <p class="body-case-b">   a.  Edge difference</p>

  <p class="body-case-b">   b.  Iterative updates</p>

  <p class="body-case-b">   c.  Number of contracted neighbors</p>

  <p class="body-case-b">   d.  Shortcut cover</p>

  <p class="body-case-b">   e.  All of the above</p>

  <p class="body-dialogb"><span class="gray">1.10</span> A* is optimal if <span class="times"><i class="fm-italics">h</i>(<i class="fm-italics">n</i>)</span> is an admissible heuristic, i.e., <span class="times"><i class="fm-italics">h</i>(<i class="fm-italics">n</i>)</span> never overestimates the cost to reach the goal.</p>

  <p class="body-case-b">   a.  True</p>

  <p class="body-case-b">   b.  False</p>

  <p class="body-dialogb"><span class="gray">1.11</span> The edge difference is the number of shortcuts introduced when contracting a node minus the number of incoming edges onto the node.</p>

  <p class="body-case-b">   a.  True</p>

  <p class="body-case-b">   b.  False</p>

  <p class="body-dialogb"><span class="gray">1.12</span> Best-first is a mixed depth- and breadth-first search that uses heuristic values and expands the most desirable unexpanded node.</p>

  <p class="body-case-b">   a.  True</p>

  <p class="body-case-b">   b.  False</p>

  <p class="body-dialogb"><span class="gray">1.13</span> What is the evaluation function in A* search?</p>

  <p class="body-case-b">   a.  Estimated cost from the current node to the goal node</p>

  <p class="body-case-b">   b.  Cost of the path through the current node to the goal node</p>

  <p class="body-case-b">   c.  Sum of the path cost through the current node to the goal node and the estimated cost from the current node to the goal node</p>

  <p class="body-case-b">   d.  Average of the path cost through the current node to the goal node and the estimated cost from the current node to the goal node</p>

  <p class="body-case-b">   e.  None of the above</p>

  <p class="body-dialogb"><span class="gray">1.14</span> Which search is complete and optimal when <span class="times"><i class="fm-italics">h</i>(<i class="fm-italics">n</i>)</span> is consistent?</p>

  <p class="body-case-b">   a.  Best-first search</p>

  <p class="body-case-b">   b.  Depth-first search</p>

  <p class="body-case-b">   c.  Both best-first and depth-first search</p>

  <p class="body-case-b">   d.  A* search</p>

  <p class="body-dialogb"><span class="gray">1.15</span> In the contraction hierarchies (CH) algorithm, we contract nodes based on which of the following?</p>

  <p class="body-case-b">   a.  Decreasing order of their importance</p>

  <p class="body-case-b">   b.  Increasing order of their importance</p>

  <p class="body-dialogb"><span class="gray">1.16</span> The A* search algorithm tries to reduce the total number of states explored by incorporating a heuristic estimate of the cost to get the goal from a given state.</p>

  <p class="body-case-b">   a.  True</p>

  <p class="body-case-b">   b.  False</p>

  <p class="body-dialogb"><span class="gray">1.17</span> The hill climbing algorithm is a local greedy search algorithm that tries to improve the efficiency of breadth-first search.</p>

  <p class="body-case-b">   a.  True</p>

  <p class="body-case-b">   b.  False</p>

  <p class="body-dialogb"><span class="gray">1.18</span> In CH, the importance of a node may change during the contraction process, necessitating the recomputation of its importance.</p>

  <p class="body-case-b">   a.  True</p>

  <p class="body-case-b">   b.  False</p>

  <p class="body-dialogb"><span class="gray">1.19</span> A beam search with a beam width equal to the number of nodes in each level is the same as</p>

  <p class="body-case-b">   a.  Breadth-first search</p>

  <p class="body-case-b">   b.  Depth-first search</p>

  <p class="body-case-b">   c.  Hill climbing</p>

  <p class="body-case-b">   d.  Best-first search</p>

  <p class="body-case-b">   e.  Dijkstra’s algorithm</p>

  <p class="body-dialogb"><span class="gray">1.20</span> In CH, the order of contraction does not affect the query performance.</p>

  <p class="body-case-b">   a.  True</p>

  <p class="body-case-b">   b.  False</p>

  <p class="body-dialog"><span class="gray">  2.</span>   Consider the search space in figure C.8, where S is the start node and G1 and G2 are the goal nodes. The edges are labeled with the value of a cost function; the number gives the cost of traversing the arc. Above each node is the value of a heuristic function; the number gives the estimate of the distance to the goal. Using A* search strategy</p>

  <p class="body-case-b">   a.  Indicate which goal state is reached first (if any)</p>

  <p class="body-case-b">   b.  List in order all the states that are popped off until one of the goal state is found</p>

  <div class="figure">
    <p class="figuree"><img alt="" class="calibre4" src="../Images/APPC_F08_Khamis.png"/></p>

    <p class="figurecaptione">Figure C.8 Search space</p>
  </div>

  <p class="body-dialog"><span class="gray">  3.</span>   In the word search puzzle shown in figure C.9, find the hidden terms used in this chapter. You can search horizontally (from left to right or from right to left), vertically (from top to bottom or from bottom to top), or diagonally.</p>

  <div class="figure">
    <p class="figuree"><img alt="" class="calibre4" src="../Images/APPC_F09_Khamis.png"/></p>

    <p class="figurecaptione">Figure C.9 Informed search word-search puzzle</p>
  </div>

  <h3 class="fm-head1" id="heading_id_11">C.3.2 Solutions</h3>

  <p class="body-dialog"><span class="gray">  1.</span>   Multiple choice and true/false:</p>

  <p class="body-dialogb"><span class="gray">1.1</span>   a) 0 (no shortcut needed because a witness path exists between A and D)</p>

  <p class="body-dialogb"><span class="gray">1.2</span>   d) Best-first search</p>

  <p class="body-dialogb"><span class="gray">1.3</span>   a) Complex hill climbing</p>

  <p class="body-dialogb"><span class="gray">1.4</span>   c) <span class="times"><i class="fm-italics">f</i>(<i class="fm-italics">n</i>) = <i class="fm-italics">h</i>(<i class="fm-italics">n</i>)</span></p>

  <p class="body-dialogb"><span class="gray">1.5</span>   c) 2</p>

  <p class="body-dialogb"><span class="gray">1.6</span>   e) All of the above</p>

  <p class="body-dialogb"><span class="gray">1.7</span>   e) All of the above</p>

  <p class="body-dialogb"><span class="gray">1.8</span>   b) False (It is a variant of depth-first search.)</p>

  <p class="body-dialogb"><span class="gray">1.9</span>   e) All of the above</p>

  <p class="body-dialogb"><span class="gray">1.10</span> a) True</p>

  <p class="body-dialogb"><span class="gray">1.11</span> b) False (Edge difference is the number of shortcuts introduced when contracting a node minus the total degree of the node; i.e., the sum of the number of incoming edges onto the node plus the number of outgoing edges emanating from the node.)</p>

  <p class="body-dialogb"><span class="gray">1.12</span> a) True</p>

  <p class="body-dialogb"><span class="gray">1.13</span> b) Cost of the path through the current node to the goal node</p>

  <p class="body-dialogb"><span class="gray">1.14</span> d) A* search</p>

  <p class="body-dialogb"><span class="gray">1.15</span> b) Increasing order of their importance</p>

  <p class="body-dialogb"><span class="gray">1.16</span> a) True</p>

  <p class="body-dialogb"><span class="gray">1.17</span> b) False</p>

  <p class="body-dialogb"><span class="gray">1.18</span> a) True</p>

  <p class="body-dialogb"><span class="gray">1.19</span> a) Breadth-first search</p>

  <p class="body-dialogb"><span class="gray">1.20</span> b) False (The order of contraction does not affect the success of CH but will affect the preprocessing time and the query time. Some contraction ordering systems minimize the number of the shortcuts added in the augmented graph, and thus the overall running time.)</p>

  <p class="body-dialog"><span class="gray">  2.</span>   The order of expansion is based on the sum of edge weights <span class="times"><i class="fm-italics">g</i>(<i class="fm-italics">n</i>)</span> and the heuristic estimation <span class="times"><i class="fm-italics">h</i>(<i class="fm-italics">n</i>)</span>; i.e., <span class="times"><i class="fm-italics">f</i>(<i class="fm-italics">n</i>) = <i class="fm-italics">g</i>(<i class="fm-italics">n</i>) + <i class="fm-italics">h</i>(<i class="fm-italics">n</i>)</span>. For example, starting from <span class="times">S, <i class="fm-italics">f</i>(A) = 8, <i class="fm-italics">f</i>(B) = 18</span>, and <span class="times"><i class="fm-italics">f</i>(C) = 9</span>, so the queue would look like <span class="times">[A,B,C]</span> because <span class="times"><i class="fm-italics">f</i>(A) &lt; <i class="fm-italics">f</i>(C) &lt; <i class="fm-italics">f</i>(B)</span>.</p>

  <p class="body-ind1">At the next step, when A is popped off the queue, nodes D and H are evaluated such that <span class="times"><i class="fm-italics">f</i>(D) = <i class="fm-italics">d</i>(S,A) + <i class="fm-italics">d</i>(A,D) + <i class="fm-italics">h</i>(D) = 1 + 5 + 4 = 10</span>, and <span class="times"><i class="fm-italics">f</i>(H) = <i class="fm-italics">d</i>(S,A) + <i class="fm-italics">d</i>(A,H) + <i class="fm-italics">h</i>(H) = 19</span>, and pushing them onto the queue in order will result in <span class="times">[A,C,D,B,H]</span>.</p>

  <p class="body-ind1">Therefore, the next node to be expanded would be C, which adds E and F to the queue with <span class="times"><i class="fm-italics">f</i>(E) = 11</span> and <span class="times"><i class="fm-italics">f</i>(F) = 19: [A,C,D,E,B,H,F]</span></p>

  <p class="body-ind1">Hence, the next node is D, which causes an update on <span class="times"><i class="fm-italics">f</i>(H) = <i class="fm-italics">d</i>(S,A) + <i class="fm-italics">d</i>(A,D) + <i class="fm-italics">d</i>(D,H) + <i class="fm-italics">h</i>(H) = 1 + 5 + 2 + 6 = 14</span> that subsequently repositions it in the queue: <span class="times">[A,C,D,E,H,B,F]</span>. The same strategy should be followed until one of the goals is found.</p>

  <p class="body-case-b">   a.  G1</p>

  <p class="body-case-b">   b.  S, A, C, D, E, H, B, G1</p>

  <p class="body-dialog"><span class="gray">  3.</span>   The solution to the word search puzzle is shown in figure C.10.</p>

  <div class="figure">
    <p class="figuree"><img alt="" class="calibre4" src="../Images/APPC_F10_Khamis.png"/></p>

    <p class="figurecaptione">Figure C.10 Informed search word-search puzzle solution</p>
  </div>

  <p class="body-ind1">The word directions and start points are formatted as (direction, <i class="timesitalic">X, Y</i>).</p>

  <p class="body-ind1">A-START (E, 7, 10)<br class="calibre10"/>
  BEAM SEARCH (E, 8, 6)<br class="calibre10"/>
  BEST-FIRST (E, 8, 9)<br class="calibre10"/>
  DEPTH-FIRST (E, 7, 12)<br class="calibre10"/>
  DOWNWARD GRAPH<br class="calibre10"/>
  (E, 3, 11)<br class="calibre10"/>
  EDGE DIFFERENCE (E, 2, 4)<br class="calibre10"/>
  HAVERSINE (E, 2, 8)<br class="calibre10"/>
  HILL CLIMBING (E, 5, 1)<br class="calibre10"/>
  INFORMED SEARCH (E, 3, 3)<br class="calibre10"/>
  KRUSKAL ALGORITHM (E, 2, 7)<br class="calibre10"/>
  WITNESS PATH (S,1, 1)</p>

  <div class="calibre11"/>

  <div class="calibre12"/>

  <div class="calibre12"/>

  <div class="calibre12"/><h2 class="fm-head" id="heading_id_12">C.4 Chapter 5: Simulated annealing</h2>

  <h3 class="fm-head1" id="heading_id_13">C.4.1 Exercises</h3>

  <p class="body-dialog"><span class="gray">  1.</span>   Multiple choice and true/false: Choose the correct answer for each of the following questions.</p>

  <p class="body-dialogb"><span class="gray">1.1</span>   Simulated Annealing, unlike hill climbing, incorporates a probabilistic mechanism that allows it to accept downward steps, influenced by the current temperature and the quality of the move being considered.</p>

  <p class="body-case-b">   a.  True</p>

  <p class="body-case-b">   b.  False</p>

  <p class="body-dialogb"><span class="gray">1.2</span>   Simulated annealing is an optimization technique that always guarantees finding the global optimum solution.</p>

  <p class="body-case-b">   a.  True</p>

  <p class="body-case-b">   b.  False</p>

  <p class="body-dialogb"><span class="gray">1.3</span>   Dual annealing is an implementation of generalized hill climbing.</p>

  <p class="body-case-b">   a.  True</p>

  <p class="body-case-b">   b.  False</p>

  <p class="body-dialogb"><span class="gray">1.4</span>   In totally adaptive SA, a random combination of previously accepted steps and parameters are used to estimate new steps and parameters.</p>

  <p class="body-case-b">   a.  True</p>

  <p class="body-case-b">   b.  False</p>

  <p class="body-dialogb"><span class="gray">1.5</span>   The simulated annealing algorithm explores more of the search space when the temperature gets lower.</p>

  <p class="body-case-b">   a.  True</p>

  <p class="body-case-b">   b.  False</p>

  <p class="body-dialogb"><span class="gray">1.6.</span>   Which cooling schedule asymptotically converges toward the global minimum but requires prohibitive computing time?</p>

  <p class="body-case-b">   a.  Linear cooling schedule</p>

  <p class="body-case-b">   b.  Geometric cooling schedule</p>

  <p class="body-case-b">   c.  Logarithmic cooling schedule</p>

  <p class="body-case-b">   d.  Exponential cooling schedule</p>

  <p class="body-case-b">   e.  Nonmonotonic adaptive cooling schedule</p>

  <p class="body-dialogb"><span class="gray">1.7.</span>   SA uses a thermal jump to avoid getting trapped in local minima while quantum annealing relies on quantum tunneling.</p>

  <p class="body-case-b">   a.  True</p>

  <p class="body-case-b">   b.  False</p>

  <p class="body-dialog"><span class="gray">  2.</span>   The Rosenbrock function, often referred to as the “valley” or “banana” function, is a nonconvex function that is defined as <span class="times"><i class="fm-italics">f</i>(<i class="fm-italics">x</i>,<i class="fm-italics">y</i>) = (1 – <i class="fm-italics">x</i>)<sup class="fm-superscript">2</sup> + 100(<i class="fm-italics">y</i> – <i class="fm-italics">x</i><sup class="fm-superscript">2</sup>)<sup class="fm-superscript">2</sup></span>. This is a standard test function and quite tough for most conventional solvers.</p>

  <p class="body-case-b">   a.  Use listing 5.1 or 5.2 or implement your own version of the simulated annealing algorithm from scratch or using one the libraries mentioned in section A.4 of appendix A to find the global minimum of this function.</p>

  <p class="body-case-b">   b.  This banana function is still relatively simple, as it has a curved narrow valley. Other functions, such as the egg crate function, are strongly multimodal and highly nonlinear. Solve this egg crate function as an example of a highly nonlinear multimodal function: <span class="times"><i class="fm-italics">f</i>(<i class="fm-italics">x</i>,<i class="fm-italics">y</i>) = <i class="fm-italics">x</i><sup class="fm-superscript">2</sup> + <i class="fm-italics">y</i><sup class="fm-superscript">2</sup> + 25[sin<sup class="fm-superscript">2</sup>(<i class="fm-italics">x</i>) + sin<sup class="fm-superscript">2</sup>(<i class="fm-italics">y</i>)]</span>. Consider the domain <span class="times">(<i class="fm-italics">x</i>,<i class="fm-italics">y</i>) <span class="cambria">∈</span> [–5,5] × [–5,5]</span>. It would take about 2,500 evaluations to get an optimal solution accurate to the third decimal place.</p>

  <p class="body-case-b">   c.  Investigate the rate of convergence of simulated annealing for different cooling schedules.</p>

  <p class="body-case-b">   d.  For standard SA, the cooling schedule is a monotonically decreasing function. There is no reason why we should not use other forms of cooling. For example, we can use <span class="times"><i class="fm-italics">T</i>(<i class="fm-italics">i</i>) = <i class="fm-italics">T</i><sub class="fm-subscript">o</sub> cos<sup class="fm-superscript">2</sup>(<i class="fm-italics">i</i>)<i class="fm-italics">e</i><sup class="fm-superscript">–</sup><i class="fm-italics"><sup class="fm-superscript">α</sup><sup class="fm-superscript">i</sup></i>, <i class="timesitalic">α</i></span> <i class="timesitalic">&gt; 0</i>. Modify the code implemented in the previous step to study the behavior of various functions as a cooling schedule.</p>

  <p class="body-dialog"><span class="gray">  3.</span>   Modify listing 5.5, or use ASA-GS [2], or implement your own version of simulated annealing to conduct a comparative study between different TSP datasets (see listing B.2 in appendix B to see how to get access to TSP instances). Fill in table C.1 with the tour length obtained by simulated annealing.</p>

  <p class="fm-table-caption">Table C.1 SA solutions for different TSP datasets</p>

  <table border="1" class="contenttable-1-table" id="table002" width="100%">
    <colgroup class="contenttable-0-colgroup">
      <col class="contenttable-0-col" span="1" width="25%"/>
      <col class="contenttable-0-col" span="1" width="25%"/>
      <col class="contenttable-0-col" span="1" width="25%"/>
      <col class="contenttable-0-col" span="1" width="25%"/>
    </colgroup>

    <thead class="calibre6">
      <tr class="contenttable-0-tr">
        <th class="contenttable-1-th">
          <p class="fm-table-head">Dataset</p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head">Best known solution</p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head">SA solution</p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head">CPU time (s)</p>
        </th>
      </tr>
    </thead>

    <tbody class="calibre6">
      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body">burma14</p>

          <p class="fm-table-body">ulysses22</p>

          <p class="fm-table-body">oliver30</p>

          <p class="fm-table-body">att48</p>

          <p class="fm-table-body">eil51</p>

          <p class="fm-table-body">eil75</p>

          <p class="fm-table-body">kroA100</p>

          <p class="fm-table-body">d198</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">30.8758</p>

          <p class="fm-table-body">75.6651</p>

          <p class="fm-table-body">420</p>

          <p class="fm-table-body">33,524</p>

          <p class="fm-table-body">426</p>

          <p class="fm-table-body">535</p>

          <p class="fm-table-body">21,282</p>

          <p class="fm-table-body">15,780</p>
        </td>

        <td class="contenttable-1-td"/>

        <td class="contenttable-1-td"/>
      </tr>
    </tbody>
  </table>

  <p class="body-dialog"><span class="gray">  4.</span>   Solve TSP for 20 major US cities as shown in figure C.11. In this TSP, a travelling salesman must visit a number US cities starting from a specific city. Assume the following cities, defined by their names and GPS latitude and longitude coordinates: New York City (40.72, –74.00); Philadelphia (39.95, –75.17); Baltimore (39.28, –76.62); Charlotte (35.23, –80.85); Memphis (35.12, –89.97); Jacksonville (30.32, –81.70); Houston (29.77, –95.38); Austin (30.27, –97.77); San Antonio (29.53, –98.47); Fort Worth (32.75, –97.33); Dallas (32.78, –96.80); San Diego (32.78, –117.15); Los Angeles (34.05, –118.25); San Jose (37.30, –121.87); San Francisco (37.78, –122.42); Indianapolis (39.78, –86.15); Phoenix (33.45, –112.07); Columbus (39.98, –82.98); Chicago (41.88, –87.63); and Detroit (42.33, –83.05). Visualize the cities and the generated solution as a NetworkX graph using the GPS coordinates of each city.</p>

  <div class="figure">
    <p class="figuree"><img alt="" class="calibre4" src="../Images/APPC_F11_Khamis.png"/></p>

    <p class="figurecaptione">Figure C.11 Travelling salesman problem (TSP) for 20 largest US cities</p>
  </div>

  <p class="body-dialog"><span class="gray">  5.</span>   Solve the crossword puzzle in figure C.12.</p>

  <div class="figure">
    <p class="figuree"><img alt="" class="calibre4" src="../Images/APPC_F12_Khamis.png"/></p>

    <p class="figurecaptione">Figure C.12 Simulated annealing crossword puzzle</p>
  </div>

  <p class="fm-head3">Across</p>

  <p class="body-dialog"><span class="gray">  6.</span>   An optimization process that searches an energy landscape to find the optimal or near-optimal solution by applying quantum effects</p>

  <p class="body-dialog"><span class="gray">  7.</span>   The probability of acceptance or rejection of neighboring solutions</p>

  <p class="body-dialog"><span class="gray">10.</span>   A cooling process by which the temperature is decreased very quickly during the first iterations but the speed of the exponential decay is slowed down later</p>

  <p class="body-dialog"><span class="gray">11.</span>   A cooling schedule in which the maximum number of iterations needs to be specified</p>

  <p class="body-dialog"><span class="gray">12.</span>   Compared to this search algorithm, the main difference is that SA probabilistically allows downward steps controlled by current temperature and how bad a move is.</p>

  <p class="body-dialog"><span class="gray">13.</span>   A cooling schedule that requires a prohibitive computing time</p>

  <p class="fm-head3">Down</p>

  <p class="body-dialog"><span class="gray">  1.</span>   A stochastic or probabilistic model that describes a sequence of possible moves in which the probability of each move depends only on the state attained in the previous move</p>

  <p class="body-dialog"><span class="gray">  2.</span>   A cooling schedule that explicitly takes into consideration how the search is progressing</p>

  <p class="body-dialog"><span class="gray">  3.</span>   A cooling schedule that decreases the temperature by a cooling factor</p>

  <p class="body-dialog"><span class="gray">  4.</span>   An optimization process based on the physical annealing process</p>

  <p class="body-dialog"><span class="gray">  5.</span>   Probability distribution used in transition probability of simulated annealing</p>

  <p class="body-dialog"><span class="gray">  8.</span>   A quantum mechanical phenomenon whereby a wavefunction can propagate through a potential barrier</p>

  <p class="body-dialog"><span class="gray">  9.</span>   State of the system at which no better or worse moves are being accepted</p>

  <p class="body-ind1">Hint: Spaces and dashes <i class="fm-italics">must</i> be used if the answer consists of two words.</p>

  <h3 class="fm-head1" id="heading_id_14">C.4.2 Solutions</h3>

  <p class="body-dialog"><span class="gray">  1.</span>   Multiple choice and true/false</p>

  <p class="body-dialogb"><span class="gray">1.1</span>   a) True</p>

  <p class="body-dialogb"><span class="gray">1.2</span>   b) False</p>

  <p class="body-dialogb"><span class="gray">1.3</span>   b) False (Dual annealing is an implementation of the generalized simulated annealing algorithm.)</p>

  <p class="body-dialogb"><span class="gray">1.4</span>   a) True</p>

  <p class="body-dialogb"><span class="gray">1.5</span>   b) False (The simulated annealing algorithm exploits the search space when the temperature gets lower.)</p>

  <p class="body-dialogb"><span class="gray">1.6</span>   c) Logarithmic cooling schedule</p>

  <p class="body-dialogb"><span class="gray">1.7</span>   a) True</p>

  <p class="body-dialog"><span class="gray">  2.</span>   The generic forms of __problem_base.py and _sa.py, provided in the book’s GitHub repo, can be used to solve this problem. You can also modify listing 5.1 or 5.2 to solve this problem.</p>

  <p class="body-dialog"><span class="gray">  3.</span>   You can use listing 5.5 or the ASA-GS implementation [1] to run simulated annealing with selected parameters on different TSP instances and report your results. In listing 5.5, replace the permanent link with the link corresponding to the TSP instance. For example, click on burma14.tsp, click on the button with three dots at the upper-right corner, and select Copy Permalink. Consider tuning the algorithm’s parameters to get close to the best tour length known (so far) for each dataset.</p>

  <p class="body-dialog"><span class="gray">  4.</span>   The next listing shows how to use the generic solver implemented as part of the optalgo-tools package to solve this problem.</p>

  <p class="fm-code-listing-captione">Listing C.3 Solving TSP using SA</p>
  <pre class="programlistinge">from optalgotools.algorithms import SimulatedAnnealing
from optalgotools.problems import TSP
pairwise_distances = distances
  
tsp_US = TSP(dists=pairwise_distances, gen_method='insert',
<span class="fm-code-continuation-arrow">➥</span> init_method='greedy')
sa=SimulatedAnnealing(max_iter=10000, max_iter_per_temp=10000,
<span class="fm-code-continuation-arrow">➥</span> initial_temp=10000000, final_temp=0.0001,
<span class="fm-code-continuation-arrow">➥</span> cooling_schedule='geometric', cooling_alpha=0.9, debug=1)
  
sa.run(tsp_US)
print(sa.s_best)</pre>

  <p class="body-ind1">As a continuation of listing C.3, the following code shows how to solve this problem using the simanneal Python library:</p>
  <pre class="programlistinge">#!pip install simanneal 
import math
import random
from simanneal import Annealer
  
class TravellingSalesmanProblem(Annealer):                              <span class="fm-combinumeral">①</span>
    def __init__(self, state, distance_matrix):
        self.distance_matrix = distance_matrix
        super(TravellingSalesmanProblem, self).__init__(state)
  
    def move(self):                                                     <span class="fm-combinumeral">②</span>
        initial_energy = self.energy() 
        a = random.randint(0, len(self.state) - 1)
        b = random.randint(0, len(self.state) - 1)
        self.state[a], self.state[b] = self.state[b], self.state[a]
        return self.energy() - initial_energy
  
    def energy(self):                                                   <span class="fm-combinumeral">③</span>
        e = 0
        for i in range(len(self.state)):
            e += self.distance_matrix[self.state[i-1]][self.state[i]]
        return e
    
init_state = list(cities)                                               <span class="fm-combinumeral">④</span>
random.shuffle(init_state)                                              <span class="fm-combinumeral">④</span>
  
tsp = TravellingSalesmanProblem(init_state, distance_matrix)
tsp.set_schedule(tsp.auto(minutes=0.2))
tsp.copy_strategy = "slice"
state, e = tsp.anneal()
  
while state[0] != 'New York City':                                      <span class="fm-combinumeral">⑤</span>
    state = state[1:] + state[:1]  
  
print("%i mile route:" % e)                                             <span class="fm-combinumeral">⑥</span>
print(" <span class="times">➞</span>  ".join(state))                                              <span class="fm-combinumeral">⑥</span></pre>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">①</span> Test the annealer with a TSP as per the simanneal module.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">②</span> Swap two cities in the route.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">③</span> Calculate the length of the route.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">④</span> Initial state, a randomly ordered itinerary</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑤</span> Set New York City as the home city.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑥</span> Print the route and its cost.</p>

  <p class="body-ind1">As a continuation, the following code can be used to visualize the problem and its solution:</p>
  <pre class="programlistinge">fig, ax = plt.subplots(figsize=(15,10))
  
reversed_dict = {key: value[::-1] for key, value in cities.items()}        <span class="fm-combinumeral">①</span>
  
H = G.copy()                                                               <span class="fm-combinumeral">②</span>
  
edge_list = list(nx.utils.pairwise(state))
  
nx.draw_networkx_edges(H, pos=reversed_dict, edge_color="gray", width=0.5) <span class="fm-combinumeral">③</span>
  
ax=nx.draw_networkx(H, pos=reversed_dict, with_labels=True, edgelist=edge_list, 
edge_color="red", node_size=200, width=3,)                                 <span class="fm-combinumeral">④</span>
  
plt.show()                                                                 <span class="fm-combinumeral">⑤</span></pre>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">①</span> Reverse the lat and long for a correct visualization.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">②</span> Create an independent shallow copy of the graph and attributes.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">③</span> Draw the closest edges on each node only.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">④</span> Draw the route.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑤</span> Visualize.</p>

  <p class="body-ind1">Running this code produces the visualization shown in figure C.13.</p>

  <div class="figure">
    <p class="figuree"><img alt="" class="calibre4" src="../Images/APPC_F13_Khamis.png"/></p>

    <p class="figurecaptione">Figure C.13 Solution for the 20 major US cities TSP using simanneal</p>
  </div>

  <p class="body-ind1">Appendix A shows examples of available Python libraries, such as scikit-opt, DEAP, OR-Tools and simanneal, that can solve this problem using simulated annealing and other metaheuristics.</p>

  <p class="body-dialog"><span class="gray">  5.</span>   The solution to the crossword puzzle is shown in figure C.14.</p>

  <div class="figure">
    <p class="figuree"><img alt="" class="calibre4" src="../Images/APPC_F14_Khamis.png"/></p>

    <p class="figurecaptione">Figure C.14 Simulated annealing crossword puzzle solution</p>
  </div>

  <div class="calibre11"/>

  <div class="calibre12"/>

  <div class="calibre12"/>

  <div class="calibre12"/><h2 class="fm-head" id="heading_id_15">C.5 Chapter 6: Tabu search</h2>

  <h3 class="fm-head1" id="heading_id_16">C.5.1 Exercises</h3>

  <p class="body-dialog"><span class="gray">  1.</span>   Multiple choice and true/false: Choose the correct answer for each of the following questions.</p>

  <p class="body-dialogb"><span class="gray">1.1.</span>   In TS, non-improving solutions are conditionally accepted in order to escape from a local optimum.</p>

  <p class="body-case-b">   a.  True</p>

  <p class="body-case-b">   b.  False</p>

  <p class="body-dialogb"><span class="gray">1.2.</span>   A frequency-based memory maintains information about how recently a search point has been visited.</p>

  <p class="body-case-b">   a.  True</p>

  <p class="body-case-b">   b.  False</p>

  <p class="body-dialogb"><span class="gray">1.3.</span>   In order to increase the efficiency for solving some problems, TS uses memory via a tabu list to avoid revisiting recently visited neighborhoods.</p>

  <p class="body-case-b">   a.  True</p>

  <p class="body-case-b">   b.  False</p>

  <p class="body-dialogb"><span class="gray">1.4.</span>   The stopping criteria to terminate TS can be</p>

  <p class="body-case-b">   a.  Neighborhood is empty</p>

  <p class="body-case-b">   b.  Number of iterations is larger than a specified threshold</p>

  <p class="body-case-b">   c.  Evidence shows that an optimum solution has been obtained</p>

  <p class="body-case-b">   d.  All of the above (a, b, and c)</p>

  <p class="body-case-b">   e.  None of the above (a, b, or c)</p>

  <p class="body-dialogb"><span class="gray">1.5.</span>   Tabu-active moves are stored in a long-term memory.</p>

  <p class="body-case-b">   a.  True</p>

  <p class="body-case-b">   b.  False</p>

  <p class="body-dialogb"><span class="gray">1.6.</span>   For large and difficult problems (scheduling, quadratic assignment, and vehicle routing), tabu search obtains solutions that often represent a global optimum or near-optimum.</p>

  <p class="body-case-b">   a.  True</p>

  <p class="body-case-b">   b.  False</p>

  <p class="body-dialogb"><span class="gray">1.7.</span>   Recency memory is used to increase intensification of the search by remembering neighbors with good solutions.</p>

  <p class="body-case-b">   a.  True</p>

  <p class="body-case-b">   b.  False</p>

  <p class="body-dialogb"><span class="gray">1.8.</span>   Aspiration criteria are used to revoke tabu-active moves as a way to avoid search stagnation.</p>

  <p class="body-case-b">   a.  True</p>

  <p class="body-case-b">   b.  False</p>

  <p class="body-dialogb"><span class="gray">1.9.</span>   TS can be considered a combination of random search and memory structures.</p>

  <p class="body-case-b">   a.  True</p>

  <p class="body-case-b">   b.  False</p>

  <p class="body-dialogb"><span class="gray">1.10.</span> When the length of the tabu list is too small, the algorithm can get trapped in cycles, and when it’s too long, many moves could be prevented at each iteration, leading to stagnation.</p>

  <p class="body-case-b">   a.  True</p>

  <p class="body-case-b">   b.  False</p>

  <p class="body-dialog"><span class="gray">  2.</span>   As shown in appendix B, the Schwefel function is complex, with many local minima. Figure C.15 shows the two-dimensional form of the function.</p>

  <div class="figure">
    <p class="figuree"><img alt="" class="calibre4" src="../Images/APPC_F15_Khamis.png"/></p>

    <p class="figurecaptione">Figure C.15 The Schwefel function</p>
  </div>

  <p class="body-ind1">Modify listing 6.1 to solve the Schwefel function using tabu search.</p>

  <p class="body-dialog"><span class="gray">  3.</span>   Apple filed US Patent 7790637 B2 for a composite laminate that includes seven sheets stacked one over another and a scrim layer. Seven planar sheets of fibers impregnated with a resin (e.g., a viscous liquid substance) are placed with different orientations to improve the strength of the composite laminate, as illustrated in figure C.16. The scrim layer is the cosmetic layer, which is a different material and is bonded to the outside to improve the cosmetic exterior surface and consistent appearance.</p>

  <div class="figure">
    <p class="figuree"><img alt="" class="calibre4" src="../Images/APPC_F16_Khamis.png"/></p>

    <p class="figurecaptione">Figure C.16 Composite laminate design—Apple’s US patent 7790637 B2</p>
  </div>

  <p class="body-ind1">The way the seven layers are ordered results in different levels of strength in the composite laminate. Assume that the pairwise strength gain or loss is given by the empirical values in figure C.17. Positive values represent a strength gain in the case of contact between the two layers (up or down), and negative values represent the strength loss.</p>

  <div class="figure">
    <p class="figuree"><img alt="" class="calibre4" src="../Images/APPC_F17_Khamis.png"/></p>

    <p class="figurecaptione">Figure C.17 Pairwise strength gain or loss</p>
  </div>

  <p class="body-ind1">Assume that we want to find the optimal ordered combination (i.e., permutation) of the seven fiber sheets to maximize the composite laminate strength. Perform four hand iterations of tabu search to show the steps of the algorithm to solve this problem. Write Python code to solve this problem.</p>

  <p class="body-dialog"><span class="gray">  4.</span>   Write Python code to use tabu search to solve the simple assembly line balancing problem, type 1 (SALBP-1), with the machine and worker constraints described in Kamarudin and Rashid’s paper “Modelling of Simple Assembly Line Balancing Problem Type 1 (SALBP-1) with Machine and Worker Constraints” [3].</p>

  <p class="body-dialog"><span class="gray">  5.</span>   In the word search puzzle in figure C.18, find the hidden terms commonly used in tabu search. You can search horizontally (from left to right or right to left), vertically (from top to bottom or bottom to top), or diagonally.</p>

  <div class="figure">
    <p class="figuree"><img alt="" class="calibre4" src="../Images/APPC_F18_Khamis.png"/></p>

    <p class="figurecaptione">Figure C.18 TS word search puzzle</p>
  </div>

  <h3 class="fm-head1" id="heading_id_17">C.5.2 Solutions</h3>

  <p class="body-dialog"><span class="gray">  1.</span>   Multiple choice and true/false</p>

  <p class="body-dialogb"><span class="gray">1.1.</span>   a) True</p>

  <p class="body-dialogb"><span class="gray">1.2.</span>   b) False (Recency-based memory maintains information about how recently a search point has been visited.)</p>

  <p class="body-dialogb"><span class="gray">1.3.</span>   a) True</p>

  <p class="body-dialogb"><span class="gray">1.4.</span>   d) All of the above (a, b, and c)</p>

  <p class="body-dialogb"><span class="gray">1.5.</span>   b) False (Tabu-active moves are stored in a short-term memory.)</p>

  <p class="body-dialogb"><span class="gray">1.6.</span>   a) True</p>

  <p class="body-dialogb"><span class="gray">1.7.</span>   a) True</p>

  <p class="body-dialogb"><span class="gray">1.8.</span>   a) True</p>

  <p class="body-dialogb"><span class="gray">1.9.</span>   b) False (TS can be considered a combination of combination of local search and memory structures.)</p>

  <p class="body-dialogb"><span class="gray">1.10.</span> a) True</p>

  <p class="body-dialog"><span class="gray">  2.</span>   Listing C.4 in the book’s GitHub repository shows how to solve the Schwefel function using tabu search.</p>

  <p class="body-dialog"><span class="gray">  3.</span>   Figure C.19 shows the TS initialization and first iteration for the composite laminate problem. The number of possible permutations without repetition is <i class="fm-italics">n</i>!. The number of possible solutions for ordering the seven fiber sheets is <span class="times">7! = 5,040</span>. To generate a neighboring solution, fiber sheet swapping can be used. The neighborhood is defined as any other solution that is obtained by a pairwise exchange of any two sheets in the solution. If we let the number of nodes <span class="times"><i class="fm-italics">n</i> = 7</span>, pairwise exchange <span class="times"><i class="fm-italics">k</i> = 2</span>. The number of neighbors is the number of combinations without repetition <span class="times"><i class="fm-italics">C</i>(<i class="fm-italics">n</i>,<i class="fm-italics">k</i>)</span> or <i class="timesitalic">n</i>-choose-<i class="timesitalic">k</i>: <span class="times"><i class="fm-italics">C</i>(<i class="fm-italics">n</i>,<i class="fm-italics">k</i>) = <i class="fm-italics">n</i>! / (<i class="fm-italics">k</i>!(<i class="fm-italics">n</i> – <i class="fm-italics">k</i>)!) = 21 neighbors</span>. Let’s assume that the tabu tenure is set at 3 iterations.</p>

  <div class="figure">
    <p class="figuree"><img alt="" class="calibre4" src="../Images/APPC_F19_Khamis.png"/></p>

    <p class="figurecaptione">Figure C.19 TS initialization for the composite laminate design</p>
  </div>

  <p class="body-ind1">Figures C.20 through C.22 show iterations 1, 2, and 3 respectively.</p>

  <div class="figure">
    <p class="figuree"><img alt="" class="calibre4" src="../Images/APPC_F20_Khamis.png"/></p>

    <p class="figurecaptione">Figure C.20 Composite laminate design—iteration 1</p>
  </div>

  <div class="figure">
    <p class="figuree"><img alt="" class="calibre4" src="../Images/APPC_F21_Khamis.png"/></p>

    <p class="figurecaptione">Figure C.21 Composite laminate design—iteration 2</p>
  </div>

  <div class="figure">
    <p class="figuree"><img alt="" class="calibre4" src="../Images/APPC_F22_Khamis.png"/></p>

    <p class="figurecaptione">Figure C.22 Composite laminate design—iteration 3</p>
  </div>

  <p class="body-ind1">In each iteration, we generate a number of candidate solution using layer swapping, and we select the move that results in the maximum delta value, which is the difference between the previous solution and the new solution in terms of strength gain. In the next iteration, shown in figure C.23, there is no move with a positive gain, so the best (non-tabu) move will be non-improving. The move (a,e) is selected, since it has a tabu tenure of only one iteration compared to the other tabu-active best move (a,b). This means that the tabu status of (a,e) can be overridden by applying the aspiration criteria.</p>

  <div class="figure">
    <p class="figuree"><img alt="" class="calibre4" src="../Images/APPC_F23_Khamis.png"/></p>

    <p class="figurecaptione">Figure C.23 Composite laminate design—TS iteration 4 and aspiration criterion</p>
  </div>

  <p class="body-ind1">To show the diversification using frequency-based memory, assume that the solution reached after 26 iterations is [a c f b g e d], and the strength value is 23. Assume that we will penalize the solution based on its frequency in usage (a highly repetitive solution gets more penalties). The tabu structure is updated based on both recency-based (upper triangle) and frequency-based (lower triangle) memories, as shown in figure C.24a. The five top candidates after swapping are shown in figure C.24b.</p>

  <div class="figure">
    <p class="figuree"><img alt="" class="calibre4" src="../Images/APPC_F24_Khamis.png"/></p>

    <p class="figurecaptione">Figure C.24 a) Recency- and frequency-based memory, b) five top candidates after swapping with their penalty values</p>
  </div>

  <p class="body-ind1">We need to diversify when no admissible improving moves exist. Non-improving moves are penalized by assigning larger penalties to more frequent swaps. According to the penalized value, swap (a,f) is chosen. Listing C.5 shows the solution of the composite laminate problem using tabu search.</p>

  <p class="fm-code-listing-captione">Listing C.5 Solving the composite laminate problem using tabu search</p>
  <pre class="programlistinge">from optalgotools.problems import SHEETS                                <span class="fm-combinumeral">①</span>
from optalgotools.algorithms import TabuSearch                          <span class="fm-combinumeral">②</span>
import matplotlib.pyplot as plt
 
iphone_case = SHEETS(init_method='greedy')                              <span class="fm-combinumeral">③</span>
  
ts = TabuSearch(max_iter=1000, tabu_tenure=10, neighbor_size=7,
<span class="fm-code-continuation-arrow">➥</span> use_aspiration=True, aspiration_limit=3, use_longterm=False, debug=1,
<span class="fm-code-continuation-arrow">➥</span> maximize=True, penalize=True)                                        <span class="fm-combinumeral">④</span>
  
ts.init_ts(iphone_case)                                                 <span class="fm-combinumeral">⑤</span>
ts.val_cur
  
ts.run(iphone_case, repetition=1)                                       <span class="fm-combinumeral">⑥</span>
ts.val_allbest</pre>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">①</span> Import the SHEETS problem instance, which contains the composite laminate design problem description.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">②</span> Import the tabu search solver.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">③</span> Create different sheets objects. For a complete list of the supported parameters, see the SHEETS class in the sheets.py file in the optalgotools.problems module.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">④</span> Create a TS object to help in solving the composite laminate problem.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑤</span> Get an initial random solution, and check its cost.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑥</span> Run TS, and evaluate the best solution cost.</p>

  <p class="body-dialog"><span class="gray">  4.</span>   Listing C.6 shows a snippet of the code for solving the SALBP-1 problem using tabu search.</p>

  <p class="fm-code-listing-captione">Listing C.6 Solving the SALBP-1 problem using tabu search</p>
  <pre class="programlistinge">tasks = pd.DataFrame(columns=['Task', 'Duration'])                           <span class="fm-combinumeral">①</span>
tasks= pd.read_csv("https://raw.githubusercontent.com/Optimization-          <span class="fm-combinumeral">①</span>
Algorithms-Book/Code-Listings/main/Appendix%20B/data/ALBP/ALB_TS_DATA2.txt", <span class="fm-combinumeral">①</span>
sep =",")                                                                    <span class="fm-combinumeral">①</span>
Prec= pd.read_csv("https://raw.githubusercontent.com/Optimization-
<span class="fm-code-continuation-arrow">➥</span>Algorithms-Book/Code-                                                      <span class="fm-combinumeral">①</span>
<span class="fm-code-continuation-arrow">➥</span>Listings/main/Appendix%20B/data/ALBP/ALB_TS_PRECEDENCE2.txt", sep =",")    <span class="fm-combinumeral">①</span>
Prec.columns=['TASK', 'IMMEDIATE_PRECEDESSOR']                               <span class="fm-combinumeral">①</span>
  
Cycle_time = 10                                                              <span class="fm-combinumeral">②</span>
  
tenure = 3
max_itr=100
  
solution = Initial_Solution(len(tasks))                                      <span class="fm-combinumeral">③</span>
soln_init = Make_Solution_Feasible(solution, Prec)                           <span class="fm-combinumeral">④</span>
  
sol_best, SI_best=tabu_search(max_itr, soln_init, SI_init, tenure, WS,
<span class="fm-code-continuation-arrow">➥</span> tasks, Prec_Matrix, Cycle_time)                                           <span class="fm-combinumeral">⑤</span>
  
Smoothing_index(sol_best, WS, tasks, Cycle_time, True)                       <span class="fm-combinumeral">⑥</span>
  
  
plt = Make_Solution_to_plot(sol_best, WS, tasks, Cycle_time)                 <span class="fm-combinumeral">⑦</span>
plt.show()                                                                   <span class="fm-combinumeral">⑦</span></pre>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">①</span> Read the data from appendix B directly using the URL.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">②</span> Define the cycle time.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">③</span> Get an initial solution.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">④</span> Ensure the feasibility of the solution considering the task precedence constraint.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑤</span> Run the tabu search.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑥</span> Calculate the smoothing index of the best solution.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑦</span> Visualize the solution.</p>

  <p class="body-ind1">Running the complete code produces the following output:</p>
  <pre class="programlistinge">The Smoothing Index value for ['T2', 'T7', 'T6', 'T1', 'T3', 'T4', 'T8',
<span class="fm-code-continuation-arrow">➥</span> 'T9', 'T5'] solution sequence is: 1.0801234497346432 
The number of workstations for ['T2', 'T7', 'T6', 'T1', 'T3', 'T4', 'T8',
<span class="fm-code-continuation-arrow">➥</span> 'T9', 'T5'] solution sequence is: 6 
The workloads of workstation for ['T2', 'T7', 'T6', 'T1', 'T3', 'T4', 'T8',
<span class="fm-code-continuation-arrow">➥</span> 'T9', 'T5'] solution sequence are: [7. 6. 5. 7. 6. 6.]
1.0801234497346432</pre>

  <p class="body-ind1">Complete code is available in the book’s GitHub repo.</p>

  <p class="body-dialog"><span class="gray">  5.</span>   The solution to the word search puzzle is shown in figure C.25.</p>

  <div class="figure">
    <p class="figuree"><img alt="" class="calibre4" src="../Images/APPC_F25_Khamis.png"/></p>

    <p class="figurecaptione">Figure C.25 TS word search puzzle solution</p>
  </div>

  <p class="body-ind1">The word directions and start points are formatted as (Direction, <i class="timesitalic">X, Y</i>)</p>

  <p class="body-ind1">ADAPTIVE MEMORY (W, 17, 13)<br class="calibre10"/>
  ASPIRATION CRITERIA (W, 23, 15)<br class="calibre10"/>
  DIVERSIFICATION (W, 23, 14)<br class="calibre10"/>
  FREQUENCY-BASED MEMORY (W, 21, 7)<br class="calibre10"/>
  INTENSIFICATION (E, 8, 8)<br class="calibre10"/>
  LOCAL SEARCH (W, 16, 6)<br class="calibre10"/>
  LONG-TERM MEMORY (E, 1, 10)<br class="calibre10"/>
  RECENCY (E, 12, 1)<br class="calibre10"/>
  RESPONSIVE EXPLORATION (W, 23, 16)<br class="calibre10"/>
  SENSORY MEMORY (W, 16, 3)<br class="calibre10"/>
  SHORT-TERM MEMORY (W, 16, 4)<br class="calibre10"/>
  TABU LIST (E, 6, 12)<br class="calibre10"/>
  TABU SEARCH (E, 1, 5)<br class="calibre10"/>
  TABU STRUCTURE (W, 23, 2)<br class="calibre10"/>
  TABU TENURE (E, 12, 5)<br class="calibre10"/>
  WORKING MEMORY (W, 20, 9)</p>

  <div class="calibre11"/>

  <div class="calibre12"/>

  <div class="calibre12"/>

  <div class="calibre12"/><h2 class="fm-head" id="heading_id_18">C.6 Chapter 7: Genetic algorithm</h2>

  

<h3 class="fm-head1" id="heading_id_19">C.6.1 Exercises</h3>

  <p class="body-dialog"><span class="gray">  1.</span>   Multiple choice and true/false: Choose the correct answer for each of the following questions.</p>

  <p class="body-dialogb"><span class="gray">1.1.</span>   Given a binary string 1101001100101101 and another binary string yxyyxyxxyyyxyxxy in which the values 0 and 1 are denoted by x and y, what offspring result from applying 1-point crossover on the two strings at a randomly selected recombination point?</p>

  <p class="body-case-b">   a.  yxxyyyxyxxy11010 and yxyyx01100101101</p>

  <p class="body-case-b">   b.  11010yxxyyyxyxxy and yxyyx01100101101</p>

  <p class="body-case-b">   c.  11010yxxyyyxyxxy and 01100101101yxyyx</p>

  <p class="body-case-b">   d.  None of the above</p>

  <p class="body-dialogb"><span class="gray">1.2.</span>   In binary genetic algorithms, how does the bitwise mutation operator work?</p>

  <p class="body-case-b">   a.  It swaps the positions of two randomly chosen bits.</p>

  <p class="body-case-b">   b.  It averages the values of two randomly chosen bits.</p>

  <p class="body-case-b">   c.  It flips a randomly chosen bit in the binary representation.</p>

  <p class="body-case-b">   d.  It reverses the order of a randomly chosen segment of bits.</p>

  <p class="body-dialogb"><span class="gray">1.3.</span>   The name of the position on the chromosome every gene has is called</p>

  <p class="body-case-b">   a.  Allele</p>

  <p class="body-case-b">   b.  Locus</p>

  <p class="body-case-b">   c.  Genotype</p>

  <p class="body-case-b">   d.  Phenotype</p>

  <p class="body-case-b">   e.  None of the above</p>

  <p class="body-dialogb"><span class="gray">1.4.</span>   In the steady-state model of genetic algorithms, how are new offspring introduced into the population?</p>

  <p class="body-case-b">   a.  By replacing the entire population</p>

  <p class="body-case-b">   b.  By replacing a small fraction of the population</p>

  <p class="body-case-b">   c.  By adding them to the existing population</p>

  <p class="body-case-b">   d.  By replacing the worst individuals in the population</p>

  <p class="body-dialogb"><span class="gray">1.5.</span>   Suppose you have the population shown in table C.2.</p>

  <p class="fm-table-caption">Table C.2 Given population</p>

  <table border="1" class="contenttable-1-table" id="table003" width="100%">
    <colgroup class="contenttable-0-colgroup">
      <col class="contenttable-0-col" span="1" width="16.66%"/>
      <col class="contenttable-0-col" span="1" width="16.66%"/>
      <col class="contenttable-0-col" span="1" width="16.66%"/>
      <col class="contenttable-0-col" span="1" width="16.66%"/>
      <col class="contenttable-0-col" span="1" width="16.66%"/>
      <col class="contenttable-0-col" span="1" width="16.66%"/>
    </colgroup>

    <thead class="calibre6">
      <tr class="contenttable-0-tr">
        <th class="contenttable-1-th">
          <p class="fm-table-head">Individual</p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head">Individual 1</p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head">Individual 2</p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head">Individual 3</p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head">Individual 4</p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head">Individual 5</p>
        </th>
      </tr>
    </thead>

    <tbody class="calibre6">
      <tr class="contenttable-0-tr">
        <td class="contenttable-1-th1">
          <p class="fm-table-head">Fitness</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">12</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">25</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">8</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">53</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">10</p>
        </td>
      </tr>
    </tbody>
  </table>

  <p class="body-ind1">Rank-based selection attempts to remove problems of fitness-proportionate selection (FPS) by basing selection probabilities on relative rather than absolute fitness. Assume that the ranking process is linear ranking, as follows:</p>

  <div class="figure">
    <p class="figuree"><img alt="" class="calibre4" src="../Images/APPC_F25_Khamis-EQ01.png"/></p>
  </div>

  <p class="body-ind1">where <i class="timesitalic">N</i> is the number of individuals in the population and <i class="timesitalic">r</i> is the rank associated with each individual in this population (the least fit individual has <span class="times"><i class="fm-italics">r</i> = 1</span>, the fittest individual <span class="times"><i class="fm-italics">r</i> = <i class="fm-italics">N</i>)</span>. <i class="timesitalic">SP</i> is the selection pressure (assume <span class="times"><i class="fm-italics">SP</i> = 1.5</span>). Which two individuals will be selected if we use this linear ranking-based selection?</p>

  <p class="body-case-b">   a.  Individuals 1 and 2</p>

  <p class="body-case-b">   b.  Individuals 1 and 3</p>

  <p class="body-case-b">   c.  Individuals 2 and 3</p>

  <p class="body-case-b">   d.  Individuals 2 and 4</p>

  <p class="body-case-b">   e.  Individuals 3 and 4</p>

  <p class="body-case-b">   f.  None of the above</p>

  <p class="body-dialogb"><span class="gray">1.6.</span>   Which selection method in genetic algorithms involves choosing a fixed number of individuals at random and selecting the best among them?</p>

  <p class="body-case-b">   a.  Roulette wheel selection</p>

  <p class="body-case-b">   b.  Rank selection</p>

  <p class="body-case-b">   c.  Tournament selection</p>

  <p class="body-case-b">   d.  Stochastic universal sampling (SUS)</p>

  <p class="body-dialogb"><span class="gray">1.7.</span>   In P-metaheuristics, the computational cost of the Latin hypercube strategy is the same as the pseudo-random initialization strategy.</p>

  <p class="body-case-b">   a.  True</p>

  <p class="body-case-b">   b.  False</p>

  <p class="body-dialogb"><span class="gray">1.8.</span>   In binary genetic algorithms, which type of chromosome encoding is used?</p>

  <p class="body-case-b">   a.  Real value</p>

  <p class="body-case-b">   b.  Permutation</p>

  <p class="body-case-b">   c.  Binary</p>

  <p class="body-case-b">   d.  Tree</p>

  <p class="body-dialogb"><span class="gray">1.9.</span>   Which of the following methods can be used to convert a minimization problem into a maximization problem in optimization?</p>

  <p class="body-case-b">   a.  Adding a constant to the objective function</p>

  <p class="body-case-b">   b.  Taking the reciprocal of the objective function</p>

  <p class="body-case-b">   c.  Negating the objective function</p>

  <p class="body-case-b">   d.  Scaling the objective function by a factor</p>

  <p class="body-dialogb"><span class="gray">1.10.</span> Which of the following is an advantage of the steady-state model compared to the generational model in genetic algorithms?</p>

  <p class="body-case-b">   a.  Faster convergence</p>

  <p class="body-case-b">   b.  Better diversity preservation</p>

  <p class="body-case-b">   c.  Lower computational cost</p>

  <p class="body-case-b">   d.  More robust mutation operators</p>

  <p class="body-dialogb"><span class="gray">1.11.</span> In a binary genetic algorithm, what does the mutation operator do to an individual’s genes?</p>

  <p class="body-case-b">   a.  Reverses the gene value (1 to 0 or 0 to 1)</p>

  <p class="body-case-b">   b.  Randomly assigns a new gene value (0 or 1)</p>

  <p class="body-case-b">   c.  Swaps the positions of two genes</p>

  <p class="body-case-b">   d.  Combines genes from different individuals</p>

  <p class="body-dialogb"><span class="gray">1.12.</span> Which of the following is a commonly used crossover method in binary genetic algorithms?</p>

  <p class="body-case-b">   a.  Single-point crossover</p>

  <p class="body-case-b">   b.  Two-point crossover</p>

  <p class="body-case-b">   c.  Uniform crossover</p>

  <p class="body-case-b">   d.  All of the above</p>

  <p class="body-dialogb"><span class="gray">1.13.</span> What is the primary difference between generational and steady-state models in genetic algorithms?</p>

  <p class="body-case-b">   a.  Selection methods</p>

  <p class="body-case-b">   b.  Crossover operators</p>

  <p class="body-case-b">   c.  Mutation operators</p>

  <p class="body-case-b">   d.  Replacement strategies</p>

  <p class="body-dialogb"><span class="gray">1.14.</span> Which crossover method in binary genetic algorithms involves exchanging genetic material between parent chromosomes based on a predefined probability for each gene?</p>

  <p class="body-case-b">   a.  Single-point crossover</p>

  <p class="body-case-b">   b.  Two-point crossover</p>

  <p class="body-case-b">   c.  Uniform crossover</p>

  <p class="body-case-b">   d.  Arithmetic crossover</p>

  <p class="body-dialogb"><span class="gray">1.15.</span> What is a potential disadvantage of using a high mutation rate in binary genetic algorithms?</p>

  <p class="body-case-b">   a.  Loss of diversity in the population</p>

  <p class="body-case-b">   b.  Premature convergence</p>

  <p class="body-case-b">   c.  Disruption of good solutions</p>

  <p class="body-case-b">   d.  Decreased selection pressure</p>

  <p class="body-dialogb"><span class="gray">1.16.</span> In the generational model of genetic algorithms, what happens to the population in each generation?</p>

  <p class="body-case-b">   a.  A small fraction of the population is replaced.</p>

  <p class="body-case-b">   b.  The entire population is replaced.</p>

  <p class="body-case-b">   c.  The population remains the same.</p>

  <p class="body-case-b">   d.  The population size is gradually reduced.</p>

  <p class="body-dialogb"><span class="gray">1.17.</span> When using a transformation to convert a minimization problem into a maximization problem, which property of the optimal solution must be preserved?</p>

  <p class="body-case-b">   a.  Feasibility</p>

  <p class="body-case-b">   b.  Optimality</p>

  <p class="body-case-b">   c.  Dominance</p>

  <p class="body-case-b">   d.  Convexity</p>

  <p class="body-dialogb"><span class="gray">1.18.</span> What are the primary operators used in genetic algorithms?</p>

  <p class="body-case-b">   a.  Initialization, pooling, and backpropagation</p>

  <p class="body-case-b">   b.  Selection, crossover, and mutation</p>

  <p class="body-case-b">   c.  Convolution, pooling, and activation</p>

  <p class="body-case-b">   d.  Forward propagation, backward propagation, and optimization</p>

  <p class="body-dialogb"><span class="gray">1.19.</span> Which of the following is an advantage of the generational model compared to the steady-state model in genetic algorithms?</p>

  <p class="body-case-b">   b.  Improved diversity preservation</p>

  <p class="body-case-b">   b.  Faster convergence</p>

  <p class="body-case-b">   c.  Lower computational cost</p>

  <p class="body-case-b">   d.  Better handling of constraints</p>

  <p class="body-dialogb"><span class="gray">1.20.</span> Suppose you need to solve the following function maximization problem using a binary genetic algorithm:</p>

  <div class="figure">
    <p class="figuree"><img alt="" class="calibre4" src="../Images/APPC_F25_Khamis-EQ02.png"/></p>
  </div>

  <p class="body-ind1">where</p>

  <p class="body-case-b">   •   <i class="timesitalic">O<sub class="fm-subscript">i</sub></i> is the objective function value of individual <i class="timesitalic">i</i> and <span class="times"><i class="fm-italics">O<sub class="fm-subscript">i</sub></i> = –(<i class="fm-italics">x</i> – 6.4)<sup class="fm-superscript">2</sup></span>.</p>

  <p class="body-case-b">   •   <i class="timesitalic">N</i> is the population size.</p>

  <p class="body-case-b">   •   <i class="timesitalic">V</i> is a large value to ensure non-negative fitness values.</p>

  <p class="body-ind1">The value of <i class="timesitalic">V</i> is the maximum value of the second term of the fitness function <span class="times"><i class="fm-italics">f</i>(<i class="fm-italics">x</i>)</span> so that the fitness value corresponding to the maximum value of the objective function is 0. How many bits are required to represent the solution with precision 0.1?</p>

  <p class="body-case-b">   a.   6 bits</p>

  <p class="body-case-b">   b.   7 bits</p>

  <p class="body-case-b">   c.   8 bits</p>

  <p class="body-case-b">   d.   9 bits</p>

  <p class="body-case-b">   e. 10 bits</p>

  <p class="body-case-b">   f.  None of the above</p>

  <p class="body-dialog"><span class="gray">  2.</span>   The Ackley function is a nonlinear, multimodal function with a large number of local minima, making it a challenging optimization problem. The general form of the Ackley function is</p>

  <div class="figure">
    <p class="figuree"><img alt="" class="calibre4" src="../Images/APPC_F25_Khamis-EQ03.png"/></p>
  </div>

  <p class="body-ind1">where</p>

  <p class="body-case-b">   •   <span class="times"><i class="fm-italics">x</i> = (<i class="fm-italics">x</i><sub class="fm-subscript">1</sub>, <i class="fm-italics">x</i><sub class="fm-subscript">2</sub>, ..., <i class="fm-italics">x<sub class="fm-subscript">d</sub></i>)</span> is the input vector.</p>

  <p class="body-case-b">   •   <i class="timesitalic">a, b</i>, and <i class="timesitalic">c</i> are positive constants (usually <span class="times"><i class="fm-italics">a</i> = 20</span>, <span class="times"><i class="fm-italics">b</i> = 0.2</span>, and <span class="times"><i class="fm-italics">c</i> = 2 × <i class="timesitalic">π</i></span>).</p>

  <p class="body-case-b">   •   d is the dimension of the input vector.</p>

  <p class="body-ind1">The function has a global minimum at the origin (<span class="times"><i class="fm-italics">x<sub class="fm-subscript">i</sub> =</i> 0</span>), where <span class="times"><i class="fm-italics">f(x) =</i> 0</span>, and it is surrounded by several local minimam, as shown in figure C.26.</p>

  <div class="figure">
    <p class="figuree"><img alt="" class="calibre4" src="../Images/APPC_F26_Khamis.png"/></p>

    <p class="figurecaptione">Figure C.26 The Ackley function</p>
  </div>

  <p class="body-ind1">The presence of these local minima makes it difficult for optimization algorithms to find the global minimum, especially those that can get stuck in local minima. Write Python code to solve a 6D Ackley function.</p>

  <h3 class="fm-head1" id="heading_id_20">C.6.2 Solutions</h3>

  <p class="body-dialog"><span class="gray">  1.</span>   Multiple choice and true/false</p>

  <p class="body-dialogb"><span class="gray">1.1.</span>   b) 11010yxxyyyxyxxy and yxyyx01100101101</p>

  <p class="body-dialogb"><span class="gray">1.2.</span>   c) It flips a randomly chosen bit in the binary representation.</p>

  <p class="body-dialogb"><span class="gray">1.3.</span>   b) Locus</p>

  <p class="body-dialogb"><span class="gray">1.4.</span>   b) By replacing a small fraction of the population</p>

  <p class="body-dialogb"><span class="gray">1.5.</span>   Considering the following linear ranking</p>

  <div class="figure">
    <p class="figuree"><img alt="" class="calibre4" src="../Images/APPC_F26_Khamis-EQ04.png"/></p>
  </div>

  <table border="1" class="contenttable-1-table" id="table004" width="100%">
    <colgroup class="contenttable-0-colgroup">
      <col class="contenttable-0-col" span="1" width="16.66%"/>
      <col class="contenttable-0-col" span="1" width="16.66%"/>
      <col class="contenttable-0-col" span="1" width="16.66%"/>
      <col class="contenttable-0-col" span="1" width="16.66%"/>
      <col class="contenttable-0-col" span="1" width="16.66%"/>
      <col class="contenttable-0-col" span="1" width="16.66%"/>
    </colgroup>

    <thead class="calibre6">
      <tr class="contenttable-0-tr">
        <th class="contenttable-1-th">
          <p class="fm-table-head">Individual</p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head">Individual 1</p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head">Individual 2</p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head">Individual 3</p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head">Individual 4</p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head">Individual 5</p>
        </th>
      </tr>
    </thead>

    <tbody class="calibre6">
      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body">Fitness</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">12</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">25</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">8</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">53</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">10</p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body">Ranking r</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">3</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">4</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">1</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">5</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">2</p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body">p(r)</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.175</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body"><b class="fm-bold">0</b>.<b class="fm-bold">2</b></p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.125</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body"><b class="fm-bold">0</b>.<b class="fm-bold">225</b></p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.15</p>
        </td>
      </tr>
    </tbody>
  </table>

  <p class="body-ind1">Individuals 4 and 2 will be selected, as they have the highest probability. So the correct answer is d.</p>

  <p class="body-dialogb"><span class="gray">1.6.</span>   c) Tournament selection</p>

  <p class="body-dialogb"><span class="gray">1.7.</span>   a) True</p>

  <p class="body-dialogb"><span class="gray">1.8.</span>   c) Binary</p>

  <p class="body-dialogb"><span class="gray">1.9.</span>   b and c) Taking the reciprocal of the objective function, and negating the objective function</p>

  <p class="body-dialogb"><span class="gray">1.10.</span> c) Lower computational cost</p>

  <p class="body-dialogb"><span class="gray">1.11.</span> a) Reverses the gene value (1 to 0 or 0 to 1)</p>

  <p class="body-dialogb"><span class="gray">1.12.</span> d) All of the above</p>

  <p class="body-dialogb"><span class="gray">1.13.</span> d) Replacement strategies</p>

  <p class="body-dialogb"><span class="gray">1.14.</span> c) Uniform crossover</p>

  <p class="body-dialogb"><span class="gray">1.15.</span> c) Disruption of good solutions</p>

  <p class="body-dialogb"><span class="gray">1.16.</span> b) The entire population is replaced.</p>

  <p class="body-dialogb"><span class="gray">1.17.</span> b) Optimality</p>

  <p class="body-dialogb"><span class="gray">1.18.</span> b) Selection, crossover, and mutation</p>

  <p class="body-dialogb"><span class="gray">1.19.</span> a) Improved diversity preservation</p>

  <p class="body-dialogb"><span class="gray">1.20.</span> d) 9 bits</p>

  <p class="body-ind1">Given <span class="times">0.0 &lt;= <i class="fm-italics">x</i> &lt;= 31.5</span> with a precision of <span class="times">0.1</span></p>

  <p class="body-case-b">   •   Calculate the range size: <span class="times">(31.5 – 0) = 31.5</span></p>

  <p class="body-case-b">   •   Divide the range size by the desired precision: <span class="times">31.5 / 0.1 = 315</span></p>

  <p class="body-case-b">   •   Round up to the nearest whole number: <span class="times">315</span></p>

  <p class="body-ind1">Now you have 315 steps (values) to represent the numbers from 0.0 to 31.5 with a precision of 0.1:</p>

  <p class="fm-equation">number_of_bits = ceil(log<sub class="fm-subscript">2</sub>(number_of_steps)) = ceil(log<sub class="fm-subscript">2</sub>(315)) ≈ ceil(8.29) = 9</p><!--<div class="figure"><p class="figureE"><img alt="" src="../PNGs/APPC_F26_Khamis-EQ05.png" /></p></div>-->

  <p class="body-ind1">So you need 9 bits to represent the numbers from 0.0 to 31.5 with a precision of 0.1.2. Listing C.8 shows a snippet of the code to solve the Ackley function using a genetic algorithm implemented from scratch or based on the pymoo open source library. We start by defining constants for the genetic algorithm and Ackley function as follows:</p>

  <p class="fm-code-listing-captione">Listing C.8 Solving the Ackley function using GA</p>
  <pre class="programlistinge">import random
import math
 
POPULATION_SIZE = 100
GENOME_LENGTH = 30
MUTATION_RATE = 0.1
CROSSOVER_RATE = 0.8
GENERATIONS = 100
 
a = 20
b = 0.2
c = 2 * math.pi</pre>

  <p class="body-ind1">We then define the <code class="fm-code-in-text">decode</code> function to convert the binary genome to real values:</p>
  <pre class="programlistinge">def decode(genome):
    x = []
    for i in range(0, GENOME_LENGTH, 5):
        binary_string = "".join([str(bit) for bit in genome[i:i+5]])
        x.append(int(binary_string, 2) / 31 * 32 - 16)
    return x</pre>

  <p class="body-ind1">The following function defines the fitness function (Ackley function):</p>
  <pre class="programlistinge"> def fitness(genome):
    x = decode(genome)
    term1 = -a * math.exp(-b * math.sqrt(sum([(xi ** 2) for xi in x]) /
<span class="fm-code-continuation-arrow">➥</span> len(x)))
    term2 = -math.exp(sum([math.cos(c * xi) for xi in x]) / len(x))
    return term1 + term2 + a + math.exp(1)</pre>

  <p class="body-ind1">Let’s now define the crossover function:</p>
  <pre class="programlistinge">def crossover(parent1, parent2):
    child1 = []
    child2 = []
    for i in range(GENOME_LENGTH):
        if random.random() &lt; CROSSOVER_RATE:
            child1.append(parent2[i])
            child2.append(parent1[i])
        else:
            child1.append(parent1[i])
            child2.append(parent2[i])
    return child1, child2</pre>

  <p class="body-ind1">The mutation function is defined as follows:</p>
  <pre class="programlistinge">def mutate(genome):
    for i in range(GENOME_LENGTH):
        if random.random() &lt; MUTATION_RATE:
            genome[i] = 1 - genome[i]</pre>

  <p class="body-ind1">Now it’s time to create an initial population:</p>
  <pre class="programlistinge">population = [[random.randint(0, 1) for _ in range(GENOME_LENGTH)] for _ in
<span class="fm-code-continuation-arrow">➥</span> range(POPULATION_SIZE)]</pre>

  <p class="body-ind1">Let’s now run the genetic algorithm:</p>
  <pre class="programlistinge">for generation in range(GENERATIONS):
    fitness_scores = [(genome, fitness(genome)) for genome in population] <span class="fm-combinumeral">①</span>
    fitness_scores.sort(key=lambda x: x[1])
    
    
    print(f"Generation {generation}: Best fitness =
<span class="fm-code-continuation-arrow">➥</span> {fitness_scores[0][1]}")                                               <span class="fm-combinumeral">②</span>
    
    parents = [fitness_scores[i][0] for i in range(POPULATION_SIZE // 2)] <span class="fm-combinumeral">③</span>
    
    
    next_generation = []                                                  <span class="fm-combinumeral">④</span>
    for i in range(POPULATION_SIZE // 2):                                 <span class="fm-combinumeral">④</span>
        parent1 = random.choice(parents)                                  <span class="fm-combinumeral">④</span>
        parent2 = random.choice(parents)                                  <span class="fm-combinumeral">④</span>
        child1, child2 = crossover(parent1, parent2)                      <span class="fm-combinumeral">④</span>
        mutate(child1)                                                    <span class="fm-combinumeral">④</span>
        mutate(child2)                                                    <span class="fm-combinumeral">④</span>
        next_generation.append(child1)                                    <span class="fm-combinumeral">④</span>
        next_generation.append(child2)                                    <span class="fm-combinumeral">④</span>
    
    population = next_generation                                          <span class="fm-combinumeral">⑤</span></pre>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">①</span> Calculate the fitness score for each genome in the population.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">②</span> Print out the best fitness score for each generation.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">③</span> Select the best half of the population to act as parents for the next generation.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">④</span> Generate the next generation by applying crossover and mutation.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑤</span> Replace the current population with the new generation of children.</p>

  <p class="body-ind1">You can print the best genome and its fitness as follows:</p>
  <pre class="programlistinge">fitness_scores = [(genome, fitness(genome)) for genome in population]
fitness_scores.sort(key=lambda x: x[1])
print(f"Generation {GENERATIONS}: Best fitness = {fitness_scores[0][1]}")</pre>

  <p class="body-ind1">You can print the best genome, decode the best genome, and then print the decision variables in real values as follows:</p>
  <pre class="programlistinge">print(f"Best genome = {fitness_scores[0][0]}")
print(f"Best genome decoded = {decode(fitness_scores[0][0])}")
print(f"Decision variables in real values = {decode(fitness_scores[0][0])}")</pre>

  <p class="body-ind1">You can solve this problem faster using GA implemented in pymoo as follows:</p>
  <pre class="programlistinge">from pymoo.algorithms.soo.nonconvex.ga import GA
from pymoo.problems import get_problem
from pymoo.optimize import minimize
 
problem = get_problem("ackley", n_var=6) 
  
algorithm = GA(
    pop_size=100,
    eliminate_duplicates=True)
  
res = minimize(problem,
               algorithm,
               seed=1,
               verbose=False)
  
print("Best solution found: \nX = %s\nF = %s" % (res.X, res.F))</pre>

  <p class="body-ind1">Running this code produces the following output:</p>
  <pre class="programlistinge">Best solution found: 
X = [ 0.00145857 -0.00011553 0.00033902 -0.00169267 -0.0005825  -0.00547546]
F = [0.01003609]</pre>

  <div class="calibre11"/>

  <div class="calibre12"/>

  <div class="calibre12"/>

  <div class="calibre12"/><h2 class="fm-head" id="heading_id_21">C.7 Chapter 8: Genetic algorithm variants</h2>

  <h3 class="fm-head1" id="heading_id_22">C.7.1 Exercises</h3>

  <p class="body-dialog"><span class="gray">  1.</span>   Assume that a company is trying to choose the optimal location for a new facility. The decision variables <span class="times"><i class="fm-italics">x</i><sub class="fm-subscript">1</sub></span> and <span class="times"><i class="fm-italics">x</i><sub class="fm-subscript">2</sub></span> represent the coordinates of the potential location for the new facility in a 2D plane. The company needs to minimize the distance squared between the new facility and an existing facility at the location (2, 1). This could represent the need to minimize transportation costs between the two facilities. Moreover, the company aims to maximize the distance squared between the new facility and a competitor’s facility at the location (3, 4). This could represent the need to establish a competitive advantage by distancing the new facility from the competitor. The new facility must be located within a certain region due to zoning regulations or other restrictions. It also must adhere to environmental constraints or property boundaries. This multi-objective constrained optimization problem can be formulated as follows:</p>

  <p class="fm-equation">Minimize <span class="times"><i class="fm-italics">f</i><sub class="fm-subscript">1</sub>(<i class="fm-italics">x</i><sub class="fm-subscript">1</sub>, <span class="times"><i class="fm-italics">x</i><sub class="fm-subscript">2</sub></span>) = √((<i class="fm-italics">x</i><sub class="fm-subscript">1</sub> – 2)<sup class="fm-superscript">2</sup> + (<i class="fm-italics">x</i><sub class="fm-subscript">2</sub> – 1)<sup class="fm-superscript">2</sup>)</span><!--<img src="C-web-resources/image/khamis-appC-eqs-9x.png" alt="" />--> (distance between the company facilities)</p>

  <p class="fm-equation">Maximize <span class="times"><i class="fm-italics">f</i><sub class="fm-subscript">1</sub>(<i class="fm-italics">x</i><sub class="fm-subscript">1</sub>, <span class="times"><i class="fm-italics">x</i><sub class="fm-subscript">2</sub></span>) = √((<i class="fm-italics">x</i><sub class="fm-subscript">1</sub> – 3)<sup class="fm-superscript">2</sup> + (<i class="fm-italics">x</i><sub class="fm-subscript">2</sub> – 4)<sup class="fm-superscript">2</sup>)</span><!--<img src="C-web-resources/image/khamis-appC-eqs-10x.png" alt="" />--> (distance between the new facility and a competitor’s facility)</p>

  <p class="body-ind1">such that</p>

  <p class="fm-equation"><span class="times"><i class="fm-italics">g</i><sub class="fm-subscript">1</sub>(<i class="fm-italics">x</i><sub class="fm-subscript">1</sub>, <span class="times"><i class="fm-italics">x</i><sub class="fm-subscript">2</sub></span>) = 2<i class="fm-italics">x</i><sub class="fm-subscript">1</sub> + <span class="times"><i class="fm-italics">x</i><sub class="fm-subscript">2</sub></span> – 6 ≤ 0</span><!--<img src="C-web-resources/image/khamis-appC-eqs-11x.png" alt="" />--> (zoning regulations)</p>

  <p class="fm-equation"><span class="times"><i class="fm-italics">g</i><sub class="fm-subscript">2</sub>(<i class="fm-italics">x</i><sub class="fm-subscript">1</sub>, <span class="times"><i class="fm-italics">x</i><sub class="fm-subscript">2</sub></span>) = 2<i class="fm-italics">x</i><sub class="fm-subscript">1</sub> – <span class="times"><i class="fm-italics">x</i><sub class="fm-subscript">2</sub></span> – 2 ≤ 0</span><!--<img src="C-web-resources/image/khamis-appC-eqs-12x1.png" alt="" />--> (environmental constraints or property boundaries)</p>

  <p class="fm-equation"><span class="times">0 ≤ <span class="times"><i class="fm-italics">x</i><sub class="fm-subscript">1</sub></span> ≤ 5</span><!--<img src="C-web-resources/image/khamis-appC-eqs-13x.png" alt="" />--> (boundary constraint)</p>

  <p class="fm-equation"><span class="times">0 ≤ <span class="times"><i class="fm-italics">x</i><sub class="fm-subscript">2</sub></span> ≤ 5</span><!--<img src="C-web-resources/image/khamis-appC-eqs-14x.png" alt="" />--> (boundary constraint)</p>

  <p class="body-ind1">Write Python code to find the optimal location for the new facility.</p>

  <p class="body-dialog"><span class="gray">  2.</span>   The All Ones problem, also known as the Max Ones problem, is a simple problem that aims to maximize the number of ones in a binary string of a fixed length. For a 10-bit All Ones problem, the optimal solution takes this form: [1111111111]. The problem is described by K. Sutner in his article “Linear cellular automata and the Garden-of-Eden” [4] as follows: suppose each of the squares of an <i class="timesitalic">n</i> <span class="cambria">×</span> <i class="timesitalic">n</i> chessboard is equipped with an indicator light and a button. If a square’s button is pressed, the light for that square will change from off to on or vice versa; the same happens to the lights of all the edge-adjacent squares. Initially all lights are off. The goal of the All Ones problem is to find a sequence of buttons that can be pressed in such a way that all lights are on at the end. This problem itself may not have direct applications, but it is used as a test problem to compare the performance of various algorithms. Write Python code to find a solution for the 10-bit All Ones problem using a genetic algorithm.</p>

  <p class="body-dialog"><span class="gray">  3.</span>   Assume that there are 10 parcels to be loaded in the cargo bike in figure C.27.</p>

  <div class="figure">
    <p class="figuree"><img alt="" class="calibre4" src="../Images/APPC_F27_Khamis.png"/></p>

    <p class="figurecaptione">Figure C.27 Cargo bike loading problem for 10 items with given weight, profit, and efficiency (profit/weight)</p>
  </div>

  <p class="body-ind1">Each parcel has its own weight, profit, and efficiency value (profit per kg). The goal is to select the parcels to be loaded in such a way that the utility function <span class="times"><i class="fm-italics">f</i><sub class="fm-subscript">1</sub></span> is maximized and the weight function <span class="times"><i class="fm-italics">f</i><sub class="fm-subscript">2</sub></span> is minimized.</p>

  <p class="fm-equation"><i class="fm-italics">f</i><sub class="fm-subscript">1</sub> = Σ<i class="fm-italics">E<sub class="fm-subscript">i</sub></i>, <i class="fm-italics">i</i> = 0, 1, ..., <i class="fm-italics">n</i>.</p>

  <p class="fm-equation"><i class="fm-italics">f</i><sub class="fm-subscript">2</sub> = |Σ<i class="fm-italics">w<sub class="fm-subscript">i</sub></i> – <i class="fm-italics">C</i>|, 50 is added if and only if Σ<i class="fm-italics">w<sub class="fm-subscript">i</sub></i> &gt; <i class="fm-italics">C</i>.</p><!--<div class="figure"><p class="figureE"><img alt="" src="../PNGs/APPC_F27_Khamis-EQ12.png" /></p></div>
<div class="figure"><p class="figureE"><img alt="" src="../PNGs/APPC_F27_Khamis-EQ13.png" /></p></div>-->

  <p class="body-ind1">where</p>

  <p class="body-case-b">   •   <i class="timesitalic">n</i> is the total number of packages.</p>

  <p class="body-case-b">   •   <i class="timesitalic">E<sub class="fm-subscript">i</sub></i> is the efficiency of package <i class="timesitalic">i</i>.</p>

  <p class="body-case-b">   •   <i class="timesitalic">w<sub class="fm-subscript">i</sub></i> is the weight of package <i class="timesitalic">i</i>.</p>

  <p class="body-case-b">   •   <i class="timesitalic">C</i> is the maximum capacity of the bike.</p>

  <p class="body-ind1">A penalty of 50 is added if and only if the total weight of the added parcels exceeds the maximum capacity. Write Python code to determine which items should be loaded for maximum efficiency.</p>

  <p class="body-dialog"><span class="gray">  4.</span>   In the opencast mining problem described by Guéret et al. in their book “Linear programming” [5], the opencast uranium mine is divided into blocks for exploitation. As illustrated in figure C.28, there are 18 blocks of 10,000 tons on three levels, identified based on the results of test drilling. The pit needs to be terraced to allow trucks to reach the bottom, and the pit is limited in the west by a village and in the east by a group of mountains. To extract a block, three blocks of the level above it need to be extracted due to constraints on the slope: the block immediately on top of it, and the blocks to the right and to the left. There are different costs associated with extracting blocks depending on their level. Level 1 blocks cost $100 per ton to extract, level 2 blocks cost $200 per ton, and level 3 blocks cost $300 per ton. However, the hatched blocks, which are formed of a very hard rock rich in quartz, cost $1,000 per ton to extract. The blocks that contain uranium are displayed in a gray shade: these are blocks 0, 6, 9, 11, 16, and 17. These blocks have different market values, with block 17 being rich in ore but made of the same hard rock as the other hatched blocks. The market values of blocks 0, 6, 9, 11, 16, and 17 are $200, $300, $500, $200, $1,000, and $1,200 per ton, respectively.</p>

  <div class="figure">
    <p class="figuree"><img alt="" class="calibre4" src="../Images/APPC_F28_Khamis.png"/></p>

    <p class="figurecaptione">Figure C.28 Opencast mining problem</p>
  </div>

  <p class="body-case-b">   a.  Write a Python code to determine which blocks to extract to maximize the total profit, given by <span class="times"><span class="cambria">Σ</span>(VALUE – COST) × <i class="fm-italics">x<sub class="fm-subscript">i</sub></i></span> for <span class="times"><i class="fm-italics">x</i> = 0,1,…,17</span>, where <i class="timesitalic">x<sub class="fm-subscript">i</sub></i> is an assignment binary variable.</p>

  <p class="body-case-b">   b.  Assume that the time duration required to process the blocks is <span class="times">[1, 1, 1, 1, 1, 1, 1, 1, 3, 2, 2, 2, 2, 3, 4, 4, 3, 4]</span> depending on the block level and the hardness of the block. Write Python code to determine which blocks to extract to maximize the discounted profit and increased cost given by the following equations:</p>

  <div class="figure">
    <p class="figuree"><img alt="" class="calibre4" src="../Images/APPC_F28_Khamis-EQ14a.png"/></p>
  </div><!--<div class="figure"><p class="figureE"><img alt="" src="../PNGs/APPC_F28_Khamis-EQ15.png" /></p></div>-->

  <p class="body-dialog"><span class="gray">  5.</span>   In the Chapter 8/Projects folder in the book’s GitHub repository, the following sample research projects are provided for review and experimentation:</p>

  <p class="body-case-b">   •   <i class="fm-italics">Routing</i>—Addresses using the genetic algorithm to find the shortest path between two points of interest in Vaughan, a municipality to the north of Toronto.</p>

  <p class="body-case-b">   •   <i class="fm-italics">Bus routing</i>—Addresses the school bus routing problem, formulating the problem as a contained multi-objective optimization problem. The cluster-first route-second scheme, genetic algorithm, and adaptive genetic algorithm are applied to solve this problem. The performance of these algorithms is evaluated using real data from public schools in the city of Winchester, Virginia, USA.</p>

  <p class="body-case-b">   •   <i class="fm-italics">Location allocation</i>—Tackles the placement of drone delivery stations using bio-inspired optimization algorithms. The solution framework consists of two stages: the first tackles the location planning problem of stations, while the second deals with the allocation of delivery demand to located stations.</p>

  <h3 class="fm-head1" id="heading_id_23">C.7.2 Solutions</h3>

  <p class="body-dialog"><span class="gray">  1.</span>   The next listing shows how to solve the facility allocation problem using NSGA-II.</p>

  <p class="fm-code-listing-captione">Listing C.9 Solving the facility allocation problem using NSGA-II</p>
  <pre class="programlistinge">import numpy as np
import math
import matplotlib.pyplot as plt
from pymoo.core.problem import ElementwiseProblem
from pymoo.algorithms.moo.nsga2 import NSGA2
from pymoo.operators.crossover.sbx import SBX
from pymoo.operators.mutation.pm import PolynomialMutation
from pymoo.operators.repair.rounding import RoundingRepair
from pymoo.operators.sampling.rnd import FloatRandomSampling
  
  
class FacilityProblem(ElementwiseProblem):
  
    def __init__(self):
        super().__init__(n_var=2,
                         n_obj=2,
                         n_ieq_constr=2,
                         xl=np.array([0,0]),
                         xu=np.array([5,5]))
  
    def _evaluate(self, x, out, *args, **kwargs):
        f1 = math.sqrt((x[0]-2)**2 + (x[1]-1)**2)
        f2 = -math.sqrt((x[0]-3)**2 + (x[1]-4)**2) 
  
        g1 = x[0]+2*x[1]-6                        <span class="fm-combinumeral">①</span>
        g2 = 2*x[0]-x[1]-2                        <span class="fm-combinumeral">②</span>
  
        out["F"] = [f1, f2]
        out["G"] = [g1, g2]
  
problem = FacilityProblem()
  
algorithm = NSGA2(
    pop_size=50,
    sampling=FloatRandomSampling(),
    crossover=SBX(prob=0.8),
    mutation = PolynomialMutation(prob=0.6, repair=RoundingRepair()), 
    eliminate_duplicates=True
)
  
from pymoo.termination import get_termination
  
termination = get_termination("n_gen", 50)
  
from pymoo.optimize import minimize
  
res = minimize(problem,
               algorithm,
               termination,
               seed=1,
               save_history=True,
               verbose=False)
  
X = res.X
F = res.F</pre>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">①</span> Zooning constraint</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">②</span> Environment/property constraint</p>

  <p class="body-ind1">The complete listing, available in the book’s GitHub repository, also shows how to perform decision making to select the best solution.</p>

  <p class="body-dialog"><span class="gray">  2.</span>   The All Ones problem solution is shown in the following listing.</p>

  <p class="fm-code-listing-captione">Listing C.10 Solving the All Ones problem using GA</p>
  <pre class="programlistinge">import numpy as np
from pymoo.algorithms.soo.nonconvex.ga import GA
from pymoo.operators.crossover.sbx import SBX
from pymoo.operators.mutation.pm import PolynomialMutation
from pymoo.operators.sampling.rnd import FloatRandomSampling
from pymoo.core.problem import Problem
from pymoo.optimize import minimize
  
class AllOnes(Problem):
    def __init__(self, n_var):
        super().__init__(n_var=n_var, n_obj=1, n_constr=0, xl=0, xu=1,
<span class="fm-code-continuation-arrow">➥</span> vtype=int)
  
    def _evaluate(self, x, out, *args, **kwargs):
        out["F"] = -np.sum(x, axis=1)
 
problem = AllOnes(n_var=10)
algorithm = GA(
    pop_size=100,
    sampling=FloatRandomSampling(),
    crossover=SBX(prob=1.0, eta=30, n_offsprings=2),
    mutation=PolynomialMutation(prob=1.0),
    eliminate_duplicates=True
)
  
res = minimize(problem, algorithm, ('n_gen', 100), seed=1, verbose=True)
  
print("Sum of the ones in the solution:", -res.F)
print("Solution: ", res.X)</pre>

  <p class="body-ind1">This code defines an <code class="fm-code-in-text">AllOnes</code> class that extends the <code class="fm-code-in-text">Problem</code> class from pymoo. The <code class="fm-code-in-text">_evaluate</code> method of the <code class="fm-code-in-text">AllOnes</code> class calculates the fitness of an individual by counting the number of ones in the binary string and returning the negative of that count (because pymoo minimizes objective functions).</p>

  <p class="body-dialog"><span class="gray">  3.</span>   The solution to the cargo bike loading problem is shown in the next listing.</p>

  <p class="fm-code-listing-captione">Listing C.11 Solving the cargo bike loading problem using GA</p>
  <pre class="programlistinge">import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
from pymoo.algorithms.soo.nonconvex.ga import GA
from pymoo.operators.crossover.ux import UniformCrossover
from pymoo.operators.mutation.pm import PolynomialMutation
from pymoo.operators.sampling.rnd import FloatRandomSampling
from pymoo.termination.default import DefaultSingleObjectiveTermination
from pymoo.core.problem import Problem
from pymoo.optimize import minimize
  
class CargoBike(Problem):                                                   <span class="fm-combinumeral">①</span>
    def __init__(self, weights, efficiency, capacity):
        super().__init__(n_var=len(weights), n_obj=1, n_constr=1, xl=0,
<span class="fm-code-continuation-arrow">➥</span> xu=1, vtype=bool)
        self.weights = weights
        self.efficiency = efficiency
        self.capacity = capacity
  
    def _evaluate(self, x, out, *args, **kwargs):
        x = np.round(x)  # Ensure X is binary
        total_weight = np.sum(self.weights * x, axis=1)
        total_profit = np.sum(self.efficiency * x, axis=1)
        out["F"] = -total_profit[:, None]
        out["G"] = np.where(total_weight &lt;= self.capacity, 0, total_weight
<span class="fm-code-continuation-arrow">➥</span> - self.capacity)[:, None]
  
weights = np.array([14.6, 20, 8.5, 10, 13, 9.6, 4.9, 16.5, 8.77, 7.8])      <span class="fm-combinumeral">②</span>
profits = np.array([14.54, 15.26, 5.8, 12.12, 8.2, 7.4, 10.3, 13.5, 6.6,
<span class="fm-code-continuation-arrow">➥</span> 20.9])                                                                   <span class="fm-combinumeral">②</span>
efficiency = np.array([1.00, 0.76, 0.68, 1.21, 0.63, 0.77, 2.1, 0.82, 0.75,
<span class="fm-code-continuation-arrow">➥</span> 2.68])                                                                   <span class="fm-combinumeral">②</span>
capacity = 100                                                              <span class="fm-combinumeral">②</span>
df=pd.DataFrame({'Weight (kg)':weights,'Profit ($)':profits,'Efficiency ($/ <span class="fm-combinumeral">②</span>
Kg)':efficiency})                                                           <span class="fm-combinumeral">②</span>
  
problem = CargoBike(weights, efficiency, capacity)                          <span class="fm-combinumeral">③</span>
  
algorithm = GA(
    pop_size=200,
    sampling=FloatRandomSampling(),
    crossover=UniformCrossover(prob=1.0),
    mutation=PolynomialMutation(prob=0.5),
    eliminate_duplicates=True
)                                                                           <span class="fm-combinumeral">④</span>
  
termination = DefaultSingleObjectiveTermination()
  
res = minimize(problem, algorithm, termination, verbose=True)               <span class="fm-combinumeral">⑤</span>
  
print(f"Best solution found: {res.X}")                                      <span class="fm-combinumeral">⑥</span>
print(f"Best objective value: {-res.F[0]}")                                 <span class="fm-combinumeral">⑥</span>
  
  
res_bool=np.round(res.X)
selected_items = df.loc[res_bool.astype(bool), :]
  
fig, ax1 = plt.subplots()
ax1.bar(1+selected_items.index, selected_items['Efficiency ($/Kg)']) 
ax1.set_ylabel('Efficiency ($/Kg)')
ax1.set_ylim(0, 5)
ax1.legend(['Efficiency ($/Kg)'], loc="upper left")
  
ax2 = ax1.twinx()
ax2.bar(1+selected_items.index, selected_items['Weight (kg)'], width=0.5,
<span class="fm-code-continuation-arrow">➥</span> alpha=0.5, color='orange')
ax2.grid(False)
ax2.set_ylabel('Weight (kg)')
ax2.set_ylim(0, 30)
ax2.legend(['Weight (kg)'], loc="upper right")
plt.show()                                                                  <span class="fm-combinumeral">⑦</span></pre>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">①</span> Define the problem.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">②</span> Define the problem inputs.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">③</span> Create a problem instance.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">④</span> Define the genetic algorithm.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑤</span> Run the optimization.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑥</span> Print the results.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑦</span> Visualize the solution.</p>

  <p class="body-ind1">Running this code produces the solution shown in figure C.29.</p>

  <div class="figure">
    <p class="figuree"><img alt="" class="calibre4" src="../Images/APPC_F29_Khamis.png"/></p>

    <p class="figurecaptione">Figure C.29 Cargo bike loading solution</p>
  </div>

  <p class="body-dialog"><span class="gray">  4.</span>   The next listing shows the steps to solve the opencast mining problem.</p>

  <p class="fm-code-listing-captione">Listing C.12 Solving the opencast mining problem</p>
  <pre class="programlistinge">import numpy as np
  
BLOCKS = np.arange(0, 17)                                              <span class="fm-combinumeral">①</span>
LEVEL23 = np.array([8, 9, 10, 11, 12, 13, 14, 15, 16, 17])             <span class="fm-combinumeral">②</span>
COST = np.array([100, 100, 100, 100, 100, 100, 100, 100,
                 200, 200, 200, 200, 200, 200, 
                 1000, 1000, 1000, 1000])                              <span class="fm-combinumeral">③</span>
  
VALUE = np.array([200, 0, 0, 0, 0, 0, 300, 0, 
                  0, 500, 0, 200, 0, 0, 
                  0, 0, 1000, 0])                                      <span class="fm-combinumeral">④</span>
  
Precedence = np.array([[0,1, 2],
                [1, 2, 3],
                [2, 3, 4],
                [3, 4, 5],
                [4, 5, 6],
                [5, 6, 7],
                [8, 9, 10],
                [9, 10, 11],
                [10, 11, 12],
                [11, 12, 13]])                                         <span class="fm-combinumeral">⑤</span></pre>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">①</span> Blocks in the mine</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">②</span> Blocks in levels 2 and 3</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">③</span> Cost of blocks.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">④</span> Value of blocks</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑤</span> Define the ARC for each block in LEVEL23.</p>

  <p class="body-ind1">As a continuation, you can visualize the precedence of extraction of blocks in levels 2 and 3 as follows:</p>
  <pre class="programlistinge">import networkx as nx
import matplotlib.pyplot as plt
  
G = nx.DiGraph()                                                        <span class="fm-combinumeral">①</span>
  
G.add_nodes_from(BLOCKS)                                                <span class="fm-combinumeral">②</span>
  
for b, arc in zip(LEVEL23, Precedence):                                 <span class="fm-combinumeral">③</span>
    for predecessor in arc:                                             <span class="fm-combinumeral">③</span>
        G.add_edge(predecessor, b)                                      <span class="fm-combinumeral">③</span>
  
pos = nx.spring_layout(G)                                               <span class="fm-combinumeral">④</span>
pos.update({0: (0, 0), 1: (0, 1), 2: (0, 2), 3: (1, 0), 4: (1, 1), 5: (1,
<span class="fm-code-continuation-arrow">➥</span> 2), 6: (2, 0), 7: (2, 1), 
            8: (2, 2), 9: (3, 0), 10: (3, 1), 11: (3, 2), 12: (4, 0), 13:
<span class="fm-code-continuation-arrow">➥</span> (4, 1), 
            14: (4, 2), 15: (5, 0), 16: (5, 1), 17: (5, 2)})            <span class="fm-combinumeral">⑤</span>
  
plt.figure(figsize=(10, 5))                                             <span class="fm-combinumeral">⑥</span>
nx.draw(G, pos, with_labels=True, node_size=1500, node_color='skyblue', <span class="fm-combinumeral">⑥</span>
<span class="fm-code-continuation-arrow">➥</span> font_size=12, font_weight='bold')                                    <span class="fm-combinumeral">⑥</span>
plt.title("Precedence graph for extraction of blocks in Level 2 and 3") <span class="fm-combinumeral">⑥</span>
plt.show()                                                              <span class="fm-combinumeral">⑥</span></pre>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">①</span> Create the directed graph.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">②</span> Add the nodes.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">③</span> Add precedence edges.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">④</span> Create a pos dictionary with a default position for all nodes.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑤</span> Update the positions of nodes that have a specific position.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑥</span> Draw the graph.</p>

  <p class="body-ind1">Figure C.30 shows the precedence graph for extracting blocks in levels 2 and 3.</p>

  <div class="figure">
    <p class="figuree"><img alt="" class="calibre4" src="../Images/APPC_F30_Khamis.png"/></p>

    <p class="figurecaptione">Figure C.30 Precedence graph for extracting blocks in levels 2 and 3</p>
  </div>

  <p class="body-ind1">As a continuation of listing C.12, the following code snippet shows how to define the problem as a single objective constrained optimization problem.</p>
  <pre class="programlistinge">from pymoo.algorithms.soo.nonconvex.ga import GA
from pymoo.operators.crossover.pntx import PointCrossover
from pymoo.operators.mutation.pm import PolynomialMutation
from pymoo.operators.repair.rounding import RoundingRepair
from pymoo.operators.sampling.rnd import FloatRandomSampling
from pymoo.core.problem import Problem
from pymoo.optimize import minimize
  
class OpencastMiningProblem(Problem):
    def __init__(self):
        super().__init__(n_var=18, n_obj=1, n_constr=len(LEVEL23), xl=0,
<span class="fm-code-continuation-arrow">➥</span> xu=1)
  
    def _evaluate(self, X, out, *args, **kwargs):
        X = np.round(X)
        profits = np.sum((VALUE - COST) * X, axis=1)
  
        constraints = np.zeros((X.shape[0], len(LEVEL23)))
        for i in range(X.shape[0]):
            for j, b in enumerate(LEVEL23):
                constraints[i, j] = min(X[i, Precedence[j]-1]) - X[i, b-1]
  
        out["F"] = profits.reshape(-1, 1)
        out["G"] = constraints</pre>

  <p class="body-ind1">We can now define the GA solver and apply it to solve the problem as follows:</p>
  <pre class="programlistinge">problem = OpencastMiningProblem()
algorithm = GA(
    pop_size=50,
    sampling=FloatRandomSampling(),
    crossover=PointCrossover(prob=0.8, n_points=2),
    mutation = PolynomialMutation(prob=0.3, repair=RoundingRepair()),
    eliminate_duplicates=True
)
  
res = minimize(problem, algorithm, ('n_gen', 50), seed=1, verbose=True)
  
print("Best solution found:\nX =", res.X)
print("Objective value =", -res.F[0])</pre>

  <p class="body-ind1">Running this code produces the following output:</p>
  <pre class="programlistinge">Best solution found:
X = [0 1 1 0 1 1 0 1 1 0 1 0 1 1 1 1 0 1]
Objective value = 4300.0</pre>

  <p class="body-ind1">The complete version of listing C.12 in the book’s GitHub repository includes the Pareto optimization implementation, which treats the problem as a multi-objective optimization problem.</p>

  <div class="calibre11"/>

  <div class="calibre12"/>

  <div class="calibre12"/>

  <div class="calibre12"/><h2 class="fm-head" id="heading_id_24">C.8 Chapter 9: Particle swarm optimization</h2>

  <h3 class="fm-head1" id="heading_id_25">C.8.1 Exercises</h3>

  <p class="body-dialog"><span class="gray">  1.</span>   Multiple choice and true/false: Choose the correct answer for each of the following questions.</p>

  <p class="body-dialogb"><span class="gray">1.1.</span>   Which of the following is a drawback of the star structure in PSO?</p>

  <p class="body-case-b">   a.  It may lead to premature convergence to a suboptimal solution.</p>

  <p class="body-case-b">   b.  It may cause the algorithm to converge too slowly.</p>

  <p class="body-case-b">   c.  It may cause the algorithm to become stuck in local optima.</p>

  <p class="body-case-b">   d.  It does not allow the algorithm to explore the search space effectively.</p>

  <p class="body-dialogb"><span class="gray">1.2.</span>   Asynchronous PSO usually produces better results because it causes the particles to use more up-to-date information.</p>

  <p class="body-case-b">   a.  True</p>

  <p class="body-case-b">   b.  False</p>

  <p class="body-dialogb"><span class="gray">1.3.</span>   What is the difference between the cognitive and social components in PSO?</p>

  <p class="body-case-b">   a.  The cognitive component is based on the particle’s own experience, while the social component is based on the experience of the swarm as a whole.</p>

  <p class="body-case-b">   b.  The cognitive component is based on the experience of the particle’s neighbors, while the social component is based on the particle’s own experience.</p>

  <p class="body-case-b">   c.  The cognitive component is based on random perturbations, while the social component is based on gradient information.</p>

  <p class="body-case-b">   d.  The cognitive and social components are the same thing.</p>

  <p class="body-dialogb"><span class="gray">1.4.</span>   Ring topology, or lbest PSO, has been shown to converge faster than other network structures, but with a susceptibility to be trapped in local minima.</p>

  <p class="body-case-b">   a.  True</p>

  <p class="body-case-b">   b.  False</p>

  <p class="body-dialogb"><span class="gray">1.5.</span>   In binary PSO (BPSO), each bit in the binary strings is updated by considering its current state, the best state it has held so far, and the best state of its neighboring bits.</p>

  <p class="body-case-b">   a.  True</p>

  <p class="body-case-b">   b.  False</p>

  <p class="body-dialogb"><span class="gray">1.6.</span>   In PSO, the velocity model that makes particles behave like independent hill climbers is</p>

  <p class="body-case-b">   a.  Cognitive-only model</p>

  <p class="body-case-b">   b.  Social-only model</p>

  <p class="body-dialogb"><span class="gray">1.7.</span>   PSO is guaranteed to find the global optimum of a function.</p>

  <p class="body-case-b">   a.  True</p>

  <p class="body-case-b">   b.  False</p>

  <p class="body-dialogb"><span class="gray">1.8.</span>   What is the role of the acceleration coefficients in the PSO algorithm?</p>

  <p class="body-case-b">   a.  To control the speed of the particles</p>

  <p class="body-case-b">   b.  To control the exploration/exploitation trade-off</p>

  <p class="body-case-b">   c.  To control the swarm size</p>

  <p class="body-case-b">   d.  To control the mutation rate</p>

  <p class="body-dialogb"><span class="gray">1.9.</span>   PSO is a local search algorithm that is only able to find local optima.</p>

  <p class="body-case-b">   a.  True</p>

  <p class="body-case-b">   b.  False</p>

  <p class="body-dialogb"><span class="gray">1.10.</span> PSO was originally developed for continuous-valued spaces.</p>

  <p class="body-case-b">   a.  True</p>

  <p class="body-case-b">   b.  False</p>

  <p class="body-dialog"><span class="gray">  2.</span>   In the restaurant game described by Martin et al. in their article “Local termination criteria for swarm intelligence: A comparison between local stochastic diffusion search and ant nest-site selection,” [6], a group of delegates attends a long conference in an unfamiliar town. Each night they have to find somewhere to dine. There is a large choice of restaurants, each of which offers a large variety of meals. The problem the group faces is to find the best restaurant, which is the restaurant where the maximum number of delegates would enjoy dining. Even a parallel exhaustive search through the restaurant and meal combinations would take too long to accomplish. If you were to solve this problem using PSO, how would you describe the three components of the velocity update in the context of this problem?</p>

  <p class="body-dialog"><span class="gray">  3.</span>   Ridesharing is a successful implementation of the sharing economy business model where personal vehicles are shared by their owners or drivers with individual travelers who have similar itineraries and schedules. The ridesharing problem is a multi-objective constrained optimization problem. A non-comprehensive list of optimization goals for ridesharing includes</p>

  <p class="body-case-b">   •   Minimizing the total travel distance or time of drivers’ trips</p>

  <p class="body-case-b">   •   Minimizing the total travel time of passengers’ trips</p>

  <p class="body-case-b">   •   Maximizing the number of matched (served) requests</p>

  <p class="body-case-b">   •   Minimizing the cost for the drivers’ trips</p>

  <p class="body-case-b">   •   Minimizing the cost for the passengers’ trips</p>

  <p class="body-case-b">   •   Maximizing the driver’s earnings</p>

  <p class="body-case-b">   •   Minimizing the passenger’s waiting time</p>

  <p class="body-case-b">   •   Minimizing the total number of drivers required</p>

  <p class="body-ind1">Consider the ridesharing problem shown in figure C.31, where the objective is to come up with a schedule for drivers that minimizes the total distances of vehicles’ trips. The statement of this multi-objective optimization is as follows:</p>

  <p class="body-ind1">Find <i class="timesitalic">s</i> that minimizes <i class="timesitalic">f</i></p>

  <div class="figure">
    <p class="figuree"><img alt="" class="calibre4" src="../Images/APPC_F30_Khamis-EQ16.png"/></p>
  </div>

  <p class="body-ind1">where</p>

  <p class="body-case-b">   •   <i class="timesitalic">f</i> is the total distance of vehicles’ trips to serve all the passengers.</p>

  <p class="body-case-b">   •   <i class="timesitalic">s<sub class="fm-subscript">i,j</sub></i> is 1 if location <i class="timesitalic">j</i> is assigned within the schedule of the driver and 0 otherwise.</p>

  <p class="body-case-b">   •   <i class="timesitalic">d<sub class="fm-subscript">i,j</sub></i> is the distance between two points within the route, where<br class="calibre10"/>
  <span class="times"><i class="fm-italics">d<sub class="fm-subscript">i,j</sub></i> = √((<i class="fm-italics">x<sub class="fm-subscript">i</sub></i> – <i class="fm-italics">x<sub class="fm-subscript">j</sub></i>)<sup class="fm-superscript">2</sup> + (<i class="fm-italics">y<sub class="fm-subscript">i</sub></i> – <i class="fm-italics">y<sub class="fm-subscript">j</sub></i>)<sup class="fm-superscript">2</sup></span></p><!--<div class="figure">
<p class="figureE"><img src="C-web-resources/image/khamis-appC-eqs-20x.png" alt="" /></p>
</div>-->

  <p class="body-case-b">   •   <i class="timesitalic">P</i> is the passenger set, with known pickup and delivery points.</p>

  <p class="body-case-b">   •   <i class="timesitalic">V</i> is the vehicle set, with predefined initial and final locations.</p>

  <div class="figure">
    <p class="figuree"><img alt="" class="calibre4" src="../Images/APPC_F31_Khamis.png"/></p>

    <p class="figurecaptione">Figure C.31 The ridesharing problem</p>
  </div>

  <p class="body-ind1">Given the pickup and drop-off locations of five passengers (table C.3) and the initial and final locations of the two drivers (table C.4), define a suitable representation for a particle (i.e., a candidate solution) that represents each driver’s schedule and evaluates its fitness.</p>

  <p class="fm-table-caption">Table C.3 Pickup and drop-off locations of the passengers</p>

  <table border="1" class="contenttable-1-table" id="table005" width="100%">
    <colgroup class="contenttable-0-colgroup">
      <col class="contenttable-0-col" span="1" width="20%"/>
      <col class="contenttable-0-col" span="1" width="20%"/>
      <col class="contenttable-0-col" span="1" width="20%"/>
      <col class="contenttable-0-col" span="1" width="20%"/>
      <col class="contenttable-0-col" span="1" width="20%"/>
    </colgroup>

    <thead class="calibre6">
      <tr class="contenttable-0-tr">
        <th class="contenttable-1-th">
          <p class="fm-table-head">Passengers</p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head">Pickup x-coordinate</p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head">Pickup y-coordinate</p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head">Drop-off x-coordinate</p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head">Drop-off y-coordinate</p>
        </th>
      </tr>
    </thead>

    <tbody class="calibre6">
      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body">P1</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">9</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">9</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">4</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">2</p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body">P2</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">8</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">5</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">2</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">4</p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body">P3</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">6</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">1</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">8</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">6</p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body">P4</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">7</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">6</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">9</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">8</p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body">P5</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">3</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">5</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">10</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">3</p>
        </td>
      </tr>
    </tbody>
  </table>

  <p class="fm-table-caption">Table C.4 Initial and final locations of the drivers</p>

  <table border="1" class="contenttable-1-table" id="table006" width="100%">
    <colgroup class="contenttable-0-colgroup">
      <col class="contenttable-0-col" span="1" width="20%"/>
      <col class="contenttable-0-col" span="1" width="20%"/>
      <col class="contenttable-0-col" span="1" width="20%"/>
      <col class="contenttable-0-col" span="1" width="20%"/>
      <col class="contenttable-0-col" span="1" width="20%"/>
    </colgroup>

    <thead class="calibre6">
      <tr class="contenttable-0-tr">
        <th class="contenttable-1-th">
          <p class="fm-table-head">Drivers</p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head">Initial x-coordinate</p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head">Initial y-coordinate</p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head">Final x-coordinate</p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head">Final y-coordinate</p>
        </th>
      </tr>
    </thead>

    <tbody class="calibre6">
      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body">A</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">4</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">1</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">8</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">10</p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body">B</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">1</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">6</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">9</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">4</p>
        </td>
      </tr>
    </tbody>
  </table>

  <p class="body-dialog"><span class="gray">  4.</span>   Consider the trip itinerary planning problem where the objective is to provide an optimal travel itinerary for tourists visiting a new city, taking into consideration the quality of the places to be visited, the proximity of the attractions to one another, and how much of the day can be completely occupied with little idle time. The problem is stated as following:</p>

  <p class="body-ind1">Find <i class="timesitalic">X</i> which optimizes <i class="timesitalic">f</i></p>

  <div class="figure">
    <p class="figuree"><img alt="" class="calibre4" src="../Images/APPC_F31_Khamis-EQ18.png"/></p>
  </div>

  <p class="body-ind1">subject to the following constraints:</p>

  <p class="body-case-b">   •   The duration of the itinerary must not exceed total time in a given day, which is set to 480 minutes. This is expressed as the summation of the duration of each venue and total commute time to be visited in an itinerary. This means that <span class="times"><i class="fm-italics">Z<sub class="fm-subscript">d</sub></i> + <i class="fm-italics">Z<sub class="fm-subscript">c</sub></i> &lt;= 480 minutes</span>.</p>

  <p class="body-case-b">   •   There should never be repetitions of the same venue in a solution.</p>

  <p class="body-ind1">where</p>

  <p class="body-case-b">   •   <span class="times"><i class="fm-italics">X</i> = [<i class="fm-italics">Z<sub class="fm-subscript">d</sub> Z<sub class="fm-subscript">c</sub> Z<sub class="fm-subscript">r</sub></i>]<i class="fm-italics"><sup class="fm-superscript">T</sup></i></span></p>

  <p class="body-case-b">   •   <i class="timesitalic">Z<sub class="fm-subscript">d</sub></i> represents the duration of the itinerary (minutes).</p>

  <p class="body-case-b">   •   <i class="timesitalic">Z<sub class="fm-subscript">c</sub></i> represents the total commute time in the itinerary.</p>

  <p class="body-case-b">   •   <i class="timesitalic">Z<sub class="fm-subscript">r</sub></i> represents the average rating of all the venues in an itinerary. The ratings are derived from Yelp, Google reviews, or others.</p>

  <p class="body-ind1">Table C.5 lists the commute times between 10 attractions.</p>

  <p class="fm-table-caption">Table C.5 Commute time between attractions</p>

  <table border="1" class="contenttable-1-table" id="table007" width="100%">
    <colgroup class="contenttable-0-colgroup">
      <col class="contenttable-0-col" span="1" width="9.09%"/>
      <col class="contenttable-0-col" span="1" width="9.09%"/>
      <col class="contenttable-0-col" span="1" width="9.09%"/>
      <col class="contenttable-0-col" span="1" width="9.09%"/>
      <col class="contenttable-0-col" span="1" width="9.09%"/>
      <col class="contenttable-0-col" span="1" width="9.09%"/>
      <col class="contenttable-0-col" span="1" width="9.09%"/>
      <col class="contenttable-0-col" span="1" width="9.09%"/>
      <col class="contenttable-0-col" span="1" width="9.09%"/>
      <col class="contenttable-0-col" span="1" width="9.09%"/>
      <col class="contenttable-0-col" span="1" width="9.09%"/>
    </colgroup>

    <thead class="calibre6">
      <tr class="contenttable-0-tr">
        <th class="contenttable-1-th" colspan="2">
          <p class="fm-table-head">Commute time (mins)</p>
        </th>

        <td class="contenttable-1-th1" colspan="9">
          <p class="fm-table-head">To</p>
        </td>
      </tr>
    </thead>

    <tbody class="calibre6">
      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td" colspan="2"/>

        <td class="contenttable-1-td">
          <p class="fm-table-body">1</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">2</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">3</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">4</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">5</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">6</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">7</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">8</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">9</p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <th class="contenttable-1-th">
          <p class="fm-table-head">From</p>
        </th>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">10</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">20</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">7</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">11</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">8</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">19</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">7</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">1</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">1</p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td" rowspan="9"/>

        <td class="contenttable-1-td">
          <p class="fm-table-body">1</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">12</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">14</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">1</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">7</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">12</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">10</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">22</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">22</p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body">2</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">12</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">25</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">21</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">28</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">1</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">22</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">12</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">12</p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body">3</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">14</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">25</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">15</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">15</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">25</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">4</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">6</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">6</p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body">4</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">1</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">21</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">15</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">25</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">22</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">11</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">10</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">10</p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body">5</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">7</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">28</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">15</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">25</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">28</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">14</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">28</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">29</p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body">6</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">12</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">1</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">25</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">22</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">28</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">22</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">12</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">12</p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body">7</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">10</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">22</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">4</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">11</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">14</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">22</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">3</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">2</p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body">8</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">22</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">12</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">6</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">10</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">28</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">12</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">3</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">1</p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body">9</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">22</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">12</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">6</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">10</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">29</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">12</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">2</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">1</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>
      </tr>
    </tbody>
  </table>

  <p class="body-ind1">The durations and ratings for the different attractions are listed in table C.6.</p>

  <p class="fm-table-caption">Table C.6 Ratings and durations for attractions</p>

  <table border="1" class="contenttable-1-table" id="table008" width="100%">
    <colgroup class="contenttable-0-colgroup">
      <col class="contenttable-0-col" span="1" width="18.18%"/>
      <col class="contenttable-0-col" span="1" width="36.91%"/>
      <col class="contenttable-0-col" span="1" width="44.91%"/>
    </colgroup>

    <thead class="calibre6">
      <tr class="contenttable-0-tr">
        <th class="contenttable-1-th">
          <p class="fm-table-head">ID</p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head">Rating</p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head">Duration (mins)</p>
        </th>
      </tr>
    </thead>

    <tbody class="calibre6">
      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td" colspan="2">
          <p class="fm-table-body">Starting hotel</p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body">1</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">2</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">120</p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body">2</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">3</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">60</p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body">3</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">3</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">180</p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body">4</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">180</p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body">5</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">5</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">120</p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body">6</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">1</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">60</p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body">7</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">4</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">60</p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body">8</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">60</p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body">9</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">2</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">120</p>
        </td>
      </tr>
    </tbody>
  </table>

  <p class="body-ind1">Define a suitable representation of a particle (i.e., a candidate solution), and carry out two hand iterations to show how to solve this problem using PSO, assuming a swarm size of 4.</p>

  <p class="body-dialog"><span class="gray">  5.</span>   <i class="fm-italics">Trilateration</i> is used to identify the location of a moving object such as a connected vehicle or a cellphone. This process uses the distance between the vehicle and three or more known cell towers to determine the location of the vehicle. By measuring the signal strength of the device’s signal at each tower, the distance between the device and each tower can be calculated. The intersection of the three (or more) circles created by these distance measurements gives an estimate of the device’s location. As shown in figure C.32, three cell towers advertise their coordinates and transmit a reference signal.</p>

  <div class="figure">
    <p class="figuree"><img alt="" class="calibre4" src="../Images/APPC_F32_Khamis.png"/></p>

    <p class="figurecaptione">Figure C.32 Cell tower trilateration</p>
  </div>

  <p class="body-ind1">The connected vehicle uses the reference signal to estimate distances to each of the cells <i class="timesitalic">r<sub class="fm-subscript">i</sub></i>. These distance measurements <i class="timesitalic">r<sub class="fm-subscript">i</sub></i> may be subject to noise. Assume that the associated error is given by the following equation:</p>

  <div class="figure">
    <p class="figuree"><img alt="" class="calibre4" src="../Images/APPC_F32_Khamis-EQ19.png"/></p>
  </div>

  <p class="body-ind1">The vehicle position (<i class="timesitalic">ϕ</i><sub class="fm-subscript">0</sub>, <i class="timesitalic">λ</i><sub class="fm-subscript">0</sub>) is the position that minimizes the following objective function:</p>

  <div class="figure">
    <p class="figuree"><img alt="" class="calibre4" src="../Images/APPC_F32_Khamis-EQ20.png"/></p>
  </div>

  <p class="body-ind1">Write Python code to find the vehicle’s position using PSO.</p>

  <p class="body-dialog"><span class="gray">  6.</span>   A coffee shop offers two sizes of coffee: small and large. The cost of making a small coffee is $1, and the cost of making a large coffee is $1.50. The coffee shop sells small coffees for $2 each and large coffees for $3 each. The coffee shop wants to maximize its profit, but it also wants to ensure that it sells at least 50 small coffees and 75 large coffees and at most 300 and 450 respectively per day. This problem can be formulated as an optimization problem as follows:</p>

  <p class="fm-equation"><span class="times">Maximize profit = 2<i class="fm-italics">x</i><sub class="fm-subscript">1</sub> + 3<i class="fm-italics">x</i><sub class="fm-subscript">2</sub> - (<i class="fm-italics">x</i><sub class="fm-subscript">1</sub> + 1.5<i class="fm-italics">x</i><sub class="fm-subscript">2</sub>)</span></p><!--<div class="figure">
<p class="figureE"><img src="C-web-resources/image/khamis-appC-eqs-24x.png" alt="" /></p>
</div>-->

  <p class="body-ind1">Subject to</p>

  <p class="fm-equation"><span class="times">50 ≤ <span class="times"><i class="fm-italics">x</i><sub class="fm-subscript">1</sub></span> ≤ 300</span></p>

  <p class="fm-equation"><span class="times">75 ≤ <span class="times"><i class="fm-italics">x</i><sub class="fm-subscript">2</sub></span> ≤ 450</span></p><!--<div class="figure">
<p class="figureE"><img src="C-web-resources/image/khamis-appC-eqs-25x.png" alt="" /></p>
</div>


<div class="figure">
<p class="figureE"><img src="C-web-resources/image/khamis-appC-eqs-26x.png" alt="" /></p>
</div>-->

  <p class="body-ind1">where</p>

  <p class="body-case-b">   •   <span class="times"><i class="fm-italics">x</i><sub class="fm-subscript">1</sub></span> is the number of small coffees to make.</p>

  <p class="body-case-b">   •   <span class="times"><i class="fm-italics">x</i><sub class="fm-subscript">2</sub></span> is the number of large coffees to make.</p>

  <p class="body-ind1">Profit is the total profit, where the first term in the equation represents the revenue from selling the coffees, and the second term represents the cost of making the coffees. Write Python code to find the optimal number of small coffees and large coffees to make every day.</p>

  <p class="body-dialog"><span class="gray">  7.</span>   A hospital wants to optimize the scheduling of its doctors to minimize the overall cost of labor while ensuring that enough doctors are available to meet patient demand. Each doctor has a different hourly rate, and there are different levels of patient demand at different times of the day. The goal is to find the optimal schedule that minimizes the total cost of labor while meeting the minimum doctor requirements during both peak and non-peak hours.</p>

  <p class="body-ind1">The hospital must schedule at least four doctors during peak hours and at least two doctors during non-peak hours. The hospital can hire part-time doctors at a lower hourly rate, but they can only work during non-peak hours. The hospital also has the option of paying overtime to full-time doctors to meet demand during peak hours, but at a higher hourly rate.</p>

  <p class="body-ind1">The problem can be mathematically described as follows:</p>

  <p class="fm-equation">Minimize the total cost of labor: <span class="times"><i class="fm-italics">f</i>(<i class="fm-italics">x</i>) = Σ(<i class="fm-italics">c<sub class="fm-subscript">i</sub></i> × <i class="fm-italics">x<sub class="fm-subscript">i</sub></i>) + Σ(<i class="fm-italics">c<sub class="fm-subscript">i</sub><sup class="fm-superscript">o</sup></i> × <i class="fm-italics">x<sub class="fm-subscript">i</sub><sup class="fm-superscript">o</sup></i>) + Σ(<i class="fm-italics">c<sub class="fm-subscript">j</sub><sup class="fm-superscript">p</sup></i> × <i class="fm-italics">x<sub class="fm-subscript">j</sub><sup class="fm-superscript">p</sup></i>)</span><!--<i class="FM-Italics"><img src="C-web-resources/image/khamis-appC-eqs-27x.png" alt="" />--></p>

  <p class="body-ind1">subject to the following constraints:</p>

  <p class="body-case-b">   •   <span class="times">Σ<i class="fm-italics">x<sub class="fm-subscript">i</sub></i> + Σ<i class="fm-italics">x<sub class="fm-subscript">i</sub><sup class="fm-superscript">o</sup></i> ≥ 4</span><!--<img src="C-web-resources/image/khamis-appC-eqs-28x.png" alt="" />-->: At least four doctors must be scheduled during peak hours.</p>

  <p class="body-case-b">   •   <span class="times">Σ<i class="fm-italics">x<sub class="fm-subscript">i</sub><sup class="fm-superscript">p</sup></i> ≥ 2</span><!--<img src="C-web-resources/image/khamis-appC-eqs-29x.png" alt="" />-->: At least two doctors must be scheduled during non-peak hours.</p>

  <p class="body-case-b">   •   <span class="times"><i class="fm-italics">x<sub class="fm-subscript">i</sub></i>, <i class="fm-italics">x<sub class="fm-subscript">i</sub><sup class="fm-superscript">o</sup></i>, <i class="fm-italics">x<sub class="fm-subscript">j</sub><sup class="fm-superscript">p</sup></i> ≥ 0</span><!--<img src="C-web-resources/image/khamis-appC-eqs-30x.png" alt="" />-->: Non-negativity constraints</p>

  <p class="body-ind1">where</p>

  <p class="body-case-b">   •   <i class="timesitalic">i</i> is the index for full-time doctors, <span class="times"><i class="fm-italics">i</i> = 1, 2, ..., <i class="fm-italics">m</i></span>.</p>

  <p class="body-case-b">   •   <i class="timesitalic">j</i> is the index for part-time doctors, <span class="times"><i class="fm-italics">j</i> = 1, 2, ..., <i class="fm-italics">n</i></span>.</p>

  <p class="body-ind1">Predefined parameters:</p>

  <p class="body-case-b">   •   <i class="timesitalic">c<sub class="fm-subscript">i</sub></i> is the hourly rate for full-time doctor <i class="timesitalic">i</i>.</p>

  <p class="body-case-b">   •   <i class="timesitalic">c<sub class="fm-subscript">i</sub><sup class="fm-superscript">o</sup></i> is the overtime hourly rate for full-time doctor <i class="timesitalic">i</i>.</p>

  <p class="body-case-b">   •   <i class="timesitalic">c<sub class="fm-subscript">j</sub><sup class="fm-superscript">p</sup></i> is the hourly rate for part-time doctor <i class="timesitalic">j</i>.</p>

  <p class="body-ind1">Decision variables:</p>

  <p class="body-case-b">   •   <i class="timesitalic">x<sub class="fm-subscript">i</sub></i> is the number of hours worked by full-time doctor <i class="timesitalic">i</i> during peak hours.</p>

  <p class="body-case-b">   •   <i class="timesitalic">x<sub class="fm-subscript">i</sub><sup class="fm-superscript">o</sup></i> is the number of overtime hours worked by full-time doctor <i class="timesitalic">i</i> during peak hours.</p>

  <p class="body-case-b">   •   <i class="timesitalic">x<sub class="fm-subscript">j</sub><sup class="fm-superscript">p</sup></i> is the number of hours worked by part-time doctor <i class="timesitalic">j</i> during non-peak hours.</p>

  <p class="body-ind1">Assume the full-time rates of full-time doctors are [30, 35, 40, 45, 50], their overtime rates are 1.5 times the full-time rates, and the part-time doctors’ rates are [25, 27, 29, 31, 33]. Write Python code to solve this problem using PSO.</p>

  <p class="body-dialog"><span class="gray">  8.</span>   In neighborhood <i class="timesitalic">Y</i> of city <i class="timesitalic">X</i>, there are eight schools that collectively possess 100 microscopes for use in biology classes. These resources, however, are not uniformly distributed amongst the schools. With recent changes in student enrollment, four schools have more microscopes than needed, while the other four schools are in need of additional ones. To address this problem, Dr. Rachel Carson, who is in charge of the biology department at city <i class="timesitalic">X</i>.'s school board, decides to use a mathematical model. She chooses to use the transportation problem model, a strategy aimed at efficiently allocating resources while minimizing transportation costs as per R. Lovelace in his article “Open source tools for geographic analysis in transport planning” [7]. The model represents supply <i class="timesitalic">n</i> and demand <i class="timesitalic">m</i> as unit weights of decision variables at various points in a network, with the cost of transporting a unit from a supply point to a demand point equivalent to the time or distance between nodes. This data is captured in an <i class="fm-italics">n</i>*<i class="fm-italics">m</i> cost matrix. The formal statement of this integer linear programming problem is d<a id="idTextAnchor000"/>escribed in Daskin’s book “Network and Discrete Location: Models, Algorithms, and Applications” [8] as follows:</p>

  <div class="figure">
    <p class="figuree"><img alt="" class="calibre4" src="../Images/APPC_F32_Khamis-EQ28.png"/></p>
  </div>

  <p class="body-ind1">subject to the following constraints</p>

  <p class="body-case-b">   •   <span class="times">Σ<i class="fm-italics"><sub class="fm-subscript">j</sub></i><sub class="fm-subscript"><span class="cambria">∈</span></sub><i class="fm-italics"><sub class="fm-subscript">J</sub> x<sub class="fm-subscript">ij</sub></i> ≤ <i class="fm-italics">S<sub class="fm-subscript">i</sub></i></span> <span class="cambria">∀</span> <span class="times"><i class="timesitalic">i</i> <span class="cambria">∈</span> <i class="timesitalic">I</i></span><!--<img src="C-web-resources/image/khamis-appC-eqs-32x.png" alt="" />--></p>

  <p class="body-case-b">   •   <span class="times">Σ<i class="fm-italics"><sub class="fm-subscript">j</sub></i><sub class="fm-subscript"><span class="cambria">∈</span></sub><i class="fm-italics"><sub class="fm-subscript">J</sub> x<sub class="fm-subscript">ij</sub></i> ≥ <i class="fm-italics">D<sub class="fm-subscript">i</sub></i></span> <span class="cambria">∀</span> <span class="times"><i class="timesitalic">j</i> <span class="cambria">∈</span> <i class="timesitalic">J</i></span><!--<img src="C-web-resources/image/khamis-appC-eqs-33x.png" alt="" />--></p>

  <p class="body-case-b">   •   <span class="times"><i class="fm-italics">x<sub class="fm-subscript">ij</sub></i> ≥ 0 <span class="cambria">∀</span> <i class="timesitalic">i</i> <span class="cambria">∈</span> <i class="timesitalic">I</i></span> and <span class="times"><span class="cambria">∀</span> <i class="timesitalic">j</i> <span class="cambria">∈</span> <i class="timesitalic">J</i></span><!--<img src="C-web-resources/image/khamis-appC-eqs-34x.png" alt="" />--></p>

  <p class="body-ind1">where</p>

  <p class="body-case-b">   •   <i class="timesitalic">i</i> is each potential origin node.</p>

  <p class="body-case-b">   •   <i class="timesitalic">I</i> is the complete set of potential origin nodes.</p>

  <p class="body-case-b">   •   <i class="timesitalic">j</i> is each potential destination node.</p>

  <p class="body-case-b">   •   <i class="timesitalic">J</i> is the complete set of potential nodes.</p>

  <p class="body-case-b">   •   <i class="timesitalic">x<sub class="fm-subscript">ij</sub></i> is the amount to be shipped from <span class="times"><span class="cambria">∀</span> <i class="fm-italics">i</i> <span class="cambria">∈</span> <i class="fm-italics">I</i></span> to <span class="times"><span class="cambria">∀</span> <i class="fm-italics">j</i> <span class="cambria">∈</span> <i class="fm-italics">J</i></span>.</p>

  <p class="body-case-b">   •   <i class="timesitalic">c<sub class="fm-subscript">ij</sub></i> is per unit shipping costs between all <span class="times"><i class="timesitalic">i</i>, <i class="fm-italics">j</i></span> pairs.</p>

  <p class="body-case-b">   •   <i class="timesitalic">S<sub class="fm-subscript">i</sub></i> is node <i class="timesitalic">i</i> supply for <span class="times"><span class="cambria">∀</span> <i class="fm-italics">i</i> <span class="cambria">∈</span> <i class="fm-italics">I</i></span>.</p>

  <p class="body-case-b">   •   <i class="timesitalic">D<sub class="fm-subscript">j</sub></i> is node <i class="timesitalic">i</i> demand for <span class="times"><span class="cambria">∀</span> <i class="fm-italics">j</i> <span class="cambria">∈</span> <i class="fm-italics">J</i></span>.</p>

  <p class="body-ind1">Write Python code to solve this problem using PSO. Visualize the solution on a geospatial map.</p>

  <p class="body-dialog"><span class="gray">  9.</span>   In the Chapter 9/Projects folder in the book’s GitHub repository, the following sample research projects are provided for review and experimentation.</p>

  <p class="body-case-b">   •   Routing—Addresses using PSO to find the shortest path between two points of interest in Toronto</p>

  <p class="body-case-b">   •   Bus stops placement—Addresses how to use PSO to find the optimal placement of bus stops in the Waterloo/Kitchener area, Ontario, Canada</p>

  <h3 class="fm-head1" id="heading_id_26">C.8.2 Solutions</h3>

  <p class="body-dialog"><span class="gray">  1.</span>   Multiple choice and true/false</p>

  <p class="body-dialogb"><span class="gray">1.1.</span>   c) It may cause the algorithm to become stuck in local optima.</p>

  <p class="body-dialogb"><span class="gray">1.2.</span>   a) True</p>

  <p class="body-dialogb"><span class="gray">1.3.</span>   a) The cognitive component is based on the particle’s own experience, while the social component is based on the experience of the swarm as a whole.</p>

  <p class="body-dialogb"><span class="gray">1.4.</span>   b) False</p>

  <p class="body-dialogb"><span class="gray">1.5.</span>   a) True</p>

  <p class="body-dialogb"><span class="gray">1.6.</span>   a) Cognitive-only model</p>

  <p class="body-dialogb"><span class="gray">1.7.</span>   b) False</p>

  <p class="body-dialogb"><span class="gray">1.8.</span>   b) To control the exploration/exploitation trade-off</p>

  <p class="body-dialogb"><span class="gray">1.9.</span>   b) False (PSO is designed to explore the search space globally and has the potential to find the global optimum.)</p>

  <p class="body-dialogb"><span class="gray">1.10.</span> a) True</p>

  <p class="body-dialog"><span class="gray">  2.</span>   Imagine a group of delegates visiting an unfamiliar city for a conference. They are trying to find the best restaurant in town using PSO principles. The town is large, and each delegate starts at a different location. Each delegate has a preferred way of exploring restaurants, like walking along certain streets or visiting specific neighborhoods. This is similar to the inertia component in PSO, where particles maintain their current velocity and direction, ensuring they don’t change their exploration pattern too abruptly.</p>

  <p class="body-ind1">As each delegate visits different restaurants, they remember the best one they’ve been to so far (their personal best). If they come across a less appealing restaurant, they’re more likely to return to their favorite one, knowing it was a good choice based on their own experience. This is the cognitive component, where particles in PSO are attracted to their personal best positions, following their past experiences and individual preferences.</p>

  <p class="body-ind1">The delegates also communicate with each other via group chat, sharing their experiences and the locations of the best restaurants they’ve found. If someone discovers an outstanding restaurant, others might decide to visit that place and try it for themselves, even if it wasn’t their personal favorite. This is the social component, where particles in PSO are influenced by the global best position or the collective knowledge of the swarm.</p>

  <p class="body-dialog"><span class="gray">  3.</span>   Due to the discrete nature of the formulated problem, permutation-based PSO should be used. A particle in this algorithm represents an ordering of the passengers to be picked up and dropped off by each driver. In this problem, we have two vehicles, A and B, and five passenger requests to match (P1–P5). For example, a candidate solution for a problem with five passengers and two drivers would have the following format:</p>

  <table border="1" class="contenttable-1-table" id="table009" width="100%">
    <colgroup class="contenttable-0-colgroup">
      <col class="contenttable-0-col" span="1" width="12.5%"/>
      <col class="contenttable-0-col" span="1" width="12.5%"/>
      <col class="contenttable-0-col" span="1" width="12.5%"/>
      <col class="contenttable-0-col" span="1" width="12.5%"/>
      <col class="contenttable-0-col" span="1" width="12.5%"/>
      <col class="contenttable-0-col" span="1" width="12.5%"/>
      <col class="contenttable-0-col" span="1" width="12.5%"/>
      <col class="contenttable-0-col" span="1" width="12.5%"/>
    </colgroup>

    <tbody class="calibre6">
      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body">A<sup class="fm-superscript">+</sup></p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">P3<sup class="fm-superscript">+</sup></p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">P4<sup class="fm-superscript">+</sup></p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">P3<sup class="fm-superscript">–</sup></p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">P5<sup class="fm-superscript">+</sup></p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">P4<sup class="fm-superscript">–</sup></p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">P5<sup class="fm-superscript">–</sup></p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">A<sup class="fm-superscript">–</sup></p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body">B<sup class="fm-superscript">+</sup></p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">P1<sup class="fm-superscript">+</sup></p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">P2<sup class="fm-superscript">+</sup></p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">P2<sup class="fm-superscript">–</sup></p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">P1<sup class="fm-superscript">–</sup></p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">B<sup class="fm-superscript">–</sup></p>
        </td>

        <td class="contenttable-1-td"/>

        <td class="contenttable-1-td"/>
      </tr>
    </tbody>
  </table>

  <p class="body-ind1">where</p>

  <p class="body-case-b">   •   + denotes the pickup points of passengers’ requests and the vehicles’ sources.</p>

  <p class="body-case-b">   •   – denotes the delivery points of passengers’ requests and the vehicles’ destinations</p>

  <p class="body-ind1">This solution can be read as follows:</p>

  <p class="body-case-b">   •   Vehicle A source point <span class="cambria">→</span> passenger 3 pickup <span class="cambria">→</span> passenger 4 pickup <span class="cambria">→</span> passenger 3 drop-off <span class="cambria">→</span> passenger 5 pickup <span class="cambria">→</span> passenger 4 drop-off <span class="cambria">→</span> passenger 5 drop-off <span class="cambria">→</span> vehicle A destination.</p>

  <p class="body-case-b">   •   Vehicle B source point <span class="cambria">→</span> passenger 1 pickup <span class="cambria">→</span> passenger 1 pickup <span class="cambria">→</span> passenger 2 drop-off <span class="cambria">→</span> passenger 2 drop-off <span class="cambria">→</span> vehicle B destination.</p>

  <p class="body-ind1">These two schedules can be also concatenated as follows:</p>

  <table border="1" class="contenttable-1-table" id="table010" width="100%">
    <colgroup class="contenttable-0-colgroup">
      <col class="contenttable-0-col" span="1" width="7.14%"/>
      <col class="contenttable-0-col" span="1" width="7.14%"/>
      <col class="contenttable-0-col" span="1" width="7.14%"/>
      <col class="contenttable-0-col" span="1" width="7.14%"/>
      <col class="contenttable-0-col" span="1" width="7.14%"/>
      <col class="contenttable-0-col" span="1" width="7.14%"/>
      <col class="contenttable-0-col" span="1" width="7.14%"/>
      <col class="contenttable-0-col" span="1" width="7.14%"/>
      <col class="contenttable-0-col" span="1" width="7.14%"/>
      <col class="contenttable-0-col" span="1" width="7.14%"/>
      <col class="contenttable-0-col" span="1" width="7.14%"/>
      <col class="contenttable-0-col" span="1" width="7.14%"/>
      <col class="contenttable-0-col" span="1" width="7.14%"/>
      <col class="contenttable-0-col" span="1" width="7.14%"/>
    </colgroup>

    <tbody class="calibre6">
      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body">A<sup class="fm-superscript">+</sup></p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">P3<sup class="fm-superscript">+</sup></p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">P4<sup class="fm-superscript">+</sup></p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">P3<sup class="fm-superscript">-</sup></p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">P5<sup class="fm-superscript">+</sup></p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">P4<sup class="fm-superscript">-</sup></p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">P5<sup class="fm-superscript">-</sup></p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">A<sup class="fm-superscript">-</sup></p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">B<sup class="fm-superscript">+</sup></p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">P1<sup class="fm-superscript">+</sup></p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">P2<sup class="fm-superscript">+</sup></p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">P2<sup class="fm-superscript">-</sup></p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">P1<sup class="fm-superscript">-</sup></p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">B<sup class="fm-superscript">-</sup></p>
        </td>
      </tr>
    </tbody>
  </table>

  <p class="body-ind1">We use the objective function to evaluate this solution as follows:</p>

  <div class="figure">
    <p class="figuree"><img alt="" class="calibre4" src="../Images/APPC_F32_Khamis-EQ32.png"/></p>
  </div>

  <p class="body-ind1">For a more comprehensive discussion of the ride-matching problem with time windows (RMPTW) and an extended version of this simplified problem, see Herbawi and Weber’s article “A genetic and insertion heuristic algorithm for solving the dynamic ridematching problem with time windows” [9].</p>

  <p class="body-dialog"><span class="gray">  4.</span>   Binary PSO (BPSO) is used to handle this problem. A binary string is used to describe the attractions to be visited. For example, [0 0 1 0 1 0 0 0 0] means visit attractions 3 and 5. The velocity is calculated using the following equation:</p>

  <div class="figure">
    <p class="figuree"><img alt="" class="calibre4" src="../Images/APPC_F32_Khamis-EQ33.png"/></p>
  </div>

  <p class="body-ind1">where</p>

  <p class="body-case-b">   •   <i class="timesitalic">i</i> is the particle number.</p>

  <p class="body-case-b">   •   <i class="timesitalic">d</i> is the dimension or the attraction.</p>

  <p class="body-case-b">   •   <i class="timesitalic">v<sub class="fm-subscript">k</sub><sup class="fm-superscript">id</sup></i> is the velocity at iteration <i class="timesitalic">k</i> for particle <i class="timesitalic">i</i> and dimension <i class="timesitalic">d</i>.</p>

  <p class="body-case-b">   •   <i class="timesitalic">pbest<sub class="fm-subscript">k</sub><sup class="fm-superscript">id</sup></i> is the personal best at iteration <i class="timesitalic">t</i> for particle <i class="timesitalic">i</i> and dimension <i class="timesitalic">d</i>.</p>

  <p class="body-case-b">   •   <i class="timesitalic">gbest<sub class="fm-subscript">k</sub><sup class="fm-superscript">d</sup></i> is the global best at iteration <i class="timesitalic">k</i> for dimension <i class="timesitalic">d</i>.</p>

  <p class="body-case-b">   •   <i class="timesitalic">x<sub class="fm-subscript">k</sub><sup class="fm-superscript">id</sup></i> is the current position at iteration <i class="timesitalic">k</i> for particle <i class="timesitalic">i</i> and dimension <i class="timesitalic">d</i>.</p>

  <p class="body-case-b">   •   <span class="times"><i class="fm-italics">ϕ</i><sub class="fm-subscript">1</sub>, <i class="fm-italics">ϕ</i><sub class="fm-subscript">2</sub></span> are uniformly generated random numbers between 0 and 2.</p>

  <p class="body-ind1">Once the velocity vector is updated, the sigmoid value of each of the velocities is updated as follows:</p>

  <div class="figure">
    <p class="figuree"><img alt="" class="calibre4" src="../Images/APPC_F32_Khamis-EQ34.png"/></p>
  </div>

  <p class="body-ind1">A new position with the sigmoid value of the velocity is created. Next the particle position is updated as follows:</p>

  <div class="figure">
    <p class="figuree"><img alt="" class="calibre4" src="../Images/APPC_F32_Khamis-EQ35.png"/></p>
  </div>

  <p class="body-ind1">where</p>

  <p class="body-case-b">   •   <i class="timesitalic">r</i> is a uniformly generated random number between 0 and 1.</p>

  <p class="body-case-b">   •   <span class="times"><i class="fm-italics">sig</i>(<i class="fm-italics">v<sub class="fm-subscript">k</sub></i><sub class="fm-subscript">+1</sub><i class="fm-italics"><sup class="fm-superscript">id</sup></i>)</span> is the sigmoid value of the velocity at <span class="times"><i class="fm-italics">v<sub class="fm-subscript">k</sub></i><sub class="fm-subscript">+1</sub><i class="fm-italics"><sup class="fm-superscript">id</sup></i></span></p>

  <p class="fm-table-caption">Table C.7 Initialization</p>

  <table border="1" class="contenttable-1-table" id="table011" width="100%">
    <colgroup class="contenttable-0-colgroup">
      <col class="contenttable-0-col" span="1" width="8.33%"/>
      <col class="contenttable-0-col" span="1" width="8.33%"/>
      <col class="contenttable-0-col" span="1" width="8.33%"/>
      <col class="contenttable-0-col" span="1" width="8.33%"/>
      <col class="contenttable-0-col" span="1" width="8.33%"/>
      <col class="contenttable-0-col" span="1" width="8.33%"/>
      <col class="contenttable-0-col" span="1" width="8.33%"/>
      <col class="contenttable-0-col" span="1" width="8.33%"/>
      <col class="contenttable-0-col" span="1" width="8.33%"/>
      <col class="contenttable-0-col" span="1" width="8.33%"/>
      <col class="contenttable-0-col" span="1" width="8.33%"/>
      <col class="contenttable-0-col" span="1" width="8.33%"/>
    </colgroup>

    <thead class="calibre6">
      <tr class="contenttable-0-tr">
        <th class="contenttable-1-th"/>

        <th class="contenttable-1-th">
          <p class="fm-table-head"><i class="fm-italics">ϕ</i><sub class="fm-subscript">1</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head"><i class="fm-italics">ϕ</i><sub class="fm-subscript">2</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head"><i class="fm-italics">v</i><sub class="fm-subscript">01</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head"><i class="fm-italics">v</i><sub class="fm-subscript">02</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head"><i class="fm-italics">v</i><sub class="fm-subscript">03</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head"><i class="fm-italics">v</i><sub class="fm-subscript">04</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head"><i class="fm-italics">v</i><sub class="fm-subscript">05</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head"><i class="fm-italics">v</i><sub class="fm-subscript">06</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head"><i class="fm-italics">v</i><sub class="fm-subscript">07</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head"><i class="fm-italics">v</i><sub class="fm-subscript">08</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head"><i class="fm-italics">v</i><sub class="fm-subscript">09</sub></p>
        </th>
      </tr>
    </thead>

    <tbody class="calibre6">
      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body"><i class="fm-italics">x</i><sub class="fm-subscript">1</sub></p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body"><i class="fm-italics">x</i><sub class="fm-subscript">2</sub></p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body"><i class="fm-italics">x</i><sub class="fm-subscript">3</sub></p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body"><i class="fm-italics">x</i><sub class="fm-subscript">4</sub></p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>
      </tr>
    </tbody>
  </table>

  <p class="body-ind1">Let <i class="timesitalic">p<sub class="fm-subscript">i</sub></i> be the current binary value for the position of attraction <i class="timesitalic">i</i> for a particle as shown in table C.8.</p>

  <p class="fm-table-caption">Table C.8 Binary value for the positions of the 9 attractions</p>

  <table border="1" class="contenttable-1-table" id="table012" width="100%">
    <colgroup class="contenttable-0-colgroup">
      <col class="contenttable-0-col" span="1" width="10%"/>
      <col class="contenttable-0-col" span="1" width="10%"/>
      <col class="contenttable-0-col" span="1" width="10%"/>
      <col class="contenttable-0-col" span="1" width="10%"/>
      <col class="contenttable-0-col" span="1" width="10%"/>
      <col class="contenttable-0-col" span="1" width="10%"/>
      <col class="contenttable-0-col" span="1" width="10%"/>
      <col class="contenttable-0-col" span="1" width="10%"/>
      <col class="contenttable-0-col" span="1" width="10%"/>
      <col class="contenttable-0-col" span="1" width="10%"/>
    </colgroup>

    <thead class="calibre6">
      <tr class="contenttable-0-tr">
        <th class="contenttable-1-th"/>

        <th class="contenttable-1-th">
          <p class="fm-table-head"><i class="fm-italics">p</i><sub class="fm-subscript">1</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head"><i class="fm-italics">p</i><sub class="fm-subscript">2</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head"><i class="fm-italics">p</i><sub class="fm-subscript">3</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head"><i class="fm-italics">p</i><sub class="fm-subscript">4</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head"><i class="fm-italics">p</i><sub class="fm-subscript">5</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head"><i class="fm-italics">p</i><sub class="fm-subscript">6</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head"><i class="fm-italics">p</i><sub class="fm-subscript">7</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head"><i class="fm-italics">p</i><sub class="fm-subscript">8</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head"><i class="fm-italics">p</i><sub class="fm-subscript">9</sub></p>
        </th>
      </tr>
    </thead>

    <tbody class="calibre6">
      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body"><i class="fm-italics">x</i><sub class="fm-subscript">1</sub></p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">1</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">1</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body"><i class="fm-italics">x</i><sub class="fm-subscript">2</sub></p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">1</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">1</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body"><i class="fm-italics">x</i><sub class="fm-subscript">3</sub></p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">1</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">1</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body"><i class="fm-italics">x</i><sub class="fm-subscript">4</sub></p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">1</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">1</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>
      </tr>
    </tbody>
  </table>

  <p class="fm-table-caption">Table C.9 Initialization: Fitness evaluation</p>

  <table border="1" class="contenttable-1-table" id="table013" width="100%">
    <colgroup class="contenttable-0-colgroup">
      <col class="contenttable-0-col" span="1" width="6.66%"/>
      <col class="contenttable-0-col" span="1" width="6.66%"/>
      <col class="contenttable-0-col" span="1" width="6.66%"/>
      <col class="contenttable-0-col" span="1" width="6.66%"/>
      <col class="contenttable-0-col" span="1" width="6.66%"/>
      <col class="contenttable-0-col" span="1" width="6.66%"/>
      <col class="contenttable-0-col" span="1" width="6.66%"/>
      <col class="contenttable-0-col" span="1" width="6.66%"/>
      <col class="contenttable-0-col" span="1" width="6.66%"/>
      <col class="contenttable-0-col" span="1" width="6.66%"/>
      <col class="contenttable-0-col" span="1" width="6.66%"/>
      <col class="contenttable-0-col" span="1" width="6.66%"/>
      <col class="contenttable-0-col" span="1" width="6.66%"/>
      <col class="contenttable-0-col" span="1" width="6.66%"/>
      <col class="contenttable-0-col" span="1" width="6.66%"/>
    </colgroup>

    <thead class="calibre6">
      <tr class="contenttable-0-tr">
        <th class="contenttable-1-th"/>

        <th class="contenttable-1-th">
          <p class="fm-table-head"><i class="fm-italics">p</i><sub class="fm-subscript">1</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head"><i class="fm-italics">p</i><sub class="fm-subscript">2</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head"><i class="fm-italics">p</i><sub class="fm-subscript">3</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head"><i class="fm-italics">p</i><sub class="fm-subscript">4</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head"><i class="fm-italics">p</i><sub class="fm-subscript">5</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head"><i class="fm-italics">p</i><sub class="fm-subscript">6</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head"><i class="fm-italics">p</i><sub class="fm-subscript">7</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head"><i class="fm-italics">p</i><sub class="fm-subscript">8</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head"><i class="fm-italics">p</i><sub class="fm-subscript">9</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head">Total commute time</p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head">Total places visited</p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head">Average rating</p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head">Total duration</p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head"><i class="fm-italics">f</i>(<i class="fm-italics">x<sub class="fm-subscript">i</sub></i>)</p>
        </th>
      </tr>
    </thead>

    <tbody class="calibre6">
      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body"><i class="fm-italics">x</i><sub class="fm-subscript">1</sub></p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">1</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">1</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">34</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">2</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">2.000</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">180</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.700</p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body"><i class="fm-italics">x</i><sub class="fm-subscript">2</sub></p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">1</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">1</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">19</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">2</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">5.000</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">240</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">2.405</p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body"><i class="fm-italics">x</i><sub class="fm-subscript">3</sub></p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">1</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">1</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">76</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">2</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">2.500</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">180</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.809</p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body"><i class="fm-italics">x</i><sub class="fm-subscript">4</sub></p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">1</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">1</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">30</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">2</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">3.000</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">180</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">1.059</p>
        </td>
      </tr>
    </tbody>
  </table>

  <p class="fm-table-caption">Table C.10 Particle’s current personal best at initialization</p>

  <table border="1" class="contenttable-1-table" id="table014" width="100%">
    <colgroup class="contenttable-0-colgroup">
      <col class="contenttable-0-col" span="1" width="9.09%"/>
      <col class="contenttable-0-col" span="1" width="9.09%"/>
      <col class="contenttable-0-col" span="1" width="9.09%"/>
      <col class="contenttable-0-col" span="1" width="9.09%"/>
      <col class="contenttable-0-col" span="1" width="9.09%"/>
      <col class="contenttable-0-col" span="1" width="9.09%"/>
      <col class="contenttable-0-col" span="1" width="9.09%"/>
      <col class="contenttable-0-col" span="1" width="9.09%"/>
      <col class="contenttable-0-col" span="1" width="9.09%"/>
      <col class="contenttable-0-col" span="1" width="9.09%"/>
      <col class="contenttable-0-col" span="1" width="9.09%"/>
    </colgroup>

    <thead class="calibre6">
      <tr class="contenttable-0-tr">
        <th class="contenttable-1-th"/>

        <th class="contenttable-1-th">
          <p class="fm-table-head">pbest<sub class="fm-subscript">01</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head">pbest <sub class="fm-subscript">02</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head">pbest <sub class="fm-subscript">03</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head">pbest <sub class="fm-subscript">04</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head">pbest <sub class="fm-subscript">05</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head">pbest <sub class="fm-subscript">06</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head">pbest <sub class="fm-subscript">07</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head">pbest <sub class="fm-subscript">08</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head">pbest <sub class="fm-subscript">09</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head">pbestVal</p>
        </th>
      </tr>
    </thead>

    <tbody class="calibre6">
      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body"><i class="fm-italics">x</i><sub class="fm-subscript">1</sub></p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">1</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">1</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">1</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">1</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.700</p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body"><i class="fm-italics">x</i><sub class="fm-subscript">2</sub></p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body1">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body1">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body1">1</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body1">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body1">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body1">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body1">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body1">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body1">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body1">2.405</p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body"><i class="fm-italics">x</i><sub class="fm-subscript">3</sub></p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">1</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">1</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">1</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.809</p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body"><i class="fm-italics">x</i><sub class="fm-subscript">4</sub></p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">1</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">1</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">1</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">1.059</p>
        </td>
      </tr>
    </tbody>
  </table>

  <p class="fm-table-caption">Table C.11 Iteration 1: Velocity update</p>

  <table border="1" class="contenttable-1-table" id="table015" width="100%">
    <colgroup class="contenttable-0-colgroup">
      <col class="contenttable-0-col" span="1" width="8.33%"/>
      <col class="contenttable-0-col" span="1" width="8.33%"/>
      <col class="contenttable-0-col" span="1" width="8.33%"/>
      <col class="contenttable-0-col" span="1" width="8.33%"/>
      <col class="contenttable-0-col" span="1" width="8.33%"/>
      <col class="contenttable-0-col" span="1" width="8.33%"/>
      <col class="contenttable-0-col" span="1" width="8.33%"/>
      <col class="contenttable-0-col" span="1" width="8.33%"/>
      <col class="contenttable-0-col" span="1" width="8.33%"/>
      <col class="contenttable-0-col" span="1" width="8.33%"/>
      <col class="contenttable-0-col" span="1" width="8.33%"/>
      <col class="contenttable-0-col" span="1" width="8.33%"/>
    </colgroup>

    <thead class="calibre6">
      <tr class="contenttable-0-tr">
        <th class="contenttable-1-th"/>

        <th class="contenttable-1-th">
          <p class="fm-table-head"><i class="fm-italics">ϕ</i><sub class="fm-subscript">1</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head"><i class="fm-italics">ϕ</i><sub class="fm-subscript">2</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head"><i class="fm-italics">v</i><sub class="fm-subscript">11</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head"><i class="fm-italics">v</i><sub class="fm-subscript">12</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head"><i class="fm-italics">v</i><sub class="fm-subscript">13</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head"><i class="fm-italics">v</i><sub class="fm-subscript">14</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head"><i class="fm-italics">v</i><sub class="fm-subscript">15</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head"><i class="fm-italics">v</i><sub class="fm-subscript">16</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head"><i class="fm-italics">v</i><sub class="fm-subscript">17</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head"><i class="fm-italics">v</i><sub class="fm-subscript">18</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head"><i class="fm-italics">v</i><sub class="fm-subscript">19</sub></p>
        </th>
      </tr>
    </thead>

    <tbody class="calibre6">
      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body"><i class="fm-italics">x</i><sub class="fm-subscript">1</sub></p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.958</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.830</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">-0.830</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">-0.830</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.830</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.000</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.000</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.000</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.000</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.830</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.000</p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body"><i class="fm-italics">x</i><sub class="fm-subscript">2</sub></p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">1.347</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">1.517</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.000</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.000</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.000</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.000</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.000</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.000</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.000</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.000</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.000</p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body"><i class="fm-italics">x</i><sub class="fm-subscript">3</sub></p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">1.320</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">1.649</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.000</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">-1.649</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">1.649</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.000</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">-1.649</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.000</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.000</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">1.649</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.000</p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body"><i class="fm-italics">x</i><sub class="fm-subscript">4</sub></p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.757</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.678</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">-0.678</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.000</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.678</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.000</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.000</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.000</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">-0.678</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.678</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.000</p>
        </td>
      </tr>
    </tbody>
  </table>

  <p class="fm-table-caption">Table C.12 Updated sigmoid velocity values of the particle after iteration 1</p>

  <table border="1" class="contenttable-1-table" id="table016" width="100%">
    <colgroup class="contenttable-0-colgroup">
      <col class="contenttable-0-col" span="1" width="10%"/>
      <col class="contenttable-0-col" span="1" width="10%"/>
      <col class="contenttable-0-col" span="1" width="10%"/>
      <col class="contenttable-0-col" span="1" width="10%"/>
      <col class="contenttable-0-col" span="1" width="10%"/>
      <col class="contenttable-0-col" span="1" width="10%"/>
      <col class="contenttable-0-col" span="1" width="10%"/>
      <col class="contenttable-0-col" span="1" width="10%"/>
      <col class="contenttable-0-col" span="1" width="10%"/>
      <col class="contenttable-0-col" span="1" width="10%"/>
    </colgroup>

    <thead class="calibre6">
      <tr class="contenttable-0-tr">
        <th class="contenttable-1-th"/>

        <th class="contenttable-1-th">
          <p class="fm-table-head">sig(<i class="fm-italics">v</i><sub class="fm-subscript">11</sub>)</p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head">sig(<i class="fm-italics">v</i><sub class="fm-subscript">12</sub>)</p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head">sig(<i class="fm-italics">v</i><sub class="fm-subscript">13</sub>)</p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head">sig(<i class="fm-italics">v</i><sub class="fm-subscript">14</sub>)</p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head">sig(<i class="fm-italics">v</i><sub class="fm-subscript">15</sub>)</p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head">sig(<i class="fm-italics">v</i><sub class="fm-subscript">16</sub>)</p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head">sig(<i class="fm-italics">v</i><sub class="fm-subscript">17</sub>)</p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head">sig(<i class="fm-italics">v</i><sub class="fm-subscript">18</sub>)</p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head">sig(<i class="fm-italics">v</i><sub class="fm-subscript">19</sub>)</p>
        </th>
      </tr>
    </thead>

    <tbody class="calibre6">
      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body"><i class="fm-italics">x</i><sub class="fm-subscript">1</sub></p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.304</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.304</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.696</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.500</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.500</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.500</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.500</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.696</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.500</p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body"><i class="fm-italics">x</i><sub class="fm-subscript">2</sub></p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.500</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.500</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.500</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.500</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.500</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.500</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.500</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.500</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.500</p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body"><i class="fm-italics">x</i><sub class="fm-subscript">3</sub></p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.500</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.161</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.839</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.500</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.161</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.500</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.500</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.839</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.500</p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body"><i class="fm-italics">x</i><sub class="fm-subscript">4</sub></p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.337</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.500</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.663</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.500</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.500</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.500</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.337</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.663</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.500</p>
        </td>
      </tr>
    </tbody>
  </table>

  <p class="fm-table-caption">Table C.13 Uniformly generated random numbers for deciding particle updated after iteration 1</p>

  <table border="1" class="contenttable-1-table" id="table017" width="100%">
    <colgroup class="contenttable-0-colgroup">
      <col class="contenttable-0-col" span="1" width="10%"/>
      <col class="contenttable-0-col" span="1" width="10%"/>
      <col class="contenttable-0-col" span="1" width="10%"/>
      <col class="contenttable-0-col" span="1" width="10%"/>
      <col class="contenttable-0-col" span="1" width="10%"/>
      <col class="contenttable-0-col" span="1" width="10%"/>
      <col class="contenttable-0-col" span="1" width="10%"/>
      <col class="contenttable-0-col" span="1" width="10%"/>
      <col class="contenttable-0-col" span="1" width="10%"/>
      <col class="contenttable-0-col" span="1" width="10%"/>
    </colgroup>

    <thead class="calibre6">
      <tr class="contenttable-0-tr">
        <th class="contenttable-1-th"/>

        <th class="contenttable-1-th">
          <p class="fm-table-head"><i class="fm-italics">r</i><sub class="fm-subscript">11</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head"><i class="fm-italics">r</i><sub class="fm-subscript">12</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head"><i class="fm-italics">r</i><sub class="fm-subscript">13</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head"><i class="fm-italics">r</i><sub class="fm-subscript">14</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head"><i class="fm-italics">r</i><sub class="fm-subscript">15</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head"><i class="fm-italics">r</i><sub class="fm-subscript">16</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head"><i class="fm-italics">r</i><sub class="fm-subscript">17</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head"><i class="fm-italics">r</i><sub class="fm-subscript">18</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head"><i class="fm-italics">r</i><sub class="fm-subscript">19</sub></p>
        </th>
      </tr>
    </thead>

    <tbody class="calibre6">
      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body">1</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.477</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.724</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.875</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.654</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.088</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.089</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.853</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.925</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.528</p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body">2</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.673</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.530</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.438</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.785</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.218</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.763</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.838</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.749</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.590</p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body">3</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.534</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.086</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.301</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.763</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.653</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.754</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.809</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.974</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.763</p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body">4</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.218</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.697</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.875</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.854</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.116</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.941</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.678</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.742</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0.965</p>
        </td>
      </tr>
    </tbody>
  </table>

  <p class="body-ind1">Iteration 1: Global best is 2.405, and the best particle is <span class="times"><i class="fm-italics">x</i><sub class="fm-subscript">2</sub> = [0 0 1 0 0 0 0 0 0]</span>.</p>

  <p class="body-ind1">Iteration 2: Velocity update</p>

  <p class="fm-table-caption">Table C.14 Updated particle state and fitness function after iteration 2</p>

  <table border="1" class="contenttable-1-table" id="table018" width="100%">
    <colgroup class="contenttable-0-colgroup">
      <col class="contenttable-0-col" span="1" width="6.66%"/>
      <col class="contenttable-0-col" span="1" width="6.66%"/>
      <col class="contenttable-0-col" span="1" width="6.66%"/>
      <col class="contenttable-0-col" span="1" width="6.66%"/>
      <col class="contenttable-0-col" span="1" width="6.66%"/>
      <col class="contenttable-0-col" span="1" width="6.66%"/>
      <col class="contenttable-0-col" span="1" width="6.66%"/>
      <col class="contenttable-0-col" span="1" width="6.66%"/>
      <col class="contenttable-0-col" span="1" width="6.66%"/>
      <col class="contenttable-0-col" span="1" width="6.66%"/>
      <col class="contenttable-0-col" span="1" width="6.66%"/>
      <col class="contenttable-0-col" span="1" width="6.66%"/>
      <col class="contenttable-0-col" span="1" width="6.66%"/>
      <col class="contenttable-0-col" span="1" width="6.66%"/>
      <col class="contenttable-0-col" span="1" width="6.66%"/>
    </colgroup>

    <thead class="calibre6">
      <tr class="contenttable-0-tr">
        <th class="contenttable-1-th"/>

        <th class="contenttable-1-th">
          <p class="fm-table-head"><i class="fm-italics">p</i><sub class="fm-subscript">1</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head"><i class="fm-italics">p</i><sub class="fm-subscript">2</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head"><i class="fm-italics">p</i><sub class="fm-subscript">3</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head"><i class="fm-italics">p</i><sub class="fm-subscript">4</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head"><i class="fm-italics">p</i><sub class="fm-subscript">5</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head"><i class="fm-italics">p</i><sub class="fm-subscript">6</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head"><i class="fm-italics">p</i><sub class="fm-subscript">7</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head"><i class="fm-italics">p</i><sub class="fm-subscript">8</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head"><i class="fm-italics">p</i><sub class="fm-subscript">9</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head">Total commute time</p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head">Total places visited</p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head">Average rating</p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head">Total duration</p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head"><i class="fm-italics">f</i>(<i class="fm-italics">x<sub class="fm-subscript">i</sub></i>)</p>
        </th>
      </tr>
    </thead>

    <tbody class="calibre6">
      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body"><i class="fm-italics">x</i><sub class="fm-subscript">1</sub></p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">1</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">1</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">64</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">2</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">3.500</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">180</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">1.158</p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body"><i class="fm-italics">x</i><sub class="fm-subscript">2</sub></p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">1</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">1</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">37</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">2</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">5.000</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">300</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">2.901</p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body"><i class="fm-italics">x</i><sub class="fm-subscript">3</sub></p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">1</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">1</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">70</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">2</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">2.500</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">240</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">1.091</p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body"><i class="fm-italics">x</i><sub class="fm-subscript">4</sub></p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">1</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">1</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">24</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">2</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">4.500</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">240</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">2.143</p>
        </td>
      </tr>
    </tbody>
  </table>

  <p class="fm-table-caption">Table C.15 Updated personal best of the particle after iteration 2</p>

  <table border="1" class="contenttable-1-table" id="table019" width="100%">
    <colgroup class="contenttable-0-colgroup">
      <col class="contenttable-0-col" span="1" width="9.09%"/>
      <col class="contenttable-0-col" span="1" width="9.09%"/>
      <col class="contenttable-0-col" span="1" width="9.09%"/>
      <col class="contenttable-0-col" span="1" width="9.09%"/>
      <col class="contenttable-0-col" span="1" width="9.09%"/>
      <col class="contenttable-0-col" span="1" width="9.09%"/>
      <col class="contenttable-0-col" span="1" width="9.09%"/>
      <col class="contenttable-0-col" span="1" width="9.09%"/>
      <col class="contenttable-0-col" span="1" width="9.09%"/>
      <col class="contenttable-0-col" span="1" width="9.09%"/>
      <col class="contenttable-0-col" span="1" width="9.09%"/>
    </colgroup>

    <thead class="calibre6">
      <tr class="contenttable-0-tr">
        <th class="contenttable-1-th"/>

        <th class="contenttable-1-th">
          <p class="fm-table-head">pbest<sub class="fm-subscript">11</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head">pbest <sub class="fm-subscript">12</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head">pbest <sub class="fm-subscript">13</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head">pbest <sub class="fm-subscript">14</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head">pbest <sub class="fm-subscript">15</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head">pbest <sub class="fm-subscript">16</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head">pbest <sub class="fm-subscript">17</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head">pbest <sub class="fm-subscript">18</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head">pbest <sub class="fm-subscript">19</sub></p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head">pbestVal</p>
        </th>
      </tr>
    </thead>

    <tbody class="calibre6">
      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body"><i class="fm-italics">x</i><sub class="fm-subscript">1</sub></p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">1</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">1</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">1.158</p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body"><i class="fm-italics">x</i><sub class="fm-subscript">2</sub></p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body1">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body1">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body1">1</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body1">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body1">1</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body1">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body1">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body1">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body1">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body1">2.901</p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body"><i class="fm-italics">x</i><sub class="fm-subscript">3</sub></p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">1</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">1</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">1.091</p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body"><i class="fm-italics">x</i><sub class="fm-subscript">4</sub></p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">1</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">1</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">0</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">2.143</p>
        </td>
      </tr>
    </tbody>
  </table>

  <p class="body-ind1">The global best is 2.901, and the best particle is <span class="times"><i class="fm-italics">x</i><sub class="fm-subscript">2</sub> = [0 0 1 0 1 0 0 0 0]</span>. Repeat until the stopping criteria is fulfilled.</p>

  <p class="body-dialog"><span class="gray">  5.</span>   The next listing shows the steps for solving the trilateration problem using PSO.</p>

  <p class="fm-code-listing-captione">Listing C.13 Solving the trilateration problem using PSO</p>
  <pre class="programlistinge">import numpy as np
from pyswarms.single import GlobalBestPSO
import pyswarms as ps
  
def objective_function(pos):                                              <span class="fm-combinumeral">①</span>
    r = np.array([6, 6.5, 8])
    x0 = np.array([1, 3, 7])
    y0 = np.array([5, 1, 7])
  
    x = pos[:, 0]
    y = pos[:, 1]
    
    f = np.sum(r - np.sqrt((x0 - x.reshape(-1, 1)) ** 2 + (y0 - y.reshape(-
<span class="fm-code-continuation-arrow">➥</span>1, 1)) ** 2), axis=1)
    return f
  
options = {"c1": 0.5, "c2": 0.5, "w": 0.79}                               <span class="fm-combinumeral">②</span>
bounds = (np.array([0, 0]), np.array([8, 8]))                             <span class="fm-combinumeral">②</span>
  
optimizer = GlobalBestPSO(n_particles=100, dimensions=2, options=options,
<span class="fm-code-continuation-arrow">➥</span> bounds=bounds)                                                         <span class="fm-combinumeral">③</span>
best_cost, best_position = optimizer.optimize(objective_function,
<span class="fm-code-continuation-arrow">➥</span> iters=1000)                                                            <span class="fm-combinumeral">③</span>
  
print("Best position:", np.round(best_position,2))                        <span class="fm-combinumeral">④</span>
print("Best cost:", np.round(best_cost,3))                                <span class="fm-combinumeral">④</span></pre>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">①</span> Define the objective function.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">②</span> Set up the PSO algorithm.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">③</span> Initialize GlobalBestPSO, and minimize the objective function.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">④</span> Print the results.</p>

  <p class="body-dialog"><span class="gray">  6.</span>   The next listing shows the steps for solving the coffee shop problem.</p>

  <p class="fm-code-listing-captione">Listing C.14 Solving the coffee shop problem using PSO</p>
  <pre class="programlistinge">import numpy as np                                                        <span class="fm-combinumeral">①</span>
import pyswarms as ps                                                     <span class="fm-combinumeral">①</span>
 
def fitness_function(x):                                                  <span class="fm-combinumeral">②</span>
    n_particles = x.shape[0]                                              <span class="fm-combinumeral">②</span>
    profit=0                                                              <span class="fm-combinumeral">②</span>
    for i in range(n_particles):                                          <span class="fm-combinumeral">②</span>
        profit=-(2*x[i][0] + 3*x[i][1] - (x[i][0] + 1.5*x[i][1]))         <span class="fm-combinumeral">②</span>
    return profit                                                         <span class="fm-combinumeral">②</span>
 
num_particles = 10                                                        <span class="fm-combinumeral">③</span>
num_iterations = 100                                                      <span class="fm-combinumeral">③</span>
 
lb = np.array([50, 75])                                                   <span class="fm-combinumeral">④</span>
ub = np.array([300, 450])                                                 <span class="fm-combinumeral">④</span>
bounds = (lb, ub)                                                         <span class="fm-combinumeral">④</span>
 
options={'w':0.79, 'c1': 1.5, 'c2': 1.3}                                  <span class="fm-combinumeral">⑤</span>
 
optimizer = ps.single.GlobalBestPSO(n_particles=num_particles,
<span class="fm-code-continuation-arrow">➥</span> dimensions=2, options=options, bounds=bounds)                          <span class="fm-combinumeral">⑥</span>
 
best_cost, best_pos = optimizer.optimize(fitness_function,
<span class="fm-code-continuation-arrow">➥</span> iters=num_iterations)                                                  <span class="fm-combinumeral">⑦</span>
 
best_pos=np.asarray(best_pos, dtype = 'int') 
print('###############################################') 
print('Total profit: ', round(-best_cost, 2), '$') 
print('Optimal number of small coffees to make: ',best_pos[0]) 
print('Optimal number of large coffees to make: ', best_pos[1]) </pre>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">①</span> Import the required libraries.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">②</span> Define the fitness function.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">③</span> Set the number of particles and iterations.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">④</span> Set the lower and upper bounds of the variables.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑤</span> Set the optimizer options.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑥</span> Initialize the optimizer.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑦</span> Perform the optimization.</p>

  <p class="body-dialog"><span class="gray">  7.</span>   The next listing shows the steps for solving the doctor scheduling problem.</p>

  <p class="fm-code-listing-captione">Listing C.15 Solving the doctor scheduling problem using PSO</p>
  <pre class="programlistinge">import matplotlib.pyplot as plt
import numpy as np
import pyswarms as ps
  
full_time_rates = np.array([30, 35, 40, 45, 50])                            <span class="fm-combinumeral">①</span>
overtime_rates = full_time_rates * 1.5                                      <span class="fm-combinumeral">①</span>
part_time_rates = np.array([25, 27, 29, 31, 33])                            <span class="fm-combinumeral">①</span>
 
def objective_function(x): 
    x1 = x[:, :len(full_time_rates)]                                        <span class="fm-combinumeral">②</span>
    x2 = x[:, len(full_time_rates):2 * len(full_time_rates)]                <span class="fm-combinumeral">②</span>
    x3 = x[:, 2 * len(full_time_rates):]                                    <span class="fm-combinumeral">②</span>
 
    total_cost = np.sum(x1 * full_time_rates) + np.sum(x2 * overtime_rates)
<span class="fm-code-continuation-arrow">➥</span> + np.sum(x3 * part_time_rates)                                           <span class="fm-combinumeral">③</span>
 
    
    penalty_x1_x2 = np.maximum(0, 4 - np.sum(x1) - np.sum(x2)) * 10000
    penalty_x3 = np.maximum(0, 2 - np.sum(x3)) * 10000                      <span class="fm-combinumeral">④</span>
                                                                            <span class="fm-combinumeral">④</span>
    total_cost_with_penalty = total_cost + penalty_x1_x2 + penalty_x3       <span class="fm-combinumeral">④</span>
 
    return total_cost_with_penalty
 
min_bound = np.zeros(3 * len(full_time_rates))                              <span class="fm-combinumeral">⑤</span>
max_bound = np.full(3 * len(full_time_rates), 10)                           <span class="fm-combinumeral">⑤</span>
bounds = (min_bound, max_bound)                                             <span class="fm-combinumeral">⑤</span>
options = {'w': 0.74, 'c1': 2.05, 'c2': 2.05, 'k': 5, 'p': 1}               <span class="fm-combinumeral">⑥</span>
optimizer = ps.single.LocalBestPSO(n_particles=30, dimensions=3 *
<span class="fm-code-continuation-arrow">➥</span> len(full_time_rates), options=options, bounds=bounds)                    <span class="fm-combinumeral">⑦</span>
cost, pos = optimizer.optimize(objective_function, iters=100, verbose=True) <span class="fm-combinumeral">⑧</span>
optimal_x1 = pos[:len(full_time_rates)]                                     <span class="fm-combinumeral">⑨</span>
optimal_x2 = pos[len(full_time_rates):2 * len(full_time_rates)]             <span class="fm-combinumeral">⑨</span>
optimal_x3 = pos[2 * len(full_time_rates):]                                 <span class="fm-combinumeral">⑨</span></pre>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">①</span> Set full-time hourly rates, overtime rates, and part-time doctor rates.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">②</span> Define the three decision variables.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">③</span> Define the total cost as an objective function.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">④</span> Define the constraints and add them as a penalty in the cost function.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑤</span> Initialize the bounds.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑥</span> Set the options for PSO.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑦</span> Create an instance of PSO.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑧</span> Perform the optimization.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑨</span> Extract optimal values of the decision variables x1, x2, and x3.</p>

  <p class="body-ind1">The complete version of listing C.15, available in the book’s GitHub repo, contains a function to print and visualize the results. Figure C.33 shows the hours worked for each doctor.</p>

  <div class="figure">
    <p class="figuree"><img alt="" class="calibre4" src="../Images/APPC_F33_Khamis.png"/></p>

    <p class="figurecaptione">Figure C.33 Hours worked by each doctor</p>
  </div>

  <p class="body-dialog"><span class="gray">  8.</span>   The next listing shows the steps for solving the supply chain optimization problem using PSO. We start by importing the required libraries.</p>

  <p class="fm-code-listing-captione">Listing C.16 Solving the supply chain optimization problem using PSO</p>
  <pre class="programlistinge">import numpy as np
import random
from pymoo.algorithms.soo.nonconvex.pso import PSO
from pymoo.optimize import minimize
from pymoo.algorithms.soo.nonconvex.ga import GA
from pymoo.operators.crossover.pntx import PointCrossover
from pymoo.operators.mutation.pm import PolynomialMutation
from pymoo.operators.repair.rounding import RoundingRepair
from pymoo.operators.sampling.rnd import FloatRandomSampling
from pymoo.core.problem import Problem
from geopy.geocoders import Nominatim
from geopy.distance import geodesic
import folium</pre>

  <p class="body-ind1">We then define the problem data as follows:</p>
  <pre class="programlistinge">supply_schools = [1, 6, 7, 8]                             <span class="fm-combinumeral">①</span>
demand_schools = [2, 3, 4, 5]                             <span class="fm-combinumeral">②</span>
amount_supply = [20, 30, 15, 35]                          <span class="fm-combinumeral">③</span>
amount_demand = [5, 45, 10, 40]                           <span class="fm-combinumeral">④</span>
n_var=len(supply_schools)*len(demand_schools)             <span class="fm-combinumeral">⑤</span></pre>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">①</span> Schools with microscopes available</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">②</span> Schools with microscopes requested</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">③</span> Number of microscopes available at each school</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">④</span> Number of microscopes requested at each school</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑤</span> Number of variables</p>

  <p class="body-ind1">As a continuation of listing C.16, the following function generates random locations around a center point to represent the supply and demand schools in the selected city (using Toronto as an example). We calculate the distances between the schools using geopy:</p>
  <pre class="programlistinge">np.random.seed(0)                                                        <span class="fm-combinumeral">①</span>
  
def generate_random(number, center_point):
    lat, lon = center_point                                              <span class="fm-combinumeral">②</span>
    coords = [(random.uniform(lat - 0.01, lat + 0.01), random.uniform(lon -
<span class="fm-code-continuation-arrow">➥</span> 0.01, lon + 0.01)) for _ in range(number)]
    return coords
  
supply_coords = generate_random(len(supply_schools), [location.latitude,
<span class="fm-code-continuation-arrow">➥</span> location.longitude])                                                  <span class="fm-combinumeral">③</span>
demand_coords = generate_random(len(demand_schools), [location.latitude,
<span class="fm-code-continuation-arrow">➥</span> location.longitude])                                                  <span class="fm-combinumeral">④</span>
  
distances = []                                                           <span class="fm-combinumeral">⑤</span>
for supply in supply_coords:                                             <span class="fm-combinumeral">⑤</span>
    row = []                                                             <span class="fm-combinumeral">⑤</span>
    for demand in demand_coords:                                         <span class="fm-combinumeral">⑤</span>
        row.append(geodesic(supply, demand).kilometers)                  <span class="fm-combinumeral">⑤</span>
    distances.append(row)                                                <span class="fm-combinumeral">⑤</span>
distances = np.array(distances)                                          <span class="fm-combinumeral">⑤</span>
  
cost_matrix=50*distances</pre>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">①</span> For reproducibility</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">②</span> Set the center of the map.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">③</span> Generate random GPS coordinates (lat, long) for the supply schools.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">④</span> Generate random GPS coordinates (lat, long) for the demand schools.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑤</span> Calculate geodesic distances between the schools in km.</p>

  <p class="body-ind1">The following class defines the transportation problem in a format compatible with pymoo. It defines the decision variables, constraints, and the objective function:</p>
  <pre class="programlistinge">class Transportation_problem(Problem):
    def __init__(self,
                 cost_matrix, 
                 amount_supply,
                 amount_demand
                 ):
        super().__init__(n_var=n_var,n_constr=1, vtype=int)
        self.cost_matrix = cost_matrix
        self.amount_supply = amount_supply
        self.amount_demand = amount_demand
        self.xl = np.array(np.zeros(n_var))
        self.xu = np.repeat(amount_supply, len(amount_demand))
  
    def _evaluate(self, X, out, *args, **kwargs):
        loss = np.zeros((X.shape[0], 1))
        g = np.zeros((X.shape[0], 1))
        for i in range(len(X)):
            soln = X[i].reshape(self.cost_matrix.shape)
            cost_x = X[i].reshape(self.cost_matrix.shape)
            cost = cost_x * cost_matrix.T
            cost = cost.sum()
            loss[i] = cost         
            total_supply = soln.sum(axis=1)
            total_demand = soln.sum(axis=0)  
            print("total_supply: ", total_supply)
            print("total_demand: ", total_demand)
            g[i] =  np.any(total_supply&lt;self.amount_supply) or
<span class="fm-code-continuation-arrow">➥</span> np.any(total_demand&lt;self.amount_demand)
        out["F"] = loss
        out["G"] = g</pre>

  <p class="body-ind1">Now we can create a problem object and a PSO solver as follows:</p>
  <pre class="programlistinge">problem = Transportation_problem(cost_matrix,amount_supply,amount_demand) 
algorithm = PSO(pop_size=100,repair=RoundingRepair()) </pre>

  <p class="body-ind1">The following line is used to run 150 iterations of the PSO solver:</p>
  <pre class="programlistinge">res = minimize(problem, algorithm, ('n_gen', 150), seed=1, verbose=False) </pre>

  <p class="body-ind1">The following code snippet is used to print the solution obtained by the PSO solver:</p>
  <pre class="programlistinge">soln = res.X                                                             <span class="fm-combinumeral">①</span>
 
supply_num=len(amount_supply)                                            <span class="fm-combinumeral">②</span>
demand_num=len(amount_demand)                                            <span class="fm-combinumeral">③</span>
 
for i in range(supply_num):                                              <span class="fm-combinumeral">④</span>
    print(f"Supply School({supply_schools[i]}): {' + [CA]'.join(['soln['+str(j)+']' for j in range(i*supply_num,
<span class="fm-code-continuation-arrow">➥</span> (i+1)*supply_num)])} &lt;= {amount_supply[i]} or {' + '.join(map(str,
<span class="fm-code-continuation-arrow">➥</span> soln[i*supply_num:(i+1)*supply_num]))} &lt;= {amount_supply[i]} or
<span class="fm-code-continuation-arrow">➥</span> {sum(soln[i*supply_num:(i+1)*supply_num])} &lt;= {amount_supply[i]}")
 
for j in range(demand_num):                                              <span class="fm-combinumeral">⑤</span>
    print(f"Demand School({demand_schools[j]}): {' +
<span class="fm-code-continuation-arrow">➥</span> '.join(['soln['+str(i*demand_num+j)+']' for i in range(demand_num)])}
<span class="fm-code-continuation-arrow">➥</span> &gt;= {amount_demand[j]} or {' + '.join(map(str, [soln[i*4+j] for i in
<span class="fm-code-continuation-arrow">➥</span> range(demand_num)]))} &gt;= {sum(soln[i*demand_num+j] for i in
<span class="fm-code-continuation-arrow">➥</span> range(demand_num))} or {sum(soln[i*demand_num+j] for i in
<span class="fm-code-continuation-arrow">➥</span> range(demand_num))} &gt;= {amount_demand[j]}") 
 
print(f"Shipping cost =  {round(res.F[0], 2)} $")                        <span class="fm-combinumeral">⑥</span></pre>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">①</span> Extract the solution.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">②</span> Number of supply points</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">③</span> Number of demand points</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">④</span> Print each supply point.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑤</span> Print each demand point.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑥</span> Print the shipping cost.</p>

  <p class="body-ind1">Given the randomness included in the implementation, the code will produce output that is something like the following:</p>
  <pre class="programlistinge">Supply School(1): soln[0] + soln[1] + soln[2] + soln[3] &lt;= 20 or 1 + 0 + 14 + 5 &lt;= 20 or 20 &lt;= 20
Supply School(6): soln[4] + soln[5] + soln[6] + soln[7] &lt;= 30 or 0 + 30 + 0 + 0 &lt;= 30 or 30 &lt;= 30
Supply School(7): soln[8] + soln[9] + soln[10] + soln[11] &lt;= 15 or 0 + 15 + 0 + 0 &lt;= 15 or 15 &lt;= 15
Supply School(8): soln[12] + soln[13] + soln[14] + soln[15] &lt;= 35 or 4 + 0 + 0 + 35 &lt;= 35 or 39 &lt;= 35
Demand School(2): soln[0] + soln[4] + soln[8] + soln[12] &gt;= 5 or 1 + 0 + 0 + 4 &gt;= 5 or 5 &gt;= 5
Demand School(3): soln[1] + soln[5] + soln[9] + soln[13] &gt;= 45 or 0 + 30 + 15 + 0 &gt;= 45 or 45 &gt;= 45
Demand School(4): soln[2] + soln[6] + soln[10] + soln[14] &gt;= 10 or 14 + 0 + 0 + 0 &gt;= 14 or 14 &gt;= 10
Demand School(5): soln[3] + soln[7] + soln[11] + soln[15] &gt;= 40 or 5 + 0 + 0 + 35 &gt;= 40 or 40 &gt;= 40
Shipping cost =  3053.94 $</pre>

  <p class="body-ind1">The following code snippet can be used to visualize the solution of a spatial map using folium:</p>
  <pre class="programlistinge">def normalize(lst):                                                  <span class="fm-combinumeral">①</span>
    s = sum(lst)
    return list(map(lambda x: (x/s)*10, lst))
  
soln_normalized = normalize(soln)                                    <span class="fm-combinumeral">②</span>
 
colors = ['cyan', 'brown', 'orange', 'purple']                       <span class="fm-combinumeral">③</span>
 
m = folium.Map(location=[location.latitude, location.longitude],
<span class="fm-code-continuation-arrow">➥</span> zoom_start=15, scrollWheelZoom=False, dragging=False)             <span class="fm-combinumeral">④</span>
 
for i, coord in zip(supply_schools, supply_coords):
    folium.Marker(location=coord, icon=folium.Icon(icon="home",
<span class="fm-code-continuation-arrow">➥</span> color='red'), popup=f'Supply School {i+1}').add_to(m)             <span class="fm-combinumeral">⑤</span>
 
for i, coord in zip(demand_schools, demand_coords):
    folium.Marker(location=coord, icon=folium.Icon(icon="flag",
<span class="fm-code-continuation-arrow">➥</span> color='blue'), popup=f'Demand School {i+1}').add_to(m)            <span class="fm-combinumeral">⑥</span>
 
for i in range(len(supply_schools)):                                 <span class="fm-combinumeral">⑦</span>
    for j in range(len(demand_schools)):
        soln_value = soln[i*len(demand_schools) + j]
        folium.PolyLine(locations=[supply_coords[i], demand_coords[j]],
<span class="fm-code-continuation-arrow">➥</span> color=colors[i % len(colors)],
<span class="fm-code-continuation-arrow">➥</span>  weight=5*soln_normalized[i*len(demand_schools) + j],
<span class="fm-code-continuation-arrow">➥</span> popup=folium.Popup(f'# of microscopes: {soln_value}')).add_to(m)
             
m                                                                    <span class="fm-combinumeral">⑧</span></pre>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">①</span> Normalize function</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">②</span> Normalize soln array</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">③</span> Define a color list.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">④</span> Create a map centered at downtown Toronto.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑤</span> Add markers for supply schools.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑥</span> Add markers for demand schools.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑦</span> Add lines (edges) between supply and demand schools.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑧</span> Show the map.</p>

  <p class="body-ind1">Figure C.34 shows a solution that may be produced by PSO.</p>

  <div class="figure">
    <p class="figuree"><img alt="" class="calibre4" src="../Images/APPC_F34_Khamis.png"/></p>

    <p class="figurecaptione">Figure C.34 School microscopes supply and demand</p>
  </div>

  <p class="body-ind1">The complete version of listing C.16, available in the book’s <a class="url" href="https://github.com/Optimization-Algorithms-Book/Code-Listings/blob/main/Appendix%20C/Chapter%209/Listing%20C.16_Supply_demand.ipynb">GitHub repo</a>, also shows how to solve this problem using the genetic algorithm.</p>

  <div class="calibre11"/>

  <div class="calibre12"/>

  <div class="calibre12"/>

  <div class="calibre12"/><h2 class="fm-head" id="heading_id_27">C.9 Chapter 10: Other swarm intelligence algorithms to explore</h2>

  

<h3 class="fm-head1" id="heading_id_28">C.9.1 Exercises</h3>

  <p class="body-dialog"><span class="gray">  1.</span>   Match the terms and descriptions shown in table C.16.</p>

  <p class="fm-table-caption">Table C.16</p>

  <table border="1" class="contenttable-1-table" id="table020" width="100%">
    <colgroup class="contenttable-0-colgroup">
      <col class="contenttable-0-col" span="1" width="33%"/>
      <col class="contenttable-0-col" span="1" width="66%"/>
    </colgroup>

    <thead class="calibre6">
      <tr class="contenttable-0-tr">
        <th class="contenttable-1-th">
          <p class="fm-table-head">Terms</p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head">Descriptions</p>
        </th>
      </tr>
    </thead>

    <tbody class="calibre6">
      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body">1. Ant colony system (ACS)</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">a. Bees that search for new food sources after exhausting their current ones</p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body">2. Stigmergy</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">b. Positive feedback about food path causes that path to be followed by more and more ants</p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body">3. Scout bees</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">c. A pheromone update method that doesn’t take the desirability of the solution into account</p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body">4. Max-min ant system (MMAS)</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">d. The maximum number of unsuccessful attempts made by a scout bee to find a new food source</p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body">5. Autocatalytic behavior</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">e. Bees that probabilistically choose food sources depending on the fitness of the solutions found by the employed bees</p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body">6. Ant density model</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">f. Indirect communication among social insects through environmental modifications that serve as external memory</p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body">7. Onlooker bees</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">g. A pheromone update method that uses local information to update the pheromone concentrations</p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body">8. Ant-cycle</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">h. An ACO variation that uses an elitist strategy called pseudo-random proportional action rule</p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body">9. Ant System (AS)</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">i. An ACO variant that adds a memory capability by including a tabu list</p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body">10. Trial limit</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">k. An ACO variation that overcomes stagnation</p>
        </td>
      </tr>
    </tbody>
  </table>

  <p class="body-dialog"><span class="gray">  2.</span>   Write Python code to find the shortest path between a source point and a destination point using the ant colony optimization algorithm. Assume that you’re currently standing at the King Edward VII equestrian statue in the city of Toronto with GPS coordinates (43.664527, –79.392442). Imagine you’re a student at the University of Toronto, and you’re already running late for your Optimization Algorithms lecture at the Bahen Centre for Information Technology with GPS coordinates (43.659659, –79.397669). Visualize the obtained route on a map centered on King’s College Circle with GPS coordinates (43.661667, –79.395) so you can reach your destination. Feel free to use the helping functions available in the optalgotools package, such as <code class="fm-code-in-text">Node</code>, <code class="fm-code-in-text">cost</code>, and <code class="fm-code-in-text">draw_route</code>. Use the code to experiment with different search spaces (different areas of interest, different origins, and destinations) and different algorithm parameter settings.</p>

  <p class="body-dialog"><span class="gray">  3.</span>   Reverse osmosis (RO) is a very effective and important process for desalination and water waste reclamation. Assume that you need to maximize the RO high pressure pump power. This power depends of a number of parameters according to the following equation:</p>

  <div class="figure">
    <p class="figuree"><img alt="" class="calibre4" src="../Images/APPC_F34_Khamis-EQ36.png"/></p>
  </div>

  <p class="body-ind1">where</p>

  <p class="body-case-b">   •   <i class="timesitalic">HP</i> is the RO high pressure pump power in kW.</p>

  <p class="body-case-b">   •   <i class="timesitalic">M<sub class="fm-subscript">d</sub></i> is the RO productivity in m3/d and is in the range of <span class="times">41.67 &lt; M<i class="fm-italics"><sub class="fm-subscript">d</sub></i> &lt;416.67 m<sup class="fm-superscript">3</sup>/d</span>.</p>

  <p class="body-case-b">   •   <i class="timesitalic">N<sub class="fm-subscript">v</sub></i> is number of pressure vessels and is ranged as <span class="times">1 &lt; N<i class="fm-italics"><sub class="fm-subscript">v</sub></i> &lt; 200</span>.</p>

  <p class="body-case-b">   •   <span class="times">∆<i class="timesitalic">π</i></span> is the net osmotic pressure across the membrane and is in the range <span class="times">1400 &lt; ∆<i class="timesitalic">π</i> &lt; 2600 kPa</span>.</p>

  <p class="body-case-b">   •   <i class="timesitalic">RR</i> is the recovery ratio and is ranged as <span class="times">1 &lt; RR &lt; 50%</span>.</p>

  <p class="body-case-b">   •   <i class="timesitalic">η</i> is the efficiency of the high pressure pump and is in the range of <span class="times">0.70 &lt; <i class="fm-italics">η</i> &lt; 0.85</span>.</p>

  <p class="body-case-b">   •   <i class="timesitalic">ρ</i> is the density of water.</p>

  <p class="body-ind1">Write Python code to find the optimal values of the decision variables (<span class="times"><i class="fm-italics">Md, Nv</i>, ∆<i class="fm-italics">π, RR, η</i></span>, and <i class="timesitalic">ρ</i>) to maximize HP using the ant colony optimization (ACO) algorithm. Solve the same problem using the <code class="fm-code-in-text">optimize</code> solver in SciPy.</p>

  <p class="body-dialog"><span class="gray">  4.</span>   Solve the supply and demand problem introduced in exercise 8 of chapter 9 using the ant colony optimization (ACO) algorithm. Use mixed integer distributed ant colony optimization (MIDACO) to solve this problem. MIDACO (<a class="url" href="http://www.midaco-solver.com">www.midaco-solver.com</a>) is a numerical high-performance software for solving single- and multi-objective optimization problems. It is based on ACO with an extension for mixed integer search domains.</p>

  <p class="body-ind1">To install MIDACO, follow these steps:</p>

  <p class="body-case-b">  1.  Download MIDACO Python Gateway (<a class="url" href="http://www.midaco-solver.com/index.php/download/python">midaco.py</a>), and remove the .txt extension.</p>

  <p class="body-case-b">  2.  Download the appropriate library file (<a class="url" href="http://www.midaco-solver.com/index.php/download/python">midacopy.dll</a> or midacopy.so).</p>

  <p class="body-case-b">  3.  Store all the files in the same folder on your PC.</p>

  <p class="body-case-b">  4.  Import <code class="fm-code-in-text">midaco</code> into your Jupyter notebook.</p>

  <p class="body-ind1">MIDACO is licensed software with a limited free license that enables optimization with up to four variables (two supply schools and two demand schools).</p>

  <p class="body-ind1">Assume the following reduced problem data:</p>
  <pre class="programlistinge">supply_schools = [1, 3]     <span class="fm-combinumeral">①</span>
demand_schools = [2, 4]     <span class="fm-combinumeral">②</span>
amount_supply = [20, 30]    <span class="fm-combinumeral">③</span>
amount_demand = [5, 45]     <span class="fm-combinumeral">④</span></pre>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">①</span> Schools with microscopes available</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">②</span> Schools with microscopes requested</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">③</span> Number of microscopes available at each school</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">④</span> Number of microscopes requested at each school</p>

  <p class="body-ind1">Write Python code to solve this problem using MIDACO. Visualize the solution on a geospatial map. For a larger number of schools, you can obtain an unlimited license or request a free academic trial of the unlimited version that can support up to 100,000 variables.</p>

  <h3 class="fm-head1" id="heading_id_29">C.9.2 Solutions</h3>

  <p class="body-dialog"><span class="gray">  1.</span>   Answers</p>

  <p class="body-dialogb"><span class="gray">1-h, 2-f, 3-a, 4-k, 5-b, 6-c, 7-e, 8-g, 9-i, 10-d</span></p>

  <p class="body-dialog"><span class="gray">  2.</span>   Listing C.17 shows the steps to find and visualize the shortest path between two points of interest in the city of Toronto. The code uses helping functions from optalgotools such as <span class="fm-code-in-text">Node</span>, <span class="fm-code-in-text">cost</span>, and <span class="fm-code-in-text">draw_route</span>. We start by defining and visualizing the search space as follows.</p>

  <p class="fm-code-listing-captione">Listing C.17 Solving a routing problem using ACO</p>
  <pre class="programlistinge">import osmnx as ox
from optalgotools.structures import Node
from optalgotools.routing import cost, draw_route
import random
from tqdm.notebook import tqdm
import matplotlib.pyplot as plt
 
reference = (43.661667, -79.395)                                         <span class="fm-combinumeral">①</span>
 
G = ox.graph_from_point(reference, dist=300, clean_periphery=True,
<span class="fm-code-continuation-arrow">➥</span> simplify=True)                                                        <span class="fm-combinumeral">②</span>
 
origin = (43.664527, -79.392442)                                         <span class="fm-combinumeral">③</span>
destination = (43.659659, -79.397669)                                    <span class="fm-combinumeral">④</span>
 
origin_id = ox.distance.nearest_nodes(G, origin[1], origin[0])           <span class="fm-combinumeral">⑤</span>
destination_id = ox.distance.nearest_nodes(G, destination[1],            <span class="fm-combinumeral">⑤</span>
<span class="fm-code-continuation-arrow">➥</span> destination[0])                                                       <span class="fm-combinumeral">⑤</span>
 
origin_node = Node(graph=G, osmid=origin_id)                             <span class="fm-combinumeral">⑥</span>
destination_node = Node(graph=G, osmid=destination_id)                   <span class="fm-combinumeral">⑥</span>
 
highlighted = [destination_id, origin_id]
 
nc = ['red' if node in highlighted else '#336699' for node in G.nodes()] <span class="fm-combinumeral">⑦</span>
ns = [70 if node in highlighted else 8 for node in G.nodes()]            <span class="fm-combinumeral">⑦</span>
fig, ax = ox.plot_graph(G, node_size=ns, node_color=nc, node_zorder=2)   <span class="fm-combinumeral">⑧</span></pre>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">①</span> Set King’s College Circle, Toronto, ON as the center of the map.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">②</span> Create a graph.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">③</span> Set the King Edward VII equestrian statue as the origin.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">④</span> Set the Bahen Centre for Information Technology at University of Toronto as the destination.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑤</span> Get the osmid of the nearest nodes to the origin and destination points.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑥</span> Create the origin and destination nodes.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑦</span> Mark both the source and destination nodes.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑧</span> Visualize the search space.</p>

  <p class="body-ind1">AS a continuation of listing C.17, we can initialize the parameters of the ACO algorithm as follows:</p>
  <pre class="programlistinge">alpha = 1                                                                <span class="fm-combinumeral">①</span>
beta = 1                                                                 <span class="fm-combinumeral">②</span>
n = 500                                                                  <span class="fm-combinumeral">③</span>
Q = 1                                                                    <span class="fm-combinumeral">④</span>
 
pheremone_concentrations = dict()
known_routes = dict()
 
pheremone_concentrations = {(u,v):random.uniform(0,0.5) for [u,v] in
<span class="fm-code-continuation-arrow">➥</span> G.edges()}                                                            <span class="fm-combinumeral">⑤</span>
 
def pheremone(level, distance, alpha, beta):                             <span class="fm-combinumeral">⑥</span>
    return level ** alpha * ((1/distance)) ** beta</pre>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">①</span> Set alpha, a parameter to control the influence of pheromones.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">②</span> Set beta, a parameter to control the influence of desirability of the city transition.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">③</span> Set the number of iterations.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">④</span> Randomize the pheromones.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑤</span> Randomize the pheromones.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑥</span> A function to calculate pheromone levels</p>

  <p class="body-ind1">We now implement the ACO procedure as follows:</p>
  <pre class="programlistinge">for ant in tqdm(range(n)):
    frontier = [origin_node]                                            <span class="fm-combinumeral">①</span>
    explored = set()
    route = []
    found = False
 
    while frontier and not found:
        parent = frontier.pop(0)
        explored.add(parent)
 
        children = []
        children_pheremones = []
        for child in parent.expand():
            if child == destination_node:
                found = True
                route = child.path()
                continue
            if child not in explored:
                children.append(child)
                children_pheremones.append(
                    pheremone(
                        pheremone_concentrations[(parent.osmid,
<span class="fm-code-continuation-arrow">➥</span> child.osmid)],
                        child.distance,
                        alpha,
                        beta,
                    )
                )
  
        if len(children) == 0:
            continue  
  
        transition_probability = [
            children_pheremones[i] / sum(children_pheremones)
            for i in range(len(children_pheremones))
        ]
  
        chosen = random.choices(children, weights=transition_probability,
<span class="fm-code-continuation-arrow">➥</span> k=1)[0]                                                             <span class="fm-combinumeral">②</span>
  
        children.pop(children.index(chosen))                           <span class="fm-combinumeral">③</span>
        frontier.extend(children)                                      <span class="fm-combinumeral">③</span>
  
        frontier.insert(0, chosen)                                     <span class="fm-combinumeral">④</span>
    
    for u, v in zip(route[:-1], route[1:]):                            <span class="fm-combinumeral">⑤</span>
        length_of_edge = G[u][v][0]['length']
        pheremone_concentrations[(u,v)] += Q/length_of_edge
    
    route = tuple(route)
    if route in known_routes:                                          <span class="fm-combinumeral">⑥</span>
        known_routes[route] += 1
    else:
        known_routes[route] = 1</pre>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">①</span> Place the ant at the origin node.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">②</span> Probabilistically choose a child to explore.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">③</span> Add all the non-explored children in case we need to explore them later.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">④</span> Set the chosen child to be the next node to explore.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑤</span> Update the pheromones.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑥</span> If the route is newly discovered, add it to the list.</p>

  <p class="body-ind1">You can now print the best route and its cost and visualize the obtained route as follows:</p>
  <pre class="programlistinge">best_route = max(known_routes, key=known_routes.get)
times_used = known_routes[best_route]
route = list(best_route)
print("Cost:", cost(G,route))
print("Times used:",times_used)
draw_route(G,route)</pre>

  <p class="body-ind1">Figure C.35 shows the optimal route generated by ACO.</p>

  <div class="figure">
    <p class="figuree"><img alt="" class="calibre4" src="../Images/APPC_F35_Khamis.png"/></p>

    <p class="figurecaptione">Figure C.35 Optimal route generated by ACO</p>
  </div>

  <p class="body-dialog"><span class="gray">  3.</span>   The next listing shows the steps for solving the reverse osmosis (RO) high pressure pump power maximization problem using ACO.</p>

  <p class="fm-code-listing-captione">Listing C.18 Solving the RO high pressure pump power maximization problem with ACO</p>
  <pre class="programlistinge">import random
 
md_range = (41.67, 416.67)                                            <span class="fm-combinumeral">①</span>
nv_range = (1, 200)                                                   <span class="fm-combinumeral">①</span>
delta_range = (1400, 2600)                                            <span class="fm-combinumeral">①</span>
rr_range = (1, 50)                                                    <span class="fm-combinumeral">①</span>
eta_range = (0.70, 0.85)                                              <span class="fm-combinumeral">①</span>
rho = 1000                                                            <span class="fm-combinumeral">②</span>
 
def ro_pump_power(X):                                                 <span class="fm-combinumeral">③</span>
    md, nv, delta, rr, eta=X
    return (md ** 2 + 1200 * md * nv * delta) / (nv * rr * 3600 * eta *
<span class="fm-code-continuation-arrow">➥</span> rho)
 
num_ants = 100                                                        <span class="fm-combinumeral">④</span>
num_iterations = 300                                                  <span class="fm-combinumeral">④</span>
evaporation_rate = 0.7                                                <span class="fm-combinumeral">④</span>
pheromone_deposit = 1                                                 <span class="fm-combinumeral">④</span>
initial_pheromone = 0.25                                              <span class="fm-combinumeral">④</span>
 
pheromone_matrix = [[initial_pheromone] * 5 for _ in range(num_ants)] <span class="fm-combinumeral">⑤</span>
  
best_solution = None                                                  <span class="fm-combinumeral">⑥</span>
best_power = float('-inf')                                            <span class="fm-combinumeral">⑥</span>
 
for _ in range(num_iterations):
    solutions = []
    powers = []
 
    for ant in range(num_ants):                                       <span class="fm-combinumeral">⑦</span>
        md = random.uniform(md_range[0], md_range[1]) 
        nv = random.uniform(nv_range[0], nv_range[1]) 
        delta = random.uniform(delta_range[0], delta_range[1]) 
        rr = random.uniform(rr_range[0], rr_range[1]) 
        eta = random.uniform(eta_range[0], eta_range[1]) 
 
        soln=(md, nv, delta, rr, eta)                                 <span class="fm-combinumeral">⑧</span>
        power = ro_pump_power(soln)                                   <span class="fm-combinumeral">⑧</span>
 
        solutions.append((md, nv, delta, rr, eta))                    <span class="fm-combinumeral">⑨</span>
        powers.append(power)                                          <span class="fm-combinumeral">⑨</span>
 
        if power &gt; best_power:                                        <span class="fm-combinumeral">⑩</span>
            best_solution = (md, nv, delta, rr, eta)
            best_power = power
 
    for ant in range(num_ants):                                       <span class="fm-combinumeral">⑪</span>
        for i in range(5):
            pheromone_matrix[ant][i] *= evaporation_rate
            if solutions[ant][i] == best_solution[i]:
                pheromone_matrix[ant][i] += pheromone_deposit / powers[ant]
 
print("Optimal Solution:")                                            <span class="fm-combinumeral">⑫</span>
print("Md:", format(best_solution[0], '.2f'))                         <span class="fm-combinumeral">⑫</span>
print("Nv:", format(best_solution[1], '.2f'))                         <span class="fm-combinumeral">⑫</span>
print("Delta:", format(best_solution[2], '.2f'))                      <span class="fm-combinumeral">⑫</span>
print("RR:", format(best_solution[3], '.2f'))                         <span class="fm-combinumeral">⑫</span>
print("Eta:", format(best_solution[4], '.2f'))                        <span class="fm-combinumeral">⑫</span>
print("Optimal HP:", format(best_power, '.2f'))                       <span class="fm-combinumeral">⑫</span></pre>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">①</span> Define the range for each decision variable.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">②</span> Density of water in kg/m^3</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">③</span> Define the objective function.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">④</span> Define the ACO parameters.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑤</span> Initialize the pheromone matrix.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑥</span> Initialize the best solution and its corresponding power.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑦</span> Construct solutions for each ant.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑧</span> Calculate the power for the current solution.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑨</span> Store the solution and its power.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑩</span> Update the best solution if necessary.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑪</span> Update pheromone trails based on the power of each solution.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑫</span> Print the optimal values of the decision variables and the optimal HP.</p>

  <p class="body-ind1">An example of the generated output is show here:</p>
  <pre class="programlistinge">Optimal Solution:
Md: 404.10
Nv: 7.39
Delta: 2536.93
RR: 1.05
Eta: 0.76
Optimal HP: 425.75</pre>

  <p class="body-ind1">As a continuation of listing C.18, the following code snippet shows the steps for solving this problem using the <code class="fm-code-in-text">optimize</code> solver in SciPy.</p>
  <pre class="programlistinge">from scipy.optimize import minimize                                    <span class="fm-combinumeral">①</span>
 
def ro_pump_power(X):                                                  <span class="fm-combinumeral">②</span>
    md, nv, delta, rr, eta=X
    return -(md ** 2 + 1200 * md * nv * delta) / (nv * rr * 3600 * eta *
<span class="fm-code-continuation-arrow">➥</span> rho) 
 
bounds = [md_range, nv_range, delta_range, rr_range, eta_range]        <span class="fm-combinumeral">③</span>
x0=[200, 100, 2000, 25, 0.75]                                          <span class="fm-combinumeral">④</span>
 
result = minimize(ro_pump_power, x0, bounds=bounds, method='SLSQP')    <span class="fm-combinumeral">⑤</span>
 
print("Optimal Solution:")                                             <span class="fm-combinumeral">⑥</span>
print("Md:", format(result.x[0], '.2f'))                               <span class="fm-combinumeral">⑥</span>
print("Nv:", format(result.x[1], '.2f'))                               <span class="fm-combinumeral">⑥</span>
print("Delta:", format(result.x[2], '.2f'))                            <span class="fm-combinumeral">⑥</span>
print("RR:", format(result.x[3], '.2f'))                               <span class="fm-combinumeral">⑥</span>
print("Eta:", format(result.x[4], '.2f'))                              <span class="fm-combinumeral">⑥</span>
print("Optimal HP:", format(-result.fun, '.2f'))                       <span class="fm-combinumeral">⑥</span></pre>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">①</span> Import the scipy optimizer.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">②</span> Define the objective function with a negative sign for minimization, as per scipy's requirement.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">③</span> Set the bounds for the decision variables.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">④</span> Set an initial guess.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑤</span> Solve the optimization problem using sequential least squares programming (SLSQP).</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑥</span> Print the optimal values of the decision variables and the optimal HP.</p>

  <p class="body-ind1">The generated output is show here:</p>
  <pre class="programlistinge">Optimal Solution:
Md: 416.67
Nv: 99.98
Delta: 2600.00
RR: 1.00
Eta: 0.70
Optimal HP: 515.88</pre>

  <p class="body-ind1">You can fine-tune the ACO parameters to get results comparable to those of the SciPy optimizer.</p>

  <p class="body-dialog"><span class="gray">  4.</span>   The next listing shows the steps for solving the supply and demand problem using the MIDACO solver. We start by importing the libraries and setting the problem data.</p>

  <p class="fm-code-listing-captione">Listing C.19 Solving the supply and demand problem using MIDACO</p>
  <pre class="programlistinge">import numpy as np
import random
import midaco                                                    <span class="fm-combinumeral">①</span>
from geopy.geocoders import Nominatim
from geopy.distance import geodesic
import folium
  
supply_schools = [1, 3]                                          <span class="fm-combinumeral">②</span>
demand_schools = [2, 4]                                          <span class="fm-combinumeral">③</span>
amount_supply = [20, 30]                                         <span class="fm-combinumeral">④</span>
amount_demand = [5, 45]                                          <span class="fm-combinumeral">⑤</span>
n_var=len(supply_schools)*len(demand_schools)
n_constr=len(supply_schools)</pre>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">①</span> Import the MIDACO solver.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">②</span> Set the schools with microscopes available.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">③</span> Set the schools with microscopes requested.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">④</span> Set the number of microscopes available at each school.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑤</span> Set the number of microscopes requested at each school.</p>

  <p class="body-ind1">As a continuation, we’ll generate random GPS coordinates for the supply and demand schools:</p>
  <pre class="programlistinge">geolocator = Nominatim(user_agent="SupplyDemand")                 <span class="fm-combinumeral">①</span>
location = geolocator.geocode("Toronto, Ontario")                 <span class="fm-combinumeral">②</span>
  
def generate_random(number, center_point):                        <span class="fm-combinumeral">③</span>
    lat, lon = center_point
    coords = [(random.uniform(lat - 0.01, lat + 0.01), random.uniform(lon -
<span class="fm-code-continuation-arrow">➥</span> 0.01, lon + 0.01)) for _ in range(number)]
    return coords
  
np.random.seed(0)                                                 <span class="fm-combinumeral">④</span>
  
supply_coords = generate_random(len(supply_schools), 
<span class="fm-code-continuation-arrow">➥</span> [location.latitude, location.longitude])                       <span class="fm-combinumeral">⑤</span>
demand_coords = generate_random(len(demand_schools), 
<span class="fm-code-continuation-arrow">➥</span> [location.latitude, location.longitude])                       <span class="fm-combinumeral">⑥</span>
  
distances = []                                                    <span class="fm-combinumeral">⑦</span>
for supply in supply_coords:                                      <span class="fm-combinumeral">⑦</span>
    row = []                                                      <span class="fm-combinumeral">⑦</span>
    for demand in demand_coords:                                  <span class="fm-combinumeral">⑦</span>
        row.append(geodesic(supply, demand).kilometers)           <span class="fm-combinumeral">⑦</span>
    distances.append(row)                                         <span class="fm-combinumeral">⑦</span>
distances = np.array(distances)                                   <span class="fm-combinumeral">⑦</span>
  
cost_matrix=50*distances                                          <span class="fm-combinumeral">⑧</span></pre>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">①</span> Create a geolocator object.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">②</span> Get the coordinates of Toronto.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">③</span> Function to generate random locations around a center point</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">④</span> Set the random seed to ensure reproducibility of random numbers generated.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑤</span> Generate random GPS coordinates (lat, long) for the supply schools.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑥</span> Generate random GPS coordinates (lat, long) for the demand schools.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑦</span> Calculate geodesic distances between the schools in km.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑧</span> Calculate the cost matrix.</p>

  <p class="body-ind1">The following function defines the main ingredients of the optimization problem, including the objective function and the constraints.</p>
  <pre class="programlistinge">def problem_function(x):
 
    f = [0.0]*1                                                                            <span class="fm-combinumeral">①</span>
    g = [0.0]*n_constr                                                                     <span class="fm-combinumeral">②</span>
 
    f[0] = np.sum(np.multiply(cost_matrix.flatten(), x))                                   <span class="fm-combinumeral">③</span>
 
    soln=np.reshape(x, (len(supply_schools), len(demand_schools)))                         <span class="fm-combinumeral">④</span>
   
    total_supply = soln.sum(axis=1)
    total_demand = soln.sum(axis=0)        
 
    g[0] = (np.all(total_supply&gt;=amount_supply) and np.all(total_demand&gt;=amount_demand))-1 <span class="fm-combinumeral">⑤</span>
 
    return f,g                                                                             <span class="fm-combinumeral">⑥</span></pre>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">①</span> Initialize the array for objectives F(X).</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">②</span> Initialize the array for constraints G(X).</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">③</span> Objective functions F(X)</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">④</span> Candidate solution</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑤</span> Inequality constraints G(X) &gt;= 0 must come second in g[me:m-1]</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑥</span> Return the objective function and constraint evaluation.</p>

  <p class="body-ind1">The first step in using MIDACO is to define the problem as follows:</p>
  <pre class="programlistinge">key = b'MIDACO_LIMITED_VERSION___[CREATIVE_COMMONS_BY-NC-ND_LICENSE]' <span class="fm-combinumeral">①</span>
problem = {}                                                          <span class="fm-combinumeral">②</span>
option  = {}                                                          <span class="fm-combinumeral">③</span>
problem['@'] = problem_function                                       <span class="fm-combinumeral">④</span></pre>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">①</span> Free limited license that supports up to 4 variables.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">②</span> Initialize the dictionary containing the problem specifications.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">③</span> Initialize the dictionary containing the MIDACO options.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">④</span> Handle for problem function name.</p>

  <p class="body-ind1">The problem dimensions are defined as follows:</p>
  <pre class="programlistinge">problem['o']  = 1                     <span class="fm-combinumeral">①</span>
problem['n']  = n_var                 <span class="fm-combinumeral">②</span>
problem['ni'] = n_var                 <span class="fm-combinumeral">③</span>
problem['m']  = n_constr              <span class="fm-combinumeral">④</span>
problem['me'] = 0                     <span class="fm-combinumeral">⑤</span></pre>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">①</span> Number of objectives</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">②</span> Number of variables (in total)</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">③</span> Number of integer variables (0 &lt;= ni &lt;= n)</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">④</span> Number of constraints (in total)</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑤</span> Number of equality constraints (0 &lt;= me &lt;= m)</p>

  <p class="body-ind1">The lower and upper bounds <code class="fm-code-in-text">xl</code> and <code class="fm-code-in-text">xu</code> are defined as follows:</p>
  <pre class="programlistinge">problem['xl'] = [0.0]*n_var
problem['xu'] = [30.0]*n_var</pre>

  <p class="body-ind1">The starting point <code class="fm-code-in-text">x</code> is set as the lower bound:</p>
  <pre class="programlistinge">problem['x'] = problem['xl'] </pre>

  <p class="body-ind1">The stopping criteria are defined as follows:</p>
  <pre class="programlistinge">option['maxeval'] = 10000             <span class="fm-combinumeral">①</span>
option['maxtime'] = 60*60*24          <span class="fm-combinumeral">②</span></pre>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">①</span> Maximum number of function evaluation</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">②</span> Maximum time limit in seconds (e.g., 1 day = 60*60*24)</p>

  <p class="body-ind1">We set the printing options as follows:</p>
  <pre class="programlistinge">option['printeval'] = 1000            <span class="fm-combinumeral">①</span>
option['save2file'] = 1               <span class="fm-combinumeral">②</span></pre>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">①</span> Print-frequency for current best solution</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">②</span> Save screen and solution [0 for no and 1 for yes]</p>

  <p class="body-ind1">MIDACO offers the option to evaluate multiple solution candidates in parallel (aka co-evaluation or fine-grained parallelization). According to the MIDACO user manual, for a parallelization factor of <span class="times"><i class="fm-italics">P</i> = 10</span>, the potential speed-up is around 10 times, while for a parallelization factor of <span class="times"><i class="fm-italics">P</i> = 100</span>, the potential speed up is around 70 times. We can set the parallelization factor as follows:</p>
  <pre class="programlistinge">option['parallel'] = 0                <span class="fm-combinumeral">①</span></pre>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">①</span> Serial: 0 or 1, Parallel: 2,3,4,5,6,7,8...</p>

  <p class="body-ind1">We can now run <code class="fm-code-in-text">midaco</code> to solve the problem:</p>
  <pre class="programlistinge">solution = midaco.run( problem, option, key)</pre>

  <p class="body-ind1">The following code snippet is used to print the solution obtained by the PSO solver:</p>
  <pre class="programlistinge">soln = solution['x']
supply_num=len(amount_supply)                                         <span class="fm-combinumeral">①</span>
demand_num=len(amount_demand)                                         <span class="fm-combinumeral">②</span>
for i in range(supply_num):                                           <span class="fm-combinumeral">③</span>
    print(f"Supply School({supply_schools[i]}): {' +
<span class="fm-code-continuation-arrow">➥</span> '.join(['soln['+str(j)+']' for j in range(i*supply_num,
<span class="fm-code-continuation-arrow">➥</span> (i+1)*supply_num)])} &lt;= {amount_supply[i]} or {' + '.join(map(str,
<span class="fm-code-continuation-arrow">➥</span> soln[i*supply_num:(i+1)*supply_num]))} &lt;= {amount_supply[i]} or
<span class="fm-code-continuation-arrow">➥</span> {sum(soln[i*supply_num:(i+1)*supply_num])} &lt;= {amount_supply[i]}")
for j in range(demand_num):                                           <span class="fm-combinumeral">④</span>
    print(f"Demand School({demand_schools[j]}): {' + '.join(['soln['+str(i*demand_num+j)+']' for i in range(demand_num)])} &gt;=
<span class="fm-code-continuation-arrow">➥</span> {amount_demand[j]} or {' + '.join(map(str, [soln[i*demand_num+j] for i
<span class="fm-code-continuation-arrow">➥</span> in range(demand_num)]))} &gt;= {sum(soln[i*demand_num+j] for i in
<span class="fm-code-continuation-arrow">➥</span> range(demand_num))} or {sum(soln[i*demand_num+j] for i in
<span class="fm-code-continuation-arrow">➥</span> range(demand_num))} &gt;= {amount_demand[j]}") 
print(f"Shipping cost =  {solution['f']} $")                          <span class="fm-combinumeral">⑤</span></pre>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">①</span> Number of supply points</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">②</span> Number of demand points</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">③</span> Print each supply point.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">④</span> Print each demand point.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑤</span> Print the shipping cost.</p>

  <p class="body-ind1">The code will produce output like the following:</p>
  <pre class="programlistinge">Supply School(1): soln[0] + soln[1] &lt;= 20 or 0.0 + 30.0 &lt;= 20 or 30.0 &lt;= 20
Supply School(3): soln[2] + soln[3] &lt;= 30 or 15.0 + 15.0 &lt;= 30 or 30.0 &lt;= 30
Demand School(2): soln[0] + soln[2] &gt;= 5 or 0.0 + 15.0 &gt;= 15.0 or 15.0 &gt;= 5
Demand School(4): soln[1] + soln[3] &gt;= 45 or 30.0 + 15.0 &gt;= 45.0 or 45.0 &gt;= 45
Shipping cost =  [1919.3192442452619] $</pre>

  <p class="body-ind1">The following code snippet can be used to visualize the solution of a spatial map using folium:</p>
  <pre class="programlistinge">def normalize(lst):                                                 <span class="fm-combinumeral">①</span>
    s = sum(lst)
    return list(map(lambda x: (x/s)*10, lst))
  
soln_normalized = normalize(soln)                                   <span class="fm-combinumeral">②</span>
  
colors = ['cyan', 'brown', 'orange', 'purple']                      <span class="fm-combinumeral">③</span>
  
m = folium.Map(location=[location.latitude, location.longitude],
<span class="fm-code-continuation-arrow">➥</span> zoom_start=15, scrollWheelZoom=False, dragging=False)            <span class="fm-combinumeral">④</span>
  
for i, coord in zip(supply_schools, supply_coords):
    folium.Marker(location=coord, icon=folium.Icon(icon="home",
<span class="fm-code-continuation-arrow">➥</span> color='red'), popup=f'Supply School {i+1}').add_to(m)            <span class="fm-combinumeral">⑤</span>
  
for i, coord in zip(demand_schools, demand_coords):
    folium.Marker(location=coord, icon=folium.Icon(icon="flag",
<span class="fm-code-continuation-arrow">➥</span> color='blue'), popup=f'Demand School {i+1}').add_to(m)           <span class="fm-combinumeral">⑥</span>
  
for i in range(len(supply_schools)):                                <span class="fm-combinumeral">⑦</span>
    for j in range(len(demand_schools)):
        soln_value = soln[i*len(demand_schools) + j]
        folium.PolyLine(locations=[supply_coords[i], demand_coords[j]],
<span class="fm-code-continuation-arrow">➥</span> color=colors[i % len(colors)],
<span class="fm-code-continuation-arrow">➥</span>  weight=5*soln_normalized[i*len(demand_schools) + j],
<span class="fm-code-continuation-arrow">➥</span> popup=folium.Popup(f'# of microscopes: {soln_value}')).add_to(m)
             
m                                                                   <span class="fm-combinumeral">⑧</span></pre>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">①</span> Normalize function.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">②</span> Normalize solution array.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">③</span> Define a color list.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">④</span> Create a map centered at downtown Toronto.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑤</span> Add markers for supply schools.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑥</span> Add markers for demand schools.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑦</span> Add lines (edges) between supply and demand schools.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑧</span> Show the map.</p>

  <p class="body-ind1">Figure C.36 shows the solution obtained using MIDACO.</p>

  <div class="figure">
    <p class="figuree"><img alt="" class="calibre4" src="../Images/APPC_F36_Khamis.png"/></p>

    <p class="figurecaptione">Figure C.36 Supply and demand problem solution obtained by MIDACO</p>
  </div>

  <p class="body-ind1">For a higher number of schools, you can obtain an unlimited license or request a free academic trial of the unlimited version that can support up to 100,000 variables.</p>

  <div class="calibre11"/>

  <div class="calibre12"/>

  <div class="calibre12"/>

  <div class="calibre12"/><h2 class="fm-head" id="heading_id_30">C.10 Chapter 11: Supervised and unsupervised learning</h2>

  <h3 class="fm-head1" id="heading_id_31">C.10.1 Exercises</h3>

  <p class="body-dialog"><span class="gray">  1.</span>   Multiple choice and true/false: Choose the correct answer for each of the following questions.</p>

  <p class="body-dialogb"><span class="gray">1.1.</span>   What are the traditional categories of machine learning algorithms?</p>

  <p class="body-case-b">   b.  Supervised, unsupervised, unreinforced</p>

  <p class="body-case-b">   b.  Supervised, hybrid, reinforcement</p>

  <p class="body-case-b">   c.  Supervised, unsupervised, hybrid, reinforcement</p>

  <p class="body-case-b">   d.  Unsupervised, semi-supervised, hybrid</p>

  <p class="body-dialogb"><span class="gray">1.2.</span>   The Kohonen map is trained using supervised learning to produce a two-dimensional representation of the input space of the training samples.</p>

  <p class="body-case-b">   a.  True</p>

  <p class="body-case-b">   b.  False</p>

  <p class="body-dialogb"><span class="gray">1.3.</span>   What kind of tasks are common in supervised learning?</p>

  <p class="body-case-b">   a.  Clustering and data reduction</p>

  <p class="body-case-b">   b.  Classification and regression</p>

  <p class="body-case-b">   c.  Feature extraction and anomaly detection</p>

  <p class="body-case-b">   d.  Dimensionality reduction and normalization</p>

  <p class="body-dialogb"><span class="gray">1.4.</span>   What is the task of clustering in unsupervised learning?</p>

  <p class="body-case-b">   a.  Group objects based on certain similarity measures</p>

  <p class="body-case-b">   b.  Identify traffic signs in a self-driving car</p>

  <p class="body-case-b">   c.  Map input features to known labels or classes</p>

  <p class="body-case-b">   d.  Optimize a model’s performance by feedback loop</p>

  <p class="body-dialogb"><span class="gray">1.5.</span>   The pointer-network (Ptr-Net) model is designed to address specific limitations of conventional sequence-to-sequence (seq2seq) models, particularly in tasks involving variable-length output sequences.</p>

  <p class="body-case-b">   a.  True</p>

  <p class="body-case-b">   b.  False</p>

  <p class="body-dialogb"><span class="gray">1.6.</span>   In reinforcement learning, how does a learning agent learn to make decisions?</p>

  <p class="body-case-b">   a.  By minimizing the error between predicted and actual classes</p>

  <p class="body-case-b">   b.  By identifying clusters within the input data</p>

  <p class="body-case-b">   c.  By maximizing cumulative reward through actions in an environment</p>

  <p class="body-case-b">   d.  By mapping input features to known labels or classes</p>

  <p class="body-dialogb"><span class="gray">1.7.</span>   What does deep learning (DL) enable in machine learning?</p>

  <p class="body-case-b">   a.  Feature representation learning at different levels of abstractions</p>

  <p class="body-case-b">   b.  Classification of different objects based on labeled data</p>

  <p class="body-case-b">   c.  Grouping of similar data points based on certain measures</p>

  <p class="body-case-b">   d.  Reward-based decision-making in an interactive environment</p>

  <p class="body-dialogb"><span class="gray">1.8.</span>   Graph embedding learns a mapping from a low-dimensional continuous domain to a discrete high-dimensional graph domain.</p>

  <p class="body-case-b">   a.  True</p>

  <p class="body-case-b">   b.  False</p>

  <p class="body-dialogb"><span class="gray">1.9.</span>   How does DL reduce the need for extensive data preprocessing?</p>

  <p class="body-case-b">   a.  By using a large amount of unlabeled data for training</p>

  <p class="body-case-b">   b.  By learning through interactions in a feedback loop</p>

  <p class="body-case-b">   c.  By approximating mapping functions between data and known labels</p>

  <p class="body-case-b">   d.  By learning discriminative features from raw data automatically</p>

  <p class="body-dialogb"><span class="gray">1.10.</span> Why is graph-structured data important in the field of combinatorial optimization?</p>

  <p class="body-case-b">   a.  It helps to maximize cumulative rewards</p>

  <p class="body-case-b">   b.  It assists in mapping functions between data and labels</p>

  <p class="body-case-b">   c.  It captures and represents the relationships and constraints between elements</p>

  <p class="body-case-b">   d.  It groups objects based on similarity measures</p>

  <p class="body-dialog"><span class="gray">  2.</span>   Match the terms and descriptions shown in table C.17.</p>

  <p class="fm-table-caption">Table C.17</p>

  <table border="1" class="contenttable-1-table" id="table021" width="100%">
    <colgroup class="contenttable-0-colgroup">
      <col class="contenttable-0-col" span="1" width="33%"/>
      <col class="contenttable-0-col" span="1" width="66%"/>
    </colgroup>

    <thead class="calibre6">
      <tr class="contenttable-0-tr">
        <th class="contenttable-1-th">
          <p class="fm-table-head">Terms</p>
        </th>

        <th class="contenttable-1-th">
          <p class="fm-table-head">Descriptions</p>
        </th>
      </tr>
    </thead>

    <tbody class="calibre6">
      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body">1. Self-organizing map (SOM)</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">a. A polygon that fully encompasses a given set of points with maximum area and minimum boundary or circumference of the shape.</p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body">2. Convex hull</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">b. A mechanism that allows the model to dynamically prioritize which parts of the input are most relevant for each output it's trying to predict, making it more effective at understanding context and reducing confusion from long input sequences</p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body">3. Pointer-network (Ptr-Net)</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">c. A type of artificial neural network that is trained using unsupervised learning to produce a low-dimensional (typically two-dimensional), discretized representation of the input space of the training samples</p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body">K-hop neighborhood</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">d. A set of neighboring nodes at a distance less than or equal to K</p>
        </td>
      </tr>

      <tr class="contenttable-0-tr">
        <td class="contenttable-1-td">
          <p class="fm-table-body">5. Attention mechanism</p>
        </td>

        <td class="contenttable-1-td">
          <p class="fm-table-body">e. A type of neural network architecture designed to deal with variable-sized input data sequences</p>
        </td>
      </tr>
    </tbody>
  </table>

  <p class="body-dialog"><span class="gray">  3.</span>   Find the shortest path to visit 20 major US cities starting from New York City using self-organizing maps. The cities are given by the names and GPS latitude and longitude coordinates as follows:</p>

  <p class="body-case-b">   •   New York City (40.72, –74.00)</p>

  <p class="body-case-b">   •   Philadelphia (39.95, –75.17)</p>

  <p class="body-case-b">   •   Baltimore (39.28, –76.62)</p>

  <p class="body-case-b">   •   Charlotte (35.23, –80.85)</p>

  <p class="body-case-b">   •   Memphis (35.12, –89.97)</p>

  <p class="body-case-b">   •   Jacksonville (30.32, –81.70)</p>

  <p class="body-case-b">   •   Houston (29.77, –95.38)</p>

  <p class="body-case-b">   •   Austin (30.27, –97.77)</p>

  <p class="body-case-b">   •   San Antonio (29.53, –98.47)</p>

  <p class="body-case-b">   •   Fort Worth (32.75, –97.33)</p>

  <p class="body-case-b">   •   Dallas (32.78, –96.80)</p>

  <p class="body-case-b">   •   San Diego (32.78, –117.15)</p>

  <p class="body-case-b">   •   Los Angeles (34.05, –118.25)</p>

  <p class="body-case-b">   •   San Jose (37.30, –121.87)</p>

  <p class="body-case-b">   •   San Francisco (37.78, –122.42)</p>

  <p class="body-case-b">   •   Indianapolis': (39.78, –86.15)</p>

  <p class="body-case-b">   •   Phoenix (33.45, –112.07)</p>

  <p class="body-case-b">   •   Columbus (39.98, –82.98)</p>

  <p class="body-case-b">   •   Chicago (41.88, –87.63)</p>

  <p class="body-case-b">   •   Detroit (42.33, –83.05)</p>

  <p class="body-dialog"><span class="gray">  4.</span>   Optimizing the hyperparameters can significantly improve the performance of the ML model. Tune the hyperparameters in listing 11.6, and observe the effect on the ConvexNet model’s performance with different testing datasets. The hyperparameters to be tuned include</p>

  <p class="body-case-b">   •   The number of input features for the model</p>

  <p class="body-case-b">   •   The number of embedding dimensions</p>

  <p class="body-case-b">   •   The number of hidden units in the model</p>

  <p class="body-case-b">   •   The number of attention heads in the multi-head self-attention mechanism</p>

  <p class="body-case-b">   •   The number of layers in the model</p>

  <p class="body-case-b">   •   The dropout probability</p>

  <p class="body-case-b">   •   The number of training epochs</p>

  <p class="body-case-b">   •   The batch size used during training</p>

  <p class="body-case-b">   •   The learning rate for the optimizer</p>

  <h3 class="fm-head1" id="heading_id_32">C.10.2 Solutions</h3>

  <p class="body-dialog"><span class="gray">  1.</span>   Multiple choice and true/false</p>

  <p class="body-dialogb"><span class="gray">1.1.</span>   c) Supervised, unsupervised, hybrid, reinforcement</p>

  <p class="body-dialogb"><span class="gray">1.2.</span>   b) False (The Kohonen map is trained using unsupervised learning to produce a low-dimensional representation of the input space of the training samples, not supervised learning.)</p>

  <p class="body-dialogb"><span class="gray">1.3.</span>   b) Classification and regression</p>

  <p class="body-dialogb"><span class="gray">1.4.</span>   a) Group objects based on certain similarity measures</p>

  <p class="body-dialogb"><span class="gray">1.5.</span>   a) True</p>

  <p class="body-dialogb"><span class="gray">1.6.</span>   c) By maximizing cumulative reward through actions in an environment</p>

  <p class="body-dialogb"><span class="gray">1.7.</span>   a) Feature representation learning at different levels of abstractions</p>

  <p class="body-dialogb"><span class="gray">1.8.</span>   b) False (Graph embedding learns a mapping from a discrete high-dimensional graph domain to a low-dimensional continuous domain, not the other way around.)</p>

  <p class="body-dialogb"><span class="gray">1.9.</span>   d) By learning discriminative features from raw data automatically</p>

  <p class="body-dialogb"><span class="gray">1.10.</span> c) It captures and represents the relationships and constraints between elements</p>

  <p class="body-dialog"><span class="gray">  2.</span>   1-c, 2-a, 3-e, 4-d, and 5-b.</p>

  <p class="body-dialog"><span class="gray">  3.</span>   MiniSom is used in this listing. MiniSom is a minimalistic and Numpy-based implementation of the SOM. You can install this library using <span class="fm-code-in-text">!pip install minisom</span>.</p>

  <p class="body-ind1">The next listing shows how to solve the 20-city TSP using self-organizing maps. We start by importing the libraries and modules, defining the cities of interest, and calculating the haversine distances between pairs of cities.</p>

  <p class="fm-code-listing-captione">Listing C.20 Solving TSP using SOM</p>
  <pre class="programlistinge">import numpy as np
import pandas as pd
from collections import defaultdict
from haversine import haversine
import networkx as nx
import matplotlib.pyplot as plt
import random
from minisom import MiniSom
  
cities = {
    'New York City': (40.72, -74.00),
    'Philadelphia': (39.95, -75.17),       
    'Baltimore': (39.28, -76.62),
    'Charlotte': (35.23, -80.85),
    'Memphis': (35.12, -89.97),
    'Jacksonville': (30.32, -81.70),
    'Houston': (29.77, -95.38),
    'Austin': (30.27, -97.77),
    'San Antonio': (29.53, -98.47),
    'Fort Worth': (32.75, -97.33),
    'Dallas': (32.78, -96.80),
    'San Diego': (32.78, -117.15),
    'Los Angeles': (34.05, -118.25),
    'San Jose': (37.30, -121.87),
    'San Francisco': (37.78, -122.42),    
    'Indianapolis': (39.78, -86.15),
    'Phoenix': (33.45, -112.07),       
    'Columbus': (39.98, -82.98), 
    'Chicago': (41.88, -87.63),
    'Detroit': (42.33, -83.05)
}                                                                        <span class="fm-combinumeral">①</span>
  
distance_matrix = defaultdict(dict)                                      <span class="fm-combinumeral">②</span>
for ka, va in cities.items():                                            <span class="fm-combinumeral">②</span>
    for kb, vb in cities.items():                                        <span class="fm-combinumeral">②</span>
        distance_matrix[ka][kb] = 0.0 if kb == ka else haversine((va[0],
<span class="fm-code-continuation-arrow">➥</span> va[1]), (vb[0], vb[1]))                                               <span class="fm-combinumeral">②</span>
  
distances = pd.DataFrame(distance_matrix)                                <span class="fm-combinumeral">③</span>
city_names=list(distances.columns)                                       <span class="fm-combinumeral">③</span>
  
distances=distances.values                                               <span class="fm-combinumeral">④</span></pre>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">①</span> Define latitude and longitude for twenty major US cities.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">②</span> Create a haversine distance matrix based on latitude-longitude coordinates.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">③</span> Convert the distance dictionary into a dataframe.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">④</span> Get the haversine distances between pairs of cities.</p>

  <p class="body-ind1">We then define a SOM to solve the TSP instance. This SOM is 1D with <i class="timesitalic">N</i> neurons. The dimensionality of the input data is 2 (latitude and longitude coordinates). The sigma parameter is used for the Gaussian neighborhood function. This parameter controls the spread of the influence of neighboring neurons during training. The learning rate determines the step size of weight updates during training. The neighborhood function used during training is set to Gaussian, which means the influence of neighboring neurons decreases with distance. The seed for the random number generator is set to 50 to ensure reproducibility of the results.</p>
  <pre class="programlistinge">N_neurons = city_count*2                                                  <span class="fm-combinumeral">①</span>
  
som = MiniSom(1, N_neurons, 2, sigma=10, learning_rate=.5,
              neighborhood_function='gaussia   n', random_seed=50)        <span class="fm-combinumeral">②</span>
som.random_weights_init(points)                                           <span class="fm-combinumeral">③</span></pre>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">①</span> Set the number of neurons (nodes) for the 1D SOM.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">②</span> Create a self-organizing map with 1xN_neurons grid.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">③</span> Initialize the weights.</p>

  <p class="body-ind1">The following code snippet generates a set of visualizations to show the progress of the SOM training:</p>
  <pre class="programlistinge">plt.figure(figsize=(10, 9))
for i, iterations in enumerate(range(5, 61, 5)):
    som.train(points, iterations, verbose=False, random_order=False)
    plt.subplot(3, 4, i+1)
    plt.scatter(x,y)
    visit_order = np.argsort([som.winner(p)[1] for p in points])
    visit_order = np.concatenate((visit_order, [visit_order[0]]))
    plt.plot(points[visit_order][:,0], points[visit_order][:,1])
    plt.title("iterations: {i};\nerror: {e:.3f}".format(i=iterations,                                                         <span class="fm-code-continuation-arrow">➥</span> e=som.quantization_error(points)))
    plt.xticks([])
    plt.yticks([])
plt.tight_layout()
plt.show()</pre>

  <p class="body-ind1">Figure C.37 shows the visualized plots.</p>

  <div class="figure">
    <p class="figuree"><img alt="" class="calibre4" src="../Images/APPC_F37_Khamis.png"/></p>

    <p class="figurecaptione">Figure C.37 Progress of SOM training with increasing numbers of iterations</p>
  </div>

  <div class="calibre11"/>

  <div class="calibre12"/>

  <div class="calibre12"/>

  <div class="calibre12"/><h2 class="fm-head" id="heading_id_33">C.11 Chapter 12: Reinforcement learning</h2>

  <h3 class="fm-head1" id="heading_id_34">C.11.1 Exercises</h3>

  <p class="body-dialog"><span class="gray">  1.</span>   Multiple choice and true/false: Choose the correct answer for each of the following questions.</p>

  <p class="body-dialogb"><span class="gray">1.1.</span>   In reinforcement learning, what does the term “reward” represent?</p>

  <p class="body-case-b">   a.  The penalty for performing an action</p>

  <p class="body-case-b">   b.  The immediate feedback received from the environment</p>

  <p class="body-case-b">   c.  The probability of taking a particular action</p>

  <p class="body-case-b">   d.  The number of steps taken by the agent</p>

  <p class="body-dialogb"><span class="gray">1.2.</span>   The goal of reinforcement learning is to</p>

  <p class="body-case-b">   a.  Minimize the cumulative reward</p>

  <p class="body-case-b">   b.  Find the shortest path to the goal state</p>

  <p class="body-case-b">   c.  Learn an optimal policy to maximize cumulative rewards</p>

  <p class="body-case-b">   d.  Achieve a deterministic environment</p>

  <p class="body-dialogb"><span class="gray">1.3.</span>   Which of the following RL algorithms is considered model-free?</p>

  <p class="body-case-b">   a.  Expert iteration</p>

  <p class="body-case-b">   b.  Proximal policy optimization (PPO)</p>

  <p class="body-case-b">   c.  Imagination-augmented agents (I2A)</p>

  <p class="body-case-b">   d.  None of the above</p>

  <p class="body-dialogb"><span class="gray">1.4.</span>   The concept of a “discount factor” in reinforcement learning is used to</p>

  <p class="body-case-b">   a.  Reduce the size of the state space</p>

  <p class="body-case-b">   b.  Decrease the rewards obtained from the environment</p>

  <p class="body-case-b">   c.  Balance the importance of immediate rewards and future rewards</p>

  <p class="body-case-b">   d.  Encourage exploration over exploitation</p>

  <p class="body-dialogb"><span class="gray">1.5.</span>   Which of the following RL algorithms is considered an on-policy RL method?</p>

  <p class="body-case-b">   a.  Q-learning</p>

  <p class="body-case-b">   b.  Twin-delayed deep deterministic policy gradient (TD3)</p>

  <p class="body-case-b">   c.  Deep deterministic policy gradient (DDPG)</p>

  <p class="body-case-b">   d.  Proximal policy optimization (PPO)</p>

  <p class="body-dialogb"><span class="gray">1.6</span>   PPO-clip and PPO-penalty are two variants of the policy gradient method designed to address potential instability during training.</p>

  <p class="body-case-b">   a.  True</p>

  <p class="body-case-b">   b.  False</p>

  <p class="body-dialogb"><span class="gray">1.7.</span>   Which multi-armed bandit strategy randomly selects a slot machine at each trial without considering past results?</p>

  <p class="body-case-b">   a.  Exploit-only greedy strategy</p>

  <p class="body-case-b">   b.  Epsilon-greedy strategy</p>

  <p class="body-case-b">   c.  Upper confidence bound (UCB) strategy</p>

  <p class="body-case-b">   d.  Explore-only strategy</p>

  <p class="body-dialogb"><span class="gray">1.8.</span>   In the <i class="fm-italics">ε</i>-greedy strategy, how does the agent balance exploration and exploitation?</p>

  <p class="body-case-b">   a.  It always selects the machine with the highest estimated mean reward.</p>

  <p class="body-case-b">   b.  It randomly selects a machine with a certain probability (epsilon) and otherwise selects the machine with the highest estimated mean reward.</p>

  <p class="body-case-b">   c.  It explores all machines equally during each trial.</p>

  <p class="body-case-b">   d.  It focuses on exploiting the current best machine only.</p>

  <p class="body-dialogb"><span class="gray">1.9.</span>   What does “regret” measure in the multi-armed bandit problem?</p>

  <p class="body-case-b">   a.  The difference between the maximum possible reward and the reward obtained from each selected machine</p>

  <p class="body-case-b">   b.  The number of times the agent chooses to explore a new machine</p>

  <p class="body-case-b">   c.  The total time spent in the same single state</p>

  <p class="body-case-b">   d.  The total number of arms or actions available to the agent</p>

  <p class="body-dialogb"><span class="gray">1.10.</span> What does the Markov decision process (MDP) represent in the context of reinforcement learning?</p>

  <p class="body-case-b">   a.  A process that involves making decisions without considering state transitions</p>

  <p class="body-case-b">   b.  A method for supervised learning using labeled datasets</p>

  <p class="body-case-b">   c.  A mathematical framework for planning under uncertainty, in which actions influence future states with certain probabilities</p>

  <p class="body-case-b">   d.  A type of optimization algorithm for clustering data</p>

  <p class="body-dialog"><span class="gray">  2.</span>   Imagine you are a digital marketer running an online advertising campaign. You have several ad variations that you can display to users, each with its own click-through rate (CTR) or conversion rate. Click-through measures the rate at which users click on a link, while conversion measures the rate at which users complete a desired action after clicking on the link, such as making a purchase, signing up for a newsletter, or completing a form. Your goal is to maximize user engagement or conversions by selecting the most effective ad variation.</p>

  <p class="body-ind1">Let’s assume you have three ad variations, represented by arms A1, A2, and A3. Each ad variation has an associated probability distribution of click-through or conversion rates, denoted as Q1, Q2, and Q3. These probability distributions represent the likelihood of a user clicking on each ad variation. At each time step <i class="fm-italics">t</i>, you need to choose an ad variation <i class="timesitalic">A</i> to display to users. When ad variation <i class="timesitalic">A</i> is displayed, users interact with it, and you observe the outcome, which can be a click or a conversion. The outcome is drawn from the probability distribution <i class="fm-italics">Q</i>(<i class="fm-italics">A</i>), representing the likelihood of a click or conversion for ad variation <i class="fm-italics">A</i>. Assume that the three probability distributions Q1, Q2, and Q3 are normal distributions with means of {7, 10, 6} and standard deviations of {0.45, 0.65, 0.35} respectively. Your objective is to maximize the cumulative number of clicks over a series of ad displays (let’s say 10,000 ad displays). Write Python code to implement an <i class="fm-italics">ε</i>-greedy strategy to determine which ad variation to display at each time step based on the estimated click-through rates.</p>

  <p class="body-dialog"><span class="gray">  3.</span>   The taxi environment is based on the taxicab, or ride-hailing, problem, where a taxi must pick up a passenger from one location and drop them off at another specified location. The goal of the agent is to learn a policy that navigates the taxi through the grid to pick up and drop off passengers while maximizing the cumulative reward. When the episode starts, the taxi is at a random square, and the passenger is at a random location. The taxi drives to the passenger’s location, picks them up, drives to the passenger’s destination (another one of the four specified locations), and drops off the passenger. Once the passenger is dropped off, the episode ends. The states, actions, and rewards are as follows:</p>

  <p class="body-case-b">   •   States (observation space includes 500 discrete states): 25 taxi positions (any location within the 5 × 5 grid world); 5 passenger locations (0: R(ed); 1: G(reen); 2: Y(ellow); 3: B(lue); 4: in taxi) and 4 destinations (0: R(ed); 1: G(reen); 2: Y(ellow); 3: B(lue)). Thus, this taxi environment has a total of 5 × 5 × 5 × 4 = 500 possible states.</p>

  <p class="body-case-b">   •   Actions (action space includes 6 discrete actions): 0 = move south; 1 = move north; 2 = move east; 3 = move west; 4 = pick up passenger, and 5 = drop off passenger.</p>

  <p class="body-case-b">   •   Rewards: +20 (a high positive reward for a successful drop off); –10 (a penalty for executing pickup and drop-off actions illegally, such as if the agent tries to drop off a passenger in a wrong location), and –1 (a slight negative reward for not making it to the destination after every time step, to mimic the delay).</p>

  <p class="body-ind1">Write Python code to show how to use A2C to learn the optimal policy for this environment. Experiment with vectorized environments where multiple independent environments are stacked into a single environment. Vectorized environments enable you to run multiple instances of an environment in parallel. Instead of training an RL agent on one environment per step, it allows you to train it on <i class="timesitalic">n</i> environments per step. For example, if you want to run four parallel environments, you can specify this number when you create the environment, as follows: <code class="fm-code-in-text">env = make_vec_env("Taxi-v3", n_envs=4, seed=0</code>.</p>

  <p class="body-dialog"><span class="gray">  <a id="idTextAnchor001"/>4.</span>   In preparing for a scheduled flight, an airline’s flight operations team is tasked with selecting the best flight route and service according to the shared context. The shared context represents the type of flight (domestic or international) and the type of passengers (business class, economy class, or a mix). The flight operations team must decide the best strategy for flight route, meal service, and in-flight entertainment. The options are represented as follows:</p>

  <p class="body-case-b">   •   <i class="fm-italics">Flight route</i>—The most direct route, a fuel-efficient route that may be longer, or a route that avoids turbulence but may require more time</p>

  <p class="body-case-b">   •   <i class="fm-italics">Meal service</i>—Full meal with multiple options, a simple meal with fewer options, or just snacks and beverages</p>

  <p class="body-case-b">   •   <i class="fm-italics">In-flight entertainment</i>—Movies and music, in-flight Wi-Fi service, or a combination of both</p>

  <p class="body-ind1">The reward is how satisfactory the chosen options are for a given flight (shared context). The reward function receives as arguments the shared context (the type of flight and passenger class) and the selected actions for each option (the chosen flight route, meal service, and in-flight entertainment). To mirror real-world scenarios and complexities, we inject normal noise in the reward value. The objective is to select the best action from the available combinatorial actions in such a way that it maximizes the total reward. Write Python code to train and test a contextual bandit for this problem.</p>

  <p class="body-dialog"><span class="gray">  5.</span>   Listing 11.4 shows how to solve TSP using an ML model pretrained with a supervised approach or a reinforcement learning approach. Replace the supervised learning model sl-ar-var-20pnn-gnn-max_20200308T172931 with the pretrained RL model rl-ar-var-20pnn-gnn-max_20200313T002243, and report your observations.</p>

  <p class="body-dialog"><span class="gray">  6.</span>   The gym-electric-motor (GEM) package is a Python toolbox designed for simulating and controlling electric motors. It is built upon OpenAI Gym environments and is suitable for classical control simulations and reinforcement learning experiments. Use GEM to define a permanent magnet synchronous motor (PMSM) environment as shown in figure C.38. For more information about PMSM and GEM, see Traue et al.’s article “Toward a reinforcement learning environment toolbox for intelligent electric motor control” [10].</p>

  <div class="figure">
    <p class="figuree"><img alt="" class="calibre4" src="../Images/APPC_F38_Khamis.png"/></p>

    <p class="figurecaptione">Figure C.38 The gym-electric-motor (GEM) environment described in Traue et al 's article [9]</p>
  </div>

  <p class="body-ind1">Listing C.24, provided in the book’s GitHub repo, provides a simplified implementation of PPO for electric motor control. This code is used to train a control model (a PPO RL agent) to control the current for a permanent magnet synchronous motor. This agent mainly controls the converter that converts the supply currents to the currents flowing into the motor. Experiment with different parameters in this algorithm and consider trying other RL models available in Stable-Baselines3 (SB3).</p>

  <h3 class="fm-head1" id="heading_id_35">C.11.2 Solutions</h3>

  <p class="body-dialog"><span class="gray">  1.</span>   Multiple choice and true/false</p>

  <p class="body-dialogb"><span class="gray">1.1.</span>   b) The immediate feedback received from the environment</p>

  <p class="body-dialogb"><span class="gray">1.2.</span>   c) Learn an optimal policy to maximize cumulative rewards.</p>

  <p class="body-dialogb"><span class="gray">1.3.</span>   b) Proximal policy optimization (PPO)</p>

  <p class="body-dialogb"><span class="gray">1.4.</span>   c) Balance the importance of immediate rewards and future rewards.</p>

  <p class="body-dialogb"><span class="gray">1.5.</span>   d) Proximal policy optimization (PPO)</p>

  <p class="body-dialogb"><span class="gray">1.6.</span>   a) True</p>

  <p class="body-dialogb"><span class="gray">1.7.</span>   d) Explore-only strategy</p>

  <p class="body-dialogb"><span class="gray">1.8.</span>   b) It randomly selects a machine with a certain probability (epsilon) and otherwise selects the machine with the highest estimated mean reward.</p>

  <p class="body-dialogb"><span class="gray">1.9.</span>   a) The difference between the maximum possible reward and the reward obtained from each selected machine</p>

  <p class="body-dialogb"><span class="gray">1.10.</span> c) A mathematical framework for planning under uncertainty, in which actions influence future states with certain probabilities</p>

  <p class="body-dialog"><span class="gray">  2.</span>   Listing C.21 shows an implementation of a <i class="timesitalic">ε</i>-greedy strategy to determine which ad variation to display at each time step based on the estimated click-through rates. In this code snippet, 10,000 ad displays are simulated. The estimates of the click-through rates for each ad variation are updated after each display.</p>

  <p class="fm-code-listing-captione">Listing C.21 Online advertising using MAB</p>
  <pre class="programlistinge">import numpy as np
 
num_arms = 3                                                   <span class="fm-combinumeral">①</span>
num_trials = 10000                                             <span class="fm-combinumeral">②</span>
 
mu = [7, 10, 6]                                                <span class="fm-combinumeral">③</span>
sigma = [0.45, 0.65, 0.35]                                     <span class="fm-combinumeral">③</span>
 
counts = np.zeros(num_arms)                                    <span class="fm-combinumeral">④</span>
rewards = np.zeros(num_arms)                                   <span class="fm-combinumeral">④</span>
 
a = np.random.choice(num_arms)                                 <span class="fm-combinumeral">⑤</span>
 
eps = 0.1                                                      <span class="fm-combinumeral">⑥</span>
 
for t in range(num_trials):
    if np.random.rand() &gt; eps:                                 <span class="fm-combinumeral">⑦</span>
        a = np.argmax(rewards / (counts + 1e-5))               <span class="fm-combinumeral">⑧</span>
    else:                                                      <span class="fm-combinumeral">⑨</span>
        a = np.random.choice(num_arms)                         <span class="fm-combinumeral">⑨</span>
 
    reward = np.random.normal(mu[a], sigma[a]) 
    
    counts[a] += 1
    rewards[a] += reward
 
estimates = rewards / counts                                   <span class="fm-combinumeral">⑩</span>
                                                               <span class="fm-combinumeral">⑩</span>
print("Estimated click-through rates: ", estimates)            <span class="fm-combinumeral">⑩</span></pre>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">①</span> Initialize the number of arms (actions).</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">②</span> Initialize the number of trials (ads).</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">③</span> Probability distribution of each arm</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">④</span> Counters for each arm</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑤</span> Select an initial arm.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑥</span> Set the epsilon value of the epsilon-greedy algorithm.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑦</span> Exploitation</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑧</span> Add a small constant to avoid division by zero.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑨</span> Exploration</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑩</span> Calculate and print the estimated click-through rates.</p>

  <p class="body-ind1">In this script, <code class="fm-code-in-text">counts</code> keeps track of the number of times each ad variation has been displayed, and <code class="fm-code-in-text">rewards</code> keeps track of the total number of clicks for each ad variation. At the end of the script, the estimated click-through rates for each ad variation are calculated and printed.</p>

  <p class="body-dialog"><span class="gray">  3.</span>   Listing C.22 shows the steps of learning the optimal policy for the taxicab problem using A2C. This code uses Stable-Baselines3 (SB3), a library for reinforcement learning, to train an agent using A2C on the Taxi-v3 environment. The SB3 function <span class="fm-code-in-text">make_vec_env</span> is used to create a vectorized environment that can run multiple parallel environments in the same process. The SB3 function <span class="fm-code-in-text">evaluate_policy</span> is used to evaluate the learned policy of the agent.</p>

  <p class="fm-code-listing-captione">Listing C.22 Dispatching a taxicab using A2C RL</p>
  <pre class="programlistinge">from stable_baselines3.common.env_util import make_vec_env
from stable_baselines3 import A2C
from stable_baselines3.common.evaluation import evaluate_policy
import matplotlib.pyplot as plt
from IPython.display import display, clear_output
  
env = make_vec_env("Taxi-v3", n_envs=1, seed=0)               <span class="fm-combinumeral">①</span>
print('Number of states:{}'.format(env.observation_space))    <span class="fm-combinumeral">②</span>
print('Number of actions:{}'.format(env.action_space))        <span class="fm-combinumeral">②</span>
  
model = A2C(policy="MlpPolicy", env=env, verbose=True)        <span class="fm-combinumeral">③</span>
  
model.learn(total_timesteps=10000, progress_bar=True)         <span class="fm-combinumeral">④</span></pre>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">①</span> Create a vectorized environment with a single parallel environment (n_envs=1).</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">②</span> Print the observation and action spaces of the environment.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">③</span> Create an A2C agent with MlpPolicy as the policy network.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">④</span> Train the A2C agent on the Taxi-v3 environment for 10,000 timesteps.</p>

  <p class="body-ind1">After the training is complete, the agent will have learned an optimal policy for navigating the Taxi-v3 environment to efficiently pick up and drop off passengers at the correct locations. The following code snippet visualizes the learned policy by rendering the Taxi-v3 environment using the trained A2C agent.</p>
  <pre class="programlistinge">images = []                                                  <span class="fm-combinumeral">①</span>
vec_env = model.get_env()                                    <span class="fm-combinumeral">②</span>
obs = vec_env.reset()                                        <span class="fm-combinumeral">③</span>
  
for i in tqdm(range(300)): 
    action, _states = model.predict(obs, deterministic=True) <span class="fm-combinumeral">④</span>
    obs, rewards, dones, info = vec_env.step(action)         <span class="fm-combinumeral">⑤</span>
    state_img = vec_env.render("rgb_array")                  <span class="fm-combinumeral">⑥</span>
    fig = plt.figure()
    plt.imshow(state_img)
    plt.axis('off')
    display(fig)
    images.append(fig)
    clear_output(wait=True)                                  <span class="fm-combinumeral">⑦</span>
    plt.close()</pre>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">①</span> Create an empty list to store the frames (images) of the rendered environment.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">②</span> Retrieve the environment associated with the model.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">③</span> Reset the environment and obtain the initial observation after the reset.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">④</span> Predict an action based on the current observation.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑤</span> Get a new observation and the reward.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑥</span> Render the environment as an RGB image.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑦</span> Clear the output for the next image.</p>

  <p class="body-dialog"><span class="gray">  4.</span>   Listing C.23 shows the implementation of a contextual bandit for an airline’s flight operations using the Vowpal Wabbit Python library. The shared context is defined by two lists: <span class="fm-code-in-text">flight_types</span> and <span class="fm-code-in-text">passenger_classes</span>. The possible choices, or actions, for the bandit problem are defined by <span class="fm-code-in-text">flight_routes</span>, <span class="fm-code-in-text">meal_services</span>, and <span class="fm-code-in-text">entertainment_options</span>. The <span class="fm-code-in-text">reward_function</span> calculates the reward associated with a particular combination of flight route, meal service, and entertainment option. The rewards are generated using a normal distribution with different means for different choices. The standard deviation (scale) is set to 0.05, implying that the rewards are sampled from a normal distribution with a small amount of variance.</p>

  <p class="fm-code-listing-captione">Listing C.23 Contextual bandit for an airline’s flight operations</p>
  <pre class="programlistinge">import vowpalwabbit
import torch
import matplotlib.pyplot as plt
import pandas as pd
import random
import numpy as np
 
flight_types = ['domestic', 'international']                         <span class="fm-combinumeral">①</span>
passenger_classes = ['business', 'economy', 'mix']                   <span class="fm-combinumeral">①</span>
 
flight_routes = ['direct', 'fuel_efficient', 'turbulence_avoidance'] <span class="fm-combinumeral">②</span>
meal_services = ['full_meal', 'simple_meal', 'snacks_beverages']     <span class="fm-combinumeral">②</span>
entertainment_options = ['movies_music', 'in_flight_wifi', 'combo']  <span class="fm-combinumeral">②</span>
 
def reward_function(shared_context, flight_route, meal_service,
<span class="fm-code-continuation-arrow">➥</span> entertainment_option):                                            <span class="fm-combinumeral">③</span>
    if flight_route == 'direct':
        route_reward = np.random.normal(loc=0.9, scale=0.05)
    elif flight_route == 'fuel_efficient':
        route_reward = np.random.normal(loc=0.8, scale=0.05)
    else: 
        route_reward = np.random.normal(loc=0.7, scale=0.05)
 
    if meal_service == 'full_meal':
        meal_reward = np.random.normal(loc=0.9, scale=0.05)
    elif meal_service == 'simple_meal':
        meal_reward = np.random.normal(loc=0.8, scale=0.05)
    else:  
        meal_reward = np.random.normal(loc=0.7, scale=0.05)
 
    if entertainment_option == 'movies_music':
        entertainment_reward = np.random.normal(loc=0.9, scale=0.05)
    elif entertainment_option == 'in_flight_wifi':
        entertainment_reward = np.random.normal(loc=0.8, scale=0.05)
    else
        entertainment_reward = np.random.normal(loc=0.7, scale=0.05)
 
    reward = (route_reward + meal_reward + entertainment_reward) / 3.0
 
    return reward</pre>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">①</span> Set the shared context.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">②</span> Set possible choices/action options.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">③</span> Calculate the reward associated with a particular combination of options.</p>

  <p class="body-ind1">As a continuation, the following two utility functions are defined. <code class="fm-code-in-text">generate_combinations</code> generates combinations of flight routes, meal services, and entertainment options, along with their associated descriptions. <code class="fm-code-in-text">sample_truck_pmf</code> performs sampling based on a probability mass function (PMF):</p>
  <pre class="programlistinge">def generate_combinations(shared_context, flight_routes, meal_services,
<span class="fm-code-continuation-arrow">➥</span> entertainment_options):
    examples = [f"shared |FlightType {shared_context[0]} PassClass
<span class="fm-code-continuation-arrow">➥</span> {shared_context[1]}"]
    descriptions = []
    for route in flight_routes:
        for meal in meal_services:
            for entertainment in entertainment_options:
                examples.append(f"|Action route={route} meal={meal}
<span class="fm-code-continuation-arrow">➥</span> entertainment={entertainment}")
                descriptions.append((route, meal, entertainment))
    return examples, descriptions
 
def sample_truck_pmf(pmf):
    pmf_tensor = torch.tensor(pmf)
    index = torch.multinomial(pmf_tensor, 1).item()
    chosen_prob = pmf[index]
    
    return index, chosen_prob</pre>

  <p class="body-ind1">We can now create a contextual bandit using the Vowpal Wabbit (VW) library and evaluate its performance over a specified number of iterations. This contextual bandit will make decisions (select actions) in the context of different flight types and passenger classes to maximize the expected reward:</p>
  <pre class="programlistinge">cb_vw = vowpalwabbit.Workspace(
    "--cb_explore_adf --epsilon 0.2 --interactions AA AU AAU -l 0.05 –
<span class="fm-code-continuation-arrow">➥</span>power_t 0",
    quiet=True,
)</pre>

  <p class="body-ind1">Here are the key arguments to create contextual bandit:</p>

  <p class="body-case-b">   •   <code class="fm-code-in-text">--cb_explore_adf</code>—Enables contextual bandit exploration with action-dependent features</p>

  <p class="body-case-b">   •   <code class="fm-code-in-text">--epsilon 0.2</code>—Sets the exploration rate to 0.2, meaning that the bandit will explore non-greedy actions with a probability of 0.2 (20% of the time)</p>

  <p class="body-case-b">   •   <code class="fm-code-in-text">--interactions AA AU AAU</code>—Specifies three-way interactions between features AA, AU, and AAU</p>

  <p class="body-case-b">   •   <code class="fm-code-in-text">-l 0.05</code>—Sets the learning rate to 0.05, which controls the step size in the learning process</p>

  <p class="body-case-b">   •   <code class="fm-code-in-text">--power_t 0</code>—Specifies that the learning rate is constant (no learning rate decay)</p>

  <p class="body-case-b">   •   <code class="fm-code-in-text">num_iterations = 2500</code></p>

  <p class="body-ind1">The following code snippet allows us to run the created contextual bandit to make decisions:</p>
  <pre class="programlistinge">num_iterations = 2500                                                                 <span class="fm-combinumeral">①</span>
cb_rewards = []                                                                       <span class="fm-combinumeral">②</span>
for _ in range(num_iterations): 
    shared_context = (random.choice(flight_types),
<span class="fm-code-continuation-arrow">➥</span> random.choice(passenger_classes))                                                  <span class="fm-combinumeral">③</span>
    examples, indices = generate_combinations(
        shared_context, flight_routes, meal_services, entertainment_options
    )                                                                                 <span class="fm-combinumeral">④</span>
    cb_prediction = cb_vw.predict(examples)                                           <span class="fm-combinumeral">⑤</span>
    chosen_index, prob = sample_truck_pmf(cb_prediction)                              <span class="fm-combinumeral">⑥</span>
    route, meal, entertainment = indices[chosen_index]                                <span class="fm-combinumeral">⑦</span>
    reward = reward_function(shared_context, route, meal, entertainment)
    cb_rewards.append(reward)                                                         <span class="fm-combinumeral">⑧</span>
    examples[chosen_index + 1] = f"0:{-1*reward}:{prob} {examples[chosen_index + 1]}" <span class="fm-combinumeral">⑨</span>
    cb_vw.learn(examples)                                                             <span class="fm-combinumeral">⑩</span>
cb_vw.finish()                                                                        <span class="fm-combinumeral">⑪</span></pre>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">①</span> Set the number of iterations.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">②</span> Initialize an empty to store the rewards at each iteration.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">③</span> Select a random shared context in each iteration.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">④</span> Generate all possible combinations of flight routes, meal services, and entertainment options based on the chosen shared context.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑤</span> Predict the expected reward for each action (combination).</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑥</span> Sample an index from the predicted rewards.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑦</span> Retrieve individual choices for flight route, meal service, and entertainment.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑧</span> Calculate the reward associated with the chosen action (combination) and shared context.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑨</span> Append the reward information to the example.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑩</span> Learn from the updated examples.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑪</span> Close the workspace and finalize the learning process.</p>

  <p class="body-ind1">We can print the average reward during training as follows:</p>
  <pre class="programlistinge">plt.plot(pd.Series(cb_rewards).expanding().mean())
plt.xlabel("Iterations")
plt.ylabel("Average reward")
plt.show()</pre>

  <p class="body-ind1">Figure C.39 shows the progress of an average reward obtained in each iteration during the learning process.</p>

  <div class="figure">
    <p class="figuree"><img alt="" class="calibre4" src="../Images/APPC_F39_Khamis.png"/></p>

    <p class="figurecaptione">Figure C.39 Average reward in each iteration during the learning process</p>
  </div>

  <p class="body-ind1">The complete version of listing C.23 provided in the book’s GitHub repo defines a <code class="fm-code-in-text">test_model</code> function and then tests the contextual bandit model using a given shared context. The <code class="fm-code-in-text">test_model</code> function is defined to test the contextual bandit model by simulating a single decision-making instance for a given shared context. It takes four parameters—<code class="fm-code-in-text">shared_context</code>, <code class="fm-code-in-text">flight_routes</code>, <code class="fm-code-in-text">meal_services</code>, and <code class="fm-code-in-text">entertainment_options</code>:</p>
  <pre class="programlistinge">def test_model(shared_context, flight_routes, meal_services,
<span class="fm-code-continuation-arrow">➥</span> entertainment_options):
    examples, _ = generate_combinations(shared_context, flight_routes,
<span class="fm-code-continuation-arrow">➥</span> meal_services, entertainment_options)                             <span class="fm-combinumeral">①</span>
    cb_prediction = cb_vw.predict(examples)                          <span class="fm-combinumeral">②</span>
    chosen_index, prob = sample_truck_pmf(cb_prediction)             <span class="fm-combinumeral">③</span>
    chosen_action = examples[chosen_index + 1]                       <span class="fm-combinumeral">④</span>
    route, meal, entertainment = indices[chosen_index]               <span class="fm-combinumeral">⑤</span>
    expected_reward = reward_function(shared_context, route, meal,
<span class="fm-code-continuation-arrow">➥</span> entertainment)                                                    <span class="fm-combinumeral">⑥</span>
    print("Chosen Action:", chosen_action)                           <span class="fm-combinumeral">⑦</span>
    print("Expected Reward:", expected_reward)                       <span class="fm-combinumeral">⑦</span>
  
test_shared_context = ('domestic', 'business')                       <span class="fm-combinumeral">⑧</span>
  
test_model(test_shared_context, flight_routes, meal_services,
<span class="fm-code-continuation-arrow">➥</span> entertainment_options)                                            <span class="fm-combinumeral">⑨</span></pre>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">①</span> Generate all possible combinations of flight routes, meal services, and entertainment options based on the given shared context.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">②</span> Predict the expected reward for each action (combination) based on the provided examples.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">③</span> Sample an index from the predicted rewards.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">④</span> Retrieve the chosen action (combination).</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑤</span> Retrieve individual choices for flight route, meal service, and entertainment.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑥</span> Calculate the expected reward associated with the chosen action and shared context.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑦</span> Print the chosen action and the expected reward.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑧</span> Set a specific shared context.</p>

  <p class="fm-code-annotatione"><span class="fm-combinumeral">⑨</span> Test the contextual bandit model's decision-making process for this specific context.</p>

  <p class="body-ind1">This code will generate the output like the following for the given context:</p>
  <pre class="programlistinge">Chosen Action: |Action route=fuel_efficient meal=full_meal entertainment=movies_music
Expected Reward: 0.87</pre>

  <p class="body-dialog"><span class="gray">  5.</span>   Replacing the included supervised learning model, sl-ar-var-20pnn-gnn-max_20200308T172931, with the pretrained RL model, rl-ar-var-20pnn-gnn-max_20200313T002243, in listing 11.4 is done as follows:</p>
  <pre class="programlistinge">model = "learning_tsp/pretrained/tsp_20-50/rl-ar-var-20pnn-gnn-max_20200313T002243"
# model = "learning_tsp/pretrained/tspsl_20-50/sl-ar-var-20pnn-gnn-max_20200308T172931"</pre>

  <p class="body-dialog"><span class="gray">  6.</span>   Listing C.24, available in the book’s GitHub repo, provides a simplified implementation of PPO for electric motor control. Experiment with the different parameters of this algorithm and consider trying other RL models available in SB3, such as advantage actor-critic (A2C), soft actor-critic (SAC), deep deterministic policy gradient (DDPG), deep Q network (DQN), hindsight experience replay (HER), and twin delayed DDPG (TD3).</p>
</body></html>