<html><head></head><body>
<div class="calibre1" id="sbo-rt-content"><h1 class="tochead" id="heading_id_2">6 <a id="idTextAnchor000"/><a id="idTextAnchor001"/><a id="idTextAnchor002"/>Rapid data creation using AI</h1>
<p class="co-summary-head">This chapter covers<a id="idIndexMarker000"/><a id="marker-109"/></p>
<ul class="calibre5">
<li class="co-summary-bullet">Generating basic test data using LLMs</li>
<li class="co-summary-bullet">Changing the format of test data</li>
<li class="co-summary-bullet">Using complex data sets to prompt LLMs to create new data sets</li>
<li class="co-summary-bullet">Integrating LLMs as a test data manager for automated checks</li>
</ul>
<p class="body">Managing test data is one of the most challenging aspects of testing and software development. Typically, data requirements grow with the complexity of a system. Having to synthesize data relevant to our context for automated checks and human-driven testing that handles complex data structures and anonymizes at scale and on demand can impose a huge drain on testing time and resources, which could be better spent on other testing activities.</p>
<p class="body">However, we need test data. It is simply not possible to carry out most testing activities if we lack the necessary data to trigger actions and observe behavior. That’s why this chapter shows how we can use large language models (LLMs) to generate test data, providing different prompts to create both simple and complex data structures and integrate LLMs into our automation frameworks via third-party APIs.</p>
<h2 class="fm-head" id="heading_id_3">6.1 Generating and transforming data with LLMs</h2>
<p class="body">Given that LLMs are powerful, probabilistic, text generators, it sounds logical that, with the right prompting, they can generate and transform test data easily. This is true, but it depends on writing clear prompts that communicate our data requirements explicitly, so that we get the right data we want, in the correct format and without any errors caused by hallucinations. There are many ways in which we can approach this, but let’s begin by looking at some basic prompts we can use casually to create test data for a range of testing activities.<a id="idIndexMarker001"/><a id="idIndexMarker002"/></p>
<h3 class="fm-head1" id="heading_id_4">6.1.1 Prompting LLMs to generate simple data sets</h3>
<p class="body"><a id="marker-110"/>To start, let’s explore how we can create basic data set examples such as this one:<a id="idIndexMarker003"/><a id="idIndexMarker004"/></p>
<pre class="programlisting">{
  "room_name": "Cozy Suite",
  "type": "single",
  "beds": 1,
  "accessible": true,
  "image": "https://example.com/room1.jpg",
  "description": "Charming room",
  "features": ["Wifi", "TV"],
  "roomPrice": 150
}</pre>
<p class="body">As we can see, the JSON data set has a mixture of data types using a fairly straightforward structure. We’ll see how to work with more complex structures later in the chapter, but for now, let’s return to a prompt that we used back in chapter 2 to create some sample test data. First, we set out the main instructions for the prompt and use the time-to-think principle to improve the quality of the output JSON:</p>
<table border="0" class="contenttable-0-table" width="100%">
<colgroup class="contenttable-0-colgroup">
<col class="contenttable-0-col" span="1" width="7%"/>
<col class="contenttable-0-col" span="1" width="93%"/>
</colgroup>
<tbody class="contenttable-0-tbody">
<tr class="contenttable-0-tr">
<td class="contenttable-0-td">
<div class="figure2">
<p class="figure1"><img alt="" class="calibre7" height="40" src="../../OEBPS/Images/logo-MW.png" width="40"/></p>
</div>
</td>
<td class="contenttable-0-td">
<p class="body-table">You are a JSON data generator. Generate 5 JSON objects in an array and check that 5 JSON objects have been created before outputting the results.</p>
</td>
</tr>
</tbody>
</table>
<p class="body">We use different delimiters to set out the rules for our data requirements:</p>
<table border="0" class="contenttable-0-table" width="100%">
<colgroup class="contenttable-0-colgroup">
<col class="contenttable-0-col" span="1" width="7%"/>
<col class="contenttable-0-col" span="1" width="93%"/>
</colgroup>
<tbody class="contenttable-0-tbody">
<tr class="contenttable-0-tr">
<td class="contenttable-0-td">
<div class="figure2">
<p class="figure1"><img alt="" class="calibre7" height="40" src="../../OEBPS/Images/logo-MW.png" width="40"/></p>
</div>
</td>
<td class="contenttable-0-td">
<p class="body-table-list-a">   *   Each parameter is identified with a <code class="fm-code-in-text1">%</code> sign.</p>
<p class="body-table-list-a">   *   Each column is described in order of key, value data type and options using the <code class="fm-code-in-text1">|</code> sign.</p>
<p class="body-table-list-a">   *   If a column data option says random, randomize data based on the suggested format and column name.</p>
</td>
</tr>
</tbody>
</table>
<p class="body">Then we provide the data we want to be created following our delimited rule set:</p>
<table border="0" class="contenttable-0-table" width="100%">
<colgroup class="contenttable-0-colgroup">
<col class="contenttable-0-col" span="1" width="7%"/>
<col class="contenttable-0-col" span="1" width="93%"/>
</colgroup>
<tbody class="contenttable-0-tbody">
<tr class="contenttable-0-tr">
<td class="contenttable-0-td">
<div class="figure2">
<p class="figure1"><img alt="" class="calibre7" height="40" src="../../OEBPS/Images/logo-MW.png" width="40"/></p>
</div>
</td>
<td class="contenttable-0-td">
<p class="body-table">Here are the instructions:</p>
<pre class="programlisting">% room_name | string | random
% type | string |  'single' or 'double'
% beds | integer | 1 to 6
% accessible | boolean | true or false
% image | string | random url
% description | string | random max 20 characters
% features | array[string] | 'Wifi', 'TV' or 'Safe'
% roomPrice |  integer | 100 to 200</pre>
</td>
</tr>
</tbody>
</table>
<p class="body">This prompt relies on a range of prompt-engineering tactics to set out explicitly what we want to see generated. We use the format tactic to declare what format we want our test data to be returned in. The delimiter tactic is used to set the rules for how we structure our data and what format values should be in. Also, we instruct the LLM to work out the solution before outputting it to reduce the risk of hallucinations.</p>
<p class="body"><a id="marker-111"/>Sending this prompt to ChatGPT returned the following data set:</p>
<table border="0" class="contenttable-0-table" width="100%">
<colgroup class="contenttable-0-colgroup">
<col class="contenttable-0-col" span="1" width="7%"/>
<col class="contenttable-0-col" span="1" width="93%"/>
</colgroup>
<tbody class="contenttable-0-tbody">
<tr class="contenttable-0-tr">
<td class="contenttable-0-td">
<div class="figure2">
<p class="figure1"><img alt="" class="calibre7" height="40" src="../../OEBPS/Images/logo-openai.png" width="40"/></p>
</div>
</td>
<td class="contenttable-0-td">
<pre class="programlisting">[
  {
    "room_name": "Cozy Suite",
    "type": "single",
    "beds": 1,
    "accessible": true,
    "image": "https://example.com/room1.jpg",
    "description": "Charming room",
    "features": ["Wifi", "TV"],
    "roomPrice": 150
  },
  {
    "room_name": "Deluxe Room",
    "type": "double",
    "beds": 2,
    "accessible": false,
    "image": "https://example.com/room2.jpg",
    "description": "Luxury abode",
    "features": ["Wifi", "Safe"],
    "roomPrice": 180
  },
  {
    "room_name": "Economy Stay",
    "type": "single",
    "beds": 1,
    "accessible": true,
    «image»: «https://example.com/room3.jpg»,
    "description": "Budget-friendly",
    "features": ["TV"],
    "roomPrice": 120
  },
  {
    "room_name": "Family Suite",
    "type": "double",
    "beds": 3,
    "accessible": true,
    "image": "https://example.com/room4.jpg",
    "description": "Spacious and comfy",
    "features": ["Wifi", "TV", "Safe"],
    "roomPrice": 200
  },
  {
    "room_name": "Executive Loft",
    "type": "single",
    "beds": 1,
    "accessible": false,
    «image»: «https://example.com/room5.jpg»,
    "description": "Modern design",
    "features": ["Wifi", "Safe"],
    "roomPrice": 170
  }
]</pre>
</td>
</tr>
</tbody>
</table>
<p class="body">There are a few observations to make from this generated data. We can see that in places where the prompt has been explicit in data expectations, we get generated data that is close to our expectations—for example, the features <code class="fm-code-in-text">accessible</code> and <code class="fm-code-in-text">roomPrice</code>. There are, however, some weaker areas where our prompt has left the LLM to determine what to output. Two notable areas are the image URLs that have opted for <code class="fm-code-in-text">example.com</code> and the relationship between <code class="fm-code-in-text">beds</code> and <code class="fm-code-in-text">type</code>. The image URLs, although valid, don’t point to actual images. Depending on our requirements, we may need to tweak our prompt further to make the URLs more explicit. The other relationship is interesting as well, as one of the records states that the room type is double but it offers three beds. It’s a good start though, and there are times when this type of generated data is enough to support our testing.<a id="idIndexMarker005"/><a id="marker-112"/><a id="idIndexMarker006"/></p>
<p class="body">But what if we want this data in a different data structure? This can be handled by quickly reworking the prompt. For example, this prompt is requesting the same data, but this time in an XML format. We begin by rewording the initial instructions to create the data in an XML format:</p>
<table border="0" class="contenttable-0-table" width="100%">
<colgroup class="contenttable-0-colgroup">
<col class="contenttable-0-col" span="1" width="7%"/>
<col class="contenttable-0-col" span="1" width="93%"/>
</colgroup>
<tbody class="contenttable-0-tbody">
<tr class="contenttable-0-tr">
<td class="contenttable-0-td">
<div class="figure2">
<p class="figure1"><img alt="" class="calibre7" height="40" src="../../OEBPS/Images/logo-MW.png" width="40"/></p>
</div>
</td>
<td class="contenttable-0-td">
<p class="body-table">You are an XML data generator. Generate 3 XML entries in an array and check that 3 XML objects have been created before outputting the results.</p>
</td>
</tr>
</tbody>
</table>
<p class="body">We add an initial instruction to handle a root XML node:</p>
<table border="0" class="contenttable-0-table" width="100%">
<colgroup class="contenttable-0-colgroup">
<col class="contenttable-0-col" span="1" width="7%"/>
<col class="contenttable-0-col" span="1" width="93%"/>
</colgroup>
<tbody class="contenttable-0-tbody">
<tr class="contenttable-0-tr">
<td class="contenttable-0-td">
<div class="figure2">
<p class="figure1"><img alt="" class="calibre7" height="40" src="../../OEBPS/Images/logo-MW.png" width="40"/></p>
</div>
</td>
<td class="contenttable-0-td">
<p class="body-table-list-a">   *   The root node element name is identified with a <code class="fm-code-in-text1">#</code> sign</p>
<p class="body-table-list-a">   *   Each element is identified with a <code class="fm-code-in-text1">%</code> sign</p>
<p class="body-table-list-a">   *   Each column is described in order of element name, data type and options using the <code class="fm-code-in-text1">|</code> sign</p>
<p class="body-table-list-a">   *   If a column data option says random, randomize data based on the suggested format and column name</p>
</td>
</tr>
</tbody>
</table>
<p class="body">Then we provide the same data steps as before:</p>
<table border="0" class="contenttable-0-table" width="100%">
<colgroup class="contenttable-0-colgroup">
<col class="contenttable-0-col" span="1" width="7%"/>
<col class="contenttable-0-col" span="1" width="93%"/>
</colgroup>
<tbody class="contenttable-0-tbody">
<tr class="contenttable-0-tr">
<td class="contenttable-0-td">
<div class="figure2">
<p class="figure1"><img alt="" class="calibre7" height="40" src="../../OEBPS/Images/logo-MW.png" width="40"/></p>
</div>
</td>
<td class="contenttable-0-td">
<p class="body-table">Here are the instructions:</p>
<pre class="programlisting"># rooms
% room_name | string | random
% type | string |  'single' or 'double'
% beds | integer | 1 to 6
% accessible | boolean | true or false
% image | string | random url
% description | string | random max 20 characters
% features | array[string] | 'Wifi', 'TV' or 'Safe'
% roomPrice |  integer | 100 to 200</pre>
</td>
</tr>
</tbody>
</table>
<p class="body">Although it’s not necessarily common to have to handle different data formats in one application, the prompt demonstrates one of the advantages of working with LLMs to generate data. Using the structured output tactic, we’re able to keep most of the prompt the same as the JSON prompt example and simply modify it to give us XML; when I sent it to ChatGPT, I got the following result:<a id="marker-113"/></p>
<table border="0" class="contenttable-0-table" width="100%">
<colgroup class="contenttable-0-colgroup">
<col class="contenttable-0-col" span="1" width="7%"/>
<col class="contenttable-0-col" span="1" width="93%"/>
</colgroup>
<tbody class="contenttable-0-tbody">
<tr class="contenttable-0-tr">
<td class="contenttable-0-td">
<div class="figure2">
<p class="figure1"><img alt="" class="calibre7" height="40" src="../../OEBPS/Images/logo-openai.png" width="40"/></p>
</div>
</td>
<td class="contenttable-0-td">
<pre class="programlisting">&lt;rooms&gt;
    &lt;room&gt;
        &lt;room_name&gt;A1&lt;/room_name&gt;
        &lt;type&gt;single&lt;/type&gt;
        &lt;beds&gt;3&lt;/beds&gt;
        &lt;accessible&gt;true&lt;/accessible&gt;
        &lt;image&gt;https://example.com/room_a1.jpg&lt;/image&gt;
        &lt;description&gt;Cozy room&lt;/description&gt;
        &lt;features&gt;
            &lt;feature&gt;Wifi&lt;/feature&gt;
            &lt;feature&gt;TV&lt;/feature&gt;
        &lt;/features&gt;
        &lt;roomPrice&gt;150&lt;/roomPrice&gt;
    &lt;/room&gt;
    &lt;room&gt;
        &lt;room_name&gt;B2&lt;/room_name&gt;
        &lt;type&gt;double&lt;/type&gt;
        &lt;beds&gt;2&lt;/beds&gt;
        &lt;accessible&gt;false&lt;/accessible&gt;
        &lt;image&gt;https://example.com/room_b2.jpg&lt;/image&gt;
        &lt;description&gt;Spacious suite&lt;/description&gt;
        &lt;features&gt;
            &lt;feature&gt;TV&lt;/feature&gt;
            &lt;feature&gt;Safe&lt;/feature&gt;
        &lt;/features&gt;
        &lt;roomPrice&gt;180&lt;/roomPrice&gt;
    &lt;/room&gt;
    &lt;room&gt;
        &lt;room_name&gt;C3&lt;/room_name&gt;
        &lt;type&gt;single&lt;/type&gt;
        &lt;beds&gt;1&lt;/beds&gt;
        &lt;accessible&gt;true&lt;/accessible&gt;
        &lt;image&gt;https://example.com/room_c3.jpg&lt;/image&gt;
        &lt;description&gt;Modern design&lt;/description&gt;
        &lt;features&gt;
            &lt;feature&gt;Wifi&lt;/feature&gt;
            &lt;feature&gt;Safe&lt;/feature&gt;
        &lt;/features&gt;
        &lt;roomPrice&gt;130&lt;/roomPrice&gt;
    &lt;/room&gt;
&lt;/rooms&gt;</pre>
</td>
</tr>
</tbody>
</table>
<p class="body">Again, the output has similar attributes as the previous examples. The structure of the XML is valid, and the rules determining what data to use have been followed. But, similar to the JSON example, we have some unusual choices being made. Single rooms with three beds, oddly named rooms, and dummy URLs are used. With both prompts, we could add more information to mitigate these problems, but we run the risk of having to create a lot of rules in our prompt to manage the relationship between data points. There are, however, other choices we can make with our prompts to handle more complex rule sets, but first, let’s explore another way in which LLMs can help us thanks to their ability to transform data.<a id="idIndexMarker007"/><a id="marker-114"/><a id="idIndexMarker008"/></p>
<div class="fm-sidebar-block">
<p class="fm-sidebar-title">Activity 6.1</p>
<p class="fm-sidebar-text">Using the prompt shared in this section, change the data structure to create either new XML or JSON test data.</p>
</div>
<h3 class="fm-head1" id="heading_id_5">6.1.2 Transforming test data into different formats</h3>
<p class="body">One of the core benefits of LLMs, which has been highlighted by advocates of the technology, is its ability to translate text from one language to another—for example, from French to English and back again. We can also use this approach to transform data and code from one structure or language to another. For example, take a look at the following prompt that transforms some JSON into a SQL statement. We use the delimiter tactic and instructions to start the prompt:<a id="idIndexMarker009"/><a id="idIndexMarker010"/></p>
<table border="0" class="contenttable-0-table" width="100%">
<colgroup class="contenttable-0-colgroup">
<col class="contenttable-0-col" span="1" width="7%"/>
<col class="contenttable-0-col" span="1" width="93%"/>
</colgroup>
<tbody class="contenttable-0-tbody">
<tr class="contenttable-0-tr">
<td class="contenttable-0-td">
<div class="figure2">
<p class="figure1"><img alt="" class="calibre7" height="40" src="../../OEBPS/Images/logo-MW.png" width="40"/></p>
</div>
</td>
<td class="contenttable-0-td">
<p class="body-table">You are a JSON to SQL transformer. Convert the JSON object delimited by triple hashes into a SQL statement that will:</p>
<p class="body-table-list-a">   1.  Create a SQL table to insert the transformed records into</p>
<p class="body-table-list-a">   2.  Create insert statements to add each record to a database</p>
</td>
</tr>
</tbody>
</table>
<p class="body">Next, we instruct the model to check the solution to improve the output:</p>
<table border="0" class="contenttable-0-table" width="100%">
<colgroup class="contenttable-0-colgroup">
<col class="contenttable-0-col" span="1" width="7%"/>
<col class="contenttable-0-col" span="1" width="93%"/>
</colgroup>
<tbody class="contenttable-0-tbody">
<tr class="contenttable-0-tr">
<td class="contenttable-0-td">
<div class="figure2">
<p class="figure1"><img alt="" class="calibre7" height="40" src="../../OEBPS/Images/logo-MW.png" width="40"/></p>
</div>
</td>
<td class="contenttable-0-td">
<p class="body-table">Check that each SQL statement covers all aspects of the JSON before outputting the results</p>
</td>
</tr>
</tbody>
</table>
<p class="body">Then we provide the data that we want to see transformed:</p>
<table border="0" class="contenttable-0-table" width="100%">
<colgroup class="contenttable-0-colgroup">
<col class="contenttable-0-col" span="1" width="7%"/>
<col class="contenttable-0-col" span="1" width="93%"/>
</colgroup>
<tbody class="contenttable-0-tbody">
<tr class="contenttable-0-tr">
<td class="contenttable-0-td">
<div class="figure2">
<p class="figure1"><img alt="" class="calibre7" height="40" src="../../OEBPS/Images/logo-MW.png" width="40"/></p>
</div>
</td>
<td class="contenttable-0-td">
<pre class="programlisting">###
[{
    "firstname": "Sally",
    "lastname": "Wilson",
    "totalprice": 229,
    "depositpaid": false,
    "bookingdates": {
        "checkin": "2017-02-20",
        "checkout": "2019-07-05"
    },
    "additionalneeds": "Breakfast"
},{
    "firstname": "Jim",
    "lastname": "Jones",
    "totalprice": 871,
    "depositpaid": false,
    "bookingdates": {
        "checkin": "2017-08-11",
        "checkout": "2021-06-30"
    },
    "additionalneeds": "Breakfast"
},{
    "firstname": "Mary",
    "lastname": "Ericsson",
    "totalprice": 558,
    "depositpaid": true,
    "bookingdates": {
        "checkin": "2018-07-04",
        "checkout": "2022-09-25"
    }
}]
###</pre>
</td>
</tr>
</tbody>
</table>
<p class="body">In this prompt, we’re asking an LLM not only to take a JSON object and convert it into a SQL <code class="fm-code-in-text">INSERT</code> statement that we could run, but also create the necessary <code class="fm-code-in-text">CREATE</code> statement to allow us to insert our data in the first place. Sending this to ChatGPT returned the following SQL statement:<a id="idIndexMarker011"/><a id="marker-115"/><a id="idIndexMarker012"/></p>
<table border="0" class="contenttable-0-table" width="100%">
<colgroup class="contenttable-0-colgroup">
<col class="contenttable-0-col" span="1" width="7%"/>
<col class="contenttable-0-col" span="1" width="93%"/>
</colgroup>
<tbody class="contenttable-0-tbody">
<tr class="contenttable-0-tr">
<td class="contenttable-0-td">
<div class="figure2">
<p class="figure1"><img alt="" class="calibre7" height="40" src="../../OEBPS/Images/logo-openai.png" width="40"/></p>
</div>
</td>
<td class="contenttable-0-td">
<pre class="programlisting">-- Create the table
CREATE TABLE bookings (
    id SERIAL PRIMARY KEY,
    firstname VARCHAR(255),
    lastname VARCHAR(255),
    totalprice DECIMAL(10, 2),
    depositpaid BOOLEAN,
    checkin DATE,
    checkout DATE,
    additionalneeds VARCHAR(255)
);
 
-- Insert the records
INSERT INTO bookings (firstname, lastname, totalprice, depositpaid,
 checkin, checkout, additionalneeds)
VALUES
    ('Sally', 'Wilson', 229.00, false, '2017-02-20', '2019-07-05',
 'Breakfast'),
    ('Jim', 'Jones', 871.00, false, '2017-08-11', '2021-06-30',
 'Breakfast'),
    ('Mary', 'Ericsson', 558.00, true, '2018-07-04', '2022-09-25', 
NULL);</pre>
</td>
</tr>
</tbody>
</table>
<p class="body">What stands out in this response is not just that correct SQL has been generated to create and insert our data into a database, but that it has honored the values from the original JSON object. It demonstrates the importance of tactics such as these that go into a prompt:</p>
<table border="0" class="contenttable-0-table" width="100%">
<colgroup class="contenttable-0-colgroup">
<col class="contenttable-0-col" span="1" width="7%"/>
<col class="contenttable-0-col" span="1" width="93%"/>
</colgroup>
<tbody class="contenttable-0-tbody">
<tr class="contenttable-0-tr">
<td class="contenttable-0-td">
<div class="figure2">
<p class="figure1"><img alt="" class="calibre7" height="40" src="../../OEBPS/Images/logo-MW.png" width="40"/></p>
</div>
</td>
<td class="contenttable-0-td">
<p class="body-table">Check that each SQL statement covers all aspects of the JSON before outputting the results</p>
</td>
</tr>
</tbody>
</table>
<p class="body">The prompt helps ensure that the data parameters themselves are not modified during the transformation process.</p>
<p class="body">These quick prompts demonstrate that LLMs can be used to rapidly generate and transform data with prompts that can be reused multiple times by replacing the data object inside the delimited portion of each prompt. This can prove useful for testing activities such as exploratory testing and debugging, where we require data fast to help us progress with our testing. But, as demonstrated, we can quickly come across either inconsistent or invalid data as our requirements become more complex.<a id="idIndexMarker013"/><a id="idIndexMarker014"/></p>
<div class="fm-sidebar-block">
<p class="fm-sidebar-title">Activity 6.2</p>
<p class="fm-sidebar-text">Build a prompt that attempts to convert a piece of XML into either a SQL or JSON data structure. Ensure that the test data within the XML is transferred across without problems.</p>
</div>
<h2 class="fm-head" id="heading_id_6">6.2 Processing complex test data with LLMs</h2>
<p class="body">In the original prompts to generate data, we set the rules and expectations in plain language. It means we are required to decode the structure of our data and its relationships before explicitly stating the learned rules in our prompt—a task that can quickly become quite complicated. Thus, instead of attempting to work out those rules ourselves, let’s take a look at how we can send different data specifications formats or existing data to prompt an LLM to create more complex data.<a id="idIndexMarker015"/><a id="marker-116"/><a id="idIndexMarker016"/></p>
<h3 class="fm-head1" id="heading_id_7">6.2.1 Using format standards in prompts</h3>
<p class="body">Let’s begin by looking at how we can employ data specification formats such as OpenAPI v3 and XSD that outline the structure and rules our data has to follow. These types of specifications can be useful for a few reasons:<a id="idIndexMarker017"/><a id="idIndexMarker018"/><a id="idIndexMarker019"/></p>
<ul class="calibre5">
<li class="fm-list-bullet">
<p class="list"><i class="fm-italics">Ready-to-go solutions</i>—Creators of specification frameworks have already handled the heavy lifting when it comes to communicating data structures in different formats. Consider the prompts we created earlier with the delimited rules that outline data names and types. All of this has already been considered and set out in specification frameworks. Therefore, it makes sense to use them rather than build our own.</p>
</li>
<li class="fm-list-bullet">
<p class="list"><i class="fm-italics">Ubiquity</i>—The frameworks we’ll use are standardized and have been adopted by lots of teams and organizations. This increases the likelihood that LLMs have been trained on specification frameworks, which will maximize our chances of obtaining a desired output when we send a prompt.</p>
</li>
<li class="fm-list-bullet">
<p class="list"><i class="fm-italics">Free use</i>—If we are working in teams that use tools such as OpenAPI and XSD to specify data structure or APIs, then the specifications are already available for us to use. The work is already done in the design phase for a feature or application.</p>
</li>
<li class="fm-list-bullet">
<p class="list"><i class="fm-italics">Intrinsic testability</i>—Employing a commonly used structure means that an LLM has likely been exposed to it more in its training than if we were using proprietary structures. This means that an LLM is likely to increase the probability of a higher-value output and assist our testing further.</p>
</li>
</ul>
<p class="body">Given that this approach has a few benefits, let’s take a look at how they can be added to prompts to generate data for us.</p>
<p class="fm-head2">JSON with OpenAPI</p>
<p class="body">We’ll start by creating a prompt that uses the OpenAPI 3.0 format to create JSON data, resulting in the following prompt, which sets out the prompt instructions using the delimiter, format, and work-our-solution tactics<a id="idIndexMarker020"/><a id="idIndexMarker021"/><a id="idIndexMarker022"/><a id="idIndexMarker023"/><a id="idIndexMarker024"/><a id="marker-117"/></p>
<table border="0" class="contenttable-0-table" width="100%">
<colgroup class="contenttable-0-colgroup">
<col class="contenttable-0-col" span="1" width="7%"/>
<col class="contenttable-0-col" span="1" width="93%"/>
</colgroup>
<tbody class="contenttable-0-tbody">
<tr class="contenttable-0-tr">
<td class="contenttable-0-td">
<div class="figure2">
<p class="figure1"><img alt="" class="calibre7" height="40" src="../../OEBPS/Images/logo-MW.png" width="40"/></p>
</div>
</td>
<td class="contenttable-0-td">
<p class="body-table">You are a JSON data generator. Generate a JSON array with 3 randomized JSON objects based on the OpenAPI schema delimited by three hashes. Confirm that all 3 JSON objects match the OpenAPI schema rules before outputting the results.</p>
</td>
</tr>
</tbody>
</table>
<p class="body">We then provide the OpenAPI specification for processing:</p>
<table border="0" class="contenttable-0-table" width="100%">
<colgroup class="contenttable-0-colgroup">
<col class="contenttable-0-col" span="1" width="7%"/>
<col class="contenttable-0-col" span="1" width="93%"/>
</colgroup>
<tbody class="contenttable-0-tbody">
<tr class="contenttable-0-tr">
<td class="contenttable-0-td">
<div class="figure2">
<p class="figure1"><img alt="" class="calibre7" height="40" src="../../OEBPS/Images/logo-MW.png" width="40"/></p>
</div>
</td>
<td class="contenttable-0-td">
<pre class="programlisting">###
openapi: 3.0.0
components:
  schemas:
    Room:
      title: Room
      type: object
      properties:
        accessible:
          type: boolean
        description:
          type: string
        type:
          type: string
          pattern: Single|Double|Twin|Family|Suite
        features:
          type: array
          items:
            type: string
            pattern: WiFi|TV|Radio|Refreshments|Safe|
        image:
          type: string
        roomNumber:
          type: string
        roomPrice:
          type: integer
          format: int32
          minimum: 0
          maximum: 999
          exclusiveMinimum: true
          exclusiveMaximum: false
        roomid:
          type: integer
          format: int32
      required:
        - accessible
        - description
        - features
        - image
        - roomNumber
        - roomPrice
###</pre>
</td>
</tr>
</tbody>
</table>
<p class="body">Notice how the prompt indicates at the start that we intend to use the OpenAPI format to outline our data requirements. We use this to set our expectations of how the resulting data should be structured, which we can see when submitting the prompt to ChatGPT and receiving the following output:<a id="marker-118"/></p>
<table border="0" class="contenttable-0-table" width="100%">
<colgroup class="contenttable-0-colgroup">
<col class="contenttable-0-col" span="1" width="7%"/>
<col class="contenttable-0-col" span="1" width="93%"/>
</colgroup>
<tbody class="contenttable-0-tbody">
<tr class="contenttable-0-tr">
<td class="contenttable-0-td">
<div class="figure2">
<p class="figure1"><img alt="" class="calibre7" height="40" src="../../OEBPS/Images/logo-openai.png" width="40"/></p>
</div>
</td>
<td class="contenttable-0-td">
<pre class="programlisting">[
  {
    "accessible": true,
    "description": "Cozy single room with a view",
    "type": "Single",
    "features": ["WiFi", "TV"],
    "image": "single_room.jpg",
    "roomNumber": "101",
    "roomPrice": 75,
    "roomid": 1
  },
  {
    "accessible": false,
    "description": "Spacious double room with amenities",
    "type": "Double",
    "features": ["WiFi", "TV", "Refreshments"],
    "image": "double_room.jpg",
    "roomNumber": "202",
    "roomPrice": 120,
    "roomid": 2
  },
  {
    "accessible": true,
    "description": "Family suite with a view and entertainment",
    "type": "Family",
    "features": ["WiFi", "TV", "Radio", "Refreshments", "Safe"],
    "image": "family_suite.jpg",
    "roomNumber": "305",
    "roomPrice": 180,
    "roomid": 3
  }
]</pre>
</td>
</tr>
</tbody>
</table>
<p class="body">Compared to the previous data we generated, this data feels more accurate. The descriptions are more detailed and cite other attributes of the room found elsewhere. For example, the family suite description references the data related to the room type and features.</p>
<p class="body">The image attributes are questionable as they simply provide an image name, but that might suffice if images are stored within our application. However, what our use of the OpenAPI language allows us to do is to set more detailed rules, meaning that we could update the image section of the specification from</p>
<table border="0" class="contenttable-0-table" width="100%">
<colgroup class="contenttable-0-colgroup">
<col class="contenttable-0-col" span="1" width="7%"/>
<col class="contenttable-0-col" span="1" width="93%"/>
</colgroup>
<tbody class="contenttable-0-tbody">
<tr class="contenttable-0-tr">
<td class="contenttable-0-td">
<div class="figure2">
<p class="figure1"><img alt="" class="calibre7" height="40" src="../../OEBPS/Images/logo-MW.png" width="40"/></p>
</div>
</td>
<td class="contenttable-0-td">
<pre class="programlisting">image:
  type: string</pre>
</td>
</tr>
</tbody>
</table>
<p class="body">to the following, in which the pattern points to test images we might have generated earlier:</p>
<table border="0" class="contenttable-0-table" width="100%">
<colgroup class="contenttable-0-colgroup">
<col class="contenttable-0-col" span="1" width="7%"/>
<col class="contenttable-0-col" span="1" width="93%"/>
</colgroup>
<tbody class="contenttable-0-tbody">
<tr class="contenttable-0-tr">
<td class="contenttable-0-td">
<div class="figure2">
<p class="figure1"><img alt="" class="calibre7" height="40" src="../../OEBPS/Images/logo-MW.png" width="40"/></p>
</div>
</td>
<td class="contenttable-0-td">
<pre class="programlisting">image:
  type: string
  items:
    type: string
    pattern:
https://realdomain.com/image_1.png|https://realdomain.com/image_2.png</pre>
</td>
</tr>
</tbody>
</table>
<p class="body"><a id="marker-119"/>If we were to add this pattern into our prompt and send it to an LLM, it would return objects such as this one:</p>
<table border="0" class="contenttable-0-table" width="100%">
<colgroup class="contenttable-0-colgroup">
<col class="contenttable-0-col" span="1" width="7%"/>
<col class="contenttable-0-col" span="1" width="93%"/>
</colgroup>
<tbody class="contenttable-0-tbody">
<tr class="contenttable-0-tr">
<td class="contenttable-0-td">
<div class="figure2">
<p class="figure1"><img alt="" class="calibre7" height="40" src="../../OEBPS/Images/logo-openai.png" width="40"/></p>
</div>
</td>
<td class="contenttable-0-td">
<pre class="programlisting">{
    "accessible": true,
    "description": "Cozy single room with a city view",
    "type": "Single",
    "features": ["WiFi", "TV"],
    «image»: «https://realdomain.com/image_1.png»,
    "roomNumber": "101",
    "roomPrice": 89,
    "roomid": 12345
}</pre>
</td>
</tr>
</tbody>
</table>
<p class="body">By utilizing different specification rules used in OpenAPI, we can control our output more successfully.</p>
<p class="fm-head2">XML and XSD</p>
<p class="body">The same process can be applied to other formats. Consider the following prompt that uses the same approach as the previous one but takes an XML Schema Definition (XSD) instead. We use format, delimiter, and work-out-solution tactics to outline the prompt to take an XSD format:<a id="idIndexMarker025"/><a id="idIndexMarker026"/><a id="idIndexMarker027"/><a id="idIndexMarker028"/><a id="idIndexMarker029"/></p>
<table border="0" class="contenttable-0-table" width="100%">
<colgroup class="contenttable-0-colgroup">
<col class="contenttable-0-col" span="1" width="7%"/>
<col class="contenttable-0-col" span="1" width="93%"/>
</colgroup>
<tbody class="contenttable-0-tbody">
<tr class="contenttable-0-tr">
<td class="contenttable-0-td">
<div class="figure2">
<p class="figure1"><img alt="" class="calibre7" height="40" src="../../OEBPS/Images/logo-MW.png" width="40"/></p>
</div>
</td>
<td class="contenttable-0-td">
<p class="body-table">You are an XML data generator. Generate 3 randomized XML objects based on the XSD schema delimited by three hashes. Add all the XML objects to parent element of rooms. Confirm that all 3 XML subobjects match the XSD schema rules before outputting the results.</p>
</td>
</tr>
</tbody>
</table>
<p class="body"><a id="marker-120"/>Next, we provide the XSD format to set how we want data output:</p>
<table border="0" class="contenttable-0-table" width="100%">
<colgroup class="contenttable-0-colgroup">
<col class="contenttable-0-col" span="1" width="7%"/>
<col class="contenttable-0-col" span="1" width="93%"/>
</colgroup>
<tbody class="contenttable-0-tbody">
<tr class="contenttable-0-tr">
<td class="contenttable-0-td">
<div class="figure2">
<p class="figure1"><img alt="" class="calibre7" height="40" src="../../OEBPS/Images/logo-MW.png" width="40"/></p>
</div>
</td>
<td class="contenttable-0-td">
<pre class="programlisting">###
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;xs:schema &gt;
 
    &lt;xs:element name="room"&gt;
        &lt;xs:complexType&gt;
            &lt;xs:sequence&gt;
                &lt;xs:element name="accessible" type="xs:boolean"/&gt;
                &lt;xs:element name="description" type="xs:string"/&gt;
                &lt;xs:element name="type"&gt;
                    &lt;xs:simpleType&gt;
                        &lt;xs:restriction base="xs:string"&gt;
                            &lt;xs:enumeration value="Single"/&gt;
                            &lt;xs:enumeration value="Double"/&gt;
                            &lt;xs:enumeration value="Twin"/&gt;
                            &lt;xs:enumeration value="Family"/&gt;
                            &lt;xs:enumeration value="Suite"/&gt;
                        &lt;/xs:restriction&gt;
                    &lt;/xs:simpleType&gt;
                &lt;/xs:element&gt;
                &lt;xs:element name="features"&gt;
                    &lt;xs:complexType&gt;
                        &lt;xs:sequence&gt;
                            &lt;xs:element name="feature" 
                            <span class="fm-code-continuation-arrow">➥</span>type="FeatureType" minOccurs="0"
                            maxOccurs="unbounded"/&gt;
                        &lt;/xs:sequence&gt;
                    &lt;/xs:complexType&gt;
                &lt;/xs:element&gt;
                &lt;xs:element name="image" type="xs:string"/&gt;
                &lt;xs:element name="roomNumber" type="xs:string"/&gt;
                &lt;xs:element name="roomPrice" type="xs:decimal"/&gt;
                &lt;xs:element name="roomid" type="xs:integer"/&gt;
            &lt;/xs:sequence&gt;
        &lt;/xs:complexType&gt;
    &lt;/xs:element&gt;
 
    &lt;xs:simpleType name="FeatureType"&gt;
        &lt;xs:restriction base="xs:string"&gt;
            &lt;xs:enumeration value="WiFi"/&gt;
            &lt;xs:enumeration value="TV"/&gt;
            &lt;xs:enumeration value="Radio"/&gt;
            &lt;xs:enumeration value="Refreshments"/&gt;
            &lt;xs:enumeration value="Safe"/&gt;
            &lt;xs:enumeration value="Views"/&gt;
        &lt;/xs:restriction&gt;
    &lt;/xs:simpleType&gt;
 
&lt;/xs:schema&gt;
###</pre>
</td>
</tr>
</tbody>
</table>
<p class="body">The prompt works in a manner similar to the one before. This prompt comes with an additional step to ensure that our test data is grouped by storing it under a single root node. But the rest of the prompt works the same, resulting in an XML output that is similar to the previous prompt that generated JSON data, as demonstrated in the response I got when I prompted ChatGPT for XML test data:<a id="marker-121"/></p>
<table border="0" class="contenttable-0-table" width="100%">
<colgroup class="contenttable-0-colgroup">
<col class="contenttable-0-col" span="1" width="7%"/>
<col class="contenttable-0-col" span="1" width="93%"/>
</colgroup>
<tbody class="contenttable-0-tbody">
<tr class="contenttable-0-tr">
<td class="contenttable-0-td">
<div class="figure2">
<p class="figure1"><img alt="" class="calibre7" height="40" src="../../OEBPS/Images/logo-openai.png" width="40"/></p>
</div>
</td>
<td class="contenttable-0-td">
<pre class="programlisting">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;rooms 
 xsi:noNamespaceSchemaLocation="schema.xsd"&gt;
    &lt;room&gt;
        &lt;accessible&gt;true&lt;/accessible&gt;
        &lt;description&gt;Cozy single room with a view&lt;/description&gt;
        &lt;type&gt;Single&lt;/type&gt;
        &lt;features&gt;
            &lt;feature&gt;WiFi&lt;/feature&gt;
            &lt;feature&gt;TV&lt;/feature&gt;
            &lt;feature&gt;Views&lt;/feature&gt;
        &lt;/features&gt;
        &lt;image&gt;single_room.jpg&lt;/image&gt;
        &lt;roomNumber&gt;101&lt;/roomNumber&gt;
        &lt;roomPrice&gt;89.99&lt;/roomPrice&gt;
        &lt;roomid&gt;1001&lt;/roomid&gt;
    &lt;/room&gt;
    &lt;room&gt;
        &lt;accessible&gt;false&lt;/accessible&gt;
        &lt;description&gt;Luxurious suite with all amenities&lt;/description&gt;
        &lt;type&gt;Suite&lt;/type&gt;
        &lt;features&gt;
            &lt;feature&gt;WiFi&lt;/feature&gt;
            &lt;feature&gt;TV&lt;/feature&gt;
            &lt;feature&gt;Safe&lt;/feature&gt;
            &lt;feature&gt;Refreshments&lt;/feature&gt;
            &lt;feature&gt;Views&lt;/feature&gt;
        &lt;/features&gt;
        &lt;image&gt;suite_room.jpg&lt;/image&gt;
        &lt;roomNumber&gt;201&lt;/roomNumber&gt;
        &lt;roomPrice&gt;349.99&lt;/roomPrice&gt;
        &lt;roomid&gt;1002&lt;/roomid&gt;
    &lt;/room&gt;
    &lt;room&gt;
        &lt;accessible&gt;true&lt;/accessible&gt;
        &lt;description&gt;Spacious family room for a comfortable 
stay&lt;/description&gt;
        &lt;type&gt;Family&lt;/type&gt;
        &lt;features&gt;
            &lt;feature&gt;WiFi&lt;/feature&gt;
            &lt;feature&gt;TV&lt;/feature&gt;
            &lt;feature&gt;Radio&lt;/feature&gt;
            &lt;feature&gt;Safe&lt;/feature&gt;
        &lt;/features&gt;
        &lt;image&gt;family_room.jpg&lt;/image&gt;
        &lt;roomNumber&gt;301&lt;/roomNumber&gt;
        &lt;roomPrice&gt;179.99&lt;/roomPrice&gt;
        &lt;roomid&gt;1003&lt;/roomid&gt;
    &lt;/room&gt;
&lt;/rooms&gt;</pre>
</td>
</tr>
</tbody>
</table>
<p class="body">These types of prompts can be extremely useful when we need to create test data for NoSQL databases. I remember once working on a project with XML documents that included more than 1,000 elements. It was practically impossible to generate all the test data we required, so we had to compromise. But with an LLM and a prompt similar to the ones we’ve just looked at, the process of creating XML documents would have taken a matter of minutes.</p>
<div class="fm-sidebar-block">
<p class="fm-sidebar-title">Activity 6.3</p>
<p class="fm-sidebar-text">Use either an OpenAPI or XSD specification to create new test data. If you have access to the specifications, try them out. Alternatively, locate example specifications and try them out in a prompt to generate test data.</p>
</div>
<h3 class="fm-head1" id="heading_id_8">6.2.2 SQL exports as prompt guides</h3>
<p class="body">The prompts we’ve explored so far have created data entities that exist as a single entity, but it’s just as common to work with applications in which data is split into separate locations. For example, how would we prompt an LLM to create data for a SQL-based database that contained data distributed across multiple tables?<a id="idIndexMarker030"/><a id="idIndexMarker031"/><a id="marker-122"/><a id="idIndexMarker032"/></p>
<p class="body">One method is to take an alternative approach using the few-shot tactic (providing examples to a prompt) and provide the structure of a database, along with examples, to demonstrate what data is created and where. Take for example the following prompt requesting SQL data to be generated across two different tables. First, we set out the initial instructions for the prompt using delimiter and structured format tactic:</p>
<table border="0" class="contenttable-0-table" width="100%">
<colgroup class="contenttable-0-colgroup">
<col class="contenttable-0-col" span="1" width="7%"/>
<col class="contenttable-0-col" span="1" width="93%"/>
</colgroup>
<tbody class="contenttable-0-tbody">
<tr class="contenttable-0-tr">
<td class="contenttable-0-td">
<div class="figure2">
<p class="figure1"><img alt="" class="calibre7" height="40" src="../../OEBPS/Images/logo-MW.png" width="40"/></p>
</div>
</td>
<td class="contenttable-0-td">
<p class="body-table">You are a SQL generator. Take the sql statement delimited by three hashes and create a SQL statement that generates 5 new records that follow the format of the provided statement.</p>
</td>
</tr>
</tbody>
</table>
<p class="body">We then have the LLM work out the solution before sharing the output:</p>
<table border="0" class="contenttable-0-table" width="100%">
<colgroup class="contenttable-0-colgroup">
<col class="contenttable-0-col" span="1" width="7%"/>
<col class="contenttable-0-col" span="1" width="93%"/>
</colgroup>
<tbody class="contenttable-0-tbody">
<tr class="contenttable-0-tr">
<td class="contenttable-0-td">
<div class="figure2">
<p class="figure1"><img alt="" class="calibre7" height="40" src="../../OEBPS/Images/logo-MW.png" width="40"/></p>
</div>
</td>
<td class="contenttable-0-td">
<p class="body-table">Check that each new entry doesn’t match the provided SQL statement before outputting the newly generated data and that the SQL can be executed successfully before outputting it.</p>
</td>
</tr>
</tbody>
</table>
<p class="body">Finally, we provide the SQL for each table for the LLM to process</p>
<table border="0" class="contenttable-0-table" width="100%">
<colgroup class="contenttable-0-colgroup">
<col class="contenttable-0-col" span="1" width="7%"/>
<col class="contenttable-0-col" span="1" width="93%"/>
</colgroup>
<tbody class="contenttable-0-tbody">
<tr class="contenttable-0-tr">
<td class="contenttable-0-td">
<div class="figure2">
<p class="figure1"><img alt="" class="calibre7" height="40" src="../../OEBPS/Images/logo-MW.png" width="40"/></p>
</div>
</td>
<td class="contenttable-0-td">
<pre class="programlisting">###
CREATE TABLE rooms (roomid int NOT NULL AUTO_INCREMENT, room_name
<span class="fm-code-continuation-arrow">➥</span>varchar(255), type varchar(255), beds int, accessible boolean,
<span class="fm-code-continuation-arrow">➥</span>image varchar(2000), description varchar(2000),
<span class="fm-code-continuation-arrow">➥</span>features varchar(100) ARRAY, roomPrice int, primary key (roomid));
 
INSERT INTO rooms (room_name, type, beds, accessible, image,
<span class="fm-code-continuation-arrow">➥</span>description, features, roomPrice) VALUES ('101', 'single', 1, 
<span class="fm-code-continuation-arrow">➥</span>true, 'https://www.mwtestconsultancy.co.uk/img/testim/room2.jpg',
<span class="fm-code-continuation-arrow">➥</span>'Aenean porttitor mauris sit amet lacinia molestie. In posuere
<span class="fm-code-continuation-arrow">➥</span>accumsan aliquet. Maecenas sit amet nisl massa. Interdum et
<span class="fm-code-continuation-arrow">➥</span>malesuada fames ac ante.', ARRAY['TV', 'WiFi', 'Safe'], 100);
 
CREATE TABLE bookings (bookingid int NOT NULL AUTO_INCREMENT, roomid
<span class="fm-code-continuation-arrow">➥</span>int, firstname varchar(255), lastname varchar(255),
<span class="fm-code-continuation-arrow">➥</span>depositpaid boolean, checkin date, checkout date,
<span class="fm-code-continuation-arrow">➥</span>primary key (bookingid), FOREIGN KEY (roomid) REFERENCES
<span class="fm-code-continuation-arrow">➥</span>ROOMS(roomid));
 
INSERT INTO bookings (roomid, firstname, lastname, depositpaid,
<span class="fm-code-continuation-arrow">➥</span>checkin, checkout) VALUES (1, 'James', 'Dean', true, '2022-02-01',
<span class="fm-code-continuation-arrow">➥</span>'2022-02-05');
###</pre>
</td>
</tr>
</tbody>
</table>
<p class="body">In this prompt, we’ve provided SQL statements for two different tables connected via the <code class="fm-code-in-text">roomid</code>. The first is the <code class="fm-code-in-text">rooms</code> table, which has the following attributes (laid out in a more readable format):<a id="marker-123"/><a id="idIndexMarker033"/></p>
<table border="0" class="contenttable-0-table" width="100%">
<colgroup class="contenttable-0-colgroup">
<col class="contenttable-0-col" span="1" width="7%"/>
<col class="contenttable-0-col" span="1" width="93%"/>
</colgroup>
<tbody class="contenttable-0-tbody">
<tr class="contenttable-0-tr">
<td class="contenttable-0-td">
<div class="figure2">
<p class="figure1"><img alt="" class="calibre7" height="40" src="../../OEBPS/Images/logo-MW.png" width="40"/></p>
</div>
</td>
<td class="contenttable-0-td">
<pre class="programlisting">roomid int NOT NULL AUTO_INCREMENT,
room_name varchar(255),
type varchar(255),
beds int,
accessible boolean,
image varchar(2000),
description varchar(2000),
features varchar(100) ARRAY,
roomPrice int,
primary key (roomid)</pre>
</td>
</tr>
</tbody>
</table>
<p class="body">And the second is the <code class="fm-code-in-text">bookings</code> table:<a id="idIndexMarker034"/></p>
<table border="0" class="contenttable-0-table" width="100%">
<colgroup class="contenttable-0-colgroup">
<col class="contenttable-0-col" span="1" width="7%"/>
<col class="contenttable-0-col" span="1" width="93%"/>
</colgroup>
<tbody class="contenttable-0-tbody">
<tr class="contenttable-0-tr">
<td class="contenttable-0-td">
<div class="figure2">
<p class="figure1"><img alt="" class="calibre7" height="40" src="../../OEBPS/Images/logo-MW.png" width="40"/></p>
</div>
</td>
<td class="contenttable-0-td">
<pre class="programlisting">bookingid int NOT NULL AUTO_INCREMENT,
roomid int,
firstname varchar(255),
lastname varchar(255),
depositpaid boolean,
checkin date,
checkout date,
primary key (bookingid),
FOREIGN KEY (roomid) REFERENCES ROOMS(roomid)</pre>
</td>
</tr>
</tbody>
</table>
<p class="body">Providing the LLM with both <code class="fm-code-in-text">CREATE</code> and <code class="fm-code-in-text">INSERT</code> statements helps maximize the desired output, ensuring not only that the correct type of test data is created, but also that the relationship between data sets is correct. If we were to provide only insert statements, we’d be providing less context and increasing the risk of foreign keys being populated with relationships to nonexistent records.<a id="idIndexMarker035"/><a id="idIndexMarker036"/></p>
<p class="body">Sending this prompt to ChatGPT returned the following response:</p>
<table border="0" class="contenttable-0-table" width="100%">
<colgroup class="contenttable-0-colgroup">
<col class="contenttable-0-col" span="1" width="7%"/>
<col class="contenttable-0-col" span="1" width="93%"/>
</colgroup>
<tbody class="contenttable-0-tbody">
<tr class="contenttable-0-tr">
<td class="contenttable-0-td">
<div class="figure2">
<p class="figure1"><img alt="" class="calibre7" height="40" src="../../OEBPS/Images/logo-openai.png" width="40"/></p>
</div>
</td>
<td class="contenttable-0-td">
<pre class="programlisting">-- Generate new rooms records
INSERT INTO rooms (room_name, type, beds, accessible, image,
 description, features, roomPrice) VALUES 
  ('102', 'double', 2, true, 'https://www.example.com/image1.jpg',
 'Lorem ipsum dolor sit amet, consectetur adipiscing elit.',
 ARRAY['TV', 'WiFi'], 150),
  ('103', 'single', 1, false, 'https://www.example.com/image2.jpg',
 'Nulla facilisi. Sed at lorem nec elit rhoncus tristique.',
 ARRAY['WiFi', 'Safe'], 120),
  ('104', 'suite', 3, true, 'https://www.example.com/image3.jpg',
 'Pellentesque fermentum tortor a dui interdum, ut efficitur felis
 pharetra.', ARRAY['TV', 'Safe', 'Minibar'], 220),
  ('105', 'double', 2, false, 'https://www.example.com/image4.jpg',
 'Vestibulum non tortor sit amet lacus mattis efficitur.',
 ARRAY['WiFi'], 160),
  ('106', 'single', 1, true, 'https://www.example.com/image5.jpg',
 'Fusce ut ligula nec ligula auctor tincidunt vel sit amet dui.',
 ARRAY['TV', 'WiFi'], 130);
 
-- Generate new bookings records
INSERT INTO bookings (roomid, firstname, lastname, depositpaid,
 checkin, checkout) VALUES 
  (2, 'Emma', 'Watson', true, '2023-08-15', '2023-08-20'),
  (3, 'John', 'Smith', false, '2023-09-01', '2023-09-05'),
  (4, 'Sophia', 'Johnson', true, '2023-08-25', '2023-08-30'),
  (5, 'Michael', 'Williams', false, '2023-09-10', '2023-09-15'),
  (6, 'Olivia', 'Brown', true, '2023-09-20', '2023-09-25');</pre>
</td>
</tr>
</tbody>
</table>
<p class="body">The test data inserted is similar to the responses from other prompts, but there is now the addition of <code class="fm-code-in-text">roomid</code> values using ids that connect the bookings to existing rooms, which have also been generated in the response.<a id="idIndexMarker037"/><a id="marker-124"/></p>
<p class="body">What these prompts have demonstrated is that if we have data that contains complex relationships or many different parameters, we can use existing documentation to assist test data generation. This is not only a great time saver but also an approach that ensures our test data generation can stay in lockstep with the structure of our data at any given time, saving us even more time in test data maintenance.</p>
<div class="fm-sidebar-block">
<p class="fm-sidebar-title">Don’t forget data privacy</p>
<p class="fm-sidebar-text">In the examples provided in this chapter, we’ve used dummy data structures and specifications, but when we create test data for our applications it’s likely that we’ll rely on either our organization’s intellectual property or user data. If we are to use those items to create our test data, we need to make sure that we aren’t violating internal policies for sharing intellectual property or laws around user data privacy. Depending on what we can and can’t share will determine how we frame our prompts.<a id="idIndexMarker038"/></p>
</div>
<div class="fm-sidebar-block">
<p class="fm-sidebar-title">Activity 6.4</p>
<p class="fm-sidebar-text">Use the SQL prompt to create your own test data. Try either locating SQL from an application you are working on or using example SQL to see what happens.</p>
</div>
<h2 class="fm-head" id="heading_id_9">6.3 Setting up LLMs as test data managers</h2>
<p class="body">We’ve examined how to create data by sending prompts through tools such as ChatGPT. But how can we go about integrating these types of prompts into our automated checks? Let’s take a look at the potential of accessing LLMs via API platforms by enhancing this simple UI automated check with data generation from an LLM model:<a id="idIndexMarker039"/><a id="marker-125"/><a id="idIndexMarker040"/><a id="idIndexMarker041"/></p>
<pre class="programlisting">@Test
public void exampleContactUsFormTest() throws InterruptedException {</pre>
<p class="body">We use Selenium to open a webpage:</p>
<pre class="programlisting">    driver.get("https://automationintesting.online/#/");</pre>
<p class="body">Next, we complete the Contact Us form on the webpage:</p>
<pre class="programlisting">    ContactFormPage contactFormPage = new ContactFormPage(driver);
    contactFormPage.enterName("John Smith");
    contactFormPage.enterEmail("john@example.com");
    contactFormPage.enterPhone("01234567890");
    contactFormPage.enterSubject("Test Subject");
    contactFormPage.enterDescription("This is a test message");
    contactFormPage.clickSubmitButton();</pre>
<p class="body">Then we assert that the contact form page has been submitted:</p>
<pre class="programlisting">    assert contactFormPage.getSuccessMessage().contains("Thanks for getting
    <span class="fm-code-continuation-arrow">➥</span>in touch");</pre>
<p class="body">With this automated check, we’re going to replace the hardcoded strings used to complete the contact form and instead connect to the OpenAI API platform and prompt one of their LLM models to create test data that we can then parse and use in our check. Examples of the initial and completed OpenAI integrated check can be found in the supporting repository at <a class="url" href="https://mng.bz/n0dv">https://mng.bz/n0dv</a>.</p>
<h3 class="fm-head1" id="heading_id_10">6.3.1 Setting up an OpenAI account</h3>
<p class="body">Before we can start sending prompts using the OpenAI API platform, we’ll need to set up an account. This can be done by registering via <a class="url" href="https://platform.openai.com/">https://platform.openai.com/</a>.<a id="idIndexMarker042"/><a id="idIndexMarker043"/><a id="idIndexMarker044"/></p>
<div class="fm-sidebar-block">
<p class="fm-sidebar-title">OpenAI platform costs</p>
<p class="fm-sidebar-text">OpenAI charges based on the number of tokens you send to and receive from an LLM. A <i class="fm-italics">token</i> is essentially a word or collection of smaller words. For example, “Hello ChatGPT” would count as two tokens. The more tokens you use, meaning the bigger the prompts and content you receive back, the more it costs. If you are registering for a new account with OpenAI at this point, they will give you $5 in free credit that can be used during your first three months. This is more than enough for what we need to complete our exercise. However, since the free credit expires after three months, if you have no free credits left, you will need to provide billing details before you can send and receive prompts: <a class="url" href="https://mng.bz/vJRx">https://mng.bz/vJRx</a>. Also, you are strongly advised to set a usage limit that works best for you so that you don’t end up with a surprising bill: <a class="url" href="https://platform.openai.com/account/billing/limits">https://platform.openai.com/account/billing/limits</a>.</p>
</div>
<p class="body">Once registered, we need to generate an API key that we’ll provide in our requests to authenticate ourselves. This can be done via <a class="url" href="https://platform.openai.com/account/api-keys">https://platform.openai.com/account/api-keys</a> and clicking the Create New Secret Key button, which asks us to give our API key a name. Upon entering a name and clicking the Create key, we’ll be given an API key, as shown in figure 6.1.</p>
<div class="figure">
<p class="figure1"><img alt="" class="calibre25" src="../../OEBPS/Images/CH06_F01_Winteringham2.png"/></p>
<p class="figurecaption">Figure 6.1 A newly created API key for the Open API platform</p>
</div>
<p class="body">As the instructions state, we need to record this API key elsewhere for future use as we’ll not be able to view it again. So, we make a note of the key and then click Done to make sure our key has been saved, as shown in figure 6.2.<a id="marker-126"/></p>
<div class="figure">
<p class="figure1"><img alt="" class="calibre26" src="../../OEBPS/Images/CH06_F02_Winteringham2.png"/></p>
<p class="figurecaption">Figure 6.2 Screen shot of the API key manager for the OpenAI API platform</p>
</div>
<p class="body">With our key created and recorded, we’re ready to begin work on integrating OpenAI into our project.</p>
<h3 class="fm-head1" id="heading_id_11">6.3.2 Connecting to OpenAI</h3>
<p class="body">Our first step is to build the necessary code to send an HTTP request to OpenAI and confirm that we can get a response back. So, we begin by adding the following library into our <code class="fm-code-in-text">pom.xml</code> that we’ll use to send our request:<a id="idIndexMarker045"/><a id="marker-127"/><a id="idIndexMarker046"/><a id="idIndexMarker047"/></p>
<pre class="programlisting">&lt;dependency&gt;
    &lt;groupId&gt;dev.langchain4j&lt;/groupId&gt;
    &lt;artifactId&gt;langchain4j-open-ai&lt;/artifactId&gt;
    &lt;version&gt;0.31.0&lt;/version&gt;
&lt;/dependency&gt;</pre>
<p class="body">LangChain4j is a Java implementation of the popular LangChain toolset that’s written in Python. It offers a collection of tools that can be used to integrate with different LLMs. For our example test, we’ll be relying on OpenAI’s GPT models to generate our test data. So, we’ll use the OpenAI specific version of LangChain to get basic access to sending a prompt. However, if we wanted more control or options, we could use the full AI services version of LangChain.</p>
<div class="fm-sidebar-block">
<p class="fm-sidebar-title">gpt-3.5-turbo and other models</p>
<p class="fm-sidebar-text">One of the features offered by the OpenAI API platform is the ability to send prompts to different LLM models. gpt-3.5-turbo is the model that is, at the time of writing, used to power the free version of ChatGPT. As we’ll learn, we can swap this out to call other models such as gpt-4o. Different models offer different features at different price points. For example, gpt-4o is a more effective LLM compared to gpt-3.5-turbo. However, the price point to use gpt-4o is much higher. More details on other models can be found in the OpenAI platform documentation at <a class="url" href="https://platform.openai.com/docs/models/overview">https://platform.openai.com/docs/models/overview</a>.</p>
</div>
<p class="body">With the necessary libraries installed, our next step is to build a prompt that will request an LLM to generate our required test data. The initial instructions use the structured output and delimiter tactics:</p>
<table border="0" class="contenttable-0-table" width="100%">
<colgroup class="contenttable-0-colgroup">
<col class="contenttable-0-col" span="1" width="7%"/>
<col class="contenttable-0-col" span="1" width="93%"/>
</colgroup>
<tbody class="contenttable-0-tbody">
<tr class="contenttable-0-tr">
<td class="contenttable-0-td">
<div class="figure2">
<p class="figure1"><img alt="" class="calibre7" height="40" src="../../OEBPS/Images/logo-MW.png" width="40"/></p>
</div>
</td>
<td class="contenttable-0-td">
<p class="body-table">You are a data generator. Create me random data in a JSON format based on the criteria delimited by three hashes. Additional data requirements are shared between back ticks.</p>
</td>
</tr>
</tbody>
</table>
<p class="body">Data to be processed is added with additional instructions:</p>
<table border="0" class="contenttable-0-table" width="100%">
<colgroup class="contenttable-0-colgroup">
<col class="contenttable-0-col" span="1" width="7%"/>
<col class="contenttable-0-col" span="1" width="93%"/>
</colgroup>
<tbody class="contenttable-0-tbody">
<tr class="contenttable-0-tr">
<td class="contenttable-0-td">
<div class="figure2">
<p class="figure1"><img alt="" class="calibre7" height="40" src="../../OEBPS/Images/logo-MW.png" width="40"/></p>
</div>
</td>
<td class="contenttable-0-td">
<p class="body-table">###</p>
<p class="body-table">name</p>
<p class="body-table">email</p>
<p class="body-table">phone `UK format`</p>
<p class="body-table">subject `Over 20 characters in length`</p>
<p class="body-table">description `Over 50 characters in length`</p>
<p class="body-table">###</p>
</td>
</tr>
</tbody>
</table>
<p class="body">We can test this prompt by adding it and the necessary code to send the prompt into a new automated check:</p>
<pre class="programlisting">@Test
public void exampleContactUsFormTestWithGPT() {</pre>
<p class="body">We create a new OpenAIChat model and provide an API key:</p>
<pre class="programlisting">OpenAiChatModel model = OpenAiChatModel.withApiKey("Enter API key");</pre>
<p class="body">Then we add our prompt to a string:</p>
<pre class="programlisting">String prompt = """
        You are a data generator. Create me random data in a
        JSON format based on the criteria delimited by three hashes.
        Additional data requirements are shared between back ticks.
        ###
        name
        email
        phone `UK format`
        subject `Over 20 characters in length`
        description `Over 50 characters in length`
        ###
        """;</pre>
<p class="body"><a id="marker-128"/>Finally, we send the prompt to a GPT model and store the response in a string:</p>
<pre class="programlisting">String testData = model.generate(prompt);

System.out.println(testData);
}</pre>
<p class="body">Running the check again, we’ll see the LLM returns something similar to</p>
<table border="0" class="contenttable-0-table" width="100%">
<colgroup class="contenttable-0-colgroup">
<col class="contenttable-0-col" span="1" width="7%"/>
<col class="contenttable-0-col" span="1" width="93%"/>
</colgroup>
<tbody class="contenttable-0-tbody">
<tr class="contenttable-0-tr">
<td class="contenttable-0-td">
<div class="figure2">
<p class="figure1"><img alt="" class="calibre7" height="40" src="../../OEBPS/Images/logo-openai.png" width="40"/></p>
</div>
</td>
<td class="contenttable-0-td">
<pre class="programlisting">{
  "name": "John Doe",
  "email": "johndoe@example.com",
  "phone": "+44 1234 567890",
  "subject": "Lorem ipsum dolor sit amet consectetur",
  "description": "Lorem ipsum dolor sit amet, consectetur adipiscing
  <span class="fm-code-continuation-arrow">➥</span>elit. Suspendisse aliquet, tortor eu aliquet tincidunt, erat mi.»
}</pre>
</td>
</tr>
</tbody>
</table>
<p class="body">Next, we’ll need to parse this into a Java object, so we create a new class <code class="fm-code-in-text">ContactFormDetails</code> that can convert the JSON into an object:<a id="idIndexMarker048"/></p>
<pre class="programlisting">public class ContactFormDetails {
    
    private String name;
    private String email;
    private String phone;
    private String subject;
    private String description;
 
    public ContactFormDetails(String name, String email,
    <span class="fm-code-continuation-arrow">➥</span>String phone, String subject, String description) {
        this.name = name;
        this.email = email;
        this.phone = phone;
        this.subject = subject;
        this.description = description;
    }
    
    public String getName() {
        return name;
    }
    
    public String getEmail() {
        return email;
    }
    
    public String getPhone() {
        return phone;
    }
    
    public String getSubject() {
        return subject;
    }
    
    public String getDescription() {
        return description;
    }
}</pre>
<p class="body">With our <code class="fm-code-in-text">ContactFormDetails</code> class created, we can now convert the prompt response, which is currently a string, into a POJO for further use:<a id="idIndexMarker049"/><a id="marker-129"/></p>
<pre class="programlisting">OpenAiChatModel model = OpenAiChatModel.<i class="fm-italics">withApiKey</i>("Enter API key");
String prompt = """
        You are a data generator. Create me random data in a
        JSON format based on the criteria delimited by three hashes.
        Additional data requirements are shared between back ticks.
        ###
        name
        email
        phone `UK format`
        subject `Over 20 characters in length`
        description `Over 50 characters in length`
        ###
        """;
 
String testData = model.generate(prompt);
 
ContactFormDetails contactFormDetails = 
<span class="fm-code-continuation-arrow">➥</span>new Gson().fromJson(testData, ContactFormDetails.class);</pre>
<p class="body">We now have the necessary test data to use in our automated check:</p>
<pre class="programlisting">@Test
public void exampleContactUsFormTestWithGPT() {</pre>
<p class="body">The following block of code sends a prompt to OpenAI to generate test data:</p>
<pre class="programlisting">OpenAiChatModel model = OpenAiChatModel.<i class="fm-italics">withApiKey</i>("Enter API key");
String prompt = """
        You are a data generator. Create me random data in a
        JSON format based on the criteria delimited by three hashes.
        Additional data requirements are shared between back ticks.
        ###
        name
        email
        phone `UK format`
        subject `Over 20 characters in length`
        description `Over 50 characters in length`
        ###
        """;
 
String testData = model.generate(prompt);</pre>
<p class="body">Next, we extract the test data from the responses and convert it into an object:</p>
<pre class="programlisting">ContactFormDetails contactFormDetails = 
<span class="fm-code-continuation-arrow">➥</span>new Gson().fromJson(testData, ContactFormDetails.class);

<i class="fm-italics">driver</i>.get("https://automationintesting.online/#/");</pre>
<p class="body"><a id="marker-130"/>Then we use the test data to complete the Contact Us form and assert success:</p>
<pre class="programlisting">ContactFormPage contactFormPage = new ContactFormPage(<i class="fm-italics">driver</i>);
contactFormPage.enterName(contactFormDetails.getName());
contactFormPage.enterEmail(contactFormDetails.getEmail());
contactFormPage.enterPhone(contactFormDetails.getPhone());
contactFormPage.enterSubject(contactFormDetails.getSubject());
contactFormPage.enterDescription(contactFormDetails.getDescription());
contactFormPage.clickSubmitButton();
 
assert contactFormPage.getSuccessMessage()
       <span class="fm-code-continuation-arrow">➥</span>.contains("Thanks for getting in touch");</pre>
<p class="body">This completes the integration of the OpenAI API platform into our automated check. Upon executing the check, we should see it pass and that test data has been successfully used to create a contact message, as shown in figure 6.3.</p>
<p class="body">We could improve the code further by perhaps storing prompts in external files and importing them into our checks when required. This may be beneficial when prompts are used on multiple occasions. It would also mean that when changes are required for test data, we would simply update our prompts with new details in a way that anyone, regardless of the experience of working with test data, could do.</p>
<div class="figure">
<p class="figure1"><img alt="" class="calibre27" src="../../OEBPS/Images/CH06_F03_Winteringham2.png"/></p>
<p class="figurecaption">Figure 6.3 A message created using LLM test data</p>
</div>
<div class="fm-sidebar-block">
<p class="fm-sidebar-title">Activity 6.5</p>
<p class="fm-sidebar-text">Create a new automated check that requires inputting test data. Using the prompt method, create a new prompt to generate test data and then pass it through your automated check.<a id="idIndexMarker050"/><a id="idIndexMarker051"/><a id="idIndexMarker052"/><a id="idIndexMarker053"/><a id="idIndexMarker054"/><a id="idIndexMarker055"/></p>
</div>
<h2 class="fm-head" id="heading_id_12">6.4 Benefiting from generated test data</h2>
<p class="body"><a id="marker-131"/>This chapter demonstrated that LLMs can be quite adept at generating test data. It can help us quickly create data for various testing activities from automation to exploratory testing, support managing complex data sets, and simplify the process of managing test data using natural language prompts. However, for this, we need to create prompts that provide clear instructions about the format we want data in and what examples to draw from, ensuring that what we’re sending to an LLM doesn’t impact personal and organizational privacy. Going back to our area of effect model, we can see the roles of humans and AI in test data generation described in figure 6.4.<a id="idIndexMarker056"/><a id="idIndexMarker057"/></p>
<div class="figure">
<p class="figure1"><img alt="" class="calibre28" src="../../OEBPS/Images/CH06_F04_Winteringham2.png"/></p>
<p class="figurecaption">Figure 6.4 The area of effect model describing the roles of humans and AI in test data generation</p>
</div>
<p class="body">By using the tactics we’ve learned with prompt engineering in a creative manner, we can create test data for a wide range of situations, from simple to complex, to help us save time in test data management.</p>
<h2 class="fm-head" id="heading_id_13">Summary</h2>
<ul class="calibre5">
<li class="fm-list-bullet">
<p class="list">Prompts can be built to rapidly generate data in any common format (JSON, XML, or SQL, for example).</p>
</li>
<li class="fm-list-bullet">
<p class="list">The relationship between data can sometimes be incorrect if not explicitly set in a prompt.</p>
</li>
<li class="fm-list-bullet">
<p class="list">Prompts can also be built to transform data from one format into another, while ensuring the raw data from an original format is copied over.</p>
</li>
<li class="fm-list-bullet">
<p class="list">We can use data specification formats such as OpenAPI and XSD in prompts to set our expectations of how data is structured.</p>
</li>
<li class="fm-list-bullet">
<p class="list">Using SQL statements that create the initial structure of a database can be used to prompt LLMs when working with distributed data structures.</p>
</li>
<li class="fm-list-bullet">
<p class="list">OpenAI offers an API platform that can be used to interact with different AI models, including gpt-3.5 and gpt-4o.</p>
</li>
<li class="fm-list-bullet">
<p class="list">We can programmatically build HTTP requests to send prompts to OpenAI LLMs to generate test data.</p>
</li>
<li class="fm-list-bullet">
<p class="list"><a id="marker-132"/>Prompting LLMs for test data requires building clear prompts with explicit expectations and useful examples.</p>
</li>
</ul>
</div></body></html>