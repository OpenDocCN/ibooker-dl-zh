["```py\ndf.head()\n```", "```py\ndf.shape\n```", "```py\ndf.info()\n```", "```py\ndf.describe()\n```", "```py\ndf.isna().sum()\n```", "```py\ndf['column_name'].value_counts()\n```", "```py\nimport pandas as pd\n\ndf_customers = pd.read_csv('olist_customers_dataset.csv')\ndf_order_items = pd.read_csv('olist_order_items_dataset.csv')\ndf_order_payments = pd.read_\ncsv('olist_order_payments_dataset.csv')\ndf_order_reviews = pd.read_csv('olist_order_reviews_dataset.csv')\ndf_orders = pd.read_csv('olist_orders_dataset.csv')\ndf_products = pd.read_csv('olist_products_dataset.csv')Jupyter\ndf_sellers = pd.read_csv('olist_sellers_dataset.csv')\ndf_product_category_translation = \n↪pd.read_csv('product_category_name_translation.csv')\n```", "```py\nimport pandas as pd\n\n*# Sample DataFrame*\ndata = {'customer_id': [1, 2, 3, 4, 2],\n        'order_id': [101, 102, 103, 104, 105]}\n\ndf = pd.DataFrame(data)\n\n*# Count orders per customer*\norder_counts = df['customer_id'].value_counts()\n\n*# Check if any customer made more than one order*\nif order_counts.max() > 1:\n    print(\"There are customers with more than one order.\")\nelse:\n    print(\"Every customer made just one order.\")\n```", "```py\nimport pandas as pd\n\n*# Sample DataFrame*\ndata = {'customer_id': [1, 2, 3, 4, 5],\n        'customer_unique_id': [1001, 1002, 1002, 1004, 1004]}\n\ndf = pd.DataFrame(data)\n\n*# Check the number of unique values in each column*\nunique_customer_ids = df['customer_id'].nunique()\nunique_customer_unique_ids = df['customer_unique_id'].nunique()\n\nprint(f\"Unique customer_id values: {unique_customer_ids}\")\nprint(f\"Unique customer_unique_id values: {unique_customer_unique_ids}\")\n\n*# Check the relationship between the two columns*\nrelationship = df.groupby('customer_unique_id')['customer_id'].nunique()\n\nprint(\"\\nRelationship between customer_unique_id and customer_id:\")\nprint(relationship)\n```", "```py\nimport pandas as pd\n\n*# Sample DataFrame*\ndata = {'customer_id': [1, 2, 3, 4, 5, 6, 7],\n        'customer_unique_id': [1001, 1002, 1002, 1004, 1004, 1001, 1004]}\n\ndf = pd.DataFrame(data)\n\n*# Check the number of unique values in each column*\nunique_customer_ids = df['customer_id'].nunique()\nunique_customer_unique_ids = df['customer_unique_id'].nunique()\n\nprint(f\"Unique customer_id values: {unique_customer_ids}\")\nprint(f\"Unique customer_unique_id values: {unique_customer_unique_ids}\")\n\n*# Check the relationship between the two columns*\nrelationship = df.groupby('customer_unique_id')['customer_id'].nunique()\n\nprint(\"\\nSummary of the relationship between customer_unique_id and\n↪customer_id:\")\nprint(f\"Min: {relationship.min()}\")\nprint(f\"Max: {relationship.max()}\")\nprint(f\"Mean: {relationship.mean()}\")\nprint(f\"Count of unique customer_id values per\n↪customer_unique_id:\\n{relationship.value_counts().sort_index()}\")\n```", "```py\nUnique customer_id values: 99441\nUnique customer_unique_id values: 96096\n\nSummary of the relationship between customer_unique_id and customer_id:\nMin: 1\nMax: 17\nMean: 1.0348089410589412\nCount of unique customer_id values per customer_unique_id:\n1     93099\n2      2745\n3       203\n4        30\n5         8\n6         6\n7         3\n9         1\n17        1\nName: customer_id, dtype: int64\n```", "```py\nimport pandas as pd\n\n*# Sample DataFrame with duplicate rows*\ndata = {'A': [1, 2, 2, 4, 5, 1],\n        'B': [6, 7, 7, 9, 10, 6]}\n\ndf = pd.DataFrame(data)\n\n*# Remove duplicate rows*\ndf_no_duplicates = df.drop_duplicates()\n\nprint(\"Original DataFrame:\")\nprint(df)\n\nprint(\"\\nDataFrame without duplicates:\")\nprint(df_no_duplicates)\n```", "```py\n*# Remove duplicates based on column 'A'*\ndf_no_duplicates = df.drop_duplicates(subset=['A'])\n\nprint(\"\\nDataFrame without duplicates based on column 'A':\")\nprint(df_no_duplicates)\n```", "```py\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n\n*# Sample DataFrame with missing values*\ndata = {'A': [1, None, 3, 4, None],\n        'B': [1, 2, None, 4, None],\n        'C': [None, 2, 3, None, 5],\n        'D': [1, 2, 3, 4, 5]}\n\nvdf = pd.DataFrame(data)\n\n*# Create a DataFrame indicating which values are missing*\nmissing_indicator = df.isna()\n\n*# Compute the correlation between the missing value indicators*\nmissing_corr = missing_indicator.corr()\n\n*# Visualize the correlation matrix using a heatmap*\nsns.heatmap(missing_corr, annot=True, cmap='coolwarm', vmin=-1, vmax=1)\nplt.title(\"Correlation of Missing Value Indicators\")\nplt.show()\n```", "```py\ndf_name['column_name'] = df_name.column_name.astype('datetime64[ns]')\n```", "```py\nforeign_key_violations = \n↪df_orders[~df_orders['order_id'].isin(df_order_payments['order_id'])]\nif not foreign_key_violations.empty:\n    print(\"Foreign key violations found:\")\n    print(foreign_key_violations)\n *# Handle violations (e.g., drop rows or correct the foreign key values)*\n```", "```py\nDataFrame name: df_order_reviews\n\nColumns:\n- review_id (object): \n↪Unique identifier of each review.\n- order_id (object): \n↪Identifier of the order being reviewed.\n- review_score (int64): \n↪Note ranging from 1 to 5 given by the customer on a satisfaction survey.\n- review_comment_title (object): \n↪Comment title from the review left by the customer in Portuguese.\n- review_comment_message (object): \n↪Comment message from the review left by the customer in Portuguese.\n- review_creation_date (datetime64[ns]): \n↪The timestamp of the review creation.\n- review_answer_timestamp  (datetime64[ns]): \n↪I am not sure what this one actually is.\n```", "```py\ndf_order_reviews['review_score'].value_counts().sort_index()\n↪.plot(kind='bar')\n```", "```py\ndf_order_reviews['review_creation_date'].dt.to_period('M').\nvalue_counts().sort_index().plot(kind='bar')\n```", "```py\ndf_order_reviews['response_time'] = \n↪df_order_reviews['review_answer_timestamp'] -\n↪df_order_reviews['review_creation_date']\n```", "```py\norder_review_counts = df_order_reviews['order_id'].value_counts()\nmultiple_review_orders = order_review_counts[order_review_counts > 1]\n```", "```py\nimport matplotlib.pyplot as plt\n\nplt.plot(df['timestamp'], df['value'])\nplt.xlabel('Timestamp')\nplt.ylabel('Value')\nplt.title('Time Series Data')\nplt.show()\n```", "```py\n<Dysfunctional code was here>\n```", "```py\n<Dysfunctional code was here>\n```", "```py\n<Dysfunctional code was here>\n```", "```py\n*# Create a new column with the timestamp at the desired frequency* \n↪*(e.g., daily)*\ndf_order_reviews['date_daily'] = \n↪df_order_reviews['review_creation_date'].dt.date\n```", "```py\n*# Group by date_daily and calculate the proportion of each score*\nscore_counts = df_order_reviews.groupby(['date_daily', \n↪'review_score']).size().unstack(fill_value=0)\nscore_proportions = score_counts.div(score_counts.sum(axis=1), axis=0)\n```", "```py\nscore_proportions.plot(kind='bar', stacked=True, figsize=(15, 6))\nplt.xlabel('Date')\nplt.ylabel('Proportion of Scores')\nplt.title('Proportion of Review Scores Over Time')\nplt.legend(title='Review Score', bbox_to_anchor=(1, 1))\nplt.show()\n```", "```py\n*# Create a new column with the timestamp at the desired frequency* \n↪*(e.g., monthly)*\ndf_order_reviews['month'] = \n↪df_order_reviews['review_creation_date'].dt.to_period('M')\n```", "```py\n*# Group by month and calculate the proportion of each score*\nscore_counts = df_order_reviews.groupby(['month', \n↪'review_score']).size().unstack(fill_value=0)\nscore_proportions = score_counts.div(score_counts.sum(axis=1), axis=0)\n```", "```py\nscore_proportions.plot(kind='bar', stacked=True, figsize=(15, 6))\nplt.xlabel('Month')\nplt.ylabel('Proportion of Scores')\nplt.title('Proportion of Review Scores Over Time (Monthly)')\nplt.legend(title='Review Score', bbox_to_anchor=(1, 1))\nplt.show()\n```", "```py\ndf_order_reviews['time_diff'] = \n↪(df_order_reviews['review_answer_timestamp'] – \n↪df_order_reviews['review_creation_date']).dt.total_seconds()\n```", "```py\ntime_diff_summary = df_order_reviews['time_diff'].describe()\nprint(time_diff_summary)\n```", "```py\nimport matplotlib.pyplot as plt\n*# Histogram*\ndf_order_reviews['time_diff'].plot(kind='hist', bins=50)\nplt.xlabel('Time Difference (Seconds)')\nplt.ylabel('Frequency')\nplt.title('Distribution of Time Difference Between Review Creation and \n↪Answer')\nplt.show()\n\n*# Box plot*\ndf_order_reviews['time_diff'].plot(kind='box', vert=False)\nplt.xlabel('Time Difference (Seconds)')\nplt.title('Box Plot of Time Difference Between Review Creation and\n↪Answer')\nplt.show()\n```", "```py\ncount    9.922400e+04\nmean     2.720730e+05\nstd      8.545003e+05\nmin      7.709000e+03\n25%      8.682075e+04\n50%      1.447155e+05\n75%      2.681480e+05\nmax      4.481561e+07\nName: time_diff, dtype: float64\n```", "```py\nmerged_df = df_order_reviews.merge(df_customers, on='customer_id', \n↪how='left')\n```", "```py\ndf_orders_reviews = merged_df\n```", "```py\norders_customers = df_orders.merge(df_customers, on='customer_id', \n↪how='left')\n```", "```py\nmerged_df = df_order_reviews.merge(orders_customers[['order_id', \n↪'customer_unique_id']], on='order_id', how='left')\n```", "```py\ndf_order_reviews = merged_df\n```", "```py\nunique_customers_per_order =\n↪df_order_reviews.groupby('order_id')['customer_unique_id'].nunique()\nmultiple_customers_orders =\nunique_customers_per_order[unique_customers_per_order > 1]\nif len(multiple_customers_orders) > 0:\n    print(f\"There are {len(multiple_customers_orders)} orders with reviews \n    ↪from multiple customers.\")\n    print(\"\\nOrder IDs and the number of unique customers:\")\n    print(multiple_customers_orders)\nelse:\n    print(\"There are no orders with reviews from multiple customers.\")\n```"]