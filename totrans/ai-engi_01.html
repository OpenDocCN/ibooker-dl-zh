<html><head></head><body><section class="pagenumrestart" data-pdf-bookmark="Chapter 1. Introduction to Building AI Applications with Foundation Models" data-type="chapter" epub:type="chapter"><div class="chapter" id="ch01_introduction_to_building_ai_applications_with_foun_1730130814984319">&#13;
      <h1><span class="label">Chapter 1. </span>Introduction to Building AI Applications with Foundation Models</h1>&#13;
<p><a contenteditable="false" data-primary="application building" data-type="indexterm" id="ch01.html0"/>If I could use only one word to describe AI post-2020, it’d be <em>scale</em>. The AI models behind applications like ChatGPT, Google’s Gemini, and Midjourney are at such a scale that they’re consuming <a href="https://oreil.ly/J0IyO">a nontrivial portion</a> of the world’s electricity, and we’re at risk of <a href="https://arxiv.org/abs/2211.04325">running out of publicly available internet data</a> to train them.</p>&#13;
<p>The scaling up of AI models has two major consequences. First, AI models are becoming more powerful and capable of more tasks, enabling more applications. More people and teams leverage AI to increase productivity, create economic value, and improve quality of life.</p>&#13;
<p>Second, training large language models (LLMs) requires data, compute resources, and specialized talent that only a few organizations can afford. This has led to the emergence of <em>model as a service</em>: models developed by these few organizations are made available for others to use as a service. Anyone who wishes to leverage AI to build applications can now use these models to do so without having to invest up front in building a model.</p>&#13;
<p>In short, the demand for AI applications has increased while the barrier to entry for building AI applications has decreased. This has turned <em>AI engineering</em>—the process of building applications on top of readily available models—into one of the fastest-growing engineering disciplines.</p>&#13;
<p>Building applications on top of machine learning (ML) models isn’t new. Long before LLMs became prominent, AI was already powering many applications, including product recommendations, fraud detection, and churn prediction. While many principles of productionizing AI applications remain the same, the new generation of large-scale, readily available models brings about new possibilities and new challenges, which are the focus of this book.</p>&#13;
<p>This chapter begins with an overview of foundation models, the key catalyst behind the explosion of AI engineering. I’ll then discuss a range of successful AI use cases, each illustrating what AI is good and not yet good at. As AI’s capabilities expand daily, predicting its future possibilities becomes increasingly challenging. However, existing application patterns can help uncover opportunities today and offer clues about how AI may continue to be used in the future.</p>&#13;
<p>To close out the chapter, I’ll provide an overview of the new AI stack, including what has changed with foundation models, what remains the same, and how the role of an AI engineer today differs from that of a traditional ML engineer.<sup><a data-type="noteref" href="ch01.html#id534" id="id534-marker">1</a></sup></p>&#13;
      <section data-pdf-bookmark="The Rise of AI Engineering" data-type="sect1"><div class="sect1" id="ch01_the_rise_of_ai_engineering_1730130814984854">&#13;
        <h1>The Rise of AI Engineering</h1>&#13;
<p><a contenteditable="false" data-primary="AI engineering (AIE)" data-secondary="rise of AI engineering" data-type="indexterm" id="ch01.html1"/><a contenteditable="false" data-primary="application building" data-secondary="rise of AI engineering" data-type="indexterm" id="ch01.html2"/>Foundation models emerged from large language models, which, in turn, originated as just language models. While applications like ChatGPT and GitHub’s Copilot may seem to have come out of nowhere, they are the culmination of decades of technology advancements, with the first language models emerging in the 1950s. This section traces the key breakthroughs that enabled the evolution from language models to AI engineering.</p>&#13;
        <section data-pdf-bookmark="From Language Models to Large Language Models" data-type="sect2"><div class="sect2" id="ch01_from_language_models_to_large_language_models_1730130814984966">&#13;
          <h2>From Language Models to Large Language Models</h2>&#13;
<p>While language models have been around for a while, they’ve only been able to grow to the scale they are today with <em>self-supervision.</em> This section gives a quick overview of what language model and self-supervision mean. If you’re already familiar with those, feel free to skip this section.</p>&#13;
          <section data-pdf-bookmark="Language models" data-type="sect3"><div class="sect3" id="ch01_language_models_1730130814985045">&#13;
            <h3>Language models</h3>&#13;
<p><a contenteditable="false" data-primary="language models" data-type="indexterm" id="ch01.html4"/>A <em>language model</em> encodes statistical information about one or more languages. Intuitively, this information tells us how likely a word is to appear in a given context. For example, given the context “My favorite color is __”, a language model that encodes English should predict “blue” more often than “car”.</p>&#13;
<p class="pagebreak-before">The statistical nature of languages was discovered centuries ago. In the 1905 story <a href="https://en.wikipedia.org/wiki/The_Adventure_of_the_Dancing_Men">“The Adventure of the Dancing Men”</a>, Sherlock Holmes leveraged simple statistical information of English to decode sequences of mysterious stick figures. Since the most common letter in English is <em>E</em>, Holmes deduced that the most common stick figure must stand for <em>E</em>.</p>&#13;
<p>Later on, Claude Shannon used more sophisticated statistics to decipher enemies’ messages during the Second World War. His work on how to model English was published in his 1951 landmark paper <a href="https://oreil.ly/G_HBp">“Prediction and Entropy of Printed English”</a>. Many concepts introduced in this paper, including entropy, are still used for language modeling today.</p>&#13;
<p>In the early days, a language model involved one language. However, today, a language model can involve multiple languages.</p>&#13;
<p><a contenteditable="false" data-primary="tokens" data-type="indexterm" id="id535"/>The basic unit of a language model is <em>token</em>. A token can be a character, a word, or a part of a word (like -tion), depending on the model.<sup><a data-type="noteref" href="ch01.html#id536" id="id536-marker">2</a></sup> For example, GPT-4, a model behind ChatGPT, breaks the phrase “I can’t wait to build AI applications” into nine tokens, as shown in <a data-type="xref" href="#ch01_figure_1_1730130814919858">Figure 1-1</a>. Note that in this example, the word “can’t” is broken into two tokens, <em>can</em> and <em>’t</em>. You can see how different OpenAI models tokenize text on the <a href="https://oreil.ly/0QI91">OpenAI website</a>.</p>&#13;
            <figure><div class="figure" id="ch01_figure_1_1730130814919858">&#13;
              <img alt="A close up of a sign&#10;&#10;Description automatically generated" src="assets/aien_0101.png"/>&#13;
              <h6><span class="label">Figure 1-1. </span>An example of how GPT-4 tokenizes a phrase.</h6>&#13;
            </div></figure>&#13;
<p><a contenteditable="false" data-primary="tokenization" data-secondary="defined" data-type="indexterm" id="id537"/>The process of breaking the original text into tokens is called <em>tokenization</em>. For GPT-4, an average token is approximately <a href="https://oreil.ly/EYccr">¾ the length of a word</a>. So, 100 tokens are approximately 75 words.</p>&#13;
<p><a contenteditable="false" data-primary="vocabulary" data-secondary="defined" data-type="indexterm" id="id538"/>The set of all tokens a model can work with is the model’s <em>vocabulary</em>. You can use a small number of tokens to construct a large number of distinct words, similar to how you can use a few letters in the alphabet to construct many words. The <a href="https://oreil.ly/bxMcW">Mixtral 8x7B</a> model has a vocabulary size of 32,000. GPT-4’s vocabulary size is <a href="https://github.com/openai/tiktoken/blob/main/tiktoken/model.py">100,256</a>. The tokenization method and vocabulary size are decided by model developers.</p>&#13;
            <div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>Why do language models use <em>token</em> as their unit instead of <em>word</em> or <em>character</em>? There are three main reasons:</p>&#13;
<ol>&#13;
<li><p>Compared to characters, tokens allow the model to break words into meaningful components. For example, “cooking” can be broken into “cook” and “ing”, with both components carrying some meaning of the original word.</p></li> &#13;
<li><p>Because there are fewer unique tokens than unique words, this reduces the model’s vocabulary size, making the model more efficient (as discussed in <span class="keep-together"><a data-type="xref" href="ch02.html#ch02_understanding_foundation_models_1730147895571359">Chapter 2</a></span>).</p></li>&#13;
<li><p>Tokens also help the model process unknown words. For instance, a made-up word like “chatgpting” could be split into “chatgpt” and “ing”, helping the model understand its structure. Tokens balance having fewer units than words while retaining more meaning than individual characters.</p></li>&#13;
</ol>&#13;
            </div>&#13;
<p>There are two main types of language models: <em>masked language models</em> and <em>autoregressive language models</em>. They differ based on what information they can use to predict a token:</p>&#13;
            <dl>&#13;
              <dt>Masked language model</dt>&#13;
<dd><p><a contenteditable="false" data-primary="masked language models" data-type="indexterm" id="id539"/>A masked language model is trained to predict missing tokens anywhere in a sequence, <em>using the context from both before and after the missing tokens</em>. In essence, a masked language model is trained to be able to fill in the blank. For example, given the context, “My favorite __ is blue”, a masked language model should predict that the blank is likely “color”. A well-known example of a masked language model is bidirectional encoder representations from transformers, or BERT (<a href="https://arxiv.org/abs/1810.04805">Devlin et al., 2018</a>).</p></dd>&#13;
<dd><p>As of writing, masked language models are commonly used for non-generative tasks such as sentiment analysis and text classification. They are also useful for tasks requiring an understanding of the overall context, such as code debugging, where a model needs to understand both the preceding and following code to identify errors.</p></dd>&#13;
              <dt>Autoregressive language model</dt>&#13;
<dd><p><a contenteditable="false" data-primary="autoregressive language model" data-type="indexterm" id="id540"/>An autoregressive language model is trained to predict the next token in a sequence, <em>using only the preceding tokens</em>. It predicts what comes next in “My favorite color is __<em>.</em>”<sup><a data-type="noteref" href="ch01.html#id541" id="id541-marker">3</a></sup> An autoregressive model can continually generate one token after another. Today, autoregressive language models are the models of choice for text generation, and for this reason, they are much more popular than masked language models.<sup><a data-type="noteref" href="ch01.html#id542" id="id542-marker">4</a></sup></p></dd>&#13;
            </dl>&#13;
<p><a data-type="xref" href="#ch01_figure_2_1730130814919894">Figure 1-2</a> shows these two types of language models.</p>&#13;
            <figure><div class="figure" id="ch01_figure_2_1730130814919894">&#13;
              <img alt="A diagram of a chicken crossword&#10;&#10;Description automatically generated" src="assets/aien_0102.png"/>&#13;
              <h6><span class="label">Figure 1-2. </span>Autoregressive language model and masked language model.</h6>&#13;
            </div></figure>&#13;
            <div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>In this book, unless explicitly stated, <em>language model</em> will refer to an autoregressive model.</p>&#13;
            </div>&#13;
<p>The outputs of language models are open-ended. A language model can use its fixed, finite vocabulary to construct infinite possible outputs. A model that can generate open-ended outputs is called <em>generative</em>, hence the term <em>generative AI</em>.</p>&#13;
<p>You can think of a language model as a <em>completion machine</em>: given a text (prompt), it tries to complete that text. Here’s an example:</p>&#13;
            <pre data-type="programlisting"><em>Prompt (from user)</em>: "To be or not to be"&#13;
<em>Completion (from language model)</em>: ", that is the question."&#13;
            </pre>&#13;
<p>It’s important to note that completions are predictions, based on probabilities, and not guaranteed to be correct. This probabilistic nature of language models makes them both so exciting and frustrating to use. We explore this further in <a data-type="xref" href="ch02.html#ch02_understanding_foundation_models_1730147895571359">Chapter 2</a>.</p>&#13;
<p class="pagebreak-before">As simple as it sounds, completion is incredibly powerful. Many tasks, including translation, summarization, coding, and solving math problems, can be framed as completion tasks. For example, given the prompt: “How are you in French is …”, a language model might be able to complete it with: “Comment ça va”, effectively translating from one language to another.</p>&#13;
<p>As another example, given the prompt:</p>&#13;
            <pre data-type="programlisting">Question: Is this email likely spam? Here’s the email: &lt;email content&gt;&#13;
Answer: &#13;
            </pre>&#13;
<p>A language model might be able to complete it with: “Likely spam”, which turns this language model into a spam classifier.</p>&#13;
<p>While completion is powerful, completion isn’t the same as engaging in a conversation. For example, if you ask a completion machine a question, it can complete what you said by adding another question instead of answering the question. <a data-type="xref" href="ch02.html#ch02_post_training_1730147895572108">“Post-Training”</a> discusses how to make a model respond appropriately to a user’s request.<a contenteditable="false" data-primary="" data-startref="ch01.html4" data-type="indexterm" id="id543"/></p>&#13;
          </div></section>&#13;
          <section data-pdf-bookmark="Self-supervision" data-type="sect3"><div class="sect3" id="ch01_self_supervision_1730130814985113">&#13;
            <h3>Self-supervision</h3>&#13;
<p><a contenteditable="false" data-primary="self-supervision language models" data-type="indexterm" id="ch01.html5"/>Language modeling is just one of many ML algorithms. There are also models for object detection, topic modeling, recommender systems, weather forecasting, stock price prediction, etc. What’s special about language models that made them the center of the scaling approach that caused the ChatGPT moment?</p>&#13;
<p><a contenteditable="false" data-primary="supervision" data-type="indexterm" id="id544"/>The answer is that language models can be trained using <em>self-supervision</em>, while many other models require <em>supervision</em>. Supervision refers to the process of training ML algorithms using labeled data, which can be expensive and slow to obtain. Self-supervision helps overcome this data labeling bottleneck to create larger datasets for models to learn from, effectively allowing models to scale up. Here’s how.</p>&#13;
<p>With supervision, you label examples to show the behaviors you want the model to learn, and then train the model on these examples. Once trained, the model can be applied to new data. For example, to train a fraud detection model, you use examples of transactions, each labeled with “fraud” or “not fraud”. Once the model learns from these examples, you can use this model to predict whether a transaction is fraudulent.</p>&#13;
<p>The success of AI models in the 2010s lay in supervision. The model that started the deep learning revolution, AlexNet (<a href="https://oreil.ly/WEQFj">Krizhevsky et al., 2012</a>), was supervised. It was trained to learn how to classify over 1 million images in the dataset ImageNet. It classified each image into one of 1,000 categories such as “car”, “balloon”, or “monkey”.</p>&#13;
<p class="pagebreak-before">A drawback of supervision is that data labeling is expensive and time-consuming. If it costs 5 cents for one person to label one image, it’d cost $50,000 to label a million images for ImageNet.<sup><a data-type="noteref" href="ch01.html#id545" id="id545-marker">5</a></sup> If you want two different people to label each image—so that you could cross-check label quality—it’d cost twice as much. Because the world contains vastly more than 1,000 objects, to expand models’ capabilities to work with more objects, you’d need to add labels of more categories. To scale up to 1 million categories, the labeling cost alone would increase to $50 million.</p>&#13;
<p>Labeling everyday objects is something that most people can do without prior training. Hence, it can be done relatively cheaply. However, not all labeling tasks are that simple. Generating Latin translations for an English-to-Latin model is more expensive. Labeling whether a CT scan shows signs of cancer would be astronomical.</p>&#13;
<p>Self-supervision helps overcome the data labeling bottleneck. In self-supervision, instead of requiring explicit labels, the model can infer labels from the input data. Language modeling is self-supervised because each input sequence provides both the labels (tokens to be predicted) and the contexts the model can use to predict these labels. For example, the sentence “I love street food.” gives six training samples, as shown in <a data-type="xref" href="#ch01_table_1_1730130814941480">Table 1-1</a>.</p>&#13;
            <table id="ch01_table_1_1730130814941480">&#13;
              <caption><span class="label">Table 1-1. </span>Training samples from the sentence “I love street food.” for language modeling.</caption>&#13;
              <thead>&#13;
                <tr>&#13;
                  <th>Input (context)</th>&#13;
                  <th>Output (next token)</th>&#13;
                </tr>&#13;
              </thead>&#13;
              <tr>&#13;
                <td><code>&lt;BOS&gt;</code></td>&#13;
                <td><code>I</code></td>&#13;
              </tr>&#13;
              <tr>&#13;
                <td><code>&lt;BOS&gt;, I</code></td>&#13;
                <td><code>love</code></td>&#13;
              </tr>&#13;
              <tr>&#13;
                <td><code>&lt;BOS&gt;, I, love</code></td>&#13;
                <td><code>street</code></td>&#13;
              </tr>&#13;
              <tr>&#13;
                <td><code>&lt;BOS&gt;, I, love, street</code></td>&#13;
                <td><code>food</code></td>&#13;
              </tr>&#13;
              <tr>&#13;
                <td><code>&lt;BOS&gt;, I, love, street, food</code></td>&#13;
                <td><code>.</code></td>&#13;
              </tr>&#13;
              <tr>&#13;
                <td><code>&lt;BOS&gt;, I, love, street, food, .</code></td>&#13;
                <td><code>&lt;EOS&gt;</code></td>&#13;
              </tr>&#13;
            </table>&#13;
<p>In <a data-type="xref" href="#ch01_table_1_1730130814941480">Table 1-1</a>, &lt;BOS&gt; and &lt;EOS&gt; mark the beginning and the end of a sequence. These markers are necessary for a language model to work with multiple sequences. Each marker is typically treated as one special token by the model. The end-of-sequence marker is especially important as it helps language models know when to end their responses.<sup><a data-type="noteref" href="ch01.html#id546" id="id546-marker">6</a></sup></p>&#13;
            <div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>Self-supervision differs from unsupervision. In self-supervised learning, labels are inferred from the input data. In unsupervised learning, you don’t need labels at all.</p>&#13;
            </div>&#13;
<p>Self-supervised learning means that language models can learn from text sequences without requiring any labeling. Because text sequences are everywhere—in books, blog posts, articles, and Reddit comments—it’s possible to construct a massive amount of training data, allowing language models to scale up to become LLMs.</p>&#13;
<p>LLM, however, is hardly a scientific term. How large does a language model have to be to be considered <em>large</em>? What is large today might be considered tiny tomorrow. A model’s size is typically measured by its number of parameters. A <em>parameter</em> is a variable within an ML model that is updated through the training process.<sup><a data-type="noteref" href="ch01.html#id547" id="id547-marker">7</a></sup> In general, though this is not always true, the more parameters a model has, the greater its capacity to learn desired behaviors.</p>&#13;
<p><a contenteditable="false" data-primary="OpenAI" data-secondary="first GPT model" data-type="indexterm" id="id548"/>When OpenAI’s first generative pre-trained transformer (GPT) model came out in June 2018, it had 117 million parameters, and that was considered large. In February 2019, when OpenAI introduced GPT-2 with 1.5 billion parameters, 117 million was downgraded to be considered small. As of the writing of this book, a model with 100 billion parameters is considered large. Perhaps one day, this size will be considered small.</p>&#13;
<p>Before we move on to the next section, I want to touch on a question that is usually taken for granted: <em>Why do larger models need more data?</em> Larger models have more capacity to learn, and, therefore, would need more training data to maximize their performance.<sup><a data-type="noteref" href="ch01.html#id549" id="id549-marker">8</a></sup> You can train a large model on a small dataset too, but it’d be a waste of compute. You could have achieved similar or better results on this dataset with smaller models<a contenteditable="false" data-primary="" data-startref="ch01.html5" data-type="indexterm" id="id550"/>.</p>&#13;
          </div></section>&#13;
        </div></section>&#13;
        <section data-pdf-bookmark="From Large Language Models to Foundation Models" data-type="sect2"><div class="sect2" id="ch01_from_large_language_model_to_foundation_model_1730130814985180">&#13;
          <h2>From Large Language Models to Foundation Models</h2>&#13;
<p><a contenteditable="false" data-primary="large language models" data-type="indexterm" id="ch01.html6"/>While language models are capable of incredible tasks, they are limited to text. As humans, we perceive the world not just via language but also through vision, hearing, touch, and more. Being able to process data beyond text is essential for AI to operate in the real world.</p>&#13;
<p>For this reason, language models are being extended to incorporate more data modalities. GPT-4V and Claude 3 can understand images and texts. Some models even understand videos, 3D assets, protein structures, and so on. Incorporating more data modalities into language models makes them even more powerful. OpenAI <a href="https://oreil.ly/NoGX7">noted in their GPT-4V system card</a> in 2023 that “incorporating additional modalities (such as image inputs) into LLMs is viewed by some as a key frontier in AI research and development.” </p>&#13;
<p>While many people still call Gemini and GPT-4V LLMs, they’re better characterized as <a href="https://arxiv.org/abs/2108.07258"><em>foundation models</em></a>. The word <em>foundation</em> signifies both the importance of these models in AI applications and the fact that they can be built upon for different needs.</p>&#13;
<p>Foundation models mark a breakthrough from the traditional structure of AI research. For a long time, AI research was divided by data modalities. Natural language processing (NLP) deals only with text. Computer vision deals only with vision. Text-only models can be used for tasks such as translation and spam detection. Image-only models can be used for object detection and image classification. Audio-only models can handle speech recognition (speech-to-text, or STT) and speech synthesis (text-to-speech, or TTS).</p>&#13;
<p><a contenteditable="false" data-primary="large multimodal model (LMM)" data-type="indexterm" id="id551"/><a contenteditable="false" data-primary="LMM (large multimodal model)" data-type="indexterm" id="id552"/><a contenteditable="false" data-primary="multimodal models" data-type="indexterm" id="id553"/>A model that can work with more than one data modality is also called a <em>multimodal model.</em> A generative multimodal model is also called a large multimodal model (LMM). If a language model generates the next token conditioned on text-only tokens, a multimodal model generates the next token conditioned on both text and image tokens, or whichever modalities that the model supports, as shown in <a data-type="xref" href="#ch01_figure_3_1730130814919919">Figure 1-3</a>.</p>&#13;
          <figure><div class="figure" id="ch01_figure_3_1730130814919919">&#13;
            <img alt="A diagram of a model&#10;&#10;Description automatically generated" src="assets/aien_0103.png"/>&#13;
            <h6><span class="label">Figure 1-3. </span>A multimodal model can generate the next token using information from both text and visual tokens.</h6>&#13;
          </div></figure>&#13;
<p class="pagebreak-before"><a contenteditable="false" data-primary="CLIP" data-type="indexterm" id="id554"/>Just like language models, multimodal models need data to scale up. Self-supervision works for multimodal models too. <a contenteditable="false" data-primary="OpenAI" data-secondary="natural language supervision" data-type="indexterm" id="id555"/>For example, OpenAI used a variant of self-supervision called <em>natural language supervision</em> to train their language-image model <a href="https://oreil.ly/zcqdu">CLIP (OpenAI, 2021)</a>. Instead of manually generating labels for each image, they found (image, text) pairs that co-occurred on the internet. They were able to generate a dataset of 400 million (image, text) pairs, which was 400 times larger than ImageNet, without manual labeling cost. This dataset enabled CLIP to become the first model that could generalize to multiple image classification tasks without requiring additional training.</p>&#13;
          <div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>This book uses the term foundation models to refer to both large language models and large multimodal models.</p>&#13;
          </div>&#13;
<p>Note that CLIP isn’t a generative model—it wasn’t trained to generate open-ended outputs. <a contenteditable="false" data-primary="embedding model" data-type="indexterm" id="id556"/>CLIP is an <em>embedding model</em>, trained to produce joint embeddings of both texts and images. <a data-type="xref" href="ch03.html#ch03a_introduction_to_embedding_1730150757064669">“Introduction to Embedding”</a> discusses embeddings in detail. For now, you can think of embeddings as vectors that aim to capture the meanings of the original data. Multimodal embedding models like CLIP are the backbones of generative multimodal models, such as Flamingo, LLaVA, and Gemini (previously Bard).</p>&#13;
<p>Foundation models also mark the transition from task-specific models to general-purpose models. Previously, models were often developed for specific tasks, such as sentiment analysis or translation. A model trained for sentiment analysis wouldn’t be able to do translation, and vice versa.</p>&#13;
<p><em>Foundation models, thanks to their scale and the way they are trained, are capable of a wide range of tasks.</em> Out of the box, general-purpose models can work relatively well for many tasks. An LLM can do both sentiment analysis and translation. However, you can often tweak a general-purpose model to maximize its performance on a specific task.</p>&#13;
<p><a data-type="xref" href="#ch01_figure_4_1730130814919937">Figure 1-4</a> shows the tasks used by the Super-NaturalInstructions benchmark to evaluate foundation models (<a href="https://arxiv.org/abs/2204.07705">Wang et al., 2022</a>), providing an idea of the types of tasks a foundation model can perform.</p>&#13;
          &#13;
<p>Imagine you’re working with a retailer to build an application to generate product descriptions for their website. An out-of-the-box model might be able to generate accurate descriptions but might fail to capture the brand’s voice or highlight the brand’s messaging. The generated descriptions might even be full of marketing speech and cliches.</p>&#13;
&#13;
<figure><div class="figure" id="ch01_figure_4_1730130814919937">&#13;
            <img alt="A diagram of different colored circles&#10;&#10;Description automatically generated" src="assets/aien_0104.png"/>&#13;
            <h6><span class="label">Figure 1-4. </span>The range of tasks in the Super-NaturalInstructions benchmark (Wang et al., 2022).</h6>&#13;
          </div></figure>&#13;
&#13;
<p>There are multiple techniques you can use to get the model to generate what you want. For example, you can craft detailed instructions with examples of the desirable product descriptions. This approach is <em>prompt engineering</em>. You can connect the model to a database of customer reviews that the model can leverage to generate better descriptions. Using a database to supplement the instructions is called <em>retrieval-augmented generation</em> (RAG). You can also <em>finetune</em>—further train—the model on a dataset of high-quality product descriptions.</p>&#13;
&#13;
&#13;
&#13;
<p>Prompt engineering, RAG, and finetuning are three very common AI engineering techniques that you can use to adapt a model to your needs. The rest of the book will discuss all of them in detail.</p>&#13;
<p>Adapting an existing powerful model to your task is generally a lot easier than building a model for your task from scratch—for example, ten examples and one weekend versus 1 million examples and six months. Foundation models make it cheaper to develop AI applications and reduce time to market. Exactly how much data is needed to adapt a model depends on what technique you use. This book will also touch on this question when discussing each technique. However, there are still many benefits to task-specific models, for example, they might be a lot smaller, making them faster and cheaper to use.</p>&#13;
<p>Whether to build your own model or leverage an existing one is a classic buy-or-build question that teams will have to answer for themselves. Discussions throughout the book can help with that decision.<a contenteditable="false" data-primary="" data-startref="ch01.html6" data-type="indexterm" id="id557"/></p>&#13;
        </div></section>&#13;
        <section data-pdf-bookmark="From Foundation Models to AI Engineering" data-type="sect2"><div class="sect2" id="ch01_from_foundation_models_to_ai_engineering_1730130814985258">&#13;
          <h2>From Foundation Models to AI Engineering</h2>&#13;
<p><a contenteditable="false" data-primary="application building" data-secondary="rise of AI engineering" data-tertiary="foundation models to AI engineering" data-type="indexterm" id="ch01.html7"/><em>AI engineering</em> <a contenteditable="false" data-primary="AI engineering (AIE)" data-secondary="defined" data-type="indexterm" id="id558"/>refers to the process of building applications on top of foundation models. People have been building AI applications for over a decade—a process often known as ML engineering or MLOps (short for ML operations). Why do we talk about AI engineering now?</p>&#13;
<p>If traditional ML engineering involves developing ML models, AI engineering leverages existing ones. The availability and accessibility of powerful foundation models lead to three factors that, together, create ideal conditions for the rapid growth of AI engineering as a discipline:</p>&#13;
          <dl>&#13;
            <dt>Factor 1: General-purpose AI capabilities</dt>&#13;
            <dd>&#13;
<p><a contenteditable="false" data-primary="foundation models" data-type="indexterm" id="id559"/>Foundation models are powerful not just because they can do existing tasks better. They are also powerful because they can do more tasks. Applications previously thought impossible are now possible, and applications not thought of before are emerging. Even applications not thought possible today might be possible tomorrow. This makes AI more useful for more aspects of life, vastly increasing both the user base and the demand for AI applications.</p>&#13;
            </dd>&#13;
            <dd>&#13;
<p>For example, since AI can now write as well as humans, sometimes even better, AI can automate or partially automate every task that requires communication, which is pretty much everything. AI is used to write emails, respond to customer requests, and explain complex contracts. Anyone with a computer has access to tools that can instantly generate customized, high-quality images and videos to help create marketing materials, edit professional headshots, visualize art concepts, illustrate books, and so on. AI can even be used to synthesize training data, develop algorithms, and write code, all of which will help train even more powerful models in the future.</p>&#13;
            </dd>&#13;
            <dt>Factor 2: Increased AI investments</dt>&#13;
            <dd>&#13;
<p><a contenteditable="false" data-primary="ChatGPT" data-secondary="effect on AI investment" data-type="indexterm" id="id560"/>The success of ChatGPT prompted a sharp increase in investments in AI, both from venture capitalists and enterprises. As AI applications become cheaper to build and faster to go to market, returns on investment for AI become more attractive. Companies rush to incorporate AI into their products and processes. Matt Ross, a senior manager of applied research at Scribd, told me that the estimated AI cost for his use cases has gone down two orders of magnitude from April 2022 to April 2023.</p>&#13;
            </dd>&#13;
            <dd>&#13;
<p><a href="https://oreil.ly/okMw6">Goldman Sachs Research</a> estimated that AI investment could approach $100 billion in the US and $200 billion globally by 2025.<sup><a data-type="noteref" href="ch01.html#id561" id="id561-marker">9</a></sup> AI is often mentioned as a competitive advantage. <a href="https://oreil.ly/tgm-a">FactSet</a> found that one in three S&amp;P 500 companies mentioned AI in their earnings calls for the second quarter of 2023, three times more than did so the year earlier. <a data-type="xref" href="#ch01_figure_5_1730130814919959">Figure 1-5</a> shows the number of S&amp;P 500 companies that mentioned AI in their earning calls from 2018 to 2023.</p>&#13;
            &#13;
          &#13;
          <figure><div class="figure" id="ch01_figure_5_1730130814919959">&#13;
            <img alt="A graph with numbers and lines&#10;&#10;Description automatically generated" src="assets/aien_0105.png"/>&#13;
            <h6><span class="label">Figure 1-5. </span>The number of S&amp;P 500 companies that mention AI in their earnings calls reached a record high in 2023. Data from FactSet.</h6>&#13;
          </div></figure>&#13;
         </dd>&#13;
            <dd>&#13;
<p>According to WallStreetZen, companies that mentioned AI in their earning calls saw their stock price increase more than those that didn’t: <a href="https://oreil.ly/fK5uh">an average of a 4.6% increase compared to 2.4%</a>. It’s unclear whether it’s causation (AI makes these companies more successful) or correlation (companies are successful because they are quick to adapt to new technologies).</p>&#13;
            </dd>&#13;
            <dt>Factor 3: Low entrance barrier to building AI applications</dt>&#13;
            <dd>&#13;
<p><a contenteditable="false" data-primary="OpenAI" data-secondary="model as a service" data-type="indexterm" id="id562"/>The model as a service approach popularized by OpenAI and other model providers makes it easier to leverage AI to build applications. In this approach, models are exposed via APIs that receive user queries and return model outputs. Without these APIs, using an AI model requires the infrastructure to host and serve this model. These APIs give you access to powerful models via single API calls.</p>&#13;
            </dd>&#13;
            <dd>&#13;
<p>Not only that, AI also makes it possible to build applications with minimal coding. First, AI can write code for you, allowing people without a software engineering background to quickly turn their ideas into code and put them in front of their users. Second, you can work with these models in plain English instead of having to use a programming language. <em>Anyone, and I mean anyone, can now develop AI applications.</em></p>&#13;
            </dd>&#13;
          </dl>&#13;
<p>Because of the resources it takes to develop foundation models, this process is possible only for big corporations (Google, Meta, Microsoft, Baidu, Tencent), governments (<a href="https://oreil.ly/r86Qz">Japan</a>, the <a href="https://oreil.ly/IUcVg">UAE</a>), and ambitious, well-funded startups (OpenAI, Anthropic, Mistral). In a September 2022 interview, <a href="https://oreil.ly/D9QBM">Sam Altman, CEO of OpenAI</a>, said that the biggest opportunity for the vast majority of people will be to adapt these models for specific applications.</p>&#13;
<p>The world is quick to embrace this opportunity. AI engineering has rapidly emerged as one of the fastest, and quite possibly the fastest-growing, engineering discipline. Tools for AI engineering are gaining traction faster than any previous software engineering tools. Within just two years, four open source AI engineering tools (AutoGPT, Stable Diffusion eb UI, LangChain, Ollama) have already garnered more stars on GitHub than Bitcoin. They are on track to surpass even the most popular web development frameworks, including React and Vue, in star count. <a data-type="xref" href="#ch01_figure_6_1730130814919984">Figure 1-6</a> shows the GitHub star growth of AI engineering tools compared to Bitcoin, Vue, and React.</p>&#13;
         &#13;
<p>A LinkedIn survey from August 2023 shows that the number of professionals adding terms like “Generative AI,” “ChatGPT,” “Prompt Engineering,” and “Prompt Crafting” to their profile increased <a href="https://oreil.ly/m8SvB">on average 75% each month</a>. <a href="https://oreil.ly/47sGE"><em>ComputerWorld</em></a> declared that “teaching AI to behave is the fastest-growing career skill”<a contenteditable="false" data-primary="" data-startref="ch01.html7" data-type="indexterm" id="id563"/>.<a contenteditable="false" data-primary="" data-startref="ch01.html2" data-type="indexterm" id="id564"/><a contenteditable="false" data-primary="" data-startref="ch01.html1" data-type="indexterm" id="id565"/></p>&#13;
&#13;
 <figure><div class="figure" id="ch01_figure_6_1730130814919984">&#13;
            <img alt="A graph of a graph with different colored lines&#10;&#10;Description automatically generated" src="assets/aien_0106.png"/>&#13;
            <h6><span class="label">Figure 1-6. </span>Open source AI engineering tools are growing faster than any other software engineering tools, according to their GitHub star counts.</h6>&#13;
          </div></figure>&#13;
&#13;
          <aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="ch01_why_the_term_ai_engineering_1730130814985321">&#13;
            <h1>Why the Term “AI Engineering?”</h1>&#13;
<p>Many terms are being used to describe the process of building applications on top of foundation models, including ML engineering, MLOps, AIOps, LLMOps, etc. Why did I choose to go with AI engineering for this book?</p>&#13;
<p>I didn’t go with the term ML engineering because, as discussed in <a data-type="xref" href="#ch01_ai_engineering_versus_ml_engineering_1730130814986585">“AI Engineering Versus ML Engineering”</a>, working with foundation models differs from working with traditional ML models in several important aspects. The term ML engineering won’t be sufficient to capture this differentiation. However, ML engineering is a great term to encompass both processes.</p>&#13;
<p>I didn’t go with all the terms that end with “Ops” because, while there are operational components of the process, the focus is more on tweaking (engineering) foundation models to do what you want.</p>&#13;
<p>Finally, I surveyed 20 people who were developing applications on top of foundation models about what term they would use to describe what they were doing. Most people preferred <em>AI engineering</em>. I decided to go with the people.</p>&#13;
          </div></aside>&#13;
          &#13;
<p>The rapidly expanding community of AI engineers has demonstrated remarkable creativity with an incredible range of exciting applications. The next section will explore some of the most common application patterns.</p>&#13;
        </div></section>&#13;
      </div></section>&#13;
      <section data-pdf-bookmark="Foundation Model Use Cases" data-type="sect1"><div class="sect1" id="ch01_foundation_model_use_cases_1730130814985414">&#13;
        <h1>Foundation Model Use Cases</h1>&#13;
<p><a contenteditable="false" data-primary="application building" data-secondary="foundation model use cases" data-type="indexterm" id="ch01.html8"/><a contenteditable="false" data-primary="foundation models" data-secondary="use cases" data-type="indexterm" id="ch01.html9"/>If you’re not already building AI applications, I hope the previous section has convinced you that now is a great time to do so. If you have an application in mind, you might want to jump to <a data-type="xref" href="#ch01_planning_ai_applications_1730130814985969">“Planning AI Applications”</a>. If you’re looking for inspiration, this section covers a wide range of industry-proven and promising use cases. </p>&#13;
<p>The number of potential applications that you could build with foundation models seems endless. Whatever use case you think of, there’s probably an AI for that.<sup><a data-type="noteref" href="ch01.html#id566" id="id566-marker">10</a></sup> It’s impossible to list all potential use cases for AI.</p>&#13;
<p>Even attempting to categorize these use cases is challenging, as different surveys use different categorizations. For example, <a href="https://oreil.ly/-k_QX">Amazon Web Services (AWS)</a> has categorized enterprise generative AI use cases into three buckets: customer experience, employee productivity, and process optimization. A <a class="orm:hideurl" href="https://oreil.ly/Kul5E">2024 O’Reilly survey</a> categorized the use cases into eight categories: programming, data analysis, customer support, marketing copy, other copy, research, web design, and art.</p>&#13;
<p>Some organizations, like <a href="https://oreil.ly/T272_">Deloitte</a>, have categorized use cases by value capture, such as cost reduction, process efficiency, growth, and accelerating innovation. For value capture, <a href="https://oreil.ly/OyIUP">Gartner</a> has a category for <em>business continuity</em>, meaning an organization might go out of business if it doesn’t adopt generative AI. Of the 2,500 executives Gartner surveyed in 2023, 7% cited business continuity as the motivation for embracing generative AI.</p>&#13;
<p class="pagebreak-before"><a href="https://arxiv.org/abs/2303.10130">Eloundou et al. (2023)</a> has excellent research on how exposed different occupations are to AI. They defined a task as exposed if AI and AI-powered software can reduce the time needed to complete this task by at least 50%. An occupation with 80% exposure means that 80% of the occupation’s tasks are exposed. According to the study, occupations with 100% or close to 100% exposure include interpreters and translators, tax preparers, web designers, and writers. Some of them are shown in <a data-type="xref" href="#ch01_table_2_1730130814941524">Table 1-2</a>. Not unsurprisingly, occupations with no exposure to AI include cooks, stonemasons, and athletes. This study gives a good idea of what use cases AI is good for.</p>&#13;
&#13;
        <table id="ch01_table_2_1730130814941524">&#13;
          <caption><span class="label">Table 1-2. </span>Occupations with the highest exposure to AI as annotated by humans. <math alttext="alpha">&#13;
  <mi>α</mi>&#13;
</math> refers to exposure to AI models directly, whereas <math alttext="beta">&#13;
  <mi>β</mi>&#13;
</math> and <math alttext="zeta">&#13;
  <mi>ζ</mi>&#13;
</math> refer to exposures to AI-powered software. Table from Eloundou et al. (2023).</caption>&#13;
          <thead>&#13;
            <tr>&#13;
              <th>Group</th>&#13;
              <th>Occupations with highest exposure</th>&#13;
              <th>% Exposure</th>&#13;
            </tr>&#13;
          </thead>&#13;
          <tr>&#13;
            <td>Human <math alttext="alpha">&#13;
  <mi>α</mi>&#13;
</math></td>&#13;
            <td>Interpreters and translators<br/> Survey researchers<br/> Poets, lyricists, and creative writers<br/> Animal scientists<br/> Public relations specialists</td>&#13;
            <td>76.5<br/> 75.0<br/> 68.8<br/> 66.7<br/> 66.7</td>&#13;
          </tr>&#13;
          <tr>&#13;
            <td>Human <math alttext="beta">&#13;
  <mi>β</mi>&#13;
</math></td>&#13;
            <td>Survey researchers<br/> Writers and authors<br/> Interpreters and translators<br/> Public relations specialists<br/> Animal scientists</td>&#13;
            <td>84.4<br/> 82.5<br/> 82.4<br/> 80.6<br/> 77.8</td>&#13;
          </tr>&#13;
          <tr>&#13;
            <td>Human <math alttext="zeta">&#13;
  <mi>ζ</mi>&#13;
</math></td>&#13;
            <td>Mathematicians<br/> Tax preparers<br/> Financial quantitative analysts<br/> Writers and authors<br/> Web and digital interface designers<br/> <em>Humans labeled 15 occupations as “fully exposed”.</em></td>&#13;
            <td>100.0<br/> 100.0<br/> 100.0<br/> 100.0<br/> 100.0</td>&#13;
          </tr>&#13;
        </table>&#13;
<p class="pagebreak-before">When analyzing the use cases, I looked at both enterprise and consumer applications. To understand enterprise use cases, I interviewed 50 companies on their AI strategies and read over 100 case studies. To understand consumer applications, I examined 205 open source AI applications with at least 500 stars on GitHub.<sup><a data-type="noteref" href="ch01.html#id567" id="id567-marker">11</a></sup> I categorized applications into eight groups, as shown in <a data-type="xref" href="#ch01_table_3_1730130814941550">Table 1-3</a>. The limited list here serves best as a reference. As you learn more about how to build foundation models in <a data-type="xref" href="ch02.html#ch02_understanding_foundation_models_1730147895571359">Chapter 2</a> and how to evaluate them in <a data-type="xref" href="ch03.html#ch03a_evaluation_methodology_1730150757064067">Chapter 3</a>, you’ll also be able to form a better picture of what use cases foundation models can and should be used for.</p>&#13;
        <table id="ch01_table_3_1730130814941550">&#13;
          <caption><span class="label">Table 1-3. </span>Common generative AI use cases across consumer and enterprise applications.</caption>&#13;
          <thead>&#13;
            <tr>&#13;
              <th>Category</th>&#13;
              <th>Examples of consumer use cases</th>&#13;
              <th>Examples of enterprise use cases</th>&#13;
            </tr>&#13;
          </thead>&#13;
          <tr>&#13;
            <td>Coding</td>&#13;
            <td>Coding</td>&#13;
            <td>Coding</td>&#13;
          </tr>&#13;
          <tr>&#13;
            <td>Image and video production</td>&#13;
            <td>Photo and video editing<br/> Design</td>&#13;
            <td>Presentation <br/> Ad generation</td>&#13;
          </tr>&#13;
          <tr>&#13;
            <td>Writing</td>&#13;
            <td>Email<br/> Social media and blog posts</td>&#13;
            <td>Copywriting, search engine optimization (SEO)<br/> Reports, memos, design docs</td>&#13;
          </tr>&#13;
          <tr>&#13;
            <td>Education</td>&#13;
            <td>Tutoring<br/> Essay grading</td>&#13;
            <td>Employee onboarding<br/> Employee upskill training</td>&#13;
          </tr>&#13;
          <tr>&#13;
            <td>Conversational bots</td>&#13;
            <td>General chatbot<br/> AI companion</td>&#13;
            <td>Customer support<br/> Product copilots</td>&#13;
          </tr>&#13;
          <tr>&#13;
            <td>Information aggregation</td>&#13;
            <td>Summarization<br/> Talk-to-your-docs</td>&#13;
            <td>Summarization<br/> Market research</td>&#13;
          </tr>&#13;
          <tr>&#13;
            <td>Data organization</td>&#13;
            <td>Image search<br/> <a class="orm:hideurl" href="https://en.wikipedia.org/wiki/Memex">Memex</a></td>&#13;
            <td>Knowledge management<br/> Document processing</td>&#13;
          </tr>&#13;
          <tr>&#13;
            <td>Workflow automation</td>&#13;
            <td>Travel planning<br/> Event planning</td>&#13;
            <td>Data extraction, entry, and annotation<br/> Lead generation</td>&#13;
          </tr>&#13;
        </table>&#13;
        &#13;
<p>Because foundation models are general, applications built on top of them can solve many problems. This means that an application can belong to more than one category. For example, a bot can provide companionship and aggregate information. An application can help you extract structured data from a PDF and answer questions about that PDF.</p>&#13;
<p><a data-type="xref" href="#ch01_figure_7_1730130814920012">Figure 1-7</a> shows the distribution of these use cases among the 205 open source applications. Note that the small percentage of education, data organization, and writing use cases doesn’t mean that these use cases aren’t popular. It just means that these applications aren’t open source. Builders of these applications might find them more suitable for enterprise use cases.</p>&#13;
        <figure class="width-85"><div class="figure" id="ch01_figure_7_1730130814920012">&#13;
          <img alt="A pie chart with different colored circles&#10;&#10;Description automatically generated" src="assets/aien_0107.png"/>&#13;
          <h6><span class="label">Figure 1-7. </span>Distribution of use cases in the 205 open source repositories on GitHub.</h6>&#13;
        </div></figure>&#13;
<p>The enterprise world generally prefers applications with lower risks. For example, a <a href="https://oreil.ly/XWeDt">2024 a16z Growth report</a> showed that companies are faster to deploy internal-facing applications (internal knowledge management) than external-facing applications (customer support chatbots), as shown in <a data-type="xref" href="#ch01_figure_8_1730130814920037">Figure 1-8</a>. Internal applications help companies develop their AI engineering expertise while minimizing the risks associated with data privacy, compliance, and potential catastrophic failures. Similarly, while foundation models are open-ended and can be used for any task, many applications built on top of them are still close-ended, such as classification. Classification tasks are easier to evaluate, which makes their risks easier to estimate.</p>&#13;
        <figure><div class="figure" id="ch01_figure_8_1730130814920037">&#13;
          <img alt="A screenshot of a graph&#10;&#10;Description automatically generated" src="assets/aien_0108.png"/>&#13;
          <h6><span class="label">Figure 1-8. </span>Companies are more willing to deploy internal-facing applications</h6>&#13;
        </div></figure>&#13;
<p>Even after seeing hundreds of AI applications, I still find new applications that surprise me every week. In the early days of the internet, few people foresaw that the dominating use case on the internet one day would be social media. As we learn to make the most out of AI, the use case that will eventually dominate might surprise us. With luck, the surprise will be a good one.</p>&#13;
        <section data-pdf-bookmark="Coding" data-type="sect2"><div class="sect2" id="ch01_coding_1730130814985492">&#13;
          <h2>Coding</h2>&#13;
<p><a contenteditable="false" data-primary="application building" data-secondary="foundation model use cases" data-tertiary="coding" data-type="indexterm" id="ch01.html10"/><a contenteditable="false" data-primary="foundation models" data-secondary="use cases" data-tertiary="coding" data-type="indexterm" id="ch01.html11"/>In multiple generative AI surveys, coding is hands down the most popular use case. AI coding tools are popular both because AI is good at coding and because early AI engineers are coders who are more exposed to coding challenges.</p>&#13;
<p>One of the earliest successes of foundation models in production is the code completion tool GitHub Copilot, whose <a href="https://oreil.ly/Xamik">annual recurring revenue crossed $100 million</a> only two years after its launch. As of this writing, AI-powered coding startups have raised hundreds of millions of dollars, with <a href="https://oreil.ly/t0xDf">Magic raising $320 million</a> and <a href="https://oreil.ly/BW5Hk">Anysphere raising $60 million</a>, both in August 2024. Open source coding tools like <a href="https://github.com/gpt-engineer-org/gpt-engineer">gpt-engineer</a> and <a href="https://github.com/abi/screenshot-to-code">screenshot-to-code</a> both got 50,000 stars on GitHub within a year, and many more are being rapidly introduced.</p>&#13;
<p>Other than tools that help with general coding, many tools specialize in certain coding tasks. Here are examples of these tasks:</p>&#13;
          <ul>&#13;
            <li>&#13;
<p>Extracting structured data from web pages and PDFs (<a href="https://github.com/reworkd/AgentGPT">AgentGPT</a>)</p></li>&#13;
            <li>&#13;
<p>Converting English to code (<a href="https://github.com/eosphoros-ai/DB-GPT">DB-GPT</a>, <a href="https://github.com/sqlchat/sqlchat">SQL Chat</a>, <a href="https://github.com/Sinaptik-AI/pandas-ai">PandasAI</a>)</p></li>&#13;
            <li>&#13;
<p>Given a design or a screenshot, generating code that will render into a website that looks like the given image (screenshot-to-code, <a href="https://github.com/sawyerhood/draw-a-ui">draw-a-ui</a>)</p></li>&#13;
            <li>&#13;
<p>Translating from one programming language or framework to another (<a href="https://github.com/joshpxyne/gpt-migrate">GPT-Migrate</a>, <a href="https://github.com/mckaywrigley/ai-code-translator">AI Code Translator</a>)</p></li>&#13;
            <li>&#13;
<p>Writing documentation (<a href="https://github.com/context-labs/autodoc">Autodoc</a>)</p></li>&#13;
            <li>&#13;
<p>Creating tests (<a href="https://github.com/GreyDGL/PentestGPT">PentestGPT</a>)</p></li>&#13;
            <li>&#13;
<p>Generating commit messages (<a href="https://github.com/Nutlope/aicommits">AI Commits</a>)</p></li>&#13;
          </ul>&#13;
<p class="pagebreak-before">It’s clear that AI can do many software engineering tasks. The question is whether AI can automate software engineering altogether. At one end of the spectrum, <a href="https://oreil.ly/zUpGu">Jensen Huang, CEO of NVIDIA</a>, predicts that AI will replace human software engineers and that we should stop saying kids should learn to code. In a leaked recording, <a href="https://oreil.ly/Hz_3i">AWS CEO Matt Garman</a> shared that in the near future, most developers will stop coding. He doesn’t mean it as the end of software developers; it’s just that their jobs will change.</p>&#13;
<p>At the other end are many software engineers who are convinced that they will never be replaced by AI, both for technical and emotional reasons (people don’t like admitting that they can be replaced).</p>&#13;
<p>Software engineering consists of many tasks. AI is better at some than others. <a href="https://oreil.ly/aqUmX">McKinsey</a> researchers found that AI can help developers be twice as productive for documentation, and 25–50% more productive for code generation and code refactoring. Minimal productivity improvement was observed for highly complex tasks, as shown in <a data-type="xref" href="#ch01_figure_9_1730130814920060">Figure 1-9</a>. In my conversations with developers of AI coding tools, many told me that they’ve noticed that AI is much better at frontend development than backend development.</p>&#13;
         &#13;
         <figure><div class="figure" id="ch01_figure_9_1730130814920060">&#13;
            <img alt="A graph of blue and white bars&#10;&#10;Description automatically generated" src="assets/aien_0109.png"/>&#13;
            <h6><span class="label">Figure 1-9. </span>AI can help developers be significantly more productive, especially for simple tasks, but this applies less for highly complex tasks. Data by McKinsey.</h6>&#13;
          </div></figure>&#13;
&#13;
<p>Regardless of whether AI will replace software engineers, AI can certainly make them more productive. This means that companies can now accomplish more with fewer engineers. AI can also disrupt the outsourcing industry, as outsourced tasks tend to be simpler ones outside of a company’s core business.<a contenteditable="false" data-primary="" data-startref="ch01.html11" data-type="indexterm" id="id568"/><a contenteditable="false" data-primary="" data-startref="ch01.html10" data-type="indexterm" id="id569"/></p>&#13;
&#13;
 &#13;
&#13;
        </div></section>&#13;
        <section data-pdf-bookmark="Image and Video Production" data-type="sect2"><div class="sect2" id="ch01_image_and_video_production_1730130814985552">&#13;
          <h2>Image and Video Production</h2>&#13;
<p><a contenteditable="false" data-primary="application building" data-secondary="foundation model use cases" data-tertiary="image and video production" data-type="indexterm" id="id570"/><a contenteditable="false" data-primary="foundation models" data-secondary="use cases" data-tertiary="image and video production" data-type="indexterm" id="id571"/>Thanks to its probabilistic nature, AI is great for creative tasks. Some of the most successful AI startups are creative applications, such as Midjourney for image generation, Adobe Firefly for photo editing, and Runway, Pika Labs, and Sora for video generation. In late 2023, at one and a half years old, <a href="https://oreil.ly/EAzCl">Midjourney</a> had already generated $200 million in annual recurring revenue. As of December 2023, among the top 10 free apps for Graphics &amp; Design on the Apple App Store, half have AI in their names. I suspect that soon, graphics and design apps will incorporate AI by default, and they’ll no longer need the word “AI” in their names. <a data-type="xref" href="ch02.html#ch02_understanding_foundation_models_1730147895571359">Chapter 2</a> discusses the probabilistic nature of AI in more detail.</p>&#13;
<p>It’s now common to use AI to generate profile pictures for social media, from LinkedIn to TikTok. Many candidates believe that AI-generated headshots can help them put their best foot forward and <a href="https://oreil.ly/fZLVg">increase their chances of landing a job</a>. The perception of AI-generated profile pictures has changed significantly. In 2019, <a href="https://oreil.ly/WNqUw">Facebook</a> banned accounts using AI-generated profile photos for safety reasons. In 2023, many social media apps provide tools that let users use AI to generate profile photos.</p>&#13;
<p>For enterprises, ads and marketing have been quick to incorporate AI.<sup><a data-type="noteref" href="ch01.html#id572" id="id572-marker">12</a></sup> AI can be used to generate promotional images and videos directly. It can help brainstorm ideas or generate first drafts for human experts to iterate upon. You can use AI to generate multiple ads and test to see which one works the best for the audience. AI can generate variations of your ads according to seasons and locations. For example, you can use AI to change leaf colors during fall or add snow to the ground during winter.</p>&#13;
        </div></section>&#13;
        <section data-pdf-bookmark="Writing" data-type="sect2"><div class="sect2" id="ch01_writing_1730130814985607">&#13;
          <h2>Writing</h2>&#13;
<p><a contenteditable="false" data-primary="application building" data-secondary="foundation model use cases" data-tertiary="writing" data-type="indexterm" id="ch01.html12"/><a contenteditable="false" data-primary="foundation models" data-secondary="use cases" data-tertiary="writing" data-type="indexterm" id="ch01.html13"/>AI has long been used to aid writing. If you use a smartphone, you’re probably familiar with autocorrect and auto-completion, both powered by AI. Writing is an ideal application for AI because we do it a lot, it can be quite tedious, and we have a high tolerance for mistakes. If a model suggests something that you don’t like, you can just ignore it.</p>&#13;
<p>It’s not a surprise that LLMs are good at writing, given that they are trained for text completion. <a contenteditable="false" data-primary="ChatGPT" data-secondary="and human writing quality" data-secondary-sortas="human writing" data-type="indexterm" id="id573"/>To study the impact of ChatGPT on writing, an MIT study (<a href="https://oreil.ly/IzQ6F">Noy and Zhang, 2023</a>) assigned occupation-specific writing tasks to 453 college-educated professionals and randomly exposed half of them to ChatGPT. Their results show that among those exposed to ChatGPT, the average time taken decreased by 40% and output quality rose by 18%. ChatGPT helps close the gap in output quality between workers, which means that it’s more helpful to those with less inclination for writing. Workers exposed to ChatGPT during the experiment were 2 times as likely to report using it in their real job two weeks after the experiment and 1.6 times as likely two months after that.</p>&#13;
<p>For consumers, the use cases are obvious. Many use AI to help them communicate better. You can be angry in an email and ask AI to make it pleasant. You can give it bullet points and get back complete paragraphs. Several people claimed they no longer send an important email without asking AI to improve it first.</p>&#13;
<p>Students are using AI to write essays. Writers are using AI to write books.<sup><a data-type="noteref" href="ch01.html#id574" id="id574-marker">13</a></sup> Many startups already use AI to generate children’s, fan fiction, romance, and fantasy books. Unlike traditional books, AI-generated books can be interactive, as a book’s plot can change depending on a reader’s preference. This means that readers can actively participate in creating the story they are reading. A children’s reading app identifies the words that a child has trouble with and generates stories centered around these words.</p>&#13;
<p>Note-taking and email apps like Google Docs, Notion, and Gmail all use AI to help users improve their writing. <a href="https://arxiv.org/abs/2305.09857">Grammarly</a>, a writing assistant app, finetunes a model to make users’ writing more fluent, coherent, and clear.</p>&#13;
<p>AI’s ability to write can also be abused. In 2023, the <a href="https://oreil.ly/LB72P">New York Times</a> reported that Amazon was flooded with shoddy AI-generated travel guidebooks, each outfitted with an author bio, a website, and rave reviews, all AI-generated.</p>&#13;
<p>For enterprises, AI writing is common in sales, marketing, and general team communication. Many managers told me they’ve been using AI to help them write performance reports. AI can help craft effective cold outreach emails, ad copywriting, and product descriptions. Customer relationship management (CRM) apps like HubSpot and Salesforce also have tools for enterprise users to generate web content and outreach emails.</p>&#13;
<p>AI seems particularly good with SEO, perhaps because many AI models are trained with data from the internet, which is populated with SEO-optimized text. AI is so good at SEO that it has enabled a new generation of content farms. These farms set up junk websites and fill them with AI-generated content to get them to rank high on Google to drive traffic to them. Then they sell advertising spots through ad exchanges. In June 2023, <a href="https://oreil.ly/mZKjr">NewsGuard</a> identified almost 400 ads from 141 popular brands on junk AI-generated websites. One of those junk websites produced 1,200 articles a day. Unless something is done to curtail this, the future of internet content will be AI-generated, and it’ll be pretty bleak.<sup><a data-type="noteref" href="ch01.html#id575" id="id575-marker">14</a></sup><a contenteditable="false" data-primary="" data-startref="ch01.html13" data-type="indexterm" id="id576"/><a contenteditable="false" data-primary="" data-startref="ch01.html12" data-type="indexterm" id="id577"/></p>&#13;
        </div></section>&#13;
        <section data-pdf-bookmark="Education" data-type="sect2"><div class="sect2" id="ch01_education_1730130814985662">&#13;
          <h2>Education</h2>&#13;
<p><a contenteditable="false" data-primary="application building" data-secondary="foundation model use cases" data-tertiary="education" data-type="indexterm" id="id578"/><a contenteditable="false" data-primary="foundation models" data-secondary="use cases" data-tertiary="education" data-type="indexterm" id="id579"/><a contenteditable="false" data-primary="ChatGPT" data-secondary="in schools" data-secondary-sortas="schools" data-type="indexterm" id="id580"/>Whenever ChatGPT is down, OpenAI’s Discord server is flooded with students complaining about being unable to complete their homework. Several education boards, including the New York City Public Schools and the Los Angeles Unified School District, were quick to <a href="https://oreil.ly/pqI5z">ban ChatGPT</a> for fear of students using it for cheating, but <a href="https://oreil.ly/nxtzw">reversed their decisions</a> just a few months later.</p>&#13;
<p>Instead of banning AI, schools could incorporate it to help students learn faster. AI can summarize textbooks and generate personalized lecture plans for each student. I find it strange that ads are personalized because we know everyone is different, but education is not. AI can help adapt the materials to the format best suited for each student. Auditory learners can ask AI to read the materials out loud. Students who love animals can use AI to adapt visualizations to feature more animals. Those who find it easier to read code than math equations can ask AI to translate math equations into code.</p>&#13;
<p>AI is especially helpful for language learning, as you can ask AI to roleplay different practice scenarios. <a href="https://oreil.ly/C8kmI">Pajak and Bicknell (Duolingo, 2022)</a> found that out of four stages of course creation, lesson personalization is the stage that can benefit the most from AI, as shown in <a data-type="xref" href="#ch01_figure_10_1730130814920091">Figure 1-10</a>.</p>&#13;
          <figure><div class="figure" id="ch01_figure_10_1730130814920091">&#13;
            <img alt="A white paper with blue text&#10;&#10;Description automatically generated" src="assets/aien_0110.png"/>&#13;
            <h6><span class="label">Figure 1-10. </span>AI can be used throughout all four stages of course creation at Duolingo, but it’s the most helpful in the personalization stage. Image from Pajak and Bicknell (Duolingo, 2022).</h6>&#13;
          </div></figure>&#13;
<p>AI can generate quizzes, both multiple-choice and open-ended, and evaluate the answers. AI can become a debate partner as it’s much better at presenting different views on the same topic than the average human. For example, <a href="https://oreil.ly/tC7-g">Khan Academy</a> offers <a href="https://oreil.ly/_N1JR">AI-powered</a> teaching assistants to students and course assistants to teachers. An innovative teaching method I’ve seen is that teachers assign AI-generated essays for students to find and correct <span class="keep-together">mistakes.</span></p>&#13;
<p>While many education companies embrace AI to build better products, many find their lunches taken by AI. For example, Chegg, a company that helps students with their homework, saw its share price plummet from $28 when ChatGPT launched in November 2022 to $2 in September 2024, as <a href="https://oreil.ly/Y-hBW">students have been turning to AI for help</a>.</p>&#13;
<p>If the risk is that AI can replace many skills, the opportunity is that AI can be used as a tutor to learn any skill. For many skills, AI can help someone get up to speed quickly and then continue learning on their own to become better than AI.</p>&#13;
        </div></section>&#13;
        <section class="pagebreak-before" data-pdf-bookmark="Conversational Bots" data-type="sect2"><div class="sect2" id="ch01_conversational_bots_1730130814985717">&#13;
          <h2 class="less_space">Conversational Bots</h2>&#13;
<p><a contenteditable="false" data-primary="application building" data-secondary="foundation model use cases" data-tertiary="conversational bots" data-type="indexterm" id="id581"/><a contenteditable="false" data-primary="conversational bots" data-type="indexterm" id="id582"/><a contenteditable="false" data-primary="foundation models" data-secondary="use cases" data-tertiary="conversational bots" data-type="indexterm" id="id583"/>Conversational bots are versatile. They can help us find information, explain concepts, and brainstorm ideas. AI can be your companion and therapist. It can emulate personalities, letting you talk to a digital copy of anyone you like. Digital girlfriends and boyfriends have become weirdly popular in an incredibly short amount of time. Many are already spending more time talking to bots than to humans (see the discussions <a href="https://oreil.ly/dZbym">here</a> and <a href="https://oreil.ly/svWj8">here</a>). Some are worried that AI will <a href="https://oreil.ly/SNme7">ruin</a> <a href="https://oreil.ly/Jbt4R">dating</a>.</p>&#13;
<p>In research, people have also found that they can use a group of conversational bots to simulate a society, enabling them to conduct studies on social dynamics (<a href="https://arxiv.org/abs/2304.03442">Park et al., 2023</a>).</p>&#13;
<p>For enterprises, the most popular bots are customer support bots. They can help companies save costs while improving customer experience because they can respond to users sooner than human agents. AI can also be product copilots that guide customers through painful and confusing tasks such as filing insurance claims, doing taxes, or looking up corporate policies.</p>&#13;
<p>The success of ChatGPT prompted a wave of text-based conversational bots. However, text isn’t the only interface for conversational agents. Voice assistants such as Google Assistant, Siri, and Alexa have been around for years.<sup><a data-type="noteref" href="ch01.html#id584" id="id584-marker">15</a></sup> 3D conversational bots are already common in games and gaining traction in retail and marketing.</p>&#13;
<p>One use case of AI-powered 3D characters is smart NPCs, non-player characters (see NVIDIA’s demos of <a href="https://oreil.ly/yn-DN">Inworld</a> and <a href="https://oreil.ly/zAHwz">Convai</a>).<sup><a data-type="noteref" href="ch01.html#id585" id="id585-marker">16</a></sup> NPCs are essential for advancing the storyline of many games. Without AI, NPCs are typically scripted to do simple actions with a limited range of dialogues. AI can make these NPCs much smarter. Intelligent bots can change the dynamics of existing games like <em>The Sims</em> and <em>Skyrim</em> as well as enable new games never possible before.</p>&#13;
        </div></section>&#13;
        <section data-pdf-bookmark="Information Aggregation" data-type="sect2"><div class="sect2" id="ch01_information_aggregation_1730130814985772">&#13;
          <h2>Information Aggregation</h2>&#13;
<p><a contenteditable="false" data-primary="application building" data-secondary="foundation model use cases" data-tertiary="information aggregation" data-type="indexterm" id="id586"/><a contenteditable="false" data-primary="information aggregation" data-type="indexterm" id="id587"/>Many people believe that our success depends on our ability to filter and digest useful information. However, keeping up with emails, Slack messages, and news can sometimes be overwhelming. Luckily, AI came to the rescue. AI has proven to be capable of aggregating information and summarizing it. According to <a href="https://oreil.ly/74soT">Salesforce’s 2023 <span class="keep-together">Generative</span> AI Snapshot Research</a>, 74% of generative AI users use it to distill complex ideas and summarize information.</p>&#13;
<p>For consumers, many applications can process your documents—contracts, disclosures, papers—and let you retrieve information in a conversational manner. This use case is also called <em>talk-to-your-docs</em>. AI can help you summarize websites, research, and create reports on the topics of your choice. During the process of writing this book, I found AI helpful for summarizing and comparing papers.</p>&#13;
<p>Information aggregation and distillation are essential for enterprise operations. More efficient information aggregation and dissimilation can help an organization become leaner, as it reduces the burden on middle management. When <a href="https://oreil.ly/Qq5-g">Instacart</a> launched an internal prompt marketplace, it discovered that one of the most popular prompt templates is “Fast Breakdown”. This template asks AI to summarize meeting notes, emails, and Slack conversations with facts, open questions, and action items. These action items can then be automatically inserted into a project tracking tool and assigned to the right owners.</p>&#13;
<p>AI can help you surface the critical information about your potential customers and run analyses on your competitors.</p>&#13;
<p>The more information you gather, the more important it is to organize it. Information aggregation goes hand in hand with data organization.</p>&#13;
        </div></section>&#13;
        <section data-pdf-bookmark="Data Organization" data-type="sect2"><div class="sect2" id="ch01_data_organization_1730130814985842">&#13;
          <h2>Data Organization</h2>&#13;
<p><a contenteditable="false" data-primary="application building" data-secondary="foundation model use cases" data-tertiary="data organization" data-type="indexterm" id="id588"/><a contenteditable="false" data-primary="data organization" data-type="indexterm" id="id589"/><a contenteditable="false" data-primary="foundation models" data-secondary="use cases" data-tertiary="data organization" data-type="indexterm" id="id590"/>One thing certain about the future is that we’ll continue producing more and more data. Smartphone users will continue taking photos and videos. Companies will continue to log everything about their products, employees, and customers. Billions of contracts are being created each year. <a contenteditable="false" data-primary="unstructured data" data-type="indexterm" id="id591"/>Photos, videos, logs, and PDFs are all unstructured or semistructured data. It’s essential to organize all this data in a way that can be searched later.</p>&#13;
<p>AI can help with exactly that. AI can automatically generate text descriptions about images and videos, or help match text queries with visuals that match those queries. Services like Google Photos are already using AI to surface images that match search queries.<sup><a data-type="noteref" href="ch01.html#id592" id="id592-marker">17</a></sup> Google Image Search goes a step further: if there’s no existing image matching users’ needs, it can generate some.</p>&#13;
<p class="pagebreak-before">AI is very good with data analysis. It can write programs to generate data visualization, identify outliers, and make predictions like revenue forecasts.<sup><a data-type="noteref" href="ch01.html#id593" id="id593-marker">18</a></sup></p>&#13;
<p>Enterprises can use AI to extract structured information from unstructured data, which can be used to organize data and help search it. Simple use cases include automatically extracting information from credit cards, driver’s licenses, receipts, tickets, contact information from email footers, and so on. More complex use cases include extracting data from contracts, reports, charts, and more. It’s estimated that the IDP, intelligent data processing, industry will reach <a href="https://oreil.ly/vnDNK">$12.81 billion by 2030</a>, growing 32.9% each year.</p>&#13;
        </div></section>&#13;
        <section data-pdf-bookmark="Workflow Automation" data-type="sect2"><div class="sect2" id="ch01_workflow_automation_1730130814985901">&#13;
          <h2>Workflow Automation</h2>&#13;
<p><a contenteditable="false" data-primary="application building" data-secondary="foundation model use cases" data-tertiary="workflow automation" data-type="indexterm" id="id594"/><a contenteditable="false" data-primary="foundation models" data-secondary="use cases" data-tertiary="workflow automation" data-type="indexterm" id="id595"/><a contenteditable="false" data-primary="workflow automation" data-type="indexterm" id="id596"/>Ultimately, AI should automate as much as possible. For end users, automation can help with boring daily tasks like booking restaurants, requesting refunds, planning trips, and filling out forms.</p>&#13;
<p>For enterprises, AI can automate repetitive tasks such as lead management, invoicing, reimbursements, managing customer requests, data entry, and so on. One especially exciting use case is using AI models to synthesize data, which can then be used to improve the models themselves. You can use AI to create labels for your data, looping in humans to improve the labels. We discuss data synthesis in <a data-type="xref" href="ch08.html#ch08_dataset_engineering_1730130932019888">Chapter 8</a>.</p>&#13;
<p>Access to external tools is required to accomplish many tasks. To book a restaurant, an application might need permission to open a search engine to look up the restaurant’s number, use your phone to make calls, and add appointments to your calendar. AIs that can plan and use tools are called <em>agents</em>. The level of interest around agents borders on obsession, but it’s not entirely unwarranted. AI agents have the potential to make every person vastly more productive and generate vastly more economic value. Agents are a central topic in <a data-type="xref" href="ch06.html#ch06_rag_and_agents_1730157386571386">Chapter 6</a>.</p>&#13;
<p>It’s been a lot of fun looking into different AI applications. One of my favorite things to daydream about is the different applications I can build. However, not all applications should be built. The next section discusses what we should consider before building an AI application.<a contenteditable="false" data-primary="" data-startref="ch01.html9" data-type="indexterm" id="id597"/><a contenteditable="false" data-primary="" data-startref="ch01.html8" data-type="indexterm" id="id598"/></p>&#13;
        </div></section>&#13;
      </div></section>&#13;
      <section data-pdf-bookmark="Planning AI Applications" data-type="sect1"><div class="sect1" id="ch01_planning_ai_applications_1730130814985969">&#13;
        <h1>Planning AI Applications</h1>&#13;
<p><a contenteditable="false" data-primary="application building" data-secondary="application planning" data-type="indexterm" id="ch01.html14"/><a contenteditable="false" data-primary="application planning" data-type="indexterm" id="ch01.html15"/>Given the seemingly limitless potential of AI, it’s tempting to jump into building applications. If you just want to learn and have fun, jump right in. Building is one of the best ways to learn. In the early days of foundation models, several heads of AI told me that they encouraged their teams to experiment with AI applications to upskill themselves.</p>&#13;
<p>However, if you’re doing this for a living, it might be worthwhile to take a step back and consider why you’re building this and how you should go about it. It’s easy to build a cool demo with foundation models. It’s hard to create a profitable product.</p>&#13;
        <section data-pdf-bookmark="Use Case Evaluation" data-type="sect2"><div class="sect2" id="ch01_use_case_evaluation_1730130814986039">&#13;
          <h2>Use Case Evaluation</h2>&#13;
<p><a contenteditable="false" data-primary="application building" data-secondary="application planning" data-tertiary="use case evaluation" data-type="indexterm" id="ch01.html16"/><a contenteditable="false" data-primary="application planning" data-secondary="use case evaluation" data-type="indexterm" id="ch01.html17"/><a contenteditable="false" data-primary="use case evaluation" data-type="indexterm" id="ch01.html18"/>The first question to ask is why you want to build this application. Like many business decisions, building an AI application is often a response to risks and opportunities. Here are a few examples of different levels of risks, ordered from high to low:</p>&#13;
          <ol>&#13;
            <li>&#13;
<p><em>If you don’t do this, competitors with AI can make you obsolete.</em> If AI poses a major existential threat to your business, incorporating AI must have the highest priority. In the 2023 <a href="https://oreil.ly/gqi3d">Gartner study</a>, 7% cited business continuity as their reason for embracing AI. This is more common for businesses involving document processing and information aggregation, such as financial analysis, insurance, and data processing. This is also common for creative work such as advertising, web design, and image production. You can refer to the 2023 OpenAI study, “GPTs are GPTs” (<a href="https://arxiv.org/abs/2303.10130">Eloundou et al., 2023</a>), to see how industries rank in their exposure to AI.</p></li>&#13;
            <li>&#13;
<p><em>If you don’t do this, you’ll miss opportunities to boost profits and productivity.</em> Most companies embrace AI for the opportunities it brings. AI can help in most, if not all, business operations. AI can make user acquisition cheaper by crafting more effective copywrites, product descriptions, and promotional visual content. AI can increase user retention by improving customer support and customizing user experience. AI can also help with sales lead generation, internal communication, market research, and competitor tracking.</p></li>&#13;
<li><p><em>You’re unsure where AI will fit into your business yet, but you don’t want to be left behind.</em> While a company shouldn’t chase every hype train, many have failed by waiting too long to take the leap (cue Kodak, Blockbuster, and BlackBerry). Investing resources into understanding how a new, transformational technology can impact your business isn’t a bad idea if you can afford it. At bigger companies, this can be part of the R&amp;D department.<sup><a data-type="noteref" href="ch01.html#id599" id="id599-marker">19</a></sup></p></li>&#13;
          </ol>&#13;
<p>Once you’ve found a good reason to develop this use case, you might consider whether you have to build it yourself. If AI poses an existential threat to your business, you might want to do AI in-house instead of outsourcing it to a competitor. However, if you’re using AI to boost profits and productivity, you might have plenty of buy options that can save you time and money while giving you better <span class="keep-together">performance.</span></p>&#13;
          <section data-pdf-bookmark="The role of AI and humans in the application" data-type="sect3"><div class="sect3" id="ch01_the_role_of_ai_and_humans_in_the_application_1730130814986106">&#13;
            <h3>The role of AI and humans in the application</h3>&#13;
<p><a contenteditable="false" data-primary="large language models" data-secondary="role of AI and humans in the application" data-type="indexterm" id="ch01.html19"/>What role AI plays in the AI product influences the application’s development and its requirements. <a href="https://oreil.ly/Dz1HE">Apple</a> has a great document explaining different ways AI can be used in a product. Here are three key points relevant to the current discussion:</p>&#13;
            <dl>&#13;
              <dt>Critical or complementary</dt>&#13;
              <dd>&#13;
<p>If an app can still work without AI, AI is complementary to the app. For example, Face ID wouldn’t work without AI-powered facial recognition, whereas Gmail would still work without Smart Compose.</p></dd>&#13;
              <dd>&#13;
<p>The more critical AI is to the application, the more accurate and reliable the AI part has to be. People are more accepting of mistakes when AI isn’t core to the application.</p></dd>&#13;
              <dt>Reactive or proactive</dt>&#13;
              <dd>&#13;
<p><a contenteditable="false" data-primary="proactive features" data-type="indexterm" id="id600"/><a contenteditable="false" data-primary="reactive features" data-type="indexterm" id="id601"/>A reactive feature shows its responses in reaction to users’ requests or specific actions, whereas a proactive feature shows its responses when there’s an opportunity for it. For example, a chatbot is reactive, whereas traffic alerts on Google Maps are proactive.</p></dd>&#13;
              <dd>&#13;
<p>Because reactive features are generated in response to events, they usually, but not always, need to happen fast. On the other hand, proactive features can be precomputed and shown opportunistically, so latency is less important.</p></dd>&#13;
              <dd>&#13;
<p>Because users don’t ask for proactive features, they can view them as intrusive or annoying if the quality is low. Therefore, proactive predictions and generations typically have a higher quality bar.</p></dd>&#13;
              <dt>Dynamic or static</dt>&#13;
              <dd>&#13;
<p><a contenteditable="false" data-primary="dynamic features" data-type="indexterm" id="id602"/><a contenteditable="false" data-primary="static features" data-type="indexterm" id="id603"/>Dynamic features are updated continually with user feedback, whereas static features are updated periodically. For example, Face ID needs to be updated as people’s faces change over time. However, object detection in Google Photos is likely updated only when Google Photos is upgraded.</p></dd>&#13;
              <dd>&#13;
<p>In the case of AI, dynamic features might mean that each user has their own model, continually finetuned on their data, or other mechanisms for personalization such as ChatGPT’s memory feature, which allows ChatGPT to remember each user’s preferences. However, static features might have one model for a group of users. If that’s the case, these features are updated only when the shared model is updated.</p></dd>&#13;
            </dl>&#13;
<p class="pagebreak-before">It’s also important to clarify the role of humans in the application. Will AI provide background support to humans, make decisions directly, or both? For example, for a customer support chatbot, AI responses can be used in different ways:</p>&#13;
            <ul>&#13;
              <li>&#13;
<p>AI shows several responses that human agents can reference to write faster responses.</p></li>&#13;
              <li>&#13;
<p>AI responds only to simple requests and routes more complex requests to humans.</p></li>&#13;
              <li>&#13;
<p>AI responds to all requests directly, without human involvement.</p></li>&#13;
            </ul>&#13;
<p> Involving humans in AI’s decision-making processes is called <em>human-in-the-loop</em>.</p>&#13;
<p>Microsoft (2023) proposed a framework for gradually increasing AI automation in products that they call <a href="https://oreil.ly/JW4_A">Crawl-Walk-Run</a>:</p>&#13;
            <ol>&#13;
              <li>&#13;
<p>Crawl means human involvement is mandatory.</p></li>&#13;
              <li>&#13;
<p>Walk means AI can directly interact with internal employees.</p></li>&#13;
              <li>&#13;
<p>Run means increased automation, potentially including direct AI interactions with external users.</p></li>&#13;
            </ol>&#13;
<p>The role of humans can change over time as the quality of the AI system improves. For example, in the beginning, when you’re still evaluating AI capabilities, you might use it to generate suggestions for human agents. If the acceptance rate by human agents is high, for example, 95% of AI-suggested responses to simple requests are used by human agents verbatim, you can let customers interact with AI directly for those simple requests.<a contenteditable="false" data-primary="" data-startref="ch01.html19" data-type="indexterm" id="id604"/></p>&#13;
          </div></section>&#13;
          <section data-pdf-bookmark="AI product defensibility" data-type="sect3"><div class="sect3" id="ch01_ai_product_defensibility_1730130814986165">&#13;
            <h3>AI product defensibility</h3>&#13;
<p><a contenteditable="false" data-primary="large language models" data-secondary="AI product defensibility" data-type="indexterm" id="id605"/><a contenteditable="false" data-primary="large language models" data-secondary="set expectations" data-type="indexterm" id="id606"/>If you’re selling AI applications as standalone products, it’s important to consider their defensibility. The low entry barrier is both a blessing and a curse. If something is easy for you to build, it’s also easy for your competitors. What moats do you have to defend your product?</p>&#13;
<p>In a way, building applications on top of foundation models means providing a layer on top of these models.<sup><a data-type="noteref" href="ch01.html#id607" id="id607-marker">20</a></sup> This also means that if the underlying models expand in capabilities, the layer you provide might be subsumed by the models, rendering your application obsolete. Imagine building a PDF-parsing application on top of ChatGPT based on the assumption that ChatGPT can’t parse PDFs well or can’t do so at scale. Your ability to compete will weaken if this assumption is no longer true. However, even in this case, a PDF-parsing application might still make sense if it’s built on top of open source models, gearing your solution toward users who want to host models in-house.</p>&#13;
<p>One general partner at a major VC firm told me that she’s seen many startups whose entire products could be a feature for Google Docs or Microsoft Office. If their products take off, what would stop Google or Microsoft from allocating three engineers to replicate these products in two weeks?</p>&#13;
<p>In AI, there are generally three types of competitive advantages: technology, data, and distribution—the ability to bring your product in front of users. With foundation models, the core technologies of most companies will be similar. The distribution advantage likely belongs to big companies.</p>&#13;
<p>The data advantage is more nuanced. Big companies likely have more existing data. However, if a startup can get to market first and gather sufficient usage data to continually improve their products, data will be their moat. Even for the scenarios where user data can’t be used to train models directly, usage information can give invaluable insights into user behaviors and product shortcomings, which can be used to guide the data collection and training process.<sup><a data-type="noteref" href="ch01.html#id608" id="id608-marker">21</a></sup></p>&#13;
<p>There have been many successful companies whose original products could’ve been features of larger products. Calendly could’ve been a feature of Google Calendar. Mailchimp could’ve been a feature of Gmail. Photoroom could’ve been a feature of Google Photos.<sup><a data-type="noteref" href="ch01.html#id609" id="id609-marker">22</a></sup> Many startups eventually overtake bigger competitors, starting by building a feature that these bigger competitors overlooked. Perhaps yours can be the next one.<a contenteditable="false" data-primary="" data-startref="ch01.html18" data-type="indexterm" id="id610"/><a contenteditable="false" data-primary="" data-startref="ch01.html17" data-type="indexterm" id="id611"/><a contenteditable="false" data-primary="" data-startref="ch01.html16" data-type="indexterm" id="id612"/></p>&#13;
          </div></section>&#13;
        </div></section>&#13;
        <section data-pdf-bookmark="Setting Expectations" data-type="sect2"><div class="sect2" id="ch01_setting_expectations_1730130814986221">&#13;
          <h2>Setting Expectations</h2>&#13;
<p><a contenteditable="false" data-primary="application building" data-secondary="application planning" data-tertiary="set expectations" data-type="indexterm" id="id613"/><a contenteditable="false" data-primary="application planning" data-secondary="set expectations" data-type="indexterm" id="id614"/><a contenteditable="false" data-primary="expectation setting" data-type="indexterm" id="id615"/>Once you’ve decided that you need to build this amazing AI application by yourself, the next step is to figure out what success looks like: how will you measure success? The most important metric is how this will impact your business. For example, if it’s a customer support chatbot, the business metrics can include the following:</p>&#13;
          <ul>&#13;
            <li>&#13;
<p>What percentage of customer messages do you want the chatbot to automate?</p></li>&#13;
            <li>&#13;
<p>How many more messages should the chatbot allow you to process?</p></li>&#13;
            <li>&#13;
<p>How much quicker can you respond using the chatbot?</p></li>&#13;
            <li>&#13;
<p>How much human labor can the chatbot save you?</p></li>&#13;
          </ul>&#13;
<p>A chatbot can answer more messages, but that doesn’t mean it’ll make users happy, so it’s important to track customer satisfaction and customer feedback in general. <a data-type="xref" href="ch10.html#ch10_user_feedback_1730130985313500">“User Feedback”</a> discusses how to design a feedback system.</p>&#13;
<p><a contenteditable="false" data-primary="metrics" data-secondary="usefulness thresholds" data-type="indexterm" id="id616"/><a contenteditable="false" data-primary="usefulness threshold" data-type="indexterm" id="id617"/>To ensure a product isn’t put in front of customers before it’s ready, have clear expectations on its usefulness threshold: how good it has to be for it to be useful. Usefulness thresholds might include the following metrics groups:</p>&#13;
          <ul>&#13;
            <li>&#13;
<p>Quality metrics to measure the quality of the chatbot’s responses.</p></li>&#13;
            <li>&#13;
<p><a contenteditable="false" data-primary="latency" data-secondary="metrics" data-type="indexterm" id="id618"/><a contenteditable="false" data-primary="time per output token (TPOT)" data-type="indexterm" id="id619"/><a contenteditable="false" data-primary="time to first token (TTFT)" data-type="indexterm" id="id620"/><a contenteditable="false" data-primary="TPOT (time per output token)" data-type="indexterm" id="id621"/><a contenteditable="false" data-primary="TTFT (time to first token)" data-type="indexterm" id="id622"/>Latency metrics including TTFT (time to first token), TPOT (time per output token), and total latency. What is considered acceptable latency depends on your use case. If all of your customer requests are currently being processed by humans with a median response time of an hour, anything faster than this might be good enough.</p></li>&#13;
            <li>&#13;
<p>Cost metrics: how much it costs per inference request.</p></li>&#13;
            <li>&#13;
<p>Other metrics such as interpretability and fairness.</p></li>&#13;
          </ul>&#13;
<p>If you’re not yet sure what metrics you want to use, don’t worry. The rest of the book will cover many of these metrics.</p>&#13;
        </div></section>&#13;
        <section data-pdf-bookmark="Milestone Planning" data-type="sect2"><div class="sect2" id="ch01_milestone_planning_1730130814986287">&#13;
          <h2>Milestone Planning</h2>&#13;
<p><a contenteditable="false" data-primary="application building" data-secondary="application planning" data-tertiary="milestone planning" data-type="indexterm" id="id623"/><a contenteditable="false" data-primary="application planning" data-secondary="milestone planning" data-type="indexterm" id="id624"/><a contenteditable="false" data-primary="milestone planning" data-type="indexterm" id="id625"/>Once you’ve set measurable goals, you need a plan to achieve these goals. How to get to the goals depends on where you start. Evaluate existing models to understand their capabilities. The stronger the off-the-shelf models, the less work you’ll have to do. For example, if your goal is to automate 60% of customer support tickets and the off-the-shelf model you want to use can already automate 30% of the tickets, the effort you need to put in might be less than if it can automate no tickets at all.</p>&#13;
<p>It’s likely that your goals will change after evaluation. For example, after evaluation, you may realize that the resources needed to get the app to the usefulness threshold will be more than its potential return, and, therefore, you no longer want to pursue it.</p>&#13;
<p>Planning an AI product needs to account for its last mile challenge. Initial success with foundation models can be misleading. As the base capabilities of foundation models are already quite impressive, it might not take much time to build a fun demo. However, a good initial demo doesn’t promise a good end product. It might take a weekend to build a demo but months, and even years, to build a product.</p>&#13;
<p>In the paper UltraChat, <a href="https://arxiv.org/abs/2305.14233">Ding et al. (2023)</a> shared that “the journey from 0 to 60 is easy, whereas progressing from 60 to 100 becomes exceedingly challenging.” <a href="https://www.linkedin.com/blog/engineering/generative-ai/musings-on-building-a-generative-ai-product">LinkedIn (2024)</a>  shared the same sentiment. It took them one month to achieve 80% of the experience they wanted. This initial success made them grossly underestimate how much time it’d take them to improve the product. They found it took them four more months to finally surpass 95%. A lot of time was spent working on the product kinks and dealing with hallucinations. The slow speed of achieving each subsequent 1% gain was discouraging.</p>&#13;
        </div></section>&#13;
        <section data-pdf-bookmark="Maintenance" data-type="sect2"><div class="sect2" id="ch01_maintenance_1730130814986342">&#13;
          <h2>Maintenance</h2>&#13;
<p><a contenteditable="false" data-primary="application building" data-secondary="application planning" data-tertiary="maintenance" data-type="indexterm" id="id626"/><a contenteditable="false" data-primary="application planning" data-secondary="maintenance" data-type="indexterm" id="id627"/>Product planning doesn’t stop at achieving its goals. You need to think about how this product might change over time and how it should be maintained. Maintenance of an AI product has the added challenge of AI’s fast pace of change. The AI space has been moving incredibly fast in the last decade. It’ll probably continue moving fast for the next decade. Building on top of foundation models today means committing to riding this bullet train.</p>&#13;
<p>Many changes are good. For example, the limitations of many models are being addressed. Context lengths are getting longer. Model outputs are getting better. <a contenteditable="false" data-primary="Massive Multitask Language Understanding (MMLU)" data-type="indexterm" id="id628"/><a contenteditable="false" data-primary="MMLU (Massive Multitask Language Understanding)" data-type="indexterm" id="id629"/><a contenteditable="false" data-primary="model inference" data-type="indexterm" id="id630"/>Model <em>inference</em>, the process of computing an output given an input, is getting faster and cheaper. <a data-type="xref" href="#ch01_figure_11_1730130814920109">Figure 1-11</a> shows the evolution of inference cost and model performance on Massive Multitask Language Understanding (MMLU) (<a href="https://arxiv.org/abs/2009.03300">Hendrycks et al., 2020</a>), a popular foundation model benchmark, between 2022 and 2024.</p>&#13;
          <figure><div class="figure" id="ch01_figure_11_1730130814920109">&#13;
            <img alt="A graph with numbers and a number of points&#10;&#10;Description automatically generated with medium confidence" src="assets/aien_0111.png"/>&#13;
            <h6><span class="label">Figure 1-11. </span>The cost of AI reasoning rapidly drops over time. Image from <a href="https://oreil.ly/UyL8r">Katrina Nguyen</a> (2024).</h6>&#13;
          </div></figure>&#13;
<p class="pagebreak-before">However, even these good changes can cause friction in your workflows. You’ll have to constantly be on your guard and run a cost-benefit analysis of each technology investment. The best option today might turn into the worst option tomorrow. You may decide to build a model in-house because it seems cheaper than paying for model providers, only to find out after three months that model providers have dropped their prices in half, making in-house the expensive option. You might invest in a third-party solution and tailor your infrastructure around it, only for the provider to go out of business after failing to secure funding.</p>&#13;
<p>Some changes are easier to adapt to. For example, as model providers converge to the same API, it’s becoming easier to swap one model API for another. However, as each model has its quirks, strengths, and weaknesses, developers working with the new model will need to adjust their workflows, prompts, and data to this new model. Without proper infrastructure for versioning and evaluation in place, the process can cause a lot of headaches.</p>&#13;
<p>Some changes are harder to adapt to, especially those around regulations. Technologies surrounding AI are considered national security issues for many countries, meaning resources for AI, including compute, talent, and data, are heavily regulated. The introduction of Europe’s General Data Protection Regulation (GDPR), for example, was estimated to cost businesses <a href="https://oreil.ly/eDfB8">$9 billion</a> to become compliant. Compute availability can change overnight as new laws put more restrictions on who can buy and sell compute resources (see the <a href="https://oreil.ly/eYTmr">US October 2023 Executive Order</a>). If your GPU vendor is suddenly banned from selling GPUs to your country, you’re in trouble.</p>&#13;
<p>Some changes can even be fatal. For example, regulations around intellectual property (IP) and AI usage are still evolving. If you build your product on top of a model trained using other people’s data, can you be certain that your product’s IP will always belong to you? Many IP-heavy companies I’ve talked to, such as game studios, hesitate to use AI for fear of losing their IPs later on.</p>&#13;
<p>Once you’ve committed to building an AI product, let’s look into the engineering stack needed to build these applications.<a contenteditable="false" data-primary="" data-startref="ch01.html15" data-type="indexterm" id="id631"/><a contenteditable="false" data-primary="" data-startref="ch01.html14" data-type="indexterm" id="id632"/></p>&#13;
        </div></section>&#13;
      </div></section>&#13;
      <section data-pdf-bookmark="The AI Engineering Stack" data-type="sect1"><div class="sect1" id="ch01_the_ai_engineering_stack_1730130814986431">&#13;
        <h1>The AI Engineering Stack</h1>&#13;
<p><a contenteditable="false" data-primary="application building" data-secondary="engineering stack" data-type="indexterm" id="ch01.html20"/>AI engineering’s rapid growth also induced an incredible amount of hype and FOMO (fear of missing out). The number of new tools, techniques, models, and applications introduced every day can be overwhelming. Instead of trying to keep up with the constantly shifting sand, let’s look into the fundamental building blocks of AI <span class="keep-together">engineering.</span></p>&#13;
<p class="pagebreak-before">To understand AI engineering, it’s important to recognize that AI engineering evolved out of ML engineering. When a company starts experimenting with foundation models, it’s natural that its existing ML team should lead the effort. Some companies treat AI engineering the same as ML engineering, as shown in <a data-type="xref" href="#ch01_figure_12_1730130814920130">Figure 1-12</a>.</p>&#13;
        <figure><div class="figure" id="ch01_figure_12_1730130814920130">&#13;
          <img alt="A screenshot of a computer&#10;&#10;Description automatically generated" src="assets/aien_0112.png"/>&#13;
          <h6><span class="label">Figure 1-12. </span>Many companies put AI engineering and ML engineering under the same umbrella, as shown in the job headlines on LinkedIn from December 17, 2023.</h6>&#13;
        </div></figure>&#13;
<p>Some companies have separate job descriptions for AI engineering, as shown in <a data-type="xref" href="#ch01_figure_13_1730130814920151">Figure 1-13</a>.</p>&#13;
       &#13;
<p>Regardless of where organizations position AI engineers and ML engineers, their roles have significant overlap. Existing ML engineers can add AI engineering to their lists of skills to expand their job prospects. However, there are also AI engineers with no previous ML experience.</p>&#13;
<p>To best understand AI engineering and how it differs from traditional ML engineering, the following section breaks down different layers of the AI application building process and looks at the role each layer plays in AI engineering and ML engineering.</p>&#13;
&#13;
 <figure><div class="figure" id="ch01_figure_13_1730130814920151">&#13;
          <img alt="A screenshot of a computer&#10;&#10;Description automatically generated" src="assets/aien_0113.png"/>&#13;
          <h6><span class="label">Figure 1-13. </span>Some companies have separate job descriptions for AI engineering, as shown in the job headlines on LinkedIn from December 17, 2023.</h6>&#13;
        </div></figure>&#13;
&#13;
        <section data-pdf-bookmark="Three Layers of the AI Stack" data-type="sect2"><div class="sect2" id="ch01_three_layers_of_the_ai_stack_1730130814986512">&#13;
          <h2>Three Layers of the AI Stack</h2>&#13;
<p><a contenteditable="false" data-primary="application building" data-secondary="engineering stack" data-tertiary="three layers of AI stack" data-type="indexterm" id="ch01.html21"/><a contenteditable="false" data-primary="engineering stack" data-type="indexterm" id="ch01.html22"/>There are three layers to any AI application stack: application development, model development, and infrastructure. When developing an AI application, you’ll likely start from the top layer and move down as needed:</p>&#13;
          <dl>&#13;
            <dt>Application development</dt>&#13;
            <dd>&#13;
<p><a contenteditable="false" data-primary="application development" data-type="indexterm" id="id633"/><a contenteditable="false" data-primary="engineering stack" data-secondary="application development" data-type="indexterm" id="id634"/>With models readily available, anyone can use them to develop applications. This is the layer that has seen the most action in the last two years, and it is still rapidly evolving. Application development involves providing a model with good prompts and necessary context. This layer requires rigorous evaluation. Good applications also demand good interfaces.</p>&#13;
            </dd>&#13;
            <dt>Model development</dt>&#13;
            <dd>&#13;
<p><a contenteditable="false" data-primary="engineering stack" data-secondary="model development" data-type="indexterm" id="id635"/><a contenteditable="false" data-primary="model development" data-type="indexterm" id="id636"/>This layer provides tooling for developing models, including frameworks for modeling, training, finetuning, and inference optimization. Because data is central to model development, this layer also contains dataset engineering. Model development also requires rigorous evaluation.</p>&#13;
            </dd>&#13;
            <dt>Infrastructure</dt>&#13;
            <dd>&#13;
<p><a contenteditable="false" data-primary="engineering stack" data-secondary="infrastructure" data-type="indexterm" id="id637"/>At the bottom is the stack is infrastructure, which includes tooling for model serving, managing data and compute, and monitoring.</p>&#13;
            </dd>&#13;
          </dl>&#13;
<p>These three layers and examples of responsibilities for each layer are shown in <a data-type="xref" href="#ch01_figure_14_1730130814920166">Figure 1-14</a>.</p>&#13;
          <figure><div class="figure" id="ch01_figure_14_1730130814920166">&#13;
            <img alt="A diagram of a software development&#10;&#10;Description automatically generated" src="assets/aien_0114.png"/>&#13;
            <h6><span class="label">Figure 1-14. </span>Three layers of the AI engineering stack.</h6>&#13;
          </div></figure>&#13;
<p>To get a sense of how the landscape has evolved with foundation models, in March 2024, I searched GitHub for all AI-related repositories with at least 500 stars. Given the prevalence of GitHub, I believe this data is a good proxy for understanding the ecosystem. In my analysis, I also included repositories for applications and models, which are the products of the application development and model development layers, respectively. I found a total of 920 repositories. <a data-type="xref" href="#ch01_figure_15_1730130814920182">Figure 1-15</a> shows the cumulative number of repositories in each category month-over-month.</p>&#13;
          <figure><div class="figure" id="ch01_figure_15_1730130814920182">&#13;
            <img alt="A graph of a number of people&#10;&#10;Description automatically generated" src="assets/aien_0115.png"/>&#13;
            <h6><span class="label">Figure 1-15. </span>Cumulative count of repositories by category over time.</h6>&#13;
          </div></figure>&#13;
<p>The data shows a big jump in the number of AI toolings in 2023, after the introduction of Stable Diffusion and ChatGPT. In 2023, the categories that saw the highest increases were applications and application development. The infrastructure layer saw some growth, but it was much less than the growth seen in other layers. This is expected. Even though models and applications have changed, the core infrastructural needs—resource management, serving, monitoring, etc.—remain the same.</p>&#13;
<p>This brings us to the next point. While the level of excitement and creativity around foundation models is unprecedented, many principles of building AI applications remain the same. For enterprise use cases, AI applications still need to solve business problems, and, therefore, it’s still essential to map from business metrics to ML metrics and vice versa. You still need to do systematic experimentation. With classical ML engineering, you experiment with different hyperparameters. With foundation models, you experiment with different models, prompts, retrieval algorithms, sampling variables, and more. (Sampling variables are discussed in <a data-type="xref" href="ch02.html#ch02_understanding_foundation_models_1730147895571359">Chapter 2</a>.) We still want to make models run faster and cheaper. It’s still important to set up a feedback loop so that we can iteratively improve our applications with production data.</p>&#13;
<p>This means that much of what ML engineers have learned and shared over the last decade is still applicable. This collective experience makes it easier for everyone to begin building AI applications. However, built on top of these enduring principles are many innovations unique to AI engineering, which we’ll explore in this book.<a contenteditable="false" data-primary="" data-startref="ch01.html22" data-type="indexterm" id="id638"/><a contenteditable="false" data-primary="" data-startref="ch01.html21" data-type="indexterm" id="id639"/></p>&#13;
        </div></section>&#13;
        <section data-pdf-bookmark="AI Engineering Versus ML Engineering" data-type="sect2"><div class="sect2" id="ch01_ai_engineering_versus_ml_engineering_1730130814986585">&#13;
          <h2>AI Engineering Versus ML Engineering</h2>&#13;
<p><a contenteditable="false" data-primary="application building" data-secondary="engineering stack" data-tertiary="AI engineering versus ML engineering" data-type="indexterm" id="ch01.html23"/><a contenteditable="false" data-primary="ML engineering, AI engineering versus" data-type="indexterm" id="ch01.html24"/><a contenteditable="false" data-primary="AI engineering (AIE)" data-secondary="ML engineering versus" data-type="indexterm" id="ch01.html24a"/>While the unchanging principles of deploying AI applications are reassuring, it’s also important to understand how things have changed. This is helpful for teams that want to adapt their existing platforms for new AI use cases and developers who are interested in which skills to learn to stay competitive in a new market.</p>&#13;
<p>At a high level, building applications using foundation models today differs from traditional ML engineering in three major ways:</p>&#13;
          <ol>&#13;
            <li>&#13;
<p>Without foundation models, you have to train your own models for your applications. With AI engineering, you use a model someone else has trained for you. This means that AI engineering focuses less on modeling and training, and more on model adaptation.</p></li>&#13;
            <li>&#13;
<p>AI engineering works with models that are bigger, consume more compute resources, and incur higher latency than traditional ML engineering. This means that there’s more pressure for efficient training and inference optimization. A corollary of compute-intensive models is that many companies now need more GPUs and work with bigger compute clusters than they previously did, which means there’s more need for engineers who know how to work with GPUs and big clusters.<sup><a data-type="noteref" href="ch01.html#id640" id="id640-marker">23</a></sup></p></li>&#13;
            <li>&#13;
<p>AI engineering works with models that can produce open-ended outputs. Open-ended outputs give models the flexibility to be used for more tasks, but they are also harder to evaluate. This makes evaluation a much bigger problem in AI engineering.</p></li>&#13;
          </ol>&#13;
<p>In short, AI engineering differs from ML engineering in that it’s less about model development and more about adapting and evaluating models. I’ve mentioned model adaptation several times in this chapter, so before we move on, I want to make sure that we’re on the same page about what model adaptation means. In general, model adaptation techniques can be divided into two categories, depending on whether they require updating model weights.</p>&#13;
<p><em>Prompt-based techniques, which include prompt engineering, adapt a model without updating the model weights.</em> You adapt a model by giving it instructions and context instead of changing the model itself. Prompt engineering is easier to get started and requires less data. Many successful applications have been built with just prompt engineering. Its ease of use allows you to experiment with more models, which increases your chance of finding a model that is unexpectedly good for your applications. However, prompt engineering might not be enough for complex tasks or applications with strict performance requirements.</p>&#13;
<p><em>Finetuning, on the other hand, requires updating model weights.</em> You adapt a model by making changes to the model itself. In general, finetuning techniques are more complicated and require more data, but they can improve your model’s quality, latency, and cost significantly. Many things aren’t possible without changing model weights, such as adapting the model to a new task it wasn’t exposed to during training.</p>&#13;
<p>Now, let’s zoom into the application development and model development layers to see how each has changed with AI engineering, starting with what existing ML engineers are more familiar with. This section gives an overview of different processes involved in developing an AI application. How these processes work will be discussed throughout this book.</p>&#13;
          <section data-pdf-bookmark="Model development" data-type="sect3"><div class="sect3" id="ch01_model_development_1730130814986662">&#13;
            <h3>Model development</h3>&#13;
<p><a contenteditable="false" data-primary="engineering stack" data-secondary="ML engineering versus" data-type="indexterm" id="ch01.html25"/><a contenteditable="false" data-primary="model development" data-type="indexterm" id="ch01.html27"/><em>Model development</em> is the layer most commonly associated with traditional ML engineering. It has three main responsibilities: modeling and training, dataset engineering, and inference optimization. Evaluation is also required, but because most people will come across it first in the application development layer, I’ll discuss evaluation in the next section.</p>&#13;
            <section data-pdf-bookmark="Modeling and training" data-type="sect4"><div class="sect4" id="ch01_modeling_and_training_1730130814986733">&#13;
              <h4>Modeling and training</h4>&#13;
<p><a contenteditable="false" data-primary="model development" data-secondary="modeling and training" data-type="indexterm" id="ch01.html29"/><a contenteditable="false" data-primary="training" data-type="indexterm" id="ch01.html30"/><em>Modeling and training</em> refers to the process of coming up with a model architecture, training it, and finetuning it. Examples of tools in this category are Google’s TensorFlow, Hugging Face’s Transformers, and Meta’s PyTorch.</p>&#13;
<p>Developing ML models requires specialized ML knowledge. It requires knowing different types of ML algorithms (such as clustering, logistic regression, decision trees, and collaborative filtering) and neural network architectures (such as feedforward, recurrent, convolutional, and transformer). It also requires understanding how a model learns, including concepts such as gradient descent, loss function, regularization, etc.</p>&#13;
<p>With the availability of foundation models, ML knowledge is no longer a must-have for building AI applications. I’ve met many wonderful and successful AI application builders who aren’t at all interested in learning about gradient descent. However, ML knowledge is still extremely valuable, as it expands the set of tools that you can use and helps troubleshooting when a model doesn’t work as expected.</p>&#13;
              <aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="ch01_on_the_differences_among_training_pre_training_f_1730130814986798">&#13;
                <h1>On the Differences Among Training, Pre-Training, <span class="keep-together">Finetuning, and Post-Training</span></h1>&#13;
<p>Training always involves changing model weights, but not all changes to model weights constitute training. For example, quantization, the process of reducing the precision of model weights, technically changes the model’s weight values but isn’t considered training.</p>&#13;
<p>The term training can often be used in place of pre-training, finetuning, and post-training, which refer to different training phases:</p>&#13;
                <dl>&#13;
                  <dt>Pre-training</dt>&#13;
                  <dd>&#13;
  <p><a contenteditable="false" data-primary="pre-training" data-type="indexterm" id="id641"/><em>Pre-training refers to </em>training a model from scratch—the model weights are randomly initialized. For LLMs, pre-training often involves training a model for text completion. Out of all training steps, pre-training is often the most resource-intensive by a long shot. For the InstructGPT model, pre-training takes up to <a href="https://oreil.ly/G3LUh">98% of the overall compute and data resources</a>. Pre-training also takes a long time to do. A small mistake during pre-training can incur a significant financial loss and set back the project significantly. Due to the resource-intensive nature of pre-training, this has become an art that only a few practice. Those with expertise in pre-training large models, however, are heavily sought after.<sup><a data-type="noteref" href="ch01.html#id642" id="id642-marker">24</a></sup></p>&#13;
                  </dd>&#13;
                  <dt>Finetuning</dt>&#13;
                  <dd>&#13;
  <p><a contenteditable="false" data-primary="finetuning" data-secondary="defined" data-type="indexterm" id="id643"/>Finetuning means continuing to train a previously trained model—the model weights are obtained from the previous training process. Because the model already has certain knowledge from pre-training, finetuning typically requires fewer resources (e.g., data and compute) than pre-training.</p>&#13;
                  </dd>&#13;
                  <dt>Post-training</dt>&#13;
                  <dd>&#13;
  <p><a contenteditable="false" data-primary="post-training" data-type="indexterm" id="id644"/>Many people use <em>post-training</em> to refer to the process of training a model after the pre-training phase. Conceptually, post-training and finetuning are the same and can be used interchangeably. However, sometimes, people might use them differently to signify the different goals. It’s usually post-training when it’s done by model developers. For example, OpenAI might post-train a model to make it better at following instructions before releasing it. It’s finetuning when it’s done by application developers. For example, you might finetune an OpenAI model (which might have been post-trained itself) to adapt it to your needs.</p>&#13;
                  </dd>&#13;
                </dl>&#13;
<p>Pre-training and post-training make up a spectrum.<sup><a data-type="noteref" href="ch01.html#id645" id="id645-marker">25</a></sup> Their processes and toolings are very similar. Their differences are explored further in Chapters <a data-type="xref" data-xrefstyle="select:labelnumber" href="ch02.html#ch02_understanding_foundation_models_1730147895571359">2</a> and <a data-type="xref" data-xrefstyle="select:labelnumber" href="ch07.html#ch07">7</a>.</p>&#13;
<p>Some people use the term training to refer to prompt engineering, which isn’t correct. I read a <a href="https://oreil.ly/0VqmX"><em>Business Insider</em> article</a> where the author said she trained ChatGPT to mimic her younger self. She did so by feeding her childhood journal entries into ChatGPT. Colloquially, the author’s usage of the word <em>training</em> is correct, as she’s teaching the model to do something. But technically, if you teach a model what to do via the context input into the model, you’re doing prompt engineering. Similarly, I’ve seen people using the term <em>finetuning</em> when what they do is prompt engineering.<a contenteditable="false" data-primary="" data-startref="ch01.html30" data-type="indexterm" id="id646"/><a contenteditable="false" data-primary="" data-startref="ch01.html29" data-type="indexterm" id="id647"/></p>&#13;
              </div></aside>&#13;
            </div></section>&#13;
            <section data-pdf-bookmark="Dataset engineering" data-type="sect4"><div class="sect4" id="ch01_dataset_engineering_1730130814986874">&#13;
              <h4>Dataset engineering</h4>&#13;
<p><a contenteditable="false" data-primary="dataset engineering" data-type="indexterm" id="id648"/><a contenteditable="false" data-primary="model development" data-secondary="dataset engineering" data-type="indexterm" id="id649"/><em>Dataset engineering</em> refers to curating, generating, and annotating the data needed for training and adapting AI models.</p>&#13;
<p><a contenteditable="false" data-primary="data annotation" data-secondary="dataset engineering and" data-type="indexterm" id="id650"/>In traditional ML engineering, most use cases are close-ended—a model’s output can only be among predefined values. For example, spam classification with only two possible outputs, “spam” and “not spam”, is close-ended. Foundation models, however, are open-ended. Annotating open-ended queries is much harder than annotating close-ended queries—it’s easier to determine whether an email is spam than to write an essay. So data annotation is a much bigger challenge for AI engineering.</p>&#13;
<p>Another difference is that traditional ML engineering works more with tabular data, whereas foundation models work with unstructured data. In AI engineering, data manipulation is more about deduplication, tokenization, context retrieval, and quality control, including removing sensitive information and toxic data. Dataset engineering is the focus of <a data-type="xref" href="ch08.html#ch08_dataset_engineering_1730130932019888">Chapter 8</a>.</p>&#13;
<p>Many people argue that because models are now commodities, data will be the main differentiator, making dataset engineering more important than ever. How much data you need depends on the adapter technique you use. Training a model from scratch generally requires more data than finetuning, which, in turn, requires more data than prompt engineering.</p>&#13;
<p>Regardless of how much data you need, expertise in data is useful when examining a model, as its training data gives important clues about that model’s strengths and weaknesses.</p>&#13;
            </div></section>&#13;
            <section data-pdf-bookmark="Inference optimization" data-type="sect4"><div class="sect4" id="ch01_inference_optimization_1730130814986936">&#13;
              <h4>Inference optimization</h4>&#13;
<p><a contenteditable="false" data-primary="inference optimization" data-type="indexterm" id="id651"/><a contenteditable="false" data-primary="model development" data-secondary="inference optimization" data-type="indexterm" id="ch01.html31"/><em>Inference optimization</em> means making models faster and cheaper. Inference optimization has always been important for ML engineering. Users never say no to faster models, and companies can always benefit from cheaper inference. However, as foundation models scale up to incur even higher inference cost and latency, inference optimization has become even more important.</p>&#13;
<p>One challenge with foundation models is that they are often <em>autoregressive</em>—tokens are generated sequentially. If it takes 10 ms for a model to generate a token, it’ll take a second to generate an output of 100 tokens, and even more for longer outputs. As users are getting notoriously impatient, getting AI applications’ latency down to the <a href="https://oreil.ly/gGXZ-">100 ms latency</a> expected for a typical internet application is a huge challenge. Inference optimization has become an active subfield in both industry and academia.</p>&#13;
<p>A summary of how the importance of different categories of model development change with AI engineering is shown in <a data-type="xref" href="#ch01_table_4_1730130814941579">Table 1-4</a>.</p>&#13;
              <table id="ch01_table_4_1730130814941579">&#13;
                <caption><span class="label">Table 1-4. </span>How different responsibilities of model development have changed with foundation models.</caption>&#13;
                <thead>&#13;
                  <tr>&#13;
                    <th>Category</th>&#13;
                    <th>Building with traditional ML</th>&#13;
                    <th>Building with foundation models</th>&#13;
                  </tr>&#13;
                </thead>&#13;
                <tbody>&#13;
                <tr>&#13;
                  <td>Modeling and training</td>&#13;
                  <td>ML knowledge is required for training a model from scratch</td>&#13;
                  <td>ML knowledge is a nice-to-have, not a must-have<sup><a data-type="noteref" href="ch01.html#id652" id="id652-marker">a</a></sup>&#13;
                  </td>&#13;
                </tr>&#13;
                <tr>&#13;
                  <td>Dataset engineering</td>&#13;
                  <td>More about feature engineering, especially with tabular data</td>&#13;
                  <td>Less about feature engineering and more about data deduplication, tokenization, context retrieval, and quality control</td>&#13;
                </tr>&#13;
                <tr>&#13;
                  <td>Inference optimization</td>&#13;
                  <td>Important</td>&#13;
                  <td>Even more important</td>&#13;
                </tr>&#13;
              </tbody>&#13;
              <tbody><tr class="footnotes"><td colspan="3"><p data-type="footnote" id="id652"><sup><a href="ch01.html#id652-marker">a</a></sup> Many people would dispute this claim, saying that ML knowledge is a must-have.</p></td></tr></tbody></table>&#13;
<p class="pagebreak-before">Inference optimization techniques, including quantization, distillation, and parallelism, are discussed in Chapters <a data-type="xref" data-xrefstyle="select:labelnumber" href="ch07.html#ch07">7</a> through <a data-type="xref" data-xrefstyle="select:labelnumber" href="ch09.html#ch09_inference_optimization_1730130963006301">9</a><a contenteditable="false" data-primary="" data-startref="ch01.html31" data-type="indexterm" id="id653"/>.<a contenteditable="false" data-primary="" data-startref="ch01.html27" data-type="indexterm" id="id654"/><a contenteditable="false" data-primary="" data-startref="ch01.html25" data-type="indexterm" id="id655"/></p>&#13;
            </div></section>&#13;
          </div></section>&#13;
          <section data-pdf-bookmark="Application development" data-type="sect3"><div class="sect3" id="ch01_application_development_1730130814987002">&#13;
            <h3>Application development</h3>&#13;
<p><a contenteditable="false" data-primary="application building" data-secondary="engineering stack" data-tertiary="application development" data-type="indexterm" id="ch01.html32"/><a contenteditable="false" data-primary="application development" data-type="indexterm" id="ch01.html33"/>With traditional ML engineering, where teams build applications using their proprietary models, the model quality is a differentiation. With foundation models, where many teams use the same model, differentiation must be gained through the application development process.</p>&#13;
<p>The application development layer consists of these responsibilities: evaluation, prompt engineering, and AI interface.</p>&#13;
            <section data-pdf-bookmark="Evaluation" data-type="sect4"><div class="sect4" id="ch01_evaluation_1730130814987068">&#13;
              <h4>Evaluation</h4>&#13;
<p><a contenteditable="false" data-primary="application development" data-secondary="evaluation" data-type="indexterm" id="id656"/><a contenteditable="false" data-primary="engineering stack" data-secondary="application development" data-tertiary="evaluation" data-type="indexterm" id="id657"/><a contenteditable="false" data-primary="evaluation" data-type="indexterm" id="id658"/><em>Evaluation</em> is about mitigating risks and uncovering opportunities. Evaluation is necessary throughout the whole model adaptation process. Evaluation is needed to select models, to benchmark progress, to determine whether an application is ready for deployment, and to detect issues and opportunities for improvement in production.</p>&#13;
<p>While evaluation has always been important in ML engineering, it’s even more important with foundation models, for many reasons. The challenges of evaluating foundation models are discussed in <a data-type="xref" href="ch03.html#ch03a_evaluation_methodology_1730150757064067">Chapter 3</a>. To summarize, these challenges chiefly arise from foundation models’ open-ended nature and expanded capabilities. For example, in close-ended ML tasks like fraud detection, there are usually expected ground truths that you can compare your model’s outputs against. If a model’s output differs from the expected output, you know the model is wrong. For a task like chatbots, however, there are so many possible responses to each prompt that it is impossible to curate an exhaustive list of ground truths to compare a model’s response to.</p>&#13;
<p>The existence of so many adaptation techniques also makes evaluation harder. A system that performs poorly with one technique might perform much better with another. <a contenteditable="false" data-primary="Gemini" data-type="indexterm" id="id659"/>When Google launched Gemini in December 2023, they claimed that <a contenteditable="false" data-primary="ChatGPT" data-secondary="Gemini versus" data-type="indexterm" id="id660"/>Gemini is better than ChatGPT in the MMLU benchmark (<a href="https://arxiv.org/abs/2009.03300">Hendrycks et al., 2020</a>). Google had evaluated Gemini using a prompt engineering technique called <a href="https://oreil.ly/VDwaR">CoT@32</a>. In this technique, Gemini was shown 32 examples, while ChatGPT was shown only 5 examples. When both were shown five examples, ChatGPT performed better, as shown in <a data-type="xref" href="#ch01_table_5_1730130814941611">Table 1-5</a>. </p>&#13;
              <table id="ch01_table_5_1730130814941611">&#13;
                <caption><span class="label">Table 1-5. </span>Different prompts can cause models to perform very differently, as seen in Gemini’s technical report (December 2023).</caption>&#13;
                <thead>&#13;
                  <tr>&#13;
                    <th> </th>&#13;
                    <th>Gemini Ultra</th>&#13;
                    <th>Gemini Pro</th>&#13;
                    <th>GPT-4</th>&#13;
                    <th>GPT-3.5</th>&#13;
                    <th>PaLM <span class="keep-together">2-L</span></th>&#13;
                    <th>Claude 2</th>&#13;
                    <th>Inflection-2</th>&#13;
                    <th>Grok 1</th>&#13;
                    <th>Llama-2</th>&#13;
                  </tr>&#13;
                </thead>&#13;
                <tr>&#13;
                  <td rowspan="2">MMLU performance</td>&#13;
                  <td>90.04%<br/> CoT@32</td>&#13;
                  <td>79.13%<br/> CoT@8</td>&#13;
                  <td>87.29%<br/> CoT@32<br/> (via API)</td>&#13;
                  <td>70%<br/> 5-shot</td>&#13;
                  <td>78.4%<br/> 5-shot</td>&#13;
                  <td>78.5%<br/> 5-shot CoT</td>&#13;
                  <td>79.6%<br/> 5-shot</td>&#13;
                  <td>73.0%<br/> 5-shot</td>&#13;
                  <td>68.0%</td>&#13;
                </tr>&#13;
                <tr>&#13;
                  <td>83.7%<br/> 5-shot</td>&#13;
                  <td>71.8%<br/> 5-shot</td>&#13;
                  <td>86.4%<br/> 5-shot (reported)</td>&#13;
                  <td> </td>&#13;
                  <td> </td>&#13;
                  <td> </td>&#13;
                  <td> </td>&#13;
                  <td> </td>&#13;
                  <td> </td>&#13;
                </tr>&#13;
              </table>&#13;
            </div></section>&#13;
            <section data-pdf-bookmark="Prompt engineering and context construction" data-type="sect4"><div class="sect4" id="ch01_prompt_engineering_and_context_construction_1730130814987131">&#13;
              <h4>Prompt engineering and context construction</h4>&#13;
<p><a contenteditable="false" data-primary="application development" data-secondary="prompt engineering and context construction" data-type="indexterm" id="id661"/><a contenteditable="false" data-primary="context construction" data-type="indexterm" id="id662"/><a contenteditable="false" data-primary="engineering stack" data-secondary="application development" data-tertiary="prompt engineering and context construction" data-type="indexterm" id="id663"/><a contenteditable="false" data-primary="prompt engineering" data-secondary="defined" data-type="indexterm" id="id664"/><em>Prompt engineering</em> is about getting AI models to express the desirable behaviors from the input alone, without changing the model weights. The Gemini evaluation story highlights the impact of prompt engineering on model performance. By using a different prompt engineering technique, Gemini Ultra’s performance on MMLU went from 83.7% to 90.04%.</p>&#13;
<p>It’s possible to get a model to do amazing things with just prompts. The right instructions can get a model to perform the task you want, in the format of your choice. Prompt engineering is not just about telling a model what to do. It’s also about giving the model the necessary context and tools to do a given task. For complex tasks with long context, you might also need to provide the model with a memory management system so that the model can keep track of its history. <a data-type="xref" href="ch05.html#ch05a_prompt_engineering_1730156991195551">Chapter 5</a> discusses prompt engineering, and <a data-type="xref" href="ch06.html#ch06_rag_and_agents_1730157386571386">Chapter 6</a> discusses context construction.</p>&#13;
            </div></section>&#13;
            <section data-pdf-bookmark="AI interface" data-type="sect4"><div class="sect4" id="ch01_ai_interface_1730130814987191">&#13;
              <h4>AI interface</h4>&#13;
<p><a contenteditable="false" data-primary="application development" data-secondary="AI interface" data-type="indexterm" id="id665"/><a contenteditable="false" data-primary="engineering stack" data-secondary="application development" data-tertiary="AI interface" data-type="indexterm" id="id666"/><a contenteditable="false" data-primary="interface, AI" data-type="indexterm" id="id667"/><em>AI interface</em> means creating an interface for end users to interact with your AI applications. Before foundation models, only organizations with sufficient resources to develop AI models could develop AI applications. These applications were often embedded into the organizations’ existing products. For example, fraud detection was embedded into Stripe, Venmo, and PayPal. Recommender systems were part of social networks and media apps like Netflix, TikTok, and Spotify.</p>&#13;
<p>With foundation models, anyone can build AI applications. You can serve your AI applications as standalone products or embed them into other products, including products developed by other people. For example, ChatGPT and Perplexity are standalone products, whereas GitHub’s Copilot is commonly used as a plug-in in VSCode, and Grammarly is commonly used as a browser extension for Google Docs. Midjourney can either be used via its standalone web app or via its integration in <span class="keep-together">Discord.</span></p>&#13;
<p class="pagebreak-before">There need to be tools that provide interfaces for standalone AI applications or make it easy to integrate AI into existing products. Here are just some of the interfaces that are gaining popularity for AI applications:</p>&#13;
              <ul>&#13;
<li><p>Standalone web, desktop, and mobile apps.<sup><a data-type="noteref" href="ch01.html#id668" id="id668-marker">26</a></sup></p></li>&#13;
<li><p>Browser extensions that let users quickly query AI models while browsing.</p></li>&#13;
<li><p>Chatbots integrated into chat apps like Slack, Discord, WeChat, and WhatsApp.</p></li>&#13;
<li><p>Many products, including VSCode, Shopify, and Microsoft 365, provide APIs that let developers integrate AI into their products as plug-ins and add-ons. These APIs can also be used by AI agents to interact with the world, as discussed in <a data-type="xref" href="ch06.html#ch06_rag_and_agents_1730157386571386">Chapter 6</a>.</p></li>&#13;
              </ul>&#13;
<p>While the chat interface is the most commonly used, AI interfaces can also be voice-based (such as with voice assistants) or embodied (such as in augmented and virtual reality).</p>&#13;
<p>These new AI interfaces also mean new ways to collect and extract user feedback. The conversation interface makes it so much easier for users to give feedback in natural language, but this feedback is harder to extract. User feedback design is discussed in <a contenteditable="false" data-primary="" data-startref="ch01.html33" data-type="indexterm" id="id669"/><a contenteditable="false" data-primary="" data-startref="ch01.html32" data-type="indexterm" id="id670"/><a data-type="xref" href="ch10.html#ch10_ai_engineering_architecture_and_user_feedback_1730130985311851">Chapter 10</a>.<a contenteditable="false" data-primary="" data-startref="ch01.html24" data-type="indexterm" id="id671"/><a contenteditable="false" data-primary="" data-startref="ch01.html24a" data-type="indexterm" id="id672"/><a contenteditable="false" data-primary="" data-startref="ch01.html23" data-type="indexterm" id="id673"/></p>&#13;
<p>A summary of how the importance of different categories of app development changes with AI engineering is shown in <a data-type="xref" href="#ch01_table_6_1730130814941642">Table 1-6</a>.</p>&#13;
              <table id="ch01_table_6_1730130814941642">&#13;
                <caption><span class="label">Table 1-6. </span>The importance of different categories in app development for AI engineering and ML engineering.</caption>&#13;
                <thead>&#13;
                  <tr>&#13;
                    <th>Category</th>&#13;
                    <th>Building with traditional ML</th>&#13;
                    <th>Building with foundation models</th>&#13;
                  </tr>&#13;
                </thead>&#13;
                <tr>&#13;
                  <td>AI interface</td>&#13;
                  <td>Less important</td>&#13;
                  <td>Important</td>&#13;
                </tr>&#13;
                <tr>&#13;
                  <td>Prompt engineering</td>&#13;
                  <td>Not applicable</td>&#13;
                  <td>Important</td>&#13;
                </tr>&#13;
                <tr>&#13;
                  <td>Evaluation</td>&#13;
                  <td>Important</td>&#13;
                  <td>More important</td>&#13;
                </tr>&#13;
              </table>&#13;
            </div></section>&#13;
          </div></section>&#13;
        </div></section>&#13;
        <section data-pdf-bookmark="AI Engineering Versus Full-Stack Engineering" data-type="sect2"><div class="sect2" id="ch01_ai_engineering_versus_full_stack_engineering_1730130814987252">&#13;
          <h2>AI Engineering Versus Full-Stack Engineering</h2>&#13;
<p><a contenteditable="false" data-primary="application building" data-secondary="engineering stack" data-tertiary="full-stack engineering versus" data-type="indexterm" id="id674"/>The increased emphasis on application development, especially on interfaces, brings AI engineering closer to full-stack development.<sup><a data-type="noteref" href="ch01.html#id675" id="id675-marker">27</a></sup> The rising importance of interfaces leads to a shift in the design of AI toolings to attract more frontend engineers. Traditionally, ML engineering is Python-centric. Before foundation models, the most <span class="keep-together">popular</span> ML frameworks supported mostly Python APIs. Today, Python is still popular, but there is also increasing support for JavaScript APIs, with <a href="https://github.com/langchain-ai/langchainjs">LangChain.js</a>, <a href="https://github.com/huggingface/transformers.js">Transformers.js</a>, <a href="https://github.com/openai/openai-node">OpenAI’s Node library</a>, and <a href="https://github.com/vercel/ai">Vercel’s AI SDK</a>.</p>&#13;
<p>While many AI engineers come from traditional ML backgrounds, more are increasingly coming from web development or full-stack backgrounds. An advantage that full-stack engineers have over traditional ML engineers is their ability to quickly turn ideas into demos, get feedback, and iterate.</p>&#13;
<p>With traditional ML engineering, you usually start with gathering data and training a model. Building the product comes last. However, with AI models readily available today, it’s possible to start with building the product first, and only invest in data and models once the product shows promise, as visualized in <a data-type="xref" href="#ch01_figure_16_1730130814920205">Figure 1-16</a>.</p>&#13;
          <figure><div class="figure" id="ch01_figure_16_1730130814920205">&#13;
            <img alt="A close-up of arrows&#10;&#10;Description automatically generated" src="assets/aien_0116.png"/>&#13;
            <h6><span class="label">Figure 1-16. </span>The new AI engineering workflow rewards those who can iterate fast. Image recreated from “The Rise of the AI Engineer” (<a href="https://oreil.ly/OOZK-">Shawn Wang, 2023</a>).</h6>&#13;
          </div></figure>&#13;
<p>In traditional ML engineering, model development and product development are often disjointed processes, with ML engineers rarely involved in product decisions at many organizations. However, with foundation models, AI engineers tend to be much more involved in building the product.<a contenteditable="false" data-primary="" data-startref="ch01.html20" data-type="indexterm" id="id676"/></p>&#13;
        </div></section>&#13;
      </div></section>&#13;
      <section data-pdf-bookmark="Summary" data-type="sect1"><div class="sect1" id="ch01_summary_1730130814987308">&#13;
        <h1>Summary</h1>&#13;
<p>I meant this chapter to serve two purposes. One is to explain the emergence of AI engineering as a discipline, thanks to the availability of foundation models. Two is to give an overview of the process needed to build applications on top of these models. I hope that this chapter achieved this goal. As an overview chapter, it only lightly touched on many concepts. These concepts will be explored further in the rest of the book.</p>&#13;
<p>The chapter discussed the rapid evolution of AI in recent years. It walked through some of the most notable transformations, starting with the transition from language models to large language models, thanks to a training approach called self-supervision. It then traced how language models incorporated other data modalities to become foundation models, and how foundation models gave rise to AI <span class="keep-together">engineering.</span></p>&#13;
<p>The rapid growth of AI engineering is motivated by the many applications enabled by the emerging capabilities of foundation models. This chapter discussed some of the most successful application patterns, both for consumers and enterprises. Despite the incredible number of AI applications already in production, we’re still in the early stages of AI engineering, with countless more innovations yet to be built.</p>&#13;
<p>Before building an application, an important yet often overlooked question is whether you should build it. This chapter discussed this question together with major considerations for building AI applications.</p>&#13;
<p>While AI engineering is a new term, it evolved out of ML engineering, which is the overarching discipline involved with building applications with all ML models. Many principles from ML engineering are still applicable to AI engineering. However, AI engineering also brings with it new challenges and solutions. The last section of the chapter discusses the AI engineering stack, including how it has changed from ML engineering.</p>&#13;
<p>One aspect of AI engineering that is especially challenging to capture in writing is the incredible amount of collective energy, creativity, and engineering talent that the community brings. This collective enthusiasm can often be overwhelming, as it’s impossible to keep up-to-date with new techniques, discoveries, and engineering feats that seem to happen constantly.</p>&#13;
<p>One consolation is that since AI is great at information aggregation, it can help us aggregate and summarize all these new updates. But tools can help only to a certain extent. The more overwhelming a space is, the more important it is to have a framework to help us navigate it. This book aims to provide such a framework.</p>&#13;
<p>The rest of the book will explore this framework step-by-step, starting with the fundamental building block of AI engineering: the foundation models that make so many amazing applications possible.<a contenteditable="false" data-primary="" data-startref="ch01.html0" data-type="indexterm" id="id677"/><a contenteditable="false" data-primary="AI accelerators" data-see="accelerators" data-type="indexterm" id="id678"/><a contenteditable="false" data-primary="AI application building" data-see="application building" data-type="indexterm" id="id679"/><a contenteditable="false" data-primary="AI application planning" data-see="application planning" data-type="indexterm" id="id680"/><a contenteditable="false" data-primary="AI engineering architecture" data-see="engineering architecture" data-type="indexterm" id="id681"/><a contenteditable="false" data-primary="AI engineering stack" data-see="engineering stack" data-type="indexterm" id="id682"/><a contenteditable="false" data-primary="AI pipeline orchestration" data-see="pipeline orchestration" data-type="indexterm" id="id683"/><a contenteditable="false" data-primary="AI systems evaluation" data-see="systems evaluation" data-type="indexterm" id="id684"/><a contenteditable="false" data-primary="AI-powered data synthesis" data-see="data synthesis, AI-powered" data-type="indexterm" id="id685"/><a contenteditable="false" data-primary="APIs" data-see="open source models, model APIs versus" data-type="indexterm" id="id686"/><a contenteditable="false" data-primary="evaluation methodology" data-secondary="AI systems evaluation" data-see="systems evaluation" data-type="indexterm" id="id687"/><a contenteditable="false" data-primary="judges" data-see="AI judges" data-type="indexterm" id="id688"/><a contenteditable="false" data-primary="KV cache" data-see="key-value cache" data-type="indexterm" id="id689"/><a contenteditable="false" data-primary="metrics" data-secondary="language modeling" data-see="language modeling metrics" data-type="indexterm" id="id690"/><a contenteditable="false" data-primary="model APIs, open source models versus" data-see="open source models, model APIs versus" data-type="indexterm" id="id691"/><a contenteditable="false" data-primary="optimization" data-secondary="inference optimization" data-see="inference optimization" data-type="indexterm" id="id692"/><a contenteditable="false" data-primary="PEFT" data-see="parameter-efficient finetuning" data-type="indexterm" id="id693"/><a contenteditable="false" data-primary="retrieval-augmented generation" data-see="RAG" data-type="indexterm" id="id694"/><a contenteditable="false" data-primary="synthesis of data" data-see="data synthesis" data-type="indexterm" id="id695"/></p>&#13;
      </div></section>&#13;
    <div data-type="footnotes"><p data-type="footnote" id="id534"><sup><a href="ch01.html#id534-marker">1</a></sup> In this book, I use <em>traditional ML</em> to refer to all ML before foundation models.</p><p data-type="footnote" id="id536"><sup><a href="ch01.html#id536-marker">2</a></sup> For non-English languages, a single Unicode character can sometimes be represented as multiple tokens.</p><p data-type="footnote" id="id541"><sup><a href="ch01.html#id541-marker">3</a></sup> Autoregressive language models are sometimes referred to as <a href="https://oreil.ly/h0Y8x">causal language models</a>.</p><p data-type="footnote" id="id542"><sup><a href="ch01.html#id542-marker">4</a></sup> Technically, a masked language model like BERT can also be used for text generations if you try really hard.</p><p data-type="footnote" id="id545"><sup><a href="ch01.html#id545-marker">5</a></sup> The actual data labeling cost varies depending on several factors, including the task’s complexity, the scale (larger datasets typically result in lower per-sample costs), and the labeling service provider. For example, as of September 2024, <a href="https://oreil.ly/EVXJl">Amazon SageMaker Ground Truth</a> charges 8 cents per image for labeling fewer than 50,000 images, but only 2 cents per image for labeling more than 1 million images.</p><p data-type="footnote" id="id546"><sup><a href="ch01.html#id546-marker">6</a></sup> This is similar to how it’s important for humans to know when to stop talking.</p><p data-type="footnote" id="id547"><sup><a href="ch01.html#id547-marker">7</a></sup> In school, I was taught that model parameters include both model weights and model biases. However, today, we generally use model weights to refer to all parameters.</p><p data-type="footnote" id="id549"><sup><a href="ch01.html#id549-marker">8</a></sup> It seems counterintuitive that larger models require more training data. If a model is more powerful, shouldn’t it require fewer examples to learn from? However, we’re not trying to get a large model to match the performance of a small model using the same data. We’re trying to maximize model performance.</p><p data-type="footnote" id="id561"><sup><a href="ch01.html#id561-marker">9</a></sup> For comparison, the entire US expenditures for public elementary and secondary schools are around $900 billion, only nine times the investments in AI in the US.</p><p data-type="footnote" id="id566"><sup><a href="ch01.html#id566-marker">10</a></sup> Fun fact: as of September 16, 2024, the website <a class="orm:hideurl" href="https://theresanaiforthat.com/"><em>theresanaiforthat.com</em></a> lists 16,814 AIs for 14,688 tasks and 4,803 jobs.</p><p data-type="footnote" id="id567"><sup><a href="ch01.html#id567-marker">11</a></sup> Exploring different AI applications is perhaps one of my favorite things about writing this book. It’s a lot of fun seeing what people are building. You can find the <a href="https://huyenchip.com/llama-police">list of open source AI applications</a> that I track. The list is updated every 12 hours.</p><p data-type="footnote" id="id572"><sup><a href="ch01.html#id572-marker">12</a></sup> Because enterprises usually spend a lot of money on ads and marketing, automation there can lead to huge savings. On average, 11% of a company’s budget is spent on marketing. See <a href="https://oreil.ly/D0-yA">“Marketing Budgets Vary by Industry”</a> (Christine Moorman, <em>WSJ</em>, 2017).</p><p data-type="footnote" id="id574"><sup><a href="ch01.html#id574-marker">13</a></sup> I have found AI very helpful in the process of writing this book, and I can see that AI will be able to automate many parts of the writing process. When writing fiction, I often ask AI to brainstorm ideas on what it thinks will happen next or how a character might react to a situation. I’m still evaluating what kind of writing can be automated and what kind of writing can’t be. </p><p data-type="footnote" id="id575"><sup><a href="ch01.html#id575-marker">14</a></sup> My hypothesis is that we’ll become so distrustful of content on the internet that we’ll only read content generated by people or brands we trust.</p><p data-type="footnote" id="id584"><sup><a href="ch01.html#id584-marker">15</a></sup> It surprises me how long it takes Apple and Amazon to incorporate generative AI advances into Siri and Alexa. A friend thinks it’s because these companies might have higher bars for quality and compliance, and it takes longer to develop voice interfaces than chat interfaces.</p><p data-type="footnote" id="id585"><sup><a href="ch01.html#id585-marker">16</a></sup> Disclaimer: I’m an advisor of Convai.</p><p data-type="footnote" id="id592"><sup><a href="ch01.html#id592-marker">17</a></sup> I currently have over 40,000 photos and videos in my Google Photos. Without AI, it’d be near impossible for me to search for the photos I want, when I want them.</p><p data-type="footnote" id="id593"><sup><a href="ch01.html#id593-marker">18</a></sup> Personally, I also find AI good at explaining data and graphs. When encountering a confusing graph with too much information, I ask ChatGPT to break it down for me.</p><p data-type="footnote" id="id599"><sup><a href="ch01.html#id599-marker">19</a></sup> Smaller startups, however, might have to prioritize product focus and can’t afford to have even one person to “look around.”</p><p data-type="footnote" id="id607"><sup><a href="ch01.html#id607-marker">20</a></sup> A running joke in the early days of generative AI is that AI startups are OpenAI or Claude wrappers.</p><p data-type="footnote" id="id608"><sup><a href="ch01.html#id608-marker">21</a></sup> During the process of writing this book, I could hardly talk to any AI startup without hearing the phrase “data flywheel.”</p><p data-type="footnote" id="id609"><sup><a href="ch01.html#id609-marker">22</a></sup> Disclaimer: I’m an investor in Photoroom.</p><p data-type="footnote" id="id640"><sup><a href="ch01.html#id640-marker">23</a></sup> As the head of AI at a Fortune 500 company told me: his team knows how to work with 10 GPUs, but they don’t know how to work with 1,000 GPUs.</p><p data-type="footnote" id="id642"><sup><a href="ch01.html#id642-marker">24</a></sup> And they are offered <a href="https://oreil.ly/AhANP">incredible compensation packages</a>.</p><p data-type="footnote" id="id645"><sup><a href="ch01.html#id645-marker">25</a></sup> If you find the terms “pre-training” and “post-training” lacking in imagination, you’re not alone. The AI research community is great at many things, but naming isn’t one of them. We already talked about how “large language models” is hardly a scientific term because of the ambiguity of the word “large”. And I really wish people would stop publishing papers with the title “X is all you need.”</p><p data-type="footnote" id="id668"><sup><a href="ch01.html#id668-marker">26</a></sup> Streamlit, Gradio, and Plotly Dash are common tools for building AI web apps.</p><p data-type="footnote" id="id675"><sup><a href="ch01.html#id675-marker">27</a></sup> Anton Bacaj told me that “AI engineering is just software engineering with AI models thrown in the stack.”</p></div></div></section></body></html>