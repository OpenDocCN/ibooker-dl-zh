- en: appendix B Supported search engines and vector databases
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 附录 B 支持的搜索引擎和向量数据库
- en: We use the open source Apache Solr search engine as our default search engine
    throughout the book for consistency, but all of the algorithms in the codebase
    are designed to work with a wide variety of search engines and vector databases.
    To that end, other than cases where engine-specific syntax is required to demonstrate
    a point, we have implemented search functionality using a generic `engine` interface
    that allows you to easily swap in your preferred search engine or vector database.
    In this appendix, we’ll cover the list of supported engines, how to swap out the
    default engine, and how the major abstractions (`engine` and `collection`) are
    used throughout the book.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 我们在整本书中一致地使用开源的 Apache Solr 搜索引擎作为默认的搜索引擎，但代码库中的所有算法都设计为可以与各种搜索引擎和向量数据库一起工作。为此，除了需要特定引擎语法来展示某个点的情况外，我们已实现使用通用
    `engine` 接口来搜索功能，这使得您能够轻松地替换您首选的搜索引擎或向量数据库。在本附录中，我们将介绍支持引擎的列表、如何替换默认引擎以及如何在整本书中使用主要抽象（`engine`
    和 `collection`）。
- en: B.1 Supported engines
  id: totrans-2
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: B.1 支持的引擎
- en: 'The list of supported engines will continue to grow over time, but at the time
    of publication, the following engines are initially supported:'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 支持的引擎列表将随着时间的推移而继续增长，但在出版时，以下引擎最初得到支持：
- en: '`solr`—Apache Solr'
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`solr`—Apache Solr'
- en: '`opensearch`—OpenSearch'
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`opensearch`—OpenSearch'
- en: '`bonsai`—Bonsai'
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`bonsai`—Bonsai'
- en: '`weaviate`—Weaviate'
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`weaviate`—Weaviate'
- en: To see the full, most up-to-date list of all supported engines, please visit
    [https://aipoweredsearch.com/supported-engines](https://aipoweredsearch.com/supported-engines).
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 要查看所有支持引擎的完整、最新列表，请访问 [https://aipoweredsearch.com/supported-engines](https://aipoweredsearch.com/supported-engines)。
- en: B.2 Swapping out the engine
  id: totrans-9
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: B.2 替换引擎
- en: Normally, you’ll only be working with one search engine or vector database at
    a time when running the book’s code examples. To use any particular engine, you
    just need to specify the engine’s name (as enumerated above) when starting up
    Docker.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 通常，当运行书籍的代码示例时，您一次只会与一个搜索引擎或向量数据库一起工作。要使用任何特定的引擎，您只需在启动 Docker 时指定该引擎的名称（如上所述）即可。
- en: 'You would launch OpenSearch, for example, like this:'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，您可以通过以下方式启动 OpenSearch：
- en: '[PRE0]'
  id: totrans-12
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: This will both start any necessary Docker containers needed to run `opensearch`
    (or the engine you specify) as well as set this engine as active in the book’s
    Jupyter notebooks for use in all the code examples.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 这将启动运行 `opensearch`（或您指定的引擎）所需的任何必要的 Docker 容器，并将此引擎设置为书籍的 Jupyter 笔记本中的活动引擎，以便在所有代码示例中使用。
- en: Note that some engines, such as managed search and API-based services, do not
    require any additional local Docker containers, since their services are hosted
    elsewhere. Also, some engines may require additional configuration parameters,
    such as API keys, remote addresses/URLs, ports, and so on. These parameters can
    be set in the .env file at the root of the project.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，一些引擎，如托管搜索和基于 API 的服务，不需要任何额外的本地 Docker 容器，因为它们的服务托管在其他地方。此外，一些引擎可能需要额外的配置参数，例如
    API 密钥、远程地址/URL、端口等。这些参数可以在项目根目录的 .env 文件中设置。
- en: 'If you want to use a different engine at any time, you can restart the Docker
    containers and specify the new engine you want to use:'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您想在任何时候使用不同的引擎，您可以重新启动 Docker 容器并指定您想要使用的新引擎：
- en: '[PRE1]'
  id: totrans-16
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'If you want to launch more than one engine at a time to experiment, you can
    provide a list of the engines you wish to start at the end of the `docker compose
    up` command:'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您想同时启动多个引擎进行实验，您可以在 `docker compose up` 命令的末尾提供您希望启动的引擎列表：
- en: '[PRE2]'
  id: totrans-18
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: The first engine you reference in your `docker compose up` command will be set
    as your active engine in the Jupyter notebooks, with the others available on standby.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 在您的 `docker compose up` 命令中引用的第一个引擎将被设置为 Jupyter 笔记本中的活动引擎，其他引擎则处于待机状态。
- en: 'If you’d like to switch to one of the standby engines within your live Jupyter
    notebooks (for example, to `opensearch`), you can do this at any time by simply
    running the following command in any notebook:'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您想在您的实时 Jupyter 笔记本中切换到备用引擎之一（例如，切换到 `opensearch`），您可以通过在任何笔记本中运行以下命令在任何时候完成此操作：
- en: '[PRE3]'
  id: totrans-21
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: Keep in mind that if you call `set_engine` for an engine that is not currently
    running, this will later result in errors if that engine is still unavailable
    when you try to use it.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 请记住，如果您为当前未运行的引擎调用 `set_engine`，那么当您尝试使用该引擎时，如果该引擎仍然不可用，这将会导致错误。
- en: 'You can also check the currently set engine at any time by running this command:'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 您也可以通过运行以下命令在任何时候检查当前设置的引擎：
- en: '[PRE4]'
  id: totrans-24
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: B.3 The engine and collection abstractions
  id: totrans-25
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: B.3 引擎和集合抽象
- en: The search engine industry is full of different terminology and concepts, and
    we have tried to abstract away as much of that as possible in the codebase. Most
    search engines started with lexical keyword search and have since added support
    for vector search, and many vector databases started with vector search and have
    since added lexical search. For our purposes, we just think of all these systems
    as *matching and ranking engines*, and we use the term *engine* to refer to all
    of them.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 搜索引擎行业充满了各种术语和概念，我们已经在代码库中尽可能地抽象掉了大部分。大多数搜索引擎最初都是从词汇关键词搜索开始的，后来增加了对向量搜索的支持，而许多向量数据库最初也是从向量搜索开始的，后来又增加了词汇搜索。就我们的目的而言，我们只是将这些系统视为*匹配和排名引擎*，并且我们使用术语*引擎*来指代所有这些系统。
- en: Likewise, each engine has a concept of one or more logical partitions or containers
    for adding data. In Solr and Weaviate, these containers are called *collections*;
    in OpenSearch, Elasticsearch, and Redis these are called *indexes*; and in Vespa
    they are called *applications*. In MongoDB, the original data is stored in a *collection*,
    but it can then be copied into an *index* for search purposes. Naming also varies
    further among other engines.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 同样，每个引擎都有一个一个或多个逻辑分区或容器来添加数据。在Solr和Weaviate中，这些容器被称为*collections*；在OpenSearch、Elasticsearch和Redis中，这些被称为*indexes*；在Vespa中，这些被称为*applications*。在MongoDB中，原始数据存储在*collection*中，但随后可以复制到*index*中进行搜索。命名在其他引擎中也有进一步的差异。
- en: For proper abstraction, we always use the term *collection* in the codebase,
    so every engine that gets implemented has a `collection` interface through which
    you can query or add documents.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 为了正确的抽象，我们在代码库中始终使用术语*collection*，因此每个实现的引擎都有一个`collection`接口，通过该接口可以查询或添加文档。
- en: Common public methods on the `engine` interface include
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 在`engine`接口上的常见公共方法包括
- en: '`engine.create_collection(collection_name)`—Creates a new collection'
  id: totrans-30
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`engine.create_collection(collection_name)`—创建新的集合'
- en: '`engine.get_collection(collection_name)`—Returns an existing collection'
  id: totrans-31
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`engine.get_collection(collection_name)`—返回现有的集合'
- en: Common public methods on the `collection` interface include
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 在`collection`接口上的常见公共方法包括
- en: '`collection.search(**request)`—Runs a search and returns results. Individual
    request parameters should be passed in as Python keyword arguments, like `collection.search(query="keyword),
    limit=10"`.'
  id: totrans-33
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`collection.search(**request)`—执行搜索并返回结果。单个请求参数应作为Python关键字参数传递，例如`collection.search(query="keyword"),
    limit=10`。'
- en: '`collection.add_documents(docs)`—Adds a list of documents to the collection'
  id: totrans-34
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`collection.add_documents(docs)`—将一系列文档添加到集合中'
- en: '`collection.write(dataframe)`—Writes each row from a Spark dataframe to the
    collection as a document'
  id: totrans-35
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`collection.write(dataframe)`—将Spark dataframe中的每一行写入集合作为文档'
- en: '`collection.commit()`—Ensures that recently added documents are persisted and
    available for searching'
  id: totrans-36
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`collection.commit()`—确保最近添加的文档被持久化并可供搜索'
- en: The `engine` and `collection` interfaces also internally implement schema definitions
    and management for all the datasets used in the book.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: '`engine`和`collection`接口还内部实现了用于书中所有数据集的模式定义和管理。'
- en: 'Because the `collection.write` method takes a dataframe, we utilize helpers
    as needed when loading data from additional data sources, such as CSV or SQL:'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 由于`collection.write`方法接受一个dataframe，我们在从CSV或SQL等额外数据源加载数据时需要根据需要使用辅助工具：
- en: '`collection.write(from_csv(csv_file))`—Writes each row in the CSV file to the
    collection as a document'
  id: totrans-39
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`collection.write(from_csv(csv_file))`—将CSV文件中的每一行写入集合作为文档'
- en: '`collection.write(from_sql(sql_query))`—Runs the SQL query and writes each
    returned row to the collection as a document'
  id: totrans-40
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`collection.write(from_sql(sql_query))`—执行SQL查询并将返回的每一行写入集合作为文档'
- en: No additional engine-specific implementation is needed for loading from these
    additional data sources, as any data source that can be mapped to a Spark dataframe
    is implicitly supported.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 从这些额外数据源加载不需要额外的引擎特定实现，因为任何可以映射到Spark dataframe的数据源都隐式支持。
- en: B.4 Adding support for additional engines
  id: totrans-42
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: B.4 添加对额外引擎的支持
- en: While we hope to eventually support most major search engines and vector databases,
    you may find that your favorite engine is not currently supported. If that is
    the case, we encourage you to add support for it and submit a pull request to
    the codebase. The `engine` and `collection` interfaces are designed to be easy
    to implement, and you can use the default `solr` implementation or any other already-implemented
    engines as a reference.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然我们希望最终支持大多数主要搜索引擎和向量数据库，但您可能会发现您喜欢的引擎目前尚未得到支持。如果是这种情况，我们鼓励您为其添加支持，并向代码库提交一个拉取请求。`engine`
    和 `collection` 接口被设计得易于实现，您可以使用默认的 `solr` 实现或任何其他已实现的引擎作为参考。
- en: Not all data stores have full support for all the capabilities implemented in
    *AI-Powered Search*. For example, a pure vector database may not support lexical
    keyword matching and ranking, and some search engines may not support vector search.
    Likewise, some specialized capabilities may only be available in certain engines.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 并非所有数据存储都完全支持 *AI-Powered Search* 中实现的所有功能。例如，纯向量数据库可能不支持词汇关键词匹配和排名，而某些搜索引擎可能不支持向量搜索。同样，某些专用功能可能仅在特定引擎中可用。
- en: While the default `solr` engine supports all of the *AI-Powered Search* capabilities
    implemented in the book, other engines may require workarounds, integration of
    additional libraries, or delegation of some capabilities to another engine for
    certain algorithms. Most engines don’t have native support for semantic knowledge
    graphs and text tagging, for example, so many of the engine implementations will
    delegate these one-off capabilities to other libraries.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管默认的 `solr` 引擎支持书中实现的全部 *AI-Powered Search* 功能，但其他引擎可能需要采取变通方法、集成额外的库，或将某些功能委托给其他引擎以处理特定算法。例如，大多数引擎没有对语义知识图谱和文本标记的原生支持，因此许多引擎实现会将这些一次性功能委托给其他库。
- en: We hope that the `engine` and `collection` abstractions will make it easy for
    you to add support for your favorite engine and also to potentially contribute
    it to the book’s codebase to benefit the larger community of *AI-Powered Search*
    readers and practitioners. Happy searching!
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 我们希望 `engine` 和 `collection` 抽象能够让您轻松添加对您喜欢的引擎的支持，并可能将其贡献给本书的代码库，以惠及更广泛的 *AI-Powered
    Search* 读者和实践者。祝您搜索愉快！
