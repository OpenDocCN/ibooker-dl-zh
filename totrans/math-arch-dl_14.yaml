- en: Appendix
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: A.1 Dot product and cosine of the angle between two vectors
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: In section [2.5.6.1](02.xhtml#subsubsec-dotproduct_as_component), we stated
    that the component of a vector ![](../../OEBPS/Images/AR_a.png) along another
    vector ![](../../OEBPS/Images/AR_b.png) is ![](../../OEBPS/Images/AR_a.png) ‚ãÖ
    ![](../../OEBPS/Images/AR_b.png) = ![](../../OEBPS/Images/AR_a.png)*^T*![](../../OEBPS/Images/AR_b.png).
    This is equivalent to ||![](../../OEBPS/Images/AR_a.png)|| ||![](../../OEBPS/Images/AR_b.png)||*cos*(*Œ∏*),
    where *Œ∏* is the angle between the vectors ![](../../OEBPS/Images/AR_a.png) and
    ![](../../OEBPS/Images/AR_b.png).
  prefs: []
  type: TYPE_NORMAL
- en: In this section, we offer a proof of this for the two-dimensional case to deepen
    your intuition about the geometry of dot products. From figure [A.2](#fig-dotproduct_as_component-repeat),
    we can see that
  prefs: []
  type: TYPE_NORMAL
- en: '![](../../OEBPS/Images/eq_A-00.png)'
  prefs: []
  type: TYPE_IMG
- en: which can be rewritten as
  prefs: []
  type: TYPE_NORMAL
- en: '![](../../OEBPS/Images/eq_A-01.png)'
  prefs: []
  type: TYPE_IMG
- en: Equation A.1
  prefs: []
  type: TYPE_NORMAL
- en: '![](../../OEBPS/Images/eq_A-02.png)'
  prefs: []
  type: TYPE_IMG
- en: Equation A.2
  prefs: []
  type: TYPE_NORMAL
- en: Using well-known trigonometric identities in equation [A.1](#eq-dotprod-as-component1),
    we get
  prefs: []
  type: TYPE_NORMAL
- en: '![](../../OEBPS/Images/eq_A-02-a.png)'
  prefs: []
  type: TYPE_IMG
- en: '![](../../OEBPS/Images/APPA_UN01a_Chaudhury.png)'
  prefs: []
  type: TYPE_IMG
- en: (a) Components of a 2D vector along coordinate axes. Note that ||![](../../OEBPS/Images/AR_a.png)||
    is the length of hypotenuse.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../../OEBPS/Images/APPA_UN01b_Chaudhury.png)'
  prefs: []
  type: TYPE_IMG
- en: (b) Dot product as a component of one vector along another ![](../../OEBPS/Images/AR_a.png)
    ‚ãÖ ![](../../OEBPS/Images/AR_b.png) = ![](../../OEBPS/Images/AR_a.png)*^T*![](../../OEBPS/Images/AR_b.png)
    = *a[x]b[x]* + *a[y]b[y]* = ||![](../../OEBPS/Images/AR_a.png)|| ||![](../../OEBPS/Images/AR_b.png)||*cos*(*Œ∏*).
  prefs: []
  type: TYPE_NORMAL
- en: Figure A.1 Vector components and dot product
  prefs: []
  type: TYPE_NORMAL
- en: 'Substituting for *cosœï* and *sinœï* from equation [A.2](#eq-dotprod-as-component2),
    we have a system of simultaneous linear equations with *cosŒ∏* and *sinŒ∏* as unknowns:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../../OEBPS/Images/eq_A-02-b.png)'
  prefs: []
  type: TYPE_IMG
- en: This system of simultaneous linear equations can be compactly written in matrix-vector
    form
  prefs: []
  type: TYPE_NORMAL
- en: '![](../../OEBPS/Images/eq_A-02-c.png)'
  prefs: []
  type: TYPE_IMG
- en: which can be simplified to
  prefs: []
  type: TYPE_NORMAL
- en: '![](../../OEBPS/Images/eq_A-02-d.png)'
  prefs: []
  type: TYPE_IMG
- en: This equation can be solved to yield
  prefs: []
  type: TYPE_NORMAL
- en: '![](../../OEBPS/Images/eq_A-02-e.png)'
  prefs: []
  type: TYPE_IMG
- en: So, ||![](../../OEBPS/Images/AR_a.png)|| ||![](../../OEBPS/Images/AR_b.png)||*cosŒ∏*
    = *a[x]b[x]* + *a[y]b[y]*, which was to be proved.
  prefs: []
  type: TYPE_NORMAL
- en: A.2 Determinants
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Determinant computation is tedious and numerically unstable if done naively.
    You should never compute one by hand‚Äîall linear algebra software packages provide
    routines to do this. Hence we only describe the algorithm to compute the determinant
    of a 2 √ó 2 matrix. This determinant can be computed as
  prefs: []
  type: TYPE_NORMAL
- en: '*det*(*A*) = *a*[11]*a*[22] ‚àí *a*[12]*a*[21]'
  prefs: []
  type: TYPE_NORMAL
- en: The inverse is
  prefs: []
  type: TYPE_NORMAL
- en: '![](../../OEBPS/Images/eq_A-02-f.png)'
  prefs: []
  type: TYPE_IMG
- en: A.3 Computing the variance of a Gaussian distribution
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: From the integral form of equation [5.13](../Text/05.xhtml#eq-variance), we
    have
  prefs: []
  type: TYPE_NORMAL
- en: '![](../../OEBPS/Images/eq_A-02-g1.png)'
  prefs: []
  type: TYPE_IMG
- en: Substituting equation [5.22](../Text/05.xhtml#eq-univar-normal),
  prefs: []
  type: TYPE_NORMAL
- en: '![](../../OEBPS/Images/eq_A-02-g2.png)'
  prefs: []
  type: TYPE_IMG
- en: in that, we get
  prefs: []
  type: TYPE_NORMAL
- en: '![](../../OEBPS/Images/eq_A-02-g3.png)'
  prefs: []
  type: TYPE_IMG
- en: Substituting ![](../../OEBPS/Images/eq_A-02-g4.png), which implies ![](../../OEBPS/Images/eq_A-02-g5.png)
    and 2*œÉ*¬≤*y*¬≤ = (*x* ‚àí *Œº*)¬≤, we get
  prefs: []
  type: TYPE_NORMAL
- en: '![](../../OEBPS/Images/eq_A-02-g6.png)'
  prefs: []
  type: TYPE_IMG
- en: Using integration by parts,
  prefs: []
  type: TYPE_NORMAL
- en: '![](../../OEBPS/Images/eq_A-02-g7.png)'
  prefs: []
  type: TYPE_IMG
- en: Now, substituting *v* = *y*¬≤, which implies *dv*/2 = *y dy*,
  prefs: []
  type: TYPE_NORMAL
- en: '![](../../OEBPS/Images/eq_A-02-g8.png)'
  prefs: []
  type: TYPE_IMG
- en: Hence,
  prefs: []
  type: TYPE_NORMAL
- en: '![](../../OEBPS/Images/eq_A-02-g9.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Such limits can be evaluated using L‚ÄôHospital‚Äôs rule:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../../OEBPS/Images/eq_A-02-h1.png)'
  prefs: []
  type: TYPE_IMG
- en: In both cases, the limit is zero because *e*^(*y*¬≤) goes to positive infinity
    regardless of whether *y* goes to positive or negative infinity. Hence the denominator
    goes to infinity in both cases, causing the fraction to go to zero.
  prefs: []
  type: TYPE_NORMAL
- en: Thus the first term in the computation of *var[gaussian]*(*x*) becomes
  prefs: []
  type: TYPE_NORMAL
- en: '![](../../OEBPS/Images/eq_A-02-h2.png).'
  prefs: []
  type: TYPE_NORMAL
- en: The second term
  prefs: []
  type: TYPE_NORMAL
- en: '![](../../OEBPS/Images/eq_A-02-h3.png)'
  prefs: []
  type: TYPE_IMG
- en: This last integral is a special one. To evaluate it, we need to go from one
    to two dimensions‚Äîthis may be one of the very few cases where making a problem
    more complex helps. It is worth examining, so let‚Äôs look at it. Let
  prefs: []
  type: TYPE_NORMAL
- en: '![](../../OEBPS/Images/eq_A-02-h4.png)'
  prefs: []
  type: TYPE_IMG
- en: Since the variable of integration does not matter, we can also write
  prefs: []
  type: TYPE_NORMAL
- en: '![](../../OEBPS/Images/eq_A-02-h5.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Let‚Äôs multiply them together:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../../OEBPS/Images/eq_A-02-h6.png)'
  prefs: []
  type: TYPE_IMG
- en: This double integral‚Äôs domain (aka region of integration) is the infinite *XY*
    plane, where *x* and *y* both range from ‚àí‚àû to ‚àû. This same plane can also be
    viewed as an infinite-radius circle (an infinite-radius circle is the same as
    a rectangle with infinite-length sides!). Consequently, we can switch to polar
    coordinates, using the transformation
  prefs: []
  type: TYPE_NORMAL
- en: '*x* = *r cos*(*Œ∏*)'
  prefs: []
  type: TYPE_NORMAL
- en: '*y* = *r cos*(*Œ∏*)'
  prefs: []
  type: TYPE_NORMAL
- en: which implies
  prefs: []
  type: TYPE_NORMAL
- en: '![](../../OEBPS/Images/eq_A-02-i1.png)'
  prefs: []
  type: TYPE_IMG
- en: Substituting *v* = *r*¬≤, which implies *dv* = 2*rdr*, we get
  prefs: []
  type: TYPE_NORMAL
- en: '![](../../OEBPS/Images/eq_A-02-i2.png)'
  prefs: []
  type: TYPE_IMG
- en: Thus, the second term of *var[gaussian]*(*x*) evaluates to ![](../../OEBPS/Images/eq_A-02-i3.png).
    We have already shown that the first term evaluates to zero. So, we get
  prefs: []
  type: TYPE_NORMAL
- en: '*var[gaussian]*(*x*) = *œÉ*¬≤'
  prefs: []
  type: TYPE_NORMAL
- en: Thus the *œÉ* in the probability density function ![](../../OEBPS/Images/eq_A-02-i5.png)
    is the standard deviation (square root of the variance), and the *Œº* is the expected
    value.
  prefs: []
  type: TYPE_NORMAL
- en: A.4 Two theorems in statistics
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'In this section, we study two important inequalities in multivariate statistics:
    Jensen‚Äôs inequality and the log-sum inequality.'
  prefs: []
  type: TYPE_NORMAL
- en: A.4.1 Jensen‚Äôs Inequality
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Consider a random variable *X*. For now, let‚Äôs think of these as discrete variables,
    although the results we will come up with apply equally well to continuous variables.
    Thus, let the random variable take the discrete values ![](../../OEBPS/Images/AR_x.png)[1],
    ![](../../OEBPS/Images/AR_x.png)[2], ‚ãØ, ![](../../OEBPS/Images/AR_x.png)*[n]*,
    with probabilities *p*(![](../../OEBPS/Images/AR_x.png)[1]), *p*(![](../../OEBPS/Images/AR_x.png)[2]),
    ‚ãØ, *p*(![](../../OEBPS/Images/AR_x.png)*[n]*).
  prefs: []
  type: TYPE_NORMAL
- en: 'Now suppose *g*(![](../../OEBPS/Images/AR_x.png)) is a convex function whose
    domain includes these random variables. From equation [3.11](../Text/03.xhtml#eq-convexity-wt-avg),
    section [3.7](../Text/03.xhtml#sec-conv-functions), we know that given any convex
    function *g*(![](../../OEBPS/Images/AR_x.png)), for an arbitrary set of its input
    values ![](../../OEBPS/Images/AR_x.png)*[i]*, *i* = 1‚ãØ*n* and a set of weights
    *Œ±[i]* *i* = 1‚ãØ*n* satisfying ![](../../OEBPS/Images/eq_A-02-i6a.png), the weighted
    sum of the function outputs is greater than or equal to the function‚Äôs output
    on the weighted sum of inputs: that is, ![](../../OEBPS/Images/eq_A-02-i6.png)'
  prefs: []
  type: TYPE_NORMAL
- en: In particular, let‚Äôs choose the set of all random variables as input values
    and their probabilities as weights (*Œ±[i]* = *p*(![](../../OEBPS/Images/AR_x.png)*[i]*)).
    We can do this because probabilities sum to 1, exactly as weights are supposed
    to do. This leads to
  prefs: []
  type: TYPE_NORMAL
- en: '![](../../OEBPS/Images/eq_A-03.png)'
  prefs: []
  type: TYPE_IMG
- en: Equation A.3
  prefs: []
  type: TYPE_NORMAL
- en: 'Equation [A.3](#eq-jensen) is Jensen‚Äôs inequality. A good mnemonic for it is:
    *for a convex function, the expected value of the function is greater than or
    equal to the function of expected value*. It holds for continuous random variables,
    too.'
  prefs: []
  type: TYPE_NORMAL
- en: A.4.2 Log sum inequality
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Suppose we have two sets of positive numbers *a*[1], *a*[2], ‚ãØ, *a[n]* and *b*[1],
    *b*[2], ‚ãØ, *b[n]*. Let *a* = Œ£*[i]^n*[= 1] *a[i]* and *b* = Œ£*[i]^n*[= 1] *b[i]*.
    Given these, the log sum inequality theorem says,
  prefs: []
  type: TYPE_NORMAL
- en: '![](../../OEBPS/Images/eq_A-04.png)'
  prefs: []
  type: TYPE_IMG
- en: Equation A.4
  prefs: []
  type: TYPE_NORMAL
- en: To see why this is true, let‚Äôs carve out an informal proof. First let‚Äôs define
    *g*(*x*) = *xlogx*. This is a convex function because
  prefs: []
  type: TYPE_NORMAL
- en: '![](../../OEBPS/Images/eq_A-04-a.png)'
  prefs: []
  type: TYPE_IMG
- en: Now, with that definition of *g*,
  prefs: []
  type: TYPE_NORMAL
- en: '![](../../OEBPS/Images/eq_A-04-b.png)'
  prefs: []
  type: TYPE_IMG
- en: This last expression is a weighted sum of convex function outputs with the weights
    summing to 1 (since Œ£*[i]^n*[= 1] *b[i]*/*b* = 1). So, we can use equation [3.11](../Text/03.xhtml#eq-convexity-wt-avg),
    section [3.7](../Text/03.xhtml#sec-conv-functions). Then we get
  prefs: []
  type: TYPE_NORMAL
- en: '![](../../OEBPS/Images/eq_A-04-c.png)'
  prefs: []
  type: TYPE_IMG
- en: A.5 Gamma functions and distribution
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: To understand the gamma distribution, we need to understand the basic gamma
    function. First let‚Äôs do an overview of the gamma function.
  prefs: []
  type: TYPE_NORMAL
- en: A.5.1 Gamma function
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: The gamma function is in some sense a generalization of the factorial. The factorial
    function is only defined for integers and is characterized by the basic equation
  prefs: []
  type: TYPE_NORMAL
- en: '*n*! = *n*(*n* ‚àí 1)!'
  prefs: []
  type: TYPE_NORMAL
- en: The gamma function is defined by
  prefs: []
  type: TYPE_NORMAL
- en: '![](../../OEBPS/Images/eq_A-05.png)'
  prefs: []
  type: TYPE_IMG
- en: Equation A.5
  prefs: []
  type: TYPE_NORMAL
- en: Applying integration by parts to equation [A.5](#eq-gamma-func), we get
  prefs: []
  type: TYPE_NORMAL
- en: '![](../../OEBPS/Images/eq_A-05-a.png)'
  prefs: []
  type: TYPE_IMG
- en: The first term is zero. This is because
  prefs: []
  type: TYPE_NORMAL
- en: '![](../../OEBPS/Images/eq_A-05-b.png)'
  prefs: []
  type: TYPE_IMG
- en: Hence,
  prefs: []
  type: TYPE_NORMAL
- en: '![](../../OEBPS/Images/eq_A-05-c.png)'
  prefs: []
  type: TYPE_IMG
- en: Thus, for integer values *Œ±* = *n*, *Œì*(*n*) = *n*!. There are other equivalent
    definitions of the gamma function, but we will not discuss them here. Instead,
    let‚Äôs talk about the gamma distribution.
  prefs: []
  type: TYPE_NORMAL
- en: A.5.2 Gamma distribution
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'The probability density function for a random variable having a gamma distribution
    is a function with two parameters *Œ±* and *Œ≤*:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../../OEBPS/Images/eq_A-06.png)'
  prefs: []
  type: TYPE_IMG
- en: Equation A.6
  prefs: []
  type: TYPE_NORMAL
- en: 'It is not hard to see that this is a proper probability density function:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../../OEBPS/Images/eq_A-06-a.png)'
  prefs: []
  type: TYPE_IMG
- en: By substituting *y* = *Œ≤x*, we get
  prefs: []
  type: TYPE_NORMAL
- en: '![](../../OEBPS/Images/eq_A-06-b.png)'
  prefs: []
  type: TYPE_IMG
- en: If *Œ±* = 1, the gamma distribution reduces to
  prefs: []
  type: TYPE_NORMAL
- en: '![](../../OEBPS/Images/eq_A-06-c.png)'
  prefs: []
  type: TYPE_IMG
- en: 'which is graphed in figure [A.2a](#fig-gamma1) at several values of *Œ≤*. The
    gamma distribution has two terms *x*^(*Œ±*‚àí1) and *e*^(‚àí*Œ≤x*) that have somewhat
    opposite effects: the former increases with *x*, while the latter deceases with
    *x*. At smaller values of *x*, the former wins, and the product increases with
    *x*. But eventually, the exponential starts winning and pulls the product downward
    asymptotically toward zero. Thus the gamma distribution has a peak. Larger *Œ≤*
    results in taller peaks and a sharper decline toward zero. Larger *Œ±* moves the
    peak further to the right. The expected value is ùîº(*x*) = *Œ±*/*Œ≤*, as illustrated
    in figure [A.2](#fig-gamma).'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../../OEBPS/Images/APPA_F01a_Chaudhury.png)'
  prefs: []
  type: TYPE_IMG
- en: '(a) Gamma distribution: *Œ±* = 1, various *Œ≤*s'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../../OEBPS/Images/APPA_F01b_Chaudhury.png)'
  prefs: []
  type: TYPE_IMG
- en: '(b) Gamma distribution: *Œ≤* = 1, various *Œ±*s'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../../OEBPS/Images/APPA_F01c_Chaudhury.png)'
  prefs: []
  type: TYPE_IMG
- en: '(c) Gamma distribution: *Œ±* = 2, various *Œ≤*s'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../../OEBPS/Images/APPA_F01d_Chaudhury.png)'
  prefs: []
  type: TYPE_IMG
- en: '(d) Gamma distribution: *Œ≤* = 2, various *Œ±*s'
  prefs: []
  type: TYPE_NORMAL
- en: Figure A.2 Graph of a gamma distribution for various values of *Œ±* and *Œ≤*.
    Larger *Œ≤* results in taller peaks and a sharper decline toward zero. Larger *Œ±*
    moves the peak to the right. The expected value is ùîº(*x*) = *Œ±*/*Œ≤*.
  prefs: []
  type: TYPE_NORMAL
- en: 'The expected value of the gamma distribution ùîº(*x*) = *Œ±*/*Œ≤*. This can be
    proved using a little trick so cool that it is worth discussing for that reason
    alone:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../../OEBPS/Images/eq_A-06-d.png)'
  prefs: []
  type: TYPE_IMG
- en: But the gamma distribution
  prefs: []
  type: TYPE_NORMAL
- en: '![](../../OEBPS/Images/eq_A-06-e.png)'
  prefs: []
  type: TYPE_IMG
- en: or
  prefs: []
  type: TYPE_NORMAL
- en: '![](../../OEBPS/Images/eq_A-06-f.png)'
  prefs: []
  type: TYPE_IMG
- en: Using this,
  prefs: []
  type: TYPE_NORMAL
- en: '![](../../OEBPS/Images/eq_A-06-g.png)'
  prefs: []
  type: TYPE_IMG
- en: Maximum of a gamma distribution
  prefs: []
  type: TYPE_NORMAL
- en: 'To maximize the gamma probability density function *p*(*Œª*|*X*) = *Œª*^((*Œ±[n]*
    ‚àí 1))*e*^(‚àí*Œ≤[n]Œª*) for a random variable *Œª*, we take the derivative and equate
    to zero:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../../OEBPS/Images/eq_A-06-h.png)'
  prefs: []
  type: TYPE_IMG
