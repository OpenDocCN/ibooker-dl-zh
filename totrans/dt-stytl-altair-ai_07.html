<html><head></head><body>
<div id="sbo-rt-content"><div class="readable-text" id="p1">
<h1 class="readable-text-h1"><span class="chapter-title-numbering"><span class="num-string">6</span></span> <span class="chapter-title-text">From data to information: Extracting insights</span></h1>
</div>
<div class="introduction-summary">
<h3 class="introduction-header">This chapter covers</h3>
<ul>
<li class="readable-text" id="p2">Introducing insights</li>
<li class="readable-text" id="p3">Choosing the characters of your story</li>
<li class="readable-text" id="p4">Choosing the right chart</li>
</ul>
</div>
<div class="readable-text" id="p5">
<p>An <em>insight</em> is something that is significant in data—something that you would want to communicate through a story. Extracting an insight from data is the most difficult task every data analyst must deal with. In the previous chapters, you learned that to turn data into information, you must extract insights from data. You also learned that an insight is something relevant you have found in your data. In this book, we will not focus on how to extract insights from data. Tons of books exist on the topic, so you can refer to them for a detailed description (see, e.g., Guja et al., 2024; De Mauro et al., 2021). In this chapter, we will follow a more intuition-based approach to extract an insight, describing the motivations guiding you while exploring data. I hope this approach will help you to broaden your point of view during your data analysis journey. Thus, the objective in this chapter is to understand that at the base of the DIKW pyramid, there is the extraction of an insight, its transformation into a character of a story, and its representation through a chart. First, we will focus on how to extract insights from data using an intuitive approach. Next, we’ll describe how to choose the characters of a data story and how to choose the right chart. The story characters and the right chart help to communicate your insight to an audience. Finally, you’ll learn how to implement some of the most popular data visualization charts in Altair. We’ll exploit the power of Copilot to speed up the chart construction process and provide the code to implement decluttered charts, ready to be added to a data story. </p>
</div>
<div class="readable-text" id="p6">
<h2 class="readable-text-h2"><span class="num-string">6.1</span> An intuitive approach to extract insights</h2>
</div>
<div class="readable-text" id="p7">
<p>In the book <em>Journey to the Center of the Earth</em> by Jules Verne, Professor Otto Lidenbrock (1864) meticulously extracts information from a medieval Icelandic manuscript by employing his keen intellect and passion for exploration. With a deep understanding of languages, history, and geology, he deciphers cryptic clues, cross-references ancient texts, and applies scientific knowledge to unravel the secrets concealed within the pages. The manuscript provides details about the journey’s route and the geological landmarks they would have encountered along the way. In other words, Professor Otto Lidenbrock turns the data contained in the old manuscript into information.</p>
</div>
<div class="readable-text intended-text" id="p8">
<p>Similar to the story told by Jules Verne, you can start by turning data into information to tell any data story. In this section, we will describe some strategies that can help you transform your data into information. </p>
</div>
<div class="readable-text intended-text" id="p9">
<p>In his book, <em>Seeing What Others Don’t</em> (Klein, 2017), Gary Klein identifies four main strategies to help you to identify an insight:</p>
</div>
<ul>
<li class="readable-text" id="p10"> Connections </li>
<li class="readable-text" id="p11"> Coincidences </li>
<li class="readable-text" id="p12"> Curiosity </li>
<li class="readable-text" id="p13"> Contradictions </li>
</ul>
<div class="readable-text" id="p14">
<p>Let’s analyze each of the four proposed strategies separately, starting with the first: connections. Keep in mind that you can apply multiple strategies simultaneously. </p>
</div>
<div class="readable-text" id="p15">
<h3 class="readable-text-h3"><span class="num-string">6.1.1</span> Connection strategy</h3>
</div>
<div class="readable-text" id="p16">
<p>This strategy involves identifying the main points of your data and then connecting them to identify a story. In his book, Klein says that sometimes you extract an insight when you see a new way to combine different pieces of data. Other times, you can extract an insight simply by looking at the pieces of data you already have in a different way. To explain how the connection strategy works, consider the following scenario. Angelica is a data analyst working for an e-commerce website. One day, Angelica receives a report on customer reviews and ratings for each product on the website. Each product is rated on a scale of 1 to 5, and customers can leave text reviews. Table 6.1 shows the sales dataset Angelica must analyze.</p>
</div>
<div class="browsable-container browsable-table-container framemaker-table-container" id="p17">
<h5 class="browsable-container-h5"><span class="num-string">Table 6.1</span> The sales dataset analyzed by Angelica</h5>
<table>
<thead>
<tr>
<th>
<div>
<strong><code>product_id</code></strong>
</div></th>
<th>
<div>
<strong><code> number_of_orders </code></strong>
</div></th>
<th>
<div>
<strong><code>product_rating</code></strong>
</div></th>
<th>
<div>
<strong><code>product_category</code></strong>
</div></th>
<th>
<div>
<strong><code>returns</code></strong>
</div></th>
<th>
<div>
<strong><code> number_of_reviews </code></strong>
</div></th>
</tr>
</thead>
<tbody>
<tr>
<td>  P1001 <br/></td>
<td>  30 <br/></td>
<td>  4.5 <br/></td>
<td>  Electronics <br/></td>
<td>  0 <br/></td>
<td>  3 <br/></td>
</tr>
<tr>
<td>  P1002 <br/></td>
<td>  12 <br/></td>
<td>  3.2 <br/></td>
<td>  Home &amp; Kitchen <br/></td>
<td>  6 <br/></td>
<td>  6 <br/></td>
</tr>
<tr>
<td>  … <br/></td>
<td>  … <br/></td>
<td>  … <br/></td>
<td>  … <br/></td>
<td/>
<td>  … <br/></td>
</tr>
<tr>
<td>  P1006 <br/></td>
<td>  24 <br/></td>
<td>  4.2 <br/></td>
<td>  Electronics <br/></td>
<td>  0 <br/></td>
<td>  4 <br/></td>
</tr>
<tr>
<td>  P1006 <br/></td>
<td>  22 <br/></td>
<td>  2.1 <br/></td>
<td>  Electronics <br/></td>
<td>  18 <br/></td>
<td>  20 <br/></td>
</tr>
</tbody>
</table>
</div>
<div class="readable-text" id="p18">
<p>Here is an explanation of the dataset columns:</p>
</div>
<ul>
<li class="readable-text" id="p19"> <code>product_id </code>—The unique identifiers for each product in the dataset. </li>
<li class="readable-text" id="p20"> <code>number_of_orders </code>—The quantity of times a particular product has been ordered. </li>
<li class="readable-text" id="p21"> <code>product_rating </code>—The rating assigned to each product by customers or users. Ratings could be on a scale (e.g., 1 to 5 stars) and reflect the satisfaction or perceived quality of the product. </li>
<li class="readable-text" id="p22"> <code>product_category </code>—This column categorizes products into different groups or types. </li>
<li class="readable-text" id="p23"> <code>returns</code>—The number of times a product was returned by customers. It provides insight into the rate of customer dissatisfaction or issues with products that lead to their return. </li>
<li class="readable-text" id="p24"> <code>number_of_reviews </code>—The count of reviews received for each product. </li>
</ul>
<div class="readable-text" id="p25">
<p>Angelica starts by plotting the product ratings versus the number of reviews and the product ratings versus percentage of returns (figure 6.1). You can find this example in the GitHub repository for the book under 06/connections.<span class="aframe-location"/></p>
</div>
<div class="browsable-container figure-container" id="p26">
<img alt="figure" height="568" src="../Images/6-1.png" width="1100"/>
<h5 class="figure-container-h5"><span class="num-string">Figure 6.1</span> The charts drawn by Angelica</h5>
</div>
<div class="readable-text intended-text" id="p27">
<p>Angelica discovers the following main points: </p>
</div>
<ul>
<li class="readable-text" id="p28"> Some products have high ratings but relatively fewer reviews. </li>
<li class="readable-text" id="p29"> Others have lower ratings but a substantial number of reviews. </li>
</ul>
<div class="readable-text" id="p30">
<p>Angelica uses her intuition to connect the points and discovers that negative reviews correlate with high return rates. This may hurt the overall customer experience and brand reputation.</p>
</div>
<div class="readable-text intended-text" id="p31">
<p>The previous example demonstrates that once we have identified the “dots,” extracting insights is just about connecting them. However, the main problem with this strategy is identifying the “non-dots,” or the irrelevant messages. An example of a non-dot in the previous scenario is the product category versus the product rating.</p>
</div>
<div class="readable-text" id="p32">
<h3 class="readable-text-h3"><span class="num-string">6.1.2</span> Coincidence strategy</h3>
</div>
<div class="readable-text" id="p33">
<p>A <em>coincidence</em> is an occurrence of events that happen at the same time due to randomness but which seem to have some connection—the unexpected convergence of two or more apparently significant situations, even though they may be disconnected. Coincidences can range from everyday events, like meeting someone you know in an unexpected place, to extraordinary events that seem incredibly unlikely. However, while coincidences are intriguing, they do not necessarily indicate anything beyond chance. They could be rare or unusually timed events capturing our attention due to their curious alignment.</p>
</div>
<div class="readable-text intended-text" id="p34">
<p>In his book, <em>Seeing What Others Don’t</em>, Gary Klein says, “Observing a coincidence means that we’ve spotted some events that seem related to each other even though they don’t seem to have any obvious causal link.” You should take a skeptical approach and consider something a coincidence (and, thus, ignore it) when it is an isolated incident with few data points to evidence a relationship between two variables. On the other hand, when events or trends repeat on multiple occasions, they should be considered less likely to be coincidental and, thus, worth investigating further.</p>
</div>
<div class="readable-text intended-text" id="p35">
<p>To identify whether a repeated event is a coincidence or not, you could approach data with a deliberately skeptical mindset, ignoring isolated events, while looking for longer-term patterns that would suggest a relationship. The presence of correlated factors could indicate a potential causal relationship. For instance, by analyzing data over time, you might discover that certain variables precede the repeated event, hinting at a cause-and-effect dynamic. Through causality, you could distinguish between mere coincidences and meaningful connections, explaining the mechanisms governing the observed phenomenon.</p>
</div>
<div class="readable-text intended-text" id="p36">
<p>Let’s consider the following example to explain how we could apply the coincidence strategy. Imagine that Angelica works for a store selling accessories for electronic devices, such as headphones, USB cables, smartphone covers, and so on. Also, imagine that Angelica wants to monitor her orders. She is given the dataset shown in table 6.2.</p>
</div>
<div class="browsable-container browsable-table-container framemaker-table-container" id="p37">
<h5 class="browsable-container-h5"><span class="num-string">Table 6.2</span> The sales dataset of the electronic store</h5>
<table>
<thead>
<tr>
<th>
<div>
         Date 
       </div></th>
<th>
<div>
         Headphones 
       </div></th>
<th>
<div>
         USB Cables 
       </div></th>
<th>
<div>
         Smartphone Covers 
       </div></th>
</tr>
</thead>
<tbody>
<tr>
<td>  2023-01-01 <br/></td>
<td>  14 <br/></td>
<td>  34 <br/></td>
<td>  32 <br/></td>
</tr>
<tr>
<td>  2023-01-02 <br/></td>
<td>  17 <br/></td>
<td>  54 <br/></td>
<td>  45 <br/></td>
</tr>
<tr>
<td>  … <br/></td>
<td>  … <br/></td>
<td>  … <br/></td>
<td>  … <br/></td>
</tr>
<tr>
<td>  2023-01-30 <br/></td>
<td>  16 <br/></td>
<td>  34 <br/></td>
<td>  34 <br/></td>
</tr>
<tr>
<td>  2023-01-31 <br/></td>
<td>  20 <br/></td>
<td>  23 <br/></td>
<td>  5 <br/></td>
</tr>
</tbody>
</table>
</div>
<div class="readable-text" id="p38">
<p>For simplicity, the dataset contains the number of orders for three products during the month of January 2023: headphones, USB cables, and smartphone covers. Figure 6.2 shows a visual representation of the dataset. You can find the complete code in the GitHub repository for the book under 06/coincidences.<span class="aframe-location"/></p>
</div>
<div class="browsable-container figure-container" id="p39">
<img alt="figure" height="474" src="../Images/6-2.png" width="1100"/>
<h5 class="figure-container-h5"><span class="num-string">Figure 6.2</span> The electronic store orders, with a focus on headphones</h5>
</div>
<div class="readable-text" id="p40">
<p>The figure highlights the headphones orders. It’s worth noting that headphone orders peak every Friday. This could be a coincidence, but the repetitiveness of the event should be considered. For example, Angelica might find that every Friday, there is an exciting radio show that causes people to rush to buy new headphones. Or she might find out that there’s a law in her town on Fridays that doesn’t allow speakers to be turned on. In any case, this repetitiveness of events requires further analysis.</p>
</div>
<div class="readable-text intended-text" id="p41">
<p>Looking at the x-axis of figure 6.2, you can notice a strange labeling strategy: first, the year; then the weekdays; and, finally, the month. This is the default Altair labeling for dates. You can read more details on how to format dates in the Altair official documentation (<span class="link-like"/>https://mng.bz/lMmy).</p>
</div>
<div class="readable-text intended-text" id="p42">
<p>Coincidence insights differ from connection insights in the way we discover them. In connection insights, we focus on important details, while in coincidence insights, we focus on repeated events. In addition, connections are helpful when you have aggregated metrics, while coincidence is best applied to things like raw sales numbers over time.</p>
</div>
<div class="readable-text" id="p43">
<h3 class="readable-text-h3"><span class="num-string">6.1.3</span> Curiosity</h3>
</div>
<div class="readable-text" id="p44">
<p>In 1928, Sir Alexander Fleming, a Scottish bacteriologist, discovered penicillin while studying staphylococci bacteria. One day, while he was meticulously examining his petri dishes filled with these microorganisms, he noticed something peculiar. A petri dish left open by mistake had become contaminated with mold. Intrigued by this unexpected occurrence, Fleming examined the petri dish closely. To his astonishment, he observed that the bacteria surrounding the mold were gradually deteriorating. Something unleashed by the mold was defeating them. Driven by curiosity, Fleming embarked on a series of experiments to explore this phenomenon. He carefully isolated the mold and extracted the substance it produced, which he named penicillin. Curiosity prompted Fleming to investigate the problem further, leading him to the discovery of penicillin, the world’s first antibiotic, saving countless lives and transforming medicine forever.</p>
</div>
<div class="readable-text intended-text" id="p45">
<p>Curiosity is a driving force that sparks wonder, propels discovery, and fuels innovation, pushing us to question, seek answers, and expand the boundaries of knowledge. Curiosity is one strategy we can apply to extract insights. Curiosity about data can be triggered by a wide range of phenomena, including outliers, missing data, data gaps across time or space, sudden shifts or trends, unexpected patterns, and much more. When we note something curious in our data, we dig deeper, ask questions, and explore the underlying factors contributing to the observed patterns. This curiosity drives us to analyze the data from different angles, uncover hidden insights, and ultimately gain a deeper understanding of the phenomena.</p>
</div>
<div class="readable-text intended-text" id="p46">
<p>Let’s consider the following example to explain how we could apply the curiosity strategy. Consider again the example of the electronic devices in the previous section. Now, imagine that you have a different trend line for March, as shown in figure 6.3.<span class="aframe-location"/></p>
</div>
<div class="browsable-container figure-container" id="p47">
<img alt="figure" height="471" src="../Images/6-3.png" width="1100"/>
<h5 class="figure-container-h5"><span class="num-string">Figure 6.3</span> The electronic store orders in March, with a focus on headphones</h5>
</div>
<div class="readable-text intended-text" id="p48">
<p>The figure shows a peak in sales on March 25. This event may raise some curiosity, which moves us to further investigation. Curiosity could help us during the brainstorming process. For example, it could lead us to search for various factors that could have contributed to this spike, such as marketing efforts, special promotions, or external events. As we proceed in the research, curiosity may spur us to add other factors, such as customer demographics during this period. This investigation will not only satisfy our curiosity but also help us to extract insights.</p>
</div>
<div class="readable-text" id="p49">
<h3 class="readable-text-h3"><span class="num-string">6.1.4</span> Contradictions</h3>
</div>
<div class="readable-text" id="p50">
<p>A <em>contradiction</em> is a situation when two or more beliefs or pieces of evidence conflict, creating an inconsistency. According to Gary Klein, to extract insight from contradictions, you must approach the data with a skeptical mindset. Unlike a coincidence-based approach, where we look for repeating events, in the case of a contradiction-based strategy, we look for seemingly conflicting events. An insight extracted from contradictions can disrupt conventional thinking, challenge established notions, and provide alternative perspectives that foster creative problem solving. By embracing the inherent tension within contradictions, you can gain valuable insights, leading to breakthroughs, innovation, and growth.</p>
</div>
<div class="readable-text intended-text" id="p51">
<p>Consider the chart in figure 6.4, showing product sales and prices over time. You can find the code of the produced chart in the GitHub repository for the book under 06/contradictions.<span class="aframe-location"/></p>
</div>
<div class="browsable-container figure-container" id="p52">
<img alt="figure" height="524" src="../Images/6-4.png" width="1100"/>
<h5 class="figure-container-h5"><span class="num-string">Figure 6.4</span> A chart showing product sales and price</h5>
</div>
<div class="readable-text intended-text" id="p53">
<p>The chart shows that a price increase corresponds to an increase in sales. This event is quite contradictory because the general assumption is that a price increase should correspond to a decrease in sales. However, to understand this phenomenon, you could wear the skepticism lens and analyze this contradictory phenomenon more deeply. One possible motivation you could discover is the perceived value. When prices increase, customers may perceive your product as more exclusive, high quality, or desirable. This perception of increased value can make customers willing to pay more, leading to increased sales. An alternative explanation could be the sense of urgency among consumers who may fear missing out on the product, believing the higher price signifies scarcity or limited availability. Another reason may be inflation. In the context of inflation, when prices rise, people may buy more for fear that the prices may rise even more, making the product unattainable.</p>
</div>
<div class="readable-text" id="p54">
<p>All the proposed strategies, connections, coincidences, curiosity, and contradictions define some possible techniques to extract meaning. Regardless of which approach you take, always rely on your experience and a deep exploratory analysis phase to extract meaning from data. Now that you have learned how to extract insight from data, let’s move on to how to choose the characters of your story.</p>
</div>
<div class="readable-text" id="p55">
<h2 class="readable-text-h2"><span class="num-string">6.2</span> Choosing the characters of your story</h2>
</div>
<div class="readable-text" id="p56">
<p>In the movie <em>Indiana Jones and the Raiders of the Lost Ark</em>, Indiana Jones, a brilliant archaeologist, embarks on a thrilling adventure pursuing an ancient artifact, the Ark of the Covenant. Set in the 1930s, Indiana races against time to find the sacred relic before the Nazis seize it for their wicked plans. This movie and the others of the Indiana Jones saga are examples of engaging stories, where the hero wants something. </p>
</div>
<div class="readable-text intended-text" id="p57">
<p>Every story starts with a hero wanting something. Without any hero and something to achieve, there is no story. The same should be true in a data story. It might seem that the term <em>hero</em> is too much to define the subject of our story. However, in our case we really want to emphasize the similarity between a data story and a real story. In any story, there is always a hero who corresponds to the main character. Our idea is to see the subject to be represented just like the hero of our story, even if it is a simple product. Using this point of view, it will also be easier for us to construct a story:</p>
</div>
<ul>
<li class="readable-text" id="p58"> <em>Every data story should have a</em> <em>hero.</em> This could be a product, a customer, or whatever. </li>
<li class="readable-text" id="p59"> <em>The hero must</em> <em>want something.</em> This may be a sales increase, increased satisfaction, or anything else. </li>
</ul>
<div class="readable-text" id="p60">
<p>Keep in mind that the hero of the story is something other than you. The hero is the main subject of your data story. It depends on the insight you have extracted. Examples of heroes include people, things, and places. </p>
</div>
<div class="readable-text intended-text" id="p61">
<p>Once you have identified the hero of your story, the next step is asking the audience the following question: <em>Will the hero get what they want?</em> In his book, <em>Building a Sto</em><em>ryBrand: Clarify Your Message So Customers Will Listen</em>, Donald Milligan (2017) says that “before knowing what the hero wants, the audience has little interest in her fate. This is why screenwriters have to define the character’s ambition within the first nine or so minutes of a film getting started.”</p>
</div>
<div class="readable-text intended-text" id="p62">
<p>In addition to having a hero, your story should have at least two other characters: the guide and the adversary. The guide, often a wise and experienced mentor, helps the hero achieve their goal. The adversary can be</p>
</div>
<ul>
<li class="readable-text" id="p63"> A competitor who seeks to hinder or oppose the hero’s progress </li>
<li class="readable-text" id="p64"> A comparison character, which allows you to measure the hero’s progress </li>
<li class="readable-text" id="p65"> The same hero at a different time (e.g., comparing the hero’s condition now to a year ago) or in a different space (e.g., comparing the hero here to another location) </li>
</ul>
<div class="readable-text" id="p66">
<p>Let’s review all the examples we have seen in the previous chapters and identify the hero of each story. For convenience, figure 6.5 summarizes the examples analyzed. Try searching for the hero, the type of hero, what the hero wants, and the adversary in each.<span class="aframe-location"/></p>
</div>
<div class="browsable-container figure-container" id="p67">
<img alt="figure" height="609" src="../Images/6-5.png" width="1100"/>
<h5 class="figure-container-h5"><span class="num-string">Figure 6.5</span> A summary of all the examples described in the previous chapters</h5>
</div>
<div class="readable-text" id="p68">
<p>Table 6.3 shows the hero and the adversary for each case study shown in figure 6.5. For each case study, the table also shows the type of hero and what the hero wants. In the example of chapter 2—<em>Yes, you can build a new swimming pool!</em>—there is the implicit assumption that an increase in tourist arrivals corresponds to the possibility of building a new swimming pool. This is, obviously, a simplistic assumption, but we simplified the example just to get started and show how the DIKW pyramid works. </p>
</div>
<div class="browsable-container browsable-table-container framemaker-table-container" id="p69">
<h5 class="browsable-container-h5"><span class="num-string">Table 6.3</span> The heroes and adversaries of the case studies analyzed in the previous chapters</h5>
<table>
<thead>
<tr>
<th>
<div>
         Case Study 
       </div></th>
<th>
<div>
         Hero 
       </div></th>
<th>
<div>
         Type of Hero 
       </div></th>
<th>
<div>
         What the Hero Wants 
       </div></th>
<th>
<div>
         Adversary 
       </div></th>
</tr>
</thead>
<tbody>
<tr>
<td>  Chapter 1: Increase the Advertising Campaign on Dog-Related Websites <br/></td>
<td>  Dog-related websites <br/></td>
<td>  Thing <br/></td>
<td>  Increase the number of views <br/></td>
<td>  Cat-related websites <br/></td>
</tr>
<tr>
<td>  Chapter 2: Yes, You Can Build a New Swimming Pool! <br/></td>
<td>  The flow of tourist arrivals to Portugal <br/></td>
<td>  Process <br/></td>
<td>  An increase in tourist arrivals <br/></td>
<td>  The flow of tourist arrivals to Germany <br/></td>
</tr>
<tr>
<td>  Chapter 3: Population in North America Over the Last 50 Years <br/></td>
<td>  Population in North America <br/></td>
<td>  People <br/></td>
<td>  Explain the trend <br/></td>
<td>  The population in the rest of the world <br/></td>
</tr>
<tr>
<td>  Chapter 5, Example 1: Together, Let’s Make a Difference: Support Our Project to Help the Homeless <br/></td>
<td>  Number of homeless people in Lazio, Piemonte, Liguria, and Sardegna <br/></td>
<td>  People <br/></td>
<td>  Reduce this number <br/></td>
<td>  Number of homeless people in the other Italian regions <br/></td>
</tr>
<tr>
<td>  Chapter 5, Example 2: Your Truth Guardian: Take a Stand Against Fake News in Material and Moral Narratives <br/></td>
<td>  News about the material and moral life <br/></td>
<td>  Thing <br/></td>
<td>  Establish whether they are genuine or fake <br/></td>
<td>  News about spiritual life <br/></td>
</tr>
</tbody>
</table>
</div>
<div class="readable-text" id="p70">
<p>In all the examples shown in table 6.3, the adversary is always a character different from the hero, although it is of the same type as the hero. In some cases, the adversary can be the same hero in a previous condition, such as product sales in the past or within another geographical region. Now that you have learned how to choose the characters of your story, let’s move on to choosing the right chart for your data story.</p>
</div>
<div class="readable-text" id="p71">
<h2 class="readable-text-h2"><span class="num-string">6.3</span> Choosing the right chart</h2>
</div>
<div class="readable-text" id="p72">
<p>The best chart depends on the insights you want to represent, the message you want to convey, and the audience you are targeting. Figure 6.6 shows how insight, message, and audience relate to each other in a chart. If you only consider the insight, the effect of your chart is to inform. <span class="aframe-location"/></p>
</div>
<div class="browsable-container figure-container" id="p73">
<img alt="figure" height="112" src="../Images/6-6.png" width="1100"/>
<h5 class="figure-container-h5"><span class="num-string">Figure 6.6</span> The relationship between insight, audience, and message</h5>
</div>
<div class="readable-text" id="p74">
<p>When telling a story, there are three levels: </p>
</div>
<ul>
<li class="readable-text" id="p75"> <em>Inform</em>—In this level, you describe the insight you have found in your data. No contact is made with the audience. </li>
<li class="readable-text" id="p76"> <em>Communicate</em>—You involve the audience by providing them details about your data, but they are not motivated to do something after listening to your story. </li>
<li class="readable-text" id="p77"> <em>Inspire</em>—Based on your data, you propose a message, which inspires the audience to do something. The audience is highly involved and will retell your story in other contexts. </li>
</ul>
<div class="readable-text" id="p78">
<p>In other words, if you only consider the insight, the effect of your chart is to inform. If you calibrate your insight to your audience, you can communicate it effectively. Finally, if you add a message to your chart, you can inspire your audience. We will see how to represent insights in the remainder of this chapter, how to calibrate the chart to your target audience in chapter 7, and how to add a message to a chart in chapter 9.</p>
</div>
<div class="readable-text intended-text" id="p79">
<p>Let’s focus on how to represent insights in a chart. The choice of a chart is driven by your specific goals. Different types of charts serve different purposes, based on the nature of the data and the message you want to convey. Table 6.4 describes which chart to use based on the information you want to convey. Consider that the list of described charts is not exhaustive, and you can use your imagination and expertise to build new charts. In addition, you can follow Dr. Abela’s chart chooser (2020; <a href="https://mng.bz/DdnE">https://mng.bz/DdnE</a>) to select the best chart for you.</p>
</div>
<div class="browsable-container browsable-table-container framemaker-table-container" id="p80">
<h5 class="browsable-container-h5"><span class="num-string">Table 6.4</span> Suggested charts based on the information to convey</h5>
<table>
<thead>
<tr>
<th>
<div>
         Information to Convey 
       </div></th>
<th>
<div>
         Description 
       </div></th>
<th>
<div>
         Suggested Charts 
       </div></th>
</tr>
</thead>
<tbody>
<tr>
<td>  A single piece of information <br/></td>
<td>  A single number representing critical information <br/></td>
<td>  • Big number (BAN) <br/>  • Donut chart <br/>  • 100% stacked bar chart <br/>  • Waffle chart <br/></td>
</tr>
<tr>
<td>  Parts of a whole <br/></td>
<td>  The components contributing to the entirety of a system, object, or concept. The sum of all components must be 100%. <br/></td>
<td>  • Pie chart <br/>  • 100% stacked car chart <br/>  • Multiple waffle chart <br/>  • Donut chart <br/></td>
</tr>
<tr>
<td>  Comparison among entities <br/></td>
<td>  The similarities and differences between multiple entities to establish relationships and distinctions <br/></td>
<td>  • Bar chart <br/>  • Column chart <br/>  • Slope graph <br/>  • Dumbbell chart <br/>  • Table <br/></td>
</tr>
<tr>
<td>  Trend <br/></td>
<td>  The behavior of an entity over the time <br/></td>
<td>  • Line chart <br/>  • Small multiple line chart <br/>  • Stacked area chart <br/>  • Stacked column chart <br/></td>
</tr>
<tr>
<td>  Outcomes of a survey or a questionnaire <br/></td>
<td>  Answers to questions contained in a survey or a questionnaire <br/></td>
<td>  • Stacked bar chart <br/>  • Column chart <br/>  • Multiple bar charts <br/></td>
</tr>
<tr>
<td>  Distribution <br/></td>
<td>  Spread of values across a dataset, indicating how frequently different values occur <br/></td>
<td>  • Histogram <br/>  • Pyramid <br/>  • Box plot <br/></td>
</tr>
<tr>
<td>  Relationship <br/></td>
<td>  Association, connection, or correlation between different entities to identify patterns, trends, and dependencies <br/></td>
<td>  • Scatterplot <br/>  • Bubble chart <br/>  • Heatmap <br/></td>
</tr>
<tr>
<td>  Spatial information <br/></td>
<td>  The behavior of an entity over the space <br/></td>
<td>  • Choropleth map <br/>  • Dot density map <br/>  • Proportional symbol map <br/>  • Heatmap <br/></td>
</tr>
<tr>
<td>  Flow <br/></td>
<td>  Represent a process <br/></td>
<td>  • Sankey (not supported by Altair 5.0.1) <br/>  • Chord (not supported by Altair 5.0.1) <br/></td>
</tr>
</tbody>
</table>
</div>
<div class="readable-text" id="p81">
<p>As you can see from the table, you can use the same chart for different purposes. In addition, you can use many different charts for the same purpose. Your choice of chart depends on the audience, as we will see in chapter 7. In the remainder of this section, we’ll describe how to implement some of the most important charts in Altair and Copilot, grouped by chart family. </p>
</div>
<div class="readable-text intended-text" id="p82">
<p>We’ll focus on the following chart families:</p>
</div>
<ul>
<li class="readable-text" id="p83"> Cooking charts </li>
<li class="readable-text" id="p84"> Bar charts </li>
<li class="readable-text" id="p85"> Line charts </li>
<li class="readable-text" id="p86"> Geographical maps </li>
<li class="readable-text" id="p87"> Dot charts </li>
</ul>
<div class="readable-text" id="p88">
<p>Let’s start with the first family: cooking charts. You can find the code associated with each chart in the GitHub repository for the book under section 06. For each chart family, we will show only one representative chart. You can find more charts in appendix C.</p>
</div>
<div class="readable-text" id="p89">
<h3 class="readable-text-h3"><span class="num-string">6.3.1</span> The cooking charts family</h3>
</div>
<div class="readable-text" id="p90">
<p>The <em>cooking charts</em> family includes the pie chart and the donut chart. Use this category of charts only to represent numerical values. Lately, I have seen an unfounded opposition to these types of charts on social media and the web. The main argument is that these graphs are too generic and do not convey the results correctly. I was a victim of this sentiment, and for a while, I avoided this type of chart as well. Then, one fine day, on LinkedIn, I read a post (<a href="https://mng.bz/NRpD">https://mng.bz/NRpD</a>) by Brent Dykes reevaluating cooking charts, especially pie charts. In his post, Dykes pointed out that pie charts aren’t great at representing the precise dimensions of the slices, but they do represent the parts of the whole. Dykes explicitly says, “I know everyone likes rules. ‘Never use this chart type ...,’ ‘Always use this chart type for...,’ etc. However, it’s not always so straightforward in data storytelling. It isn’t just about how to display a certain type of data but how to best communicate a specific point to your audience.”</p>
</div>
<div class="readable-text intended-text" id="p91">
<p>Following Dykes’s suggestions, you can use cooking charts in three main cases:</p>
</div>
<ul>
<li class="readable-text" id="p92"> You must represent a part of the whole. The total sum of the slices must be 100%. </li>
<li class="readable-text" id="p93"> There are a maximum of two to three slices to represent (provided they are not very similar in size; otherwise, it is very difficult to determine which one is bigger than the others). </li>
<li class="readable-text" id="p94"> You don’t want to transmit details about your data but only a general overview. This could be the case for a general audience, not including technical experts. </li>
</ul>
<div class="readable-text" id="p95">
<p>In the remainder of this section, we will see how to implement a pie chart. For donut charts, refer to appendix C. A <em>pie chart</em> is a type of circular data visualization that displays data by dividing a circle into slices, each representing a proportion or percentage of a whole.</p>
</div>
<div class="readable-text intended-text" id="p96">
<p>Suppose we want to use a pie chart to represent a value of 70%. First, create a pandas DataFrame containing your number and its complementary value (30%).</p>
</div>
<div class="browsable-container listing-container" id="p97">
<h5 class="listing-container-h5 browsable-container-h5"><span class="num-string">Listing 6.1</span> The DataFrame with the number</h5>
<div class="code-area-container">
<pre class="code-area">import pandas as pd
import altair as alt

data = {
    'percentage': [0.7,0.3], 
    'label'     : ['70%','30%'], <span class="aframe-location"/> #1
    'color'     : ['#81c01e','lightgray'] <span class="aframe-location"/> #2
}

df = pd.DataFrame(data)</pre>
<div class="code-annotations-overlay-container">
     #1 The labels to show
     <br/>#2 Use a neutral color (light gray) for the complementary number.
     <br/>
</div>
</div>
</div>
<div class="readable-text print-book-callout" id="p98">
<p><span class="print-book-callout-head">Note</span>  Create a pandas DataFrame with the number to represent and its complementary value. </p>
</div>
<div class="readable-text" id="p99">
<p>Next, ask GitHub Copilot to draw the chart for you. A pie chart does not have the classical <code>x</code> and <code>y</code> channels to encode data. Instead, the pie chart uses the <code>Theta</code> and <code>Color</code> channels. The <code>Theta</code> channel specifies the angular position of data points in a polar plot. The <code>Color</code> channel refers to encoding data using different colors. </p>
</div>
<div class="readable-text intended-text" id="p100">
<p>Listing 6.2 shows the starting prompt for GitHub Copilot.</p>
</div>
<div class="browsable-container listing-container" id="p101">
<h5 class="listing-container-h5 browsable-container-h5"><span class="num-string">Listing 6.2</span> How to generate a basic pie chart in Copilot</h5>
<div class="code-area-container">
<pre class="code-area"># Draw a pie chart in Altair with the following options:
# - Use the `percentage` column for theta channel
# - Use the `label` column for tooltip
# - Use the `color` column for color
# Save chart to `chart` variable.
# Save chart as 'pie-chart.xhtml'.</pre>
</div>
</div>
<div class="readable-text print-book-callout" id="p102">
<p><span class="print-book-callout-head">Note</span>  The basic instructions to draw a pie chart in Copilot.</p>
</div>
<div class="readable-text" id="p103">
<p>As a result, Copilot will generate the code shown in the following listing. Figure 6.7 shows the resulting chart.</p>
</div>
<div class="browsable-container listing-container" id="p104">
<h5 class="listing-container-h5 browsable-container-h5"><span class="num-string">Listing 6.3</span> The code to generate a basic pie chart</h5>
<div class="code-area-container">
<pre class="code-area">chart = alt.Chart(df).mark_arc(
).encode(
    theta=alt.Theta('percentage', stack=True), <span class="aframe-location"/> #1
    color=alt.Color('color', scale=None),
    tooltip='label'
).properties(
    width=300,
    height=300
)
chart.save('pie-chart.xhtml')<span class="aframe-location"/></pre>
<div class="code-annotations-overlay-container">
     #1 stack=True is not generated directly by Copilot.
     <br/>
</div>
</div>
</div>
<div class="browsable-container figure-container" id="p105">
<img alt="figure" height="445" src="../Images/6-7.png" width="445"/>
<h5 class="figure-container-h5"><span class="num-string">Figure 6.7</span> A basic pie chart in Altair</h5>
</div>
<div class="readable-text print-book-callout" id="p106">
<p><span class="print-book-callout-head">Note</span>  Listing 6.3 is the code to generate a basic pie chart in Altair. Use the <code>mark_arc()</code> method to draw a pie chart. We add the <code>stack=True</code> property manually for the next steps. This property means that the individual slices within the chart will be stacked on each other instead of being displayed side by side.</p>
</div>
<div class="readable-text" id="p107">
<p>We can improve the chart by adding the label value next to each slice. Ask Copilot to draw a text containing the labels, as shown in the following listing.</p>
</div>
<div class="browsable-container listing-container" id="p108">
<h5 class="listing-container-h5 browsable-container-h5"><span class="num-string">Listing 6.4</span> How to label to the chart in Copilot</h5>
<div class="code-area-container">
<pre class="code-area"># Add text near to each slice of the pie chart.
# - Use the `label` column for text channel.
# - Use the `color` column for color.

# Combine the pie chart and the text chart.
# - Use `+` operator to combine the charts.
# - Save the combined chart to `chart` variable.</pre>
</div>
</div>
<div class="readable-text print-book-callout" id="p109">
<p><span class="print-book-callout-head">Note</span>  This is the prompt for Copilot to generate labels next to the pie chart.</p>
</div>
<div class="readable-text" id="p110">
<p>As a result, Copilot will generate some partial code that does not show the desired output. Modify it as described in the following listing. Figure 6.8 shows the resulting chart.</p>
</div>
<div class="browsable-container listing-container" id="p111">
<h5 class="listing-container-h5 browsable-container-h5"><span class="num-string">Listing 6.5</span> The code to generate labels</h5>
<div class="code-area-container">
<pre class="code-area">text = chart.mark_text( <span class="aframe-location"/> #1
    size = 20, <span class="aframe-location"/> #2
    radius=180 <span class="aframe-location"/> #3
).encode(
    text='label',
    color=alt.Color('color', scale=None)
).properties(
    width=300,
    height=300
)

chart = (chart + text
).configure_view(
    strokeWidth=0    <span class="aframe-location"/> #4
) <span class="aframe-location"/></pre>
<div class="code-annotations-overlay-container">
     #1 Copilot uses alt.Chart(df) to draw the chart. Use chart instead.
     <br/>#2 Add the size property to set the font size.
     <br/>#3 Add radius to set the distance from the slice.
     <br/>#4 Use strokeWidth=0 to remove borders from the chart.
     <br/>
</div>
</div>
</div>
<div class="browsable-container figure-container" id="p112">
<img alt="figure" height="441" src="../Images/6-8.png" width="487"/>
<h5 class="figure-container-h5"><span class="num-string">Figure 6.8</span> A pie chart in Altair with labels</h5>
</div>
<div class="readable-text print-book-callout" id="p113">
<p><span class="print-book-callout-head">Note</span>  Listing 6.5 is the code to generate the labels for the basic pie chart in Altair. Use the <code>mark_text()</code> method to write the text.</p>
</div>
<div class="readable-text" id="p114">
<p>Now that you have learned how to implement a pie chart, let’s move on to the next chart family. In the following section, we’ll discuss bar charts.</p>
</div>
<div class="readable-text" id="p115">
<h3 class="readable-text-h3"><span class="num-string">6.3.2</span> The bar charts family</h3>
</div>
<div class="readable-text" id="p116">
<p>The family of <em>bar charts</em> includes various types of charts where each data series is visualized as rectangular bars. These bars can be oriented either vertically, known as <em>column charts</em>, or horizontally, known as <em>bar charts</em>. In addition to the classic bar and column charts, this family also includes stacked column/bar charts, pyramid charts, and histograms. Use these charts to represent categorical data or compare different categories by displaying their corresponding values along a horizontal or vertical axis. </p>
</div>
<div class="readable-text intended-text" id="p117">
<p>In a way similar to the backlash against pie charts, lately, on the web and in social media, I have noticed an excessive abuse of bar charts. While these charts have the advantages of simplicity and effectiveness in conveying a message, using them repeatedly with the same audience could bore the audience and is likely a reason for the consternation directed at these charts.</p>
</div>
<div class="readable-text intended-text" id="p118">
<p>You have already learned how to draw a bar chart and a column chart in the previous chapters. In this section, you’ll learn how to improve bar chart readability, thanks to Copilot. For the other charts belonging to this family, refer to appendix C. </p>
</div>
<div class="readable-text intended-text" id="p119">
<p>A bar chart is a type of chart that uses rectangular bars to represent data values, where the length of each bar corresponds to the quantity it represents. Use this chart to represent data across different categories. Consider the dataset shown in table 6.5, describing the number of likes for each type of meal.</p>
</div>
<div class="browsable-container browsable-table-container framemaker-table-container" id="p120">
<h5 class="browsable-container-h5"><span class="num-string">Table 6.5</span> The dataset of the example</h5>
<table>
<thead>
<tr>
<th>
<div>
         Meal Type 
       </div></th>
<th>
<div>
         Number of Likes 
       </div></th>
</tr>
</thead>
<tbody>
<tr>
<td>  Pizza <br/></td>
<td>  120 <br/></td>
</tr>
<tr>
<td>  Burger <br/></td>
<td>  95 <br/></td>
</tr>
<tr>
<td>  Pasta <br/></td>
<td>  80 <br/></td>
</tr>
<tr>
<td>  Sushi <br/></td>
<td>  60 <br/></td>
</tr>
<tr>
<td>  Salad <br/></td>
<td>  50 <br/></td>
</tr>
<tr>
<td>  Steak <br/></td>
<td>  70 <br/></td>
</tr>
<tr>
<td>  Tacos <br/></td>
<td>  90 <br/></td>
</tr>
<tr>
<td>  Ice Cream <br/></td>
<td>  110 <br/></td>
</tr>
<tr>
<td>  Curry <br/></td>
<td>  40 <br/></td>
</tr>
<tr>
<td>  Sandwich <br/></td>
<td>  75 <br/></td>
</tr>
</tbody>
</table>
</div>
<div class="readable-text" id="p121">
<p>The following listing shows the code to generate a simple bar chart representing the previous dataset in Altair, and figure 6.9 shows the produced chart.</p>
</div>
<div class="browsable-container listing-container" id="p122">
<h5 class="listing-container-h5 browsable-container-h5"><span class="num-string">Listing 6.6</span> The code to create a bar chart</h5>
<div class="code-area-container">
<pre class="code-area">import pandas as pd
import altair as alt
df = pd.read_csv('data/meals.csv')

chart = alt.Chart(df).mark_bar(
    color='#81c01e'
).encode(
    y=alt.Y('Meal Type', sort='-x'),
    x='Number of Likes'
).properties(
    width=300,
    height=300
)

chart.save('bar-chart.xhtml')</pre>
</div>
</div>
<div class="readable-text print-book-callout" id="p123">
<p><span class="print-book-callout-head">Note</span>  Use the <code>color</code> property to set the bar color and the <code>sort</code> property of the <code>y</code> channel to sort categories based on descending values of <code>x</code>.<span class="aframe-location"/></p>
</div>
<div class="browsable-container figure-container" id="p124">
<img alt="figure" height="975" src="../Images/6-9.png" width="1083"/>
<h5 class="figure-container-h5"><span class="num-string">Figure 6.9</span> If you start writing, Copilot will suggest the next steps.</h5>
</div>
<div class="readable-text" id="p125">
<p>The chart needs to be decluttered, so we should remove unnecessary elements, such as the y-axis title (Meal Type), the grids, and so on. For example, we can add the value of each bar at its end and remove the x-axis labels entirely. Use Copilot to help you build the chart. As you use Copilot, you will find that it will suggest more and more things that fit your coding style. If you start writing something, Copilot will suggest the next steps based on what you have written previously. This means that you can use Copilot not only with predefined prompts but also to suggest the next steps in your prompts.</p>
</div>
<div class="readable-text intended-text" id="p126">
<p>To add the value of each bar at its end, start writing a prompt for Copilot, press Enter, and Copilot will suggest how to implement it, as shown in figure 6.10.<span class="aframe-location"/></p>
</div>
<div class="browsable-container figure-container" id="p127">
<img alt="figure" height="100" src="../Images/6-10.png" width="1028"/>
<h5 class="figure-container-h5"><span class="num-string">Figure 6.10</span> An example of a Copilot suggestion</h5>
</div>
<div class="readable-text" id="p128">
<p>Simply press Enter, and Copilot will continue proposing how to add the text. The following listing shows the complete prompt proposed by Copilot.</p>
</div>
<div class="browsable-container listing-container" id="p129">
<h5 class="listing-container-h5 browsable-container-h5"><span class="num-string">Listing 6.7</span> The prompt generated by Copilot </h5>
<div class="code-area-container">
<pre class="code-area"># Add text to the end of each bar.
# - Use the `Number of Likes` column for text channel.
# - Use the `Meal Type` column for y channel and sort by the number of likes.
# - Set the color of the text to '#81c01'.
# - Set the text alignment to 'left'.
# - Set the text baseline to 'middle'.
# - Set font size to 14.</pre>
</div>
</div>
<div class="readable-text print-book-callout" id="p130">
<p><span class="print-book-callout-head">Note</span>  Use Copilot to generate the prompt to build your chart, and then press Enter to let Copilot generate the code.</p>
</div>
<div class="readable-text" id="p131">
<p>After the final prompt, press Enter, and Copilot will generate the code.</p>
</div>
<div class="browsable-container listing-container" id="p132">
<h5 class="listing-container-h5 browsable-container-h5"><span class="num-string">Listing 6.8</span> The code to generate labels</h5>
<div class="code-area-container">
<pre class="code-area">text = chart.mark_text(
    align='left',
    baseline='middle',
    dx=3,
    color='#81c01',
    fontSize=14
).encode(
    text='Number of Likes',
    y=alt.Y('Meal Type', sort='-x', title=None)
)</pre>
</div>
</div>
<div class="readable-text print-book-callout" id="p133">
<p><span class="print-book-callout-head">Note</span>  Apply the <code>mark_text()</code> method to the chart to generate the labels. You can use the columns already set for the <code>chart</code> variable.</p>
</div>
<div class="readable-text" id="p134">
<p>Now, add five vertical lines to the chart to ease the audience’s comparison process. Ask Copilot to generate the code for you. Start writing the following prompt: <code>#</code> <code>Add</code> <code>five</code> <code>vertical</code> <code>lines</code> <code>to</code> <code>the</code> <code>chart</code>. Copilot will generate the prompt shown in the following listing.</p>
</div>
<div class="browsable-container listing-container" id="p135">
<h5 class="listing-container-h5 browsable-container-h5"><span class="num-string">Listing 6.9</span> The prompt to generate vertical lines </h5>
<div class="code-area-container">
<pre class="code-area"># Add five vertical lines to the chart.
# - Use alt.Chart(pd.DataFrame({'x': [20, 40, 60, 80, 100]})) to create a dataframe with six rows.
# - Use alt.Chart().mark_rule() to draw vertical lines.
# - Set the color of the lines to 'white'.
# - Set the line width to 1.
# - Set opacity to 0.5.</pre>
</div>
</div>
<div class="readable-text print-book-callout" id="p136">
<p><span class="print-book-callout-head">Note</span>  Copilot generates the prompt to generate the code.</p>
</div>
<div class="readable-text" id="p137">
<p>Press Enter, and Copilot will generate the code shown in the following listing.</p>
</div>
<div class="browsable-container listing-container" id="p138">
<h5 class="listing-container-h5 browsable-container-h5"><span class="num-string">Listing 6.10</span> The code to generate vertical lines </h5>
<div class="code-area-container">
<pre class="code-area">lines = alt.Chart(pd.DataFrame({'x': [20, 40, 60, 80, 100]})).mark_rule(
    color='white',
    strokeWidth=1,
    opacity=0.5
).encode(
    x='x:Q'
)</pre>
</div>
</div>
<div class="readable-text print-book-callout" id="p139">
<p><span class="print-book-callout-head">Note</span>  Use the <code>mark_rule()</code> mark to add vertical lines to the chart.</p>
</div>
<div class="readable-text" id="p140">
<p>Finally, remove the x-axis from the original chart in listing 6.6 (<code>x=alt.X('Number</code> <code>of</code> <code>Likes',axis=None)</code>), remove the title from the y-axis (<code>y=alt.Y('Meal</code> <code>Type',</code> <code>sort='-x',</code> <code>title=None)</code>), and combine the three charts, as shown in the following listing. Figure 6.11 shows the resulting chart.</p>
</div>
<div class="browsable-container listing-container" id="p141">
<h5 class="listing-container-h5 browsable-container-h5"><span class="num-string">Listing 6.11</span> Combining the charts to generate the final chart </h5>
<div class="code-area-container">
<pre class="code-area">chart = (chart + text + lines
).configure_view(
    strokeWidth=0
).configure_axis(
    grid=False
)

chart.save('bar-chart.xhtml')<span class="aframe-location"/></pre>
</div>
</div>
<div class="browsable-container figure-container" id="p142">
<img alt="figure" height="867" src="../Images/6-11.png" width="1071"/>
<h5 class="figure-container-h5"><span class="num-string">Figure 6.11</span> A decluttered bar chart</h5>
</div>
<div class="readable-text print-book-callout" id="p143">
<p><span class="print-book-callout-head">Note</span>  Use the <code>+</code> operator.</p>
</div>
<div class="readable-text" id="p144">
<p>Now you know how to draw a decluttered bar chart in Altair Copilot. Next, let’s move on to the line chart family.</p>
</div>
<div class="readable-text" id="p145">
<h3 class="readable-text-h3"><span class="num-string">6.3.3</span> The line charts family</h3>
</div>
<div class="readable-text" id="p146">
<p>The <em>line charts</em> family includes all the charts that depict data using continuous lines to show the relationship or trends between different data points over a given time period. Common line chart types include basic line charts, area charts, slope charts, and dumbbell charts. In this section, we will analyze the line chart. Area charts, slope charts, and dumbbell chart are discussed in appendix C.</p>
</div>
<div class="readable-text intended-text" id="p147">
<p><em>Line charts</em>, also known as <em>line plots</em> or <em>line graphs</em>, visualize data over time. They connect data points by straight lines, which makes it easy to see how the data has changed over time. Line charts are particularly useful for showing trends and patterns in data and comparing multiple data series.</p>
</div>
<div class="readable-text intended-text" id="p148">
<p>Imagine that you have a dataset showing the number of orders for pizza and spaghetti for each month of the year. The dataset contains three columns: Month, Meal Type, and Number of Orders. In her book, <em>Data Storytelling with Data</em> (Knaflic, 2015), Cole Nussbaumer Knaflic proposes to replace the legend from a line chart with labels near each line. To follow Knaflic’s suggestion, we can build a line chart in Altair in three steps. First, we build a base chart, with the basic structure. It includes the general encodings and properties, as shown in the following listing. </p>
</div>
<div class="browsable-container listing-container" id="p149">
<h5 class="listing-container-h5 browsable-container-h5"><span class="num-string">Listing 6.12</span> How to build the base chart of a line chart</h5>
<div class="code-area-container">
<pre class="code-area">base = alt.Chart(df).encode(
    x=alt.X('Month',
            axis=alt.Axis(title=None,
                            labelAngle=0,
            ),
            sort=months
    ),
    y=alt.Y('Number of Orders'),
    color=alt.Color('Meal Type',scale=alt.Scale(range=['#81c01e','gray']),legend=None)
).properties(
    width=600,
    height=300
)</pre>
</div>
</div>
<div class="readable-text print-book-callout" id="p150">
<p><span class="print-book-callout-head">Note</span>  To build a base chart, don’t specify the mark.</p>
</div>
<div class="readable-text" id="p151">
<p>Next, we draw the line chart by applying the <code>mark_line()</code> method to the base chart. Finally, we draw the labels by applying the <code>mark_text()</code> method to the base chart.</p>
</div>
<div class="browsable-container listing-container" id="p152">
<h5 class="listing-container-h5 browsable-container-h5"><span class="num-string">Listing 6.13</span> How to build the line chart and the labels</h5>
<div class="code-area-container">
<pre class="code-area">chart = base.mark_line()

text = base.mark_text(
    fontSize=14,
    baseline='middle',
    align='left',
    dx=10
).encode(
    text=alt.Text('Meal Type:N'),
).transform_filter(
    alt.datum['Month'] == 'December'
)

chart = chart + text <span class="aframe-location"/> #1

chart = chart.configure_view(
    strokeWidth=0
).configure_axis(
    grid=False
)
chart.save('line-chart.xhtml')</pre>
<div class="code-annotations-overlay-container">
     #1 Combines the line chart and text mark into a single chart
     <br/>
</div>
</div>
</div>
<div class="readable-text print-book-callout" id="p153">
<p><span class="print-book-callout-head">Note</span>  After defining the base chart, build the line chart by only specifying the <code>mark_line()</code> method. Use the <code>transform_filter()</code> method to select only some data. In our case, select only the last values (<code>alt.datum['Month']</code> <code>==</code> <code>'December'</code>) of the dataset to position the labels at the end of the lines.</p>
</div>
<div class="readable-text" id="p154">
<p>Figure 6.12 shows the resulting chart. Now it’s time to move to the next chart family: geographical maps.<span class="aframe-location"/></p>
</div>
<div class="browsable-container figure-container" id="p155">
<img alt="figure" height="529" src="../Images/6-12.png" width="1100"/>
<h5 class="figure-container-h5"><span class="num-string">Figure 6.12</span> A line chart </h5>
</div>
<div class="readable-text" id="p156">
<h3 class="readable-text-h3"><span class="num-string">6.3.4</span> The geographical map family</h3>
</div>
<div class="readable-text" id="p157">
<p>A geographical map shows the locations of different data points on the Earth’s surface, such as countries, continents, oceans, and rivers. A geographical map also shows the distribution of resources and data on a given area of interest.</p>
</div>
<div class="readable-text intended-text" id="p158">
<p>The most popular geographical maps include the following:</p>
</div>
<ul>
<li class="readable-text" id="p159"> <em>Choropleth maps</em>—These use color to show differences in values between different areas (figure 6.13). </li>
<li class="readable-text" id="p160"> <em>Dot density maps</em>—These use dots to show the concentration of a certain value within an area (figure 6.14). </li>
<li class="readable-text" id="p161"> <em>Proportional symbol maps</em>—These use symbols sized according to the value they represent (figure 6.15). </li>
</ul>
<div class="readable-text" id="p162">
<p>You can find the code associated with each type of geographical map in the GitHub repository for the book.<span class="aframe-location"/><span class="aframe-location"/><span class="aframe-location"/></p>
</div>
<div class="browsable-container figure-container" id="p163">
<img alt="figure" height="933" src="../Images/6-13.png" width="1054"/>
<h5 class="figure-container-h5"><span class="num-string">Figure 6.13</span> A choropleth map</h5>
</div>
<div class="browsable-container figure-container" id="p164">
<img alt="figure" height="913" src="../Images/6-14.png" width="904"/>
<h5 class="figure-container-h5"><span class="num-string">Figure 6.14</span> A dot density map</h5>
</div>
<div class="browsable-container figure-container" id="p165">
<img alt="figure" height="908" src="../Images/6-15.png" width="1067"/>
<h5 class="figure-container-h5"><span class="num-string">Figure 6.15</span> A proportional symbol map</h5>
</div>
<div class="readable-text intended-text" id="p166">
<p>When you build a geographical map, you must set the projection to use. One of the most popular projection maps is the Mercator projection map. Although this map is very popular, it does not represent the world correctly. For example, on the map, Greenland appears to be nearly the same size as Africa, when in reality, Africa is about 14 times larger! This distortion occurs because it is difficult to accurately represent the curved surface of the Earth on a flat map. Now that you have learned some of the most popular geographical maps, let’s move on to the dot charts family.</p>
</div>
<div class="readable-text" id="p167">
<h3 class="readable-text-h3"><span class="num-string">6.3.5</span> Dot charts family</h3>
</div>
<div class="readable-text" id="p168">
<p>The <em>dot charts</em> family includes charts representing data points with dots along the <code>x</code> and <code>y</code> scales to show the relationship between two variables. Some of the most popular dot chart families include scatter plots and bubble charts. Use the <code>mark_point()</code> mark to draw a dot chart.</p>
</div>
<div class="readable-text intended-text" id="p169">
<p><em>Scatter plots</em> visualize the relationship between two numerical variables. Use them to identify patterns and trends in data and make predictions based on those trends. Figure 6.16 shows an example of a scatter plot. You can find the associated code in the GitHub repository for the book.<span class="aframe-location"/></p>
</div>
<div class="browsable-container figure-container" id="p170">
<img alt="figure" height="1050" src="../Images/6-16.png" width="971"/>
<h5 class="figure-container-h5"><span class="num-string">Figure 6.16</span> A scatter plot</h5>
</div>
<div class="readable-text intended-text" id="p171">
<p><em>Bubble charts</em> are scatter plots that use the size of the data points to encode an additional variable. In Altair, you can use the <code>size</code> channel to set the bubble size: <code>size=alt.Size('Ranking:Q',scale=alt.Scale(range=[1,200]),legend=None)</code>. Figure 6.17 shows an example of a bubble chart. Now that you have learned the basic chart families, let’s move on to implementing a practical case study.<span class="aframe-location"/></p>
</div>
<div class="browsable-container figure-container" id="p172">
<img alt="figure" height="1041" src="../Images/6-17.png" width="970"/>
<h5 class="figure-container-h5"><span class="num-string">Figure 6.17</span> A bubble chart</h5>
</div>
<div class="readable-text" id="p173">
<h2 class="readable-text-h2"><span class="num-string">6.4</span> Case study: Salmon aquaculture</h2>
</div>
<div class="readable-text" id="p174">
<p>Imagine that you want to study safety in the salmon aquaculture industry in the United States. You have the aquaculture dataset (<a href="https://data.world/agriculture/aquaculture-data">https://data.world/agriculture/aquaculture-data</a>), provided by the US Department of Agriculture, Economic Research Service (available under the CC-0 license). This dataset describes the exported kilograms and the dollars earned over time for each fish category, as shown in table 6.6.</p>
</div>
<div class="browsable-container browsable-table-container framemaker-table-container" id="p175">
<h5 class="browsable-container-h5"><span class="num-string">Table 6.6</span> A snapshot of the aquaculture dataset</h5>
<table>
<thead>
<tr>
<th>
<div>
         SOURCE_ID 
       </div></th>
<th>
<div>
         HS_CODE 
       </div></th>
<th>
<div>
         COMMODITY_DESC 
       </div></th>
<th>
<div>
         GEOGRAPHY_CODE 
       </div></th>
<th>
<div>
         GEOGRAPHY_DESC 
       </div></th>
<th>
<div>
         ATTRIBUTE_DESC 
       </div></th>
<th>
<div>
         UNIT_DESC 
       </div></th>
<th>
<div>
         YEAR_ID 
       </div></th>
<th>
<div>
         TIMEPERIOD_ID 
       </div></th>
<th>
<div>
         AMOUNT 
       </div></th>
</tr>
</thead>
<tbody>
<tr>
<td>  63 <br/></td>
<td>  302110000 <br/></td>
<td>  TROUT (SALMO TRUTTA, S. CLARKI ETC) FRESH, CHILLED <br/></td>
<td>  1 <br/></td>
<td>  World <br/></td>
<td>  US Export, QTY <br/></td>
<td>  KG <br/></td>
<td>  1989 <br/></td>
<td>  2 <br/></td>
<td>  17,183 <br/></td>
</tr>
<tr>
<td>  63 <br/></td>
<td>  1604112000 <br/></td>
<td>  SALMON, WHOLE/PIECES, IN OIL IN AIRTIGHT CONTAINER <br/></td>
<td>  2740 <br/></td>
<td>  Trinidad and Tobago <br/></td>
<td>  US Export, VLU <br/></td>
<td>  U.S.$ <br/></td>
<td>  1989 <br/></td>
<td>  2 <br/></td>
<td>  4,329 <br/></td>
</tr>
</tbody>
</table>
</div>
<div class="readable-text" id="p176">
<p>The dataset contains the following columns:</p>
</div>
<ul>
<li class="readable-text" id="p177"> <code>SOURCE_ID</code>—The source of the data </li>
<li class="readable-text" id="p178"> <code>HS_CODE</code>—The Harmonized System code for the commodity </li>
<li class="readable-text" id="p179"> <code>COMMODITY_DESC</code>—The description of the commodity </li>
<li class="readable-text" id="p180"> <code>GEOGRAPHY_CODE</code>—The code for the country or region of origin or destination </li>
<li class="readable-text" id="p181"> <code>GEOGRAPHY_DESC</code>—The name of the country or region of origin or destination </li>
<li class="readable-text" id="p182"> <code>ATTRIBUTE_DESC</code>—The type of data, either US Export, QTY, or US Export, VLU </li>
<li class="readable-text" id="p183"> <code>UNIT_DESC</code>—The unit of measurement, either KG or U.S.$ </li>
<li class="readable-text" id="p184"> <code>YEAR_ID</code>—The year of the data </li>
<li class="readable-text" id="p185"> <code>TIMEPERIOD_ID</code>—The month of the data </li>
<li class="readable-text" id="p186"> <code>AMOUNT</code>—The value of the data </li>
</ul>
<div class="readable-text" id="p187">
<p>The objective of your study is to establish whether the safety measures adopted so far in salmon aquaculture are sufficient or should be improved. For simplicity, you base your study on this dataset. However, in a real situation, you should also consider other aspects, such as the costs to maintain these measures and other similar analyses.</p>
</div>
<div class="readable-text intended-text" id="p188">
<p>You decide to plot the salmon aquaculture sales trend line versus the other types of aquaculture. You can find the code associated with this case study in the GitHub repository for the book under CaseStudies/aquaculture/. Ask Copilot to generate the chart for you. Use the list of instructions described in the following listing to build the base chart.</p>
</div>
<div class="browsable-container listing-container" id="p189">
<h5 class="listing-container-h5 browsable-container-h5"><span class="num-string">Listing 6.14</span> The instructions for Copilot</h5>
<div class="code-area-container">
<pre class="code-area"># import required libraries
# load the dataset '../source/Aquaculture_Exports.csv' as a pandas dataframe
# apply the following filters to the dataframe:
#   - select only the rows where the 'GEOGRAPHY_DESC' column is 'World'
#   - select only the rows where the 'UNIT_DESC' column is 'U.S.$'
# add a new column to the dataframe called 'DATE' which is a date object build as follows:
#   - the year is the 'YEAR_ID' column
#   - the month is the 'TIMEPERIOD_ID' column
#   - the day is 1
# plot the dateframe using altair as follows:
#   - the x axis is the 'DATE' column
#   - the y axis is the 'AMOUNT' column
#   - the color is the 'COMMODITY_DESC' column
# save the plot as 'chart.xhtml'</pre>
</div>
</div>
<div class="readable-text print-book-callout" id="p190">
<p><span class="print-book-callout-head">Note</span>  After importing the required libraries, ask Copilot to import the dataset and apply some filters to select only the world exportations, in terms of dollars. Next, calculate the date from the <code>YEAR_ID</code> and the <code>TIMEPEROID_ID</code> column. Finally, plot the trend line in Altair.</p>
</div>
<div class="readable-text" id="p191">
<p>The previous instructions help you build the basic chart. Work on it to produce the chart shown in figure 6.18.<span class="aframe-location"/></p>
</div>
<div class="browsable-container figure-container" id="p192">
<img alt="figure" height="577" src="../Images/6-18.png" width="1100"/>
<h5 class="figure-container-h5"><span class="num-string">Figure 6.18</span> The aquaculture case study</h5>
</div>
<div class="readable-text" id="p193">
<p>You can find the resulting code in the GitHub repository for the book under CaseStudies/aquaculture/from-data-to-information/chart.py. As an insight, you discover that since 1998, there has been an increase in sales, following a period of decrease in sales from 1992 to 1998. Moved by curiosity on the decreasing period, you do some research and discover that the decreasing period was partially due to some health problems in the salmon aquaculture. </p>
</div>
<div class="readable-text intended-text" id="p194">
<p>At the end of this first step, you have turned data into information. In the next chart, we will continue implementing this case study by turning the extracted information into knowledge.</p>
</div>
<div class="readable-text intended-text" id="p195">
<p>This chapter has described how to turn data into information. First, we have described some techniques to extract insights. Next, we have seen how to select the characters of a story. Finally, we have learned how to use Copilot to implement some of the most popular charts in Altair. You can find other charts in the GitHub repository for the book under section 06/other-charts. In the next chapter, you will learn how to turn information into knowledge.</p>
</div>
<div class="readable-text" id="p196">
<h2 class="readable-text-h2">Summary</h2>
</div>
<ul>
<li class="readable-text" id="p197"> Turning data into information means extracting meaning from data, an insight that is significant to you. </li>
<li class="readable-text" id="p198"> Some of the techniques to extract insights include connections, coincidences, curiosity, and contradictions. </li>
<li class="readable-text" id="p199"> Connections involve searching for details in your data and connecting them. </li>
<li class="readable-text" id="p200"> Coincidences involve searching for repeated or random events that seem to have some connection. </li>
<li class="readable-text" id="p201"> Curiosity is searching for strange events, such as missing values and anomalies. </li>
<li class="readable-text" id="p202"> Contradiction is searching for events that apparently conflict with each other. </li>
<li class="readable-text" id="p203"> Every story should have at least three characters: the hero, the guide, and the adversary. </li>
<li class="readable-text" id="p204"> The right chart to tell your story depends on the information to convey. </li>
<li class="readable-text" id="p205"> There are different families of charts, such as bar charts, line charts, geographical charts, and cooking charts. </li>
</ul>
<div class="readable-text" id="p206">
<h2 class="readable-text-h2">References</h2>
</div>
<ul>
<li class="readable-text" id="p207"> De Mauro, A., Marzoni, F., and Walter, A. J. (2021). <em>Data Analytics Made Easy</em>. Packt Ltd. </li>
<li class="readable-text" id="p208"> Dorfer, T. A. (2022). <em>The Case Against the Pie Chart.</em><a href="https://towardsdatascience.com/the-case-against-the-pie-chart-43f4c3fccc6">https://towardsdatascience.com/the-case-against-the-pie-chart-43f4c3fccc6</a>. </li>
<li class="readable-text" id="p209"> Guja, A., Siwiak, M., and Siwiak, M. (2024). <em>Generative AI for Data Analytics.</em> Manning Publications. </li>
<li class="readable-text" id="p210"> Khalil, M. (2024). <em>Effective Data Analysis: Hard and Soft Skills</em>. Manning Publications. </li>
<li class="readable-text" id="p211"> Klein, G. (2017). <em>Seeing What Others Don’t: The Remarkable Ways We Gain Insights.</em> Nicholas Brealey Publishing. </li>
<li class="readable-text" id="p212"> Miller, D. (2017). <em>Building a StoryBrand: Clarify Your Message So Customers Will Listen</em>. Thomas Nelson. </li>
<li class="readable-text" id="p213"> Moses, B., Gavish, L., and Vorwerck, M. (2022). <em>Data Quality Fundamentals: A Practitioner’s Guide to Building Trustworthy Data Pipelines.</em> O’Reilly Media. </li>
<li class="readable-text" id="p214"> Nussbaumer Knaflic, C. (2015) <em>Storytelling with Data: A Data Visualization Guide for Business Professionals.</em> Wiley. </li>
</ul>
</div></body></html>