["```py\nFor ${PersonA.name}, we know the following: ${JSON.stringify(PersonA)}, \nso we recommend the book ${BookForPersonA}.\n\nFor ${PersonB.name}, we know the following: ${JSON.stringify(PersonB)}, \nso we recommend the book ${BookForPersonB}.\n\nFor ${PersonC.name}, we know the following: ${JSON.stringify(PersonC)}, \nso we recommend the book ${BookForPersonC}.\n\nFor ${PersonD.name}, we know the following: ${JSON.stringify(PersonD)}, \nso we recommend the book ${BookForPersonD}.\n\nFor ${user.name}$, we know the following:\n${JSON.stringify(user)}, so we recommend the book \n```", "```py\nimport numpy as np\nimport faiss\nfrom openai import OpenAI\nclient = OpenAI()\n```", "```py\nreviews = [\n   \"I hate stories about backpacking. It's boring.\",\n   \"A moving exploration of racial injustice and moral growth.\",\n   \"Compelling dystopia, but overwhelmingly bleak.\",\n   \"Timeless romance with sharp social commentary.\",\n   \"Epic sea adventure with philosophical depth.\",\n   \"Mesmerizing magic and romance with rich world-building.\",\n   \"Beautifully descriptive, but predictable plot.\",\n   \"A detailed and emotional journey through loss and art.\",\n   \"Fresh take on Greek mythology, but pacing dragged.\",\n   \"Brilliant exploration of complex relationships and personal growth.\",\n   \"Another bland romantic utopia. This time on a tropical island.\",\n]\n```", "```py\ndef get_embedding(text):\n   text = text.replace(\"\\n\", \" \")\n   return client.embeddings.create(\n      input = [text], \n      model=\"text-embedding-3-small\",\n   ).data[0].embedding\n```", "```py\ndef index_reviews(reviews):\n   # get the embeddings for the reviews\n   vectors = []\n   for review in reviews:\n      vectors.append(get_embedding(review))\n\n   # create the index\n   d = len(vectors[0]) # dimension of the vectors\n   index = faiss.IndexFlatL2(d)\n\n   # reshape vectors into 2D array and then add to the index\n   vectors = np.array(vectors).reshape(len(vectors), -1)\n   index.add(vectors)\n\n   return index\n```", "```py\ndef retrieve_reviews(index, query, reviews, k=2):\n   # get the embedding for the query\n   query_vector = get_embedding(query)\n\n   # reshape vector into 2D array and then search the index\n   query_vector = np.array(query_vector).reshape(1, -1)\n   distances, indices = index.search(query_vector, k)\n\n   return [reviews[i] for i in indices[0]]\n```", "```py\nindex = index_reviews(reviews)\n\nbook = \"The Beach by Alex Garland critiques backpacker culture by exposing the \nselfishness and moral decay behind their pursuit of an untouched paradise.\"\n\nrelated_reviews = retrieve_reviews(index, book, reviews)\n\nprint(related_reviews)\n```", "```py\ndef predict_rating(book, related_reviews):\n   reviews = \"\\n\".join(related_reviews)\n\n   prompt = (\n      \"Here is a book I might want to read:\\n\" +\n      book + \"\\n\\n\" +\n\n      \"Here are relevant reviews from the past:\\n\" +\n      reviews + \"\\n\\n\" +\n\n      \"On a scale of 1 (worst) to 5 (best), \" +\n      \"how likely am I to enjoy this book? \" +\n      \"Reply with no explanation, just a number.\"\n   )\n\n   response = client.chat.completions.create(\n      model=\"gpt-4o-mini\",\n      messages=[{\n         \"role\": \"user\",\n         \"content\": prompt\n      }],\n      max_tokens=2000,\n      temperature=0.7,\n   )\n\n   return response.choices[0].message.content\n```", "```py\nHere is a book I might want to read:\nThe Beach by Alex Garland critiques backpacker culture by exposing the \nselfishness and moral decay behind their pursuit of an untouched paradise.\n\nHere are relevant reviews from the past:\nI hate stories about backpacking. It's boring.\nAnother bland romantic utopia. This time on a tropical island.\n\nOn a scale of 1 (worst) to 5 (best), how likely am I to enjoy this book? \nReply with no explanation, just a number.\n\n```", "```py\n# Introduction\n\nI’m going through ${User}’s social media post and jotting down \nanything that could later help me decide which book I want to \ngive them for Christmas. If there’s nothing, I’ll simply \nwrite N/A.\n\n# “What I had for lunch today”\n## Post 1\n“Today I had salmon salad. Look at this photo!”\n## Notes\nN/A\n\n# “Random musings about things I like”\n## Post 2\n“I like flowers, I like the daffodils. I like the mountains. \nI like the rolling hills.”\n## Notes\nLikes nature things.\n\n# Post 3\n“Ugh, I am sick and tired of hearing about backpackers. \nAlways feeling superior to other tourists! Full of themselves! \nPlease, go backpacking if you really must, but leave me alone \nwith your stories.”\n# Notes\n```"]