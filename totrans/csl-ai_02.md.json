["```py\nfrom pgmpy.factors.discrete import DiscreteFactor\ndist = DiscreteFactor(\n    variables=[\"X\"],    #1\n    cardinality=[3],    #2\n    values=[.45, .30, .25],  #3\n    state_names= {'X': ['1', '2', '3']}     #4\n)\nprint(dist)\n```", "```py\n+------+----------+\n| X    |   phi(X) |\n+======+==========+\n| X(1) |   0.4500 |\n+------+----------+\n| X(2) |   0.3000 |\n+------+----------+\n| X(3) |   0.2500 |\n+------+----------+\n```", "```py\njoint = DiscreteFactor(\n    variables=['X', 'Y'],   #1\n    cardinality=[3, 2],     #2\n\nvalues=[.25, .20, .20, .10, .15, .10],     #3\n    state_names= {\n        'X': ['1', '2', '3'],    #3\n        'Y': ['0', '1']    #3\n    }\n)\nprint(joint)     #4\n```", "```py\n+------+------+------------+\n| X    | Y    |   phi(X,Y) |\n+======+======+============+\n| X(1) | Y(0) |     0.2500 |\n+------+------+------------+\n| X(1) | Y(1) |     0.2000 |\n+------+------+------------+\n| X(2) | Y(0) |     0.2000 |\n+------+------+------------+\n| X(2) | Y(1) |     0.1000 |\n+------+------+------------+\n| X(3) | Y(0) |     0.1500 |\n+------+------+------------+\n| X(3) | Y(1) |     0.1000 |\n+------+------+------------+\n```", "```py\nprint(joint.marginalize(variables=['Y'], inplace=False))\n```", "```py\n+------+----------+\n| X    |   phi(X) |\n+======+==========+\n| X(1) |   0.4500 |\n+------+----------+\n| X(2) |   0.3000 |\n+------+----------+\n| X(3) |   0.2500 |\n+------+----------+\n```", "```py\nprint(joint.marginalize(variables=['X'], inplace=False))\n```", "```py\n+------+----------+\n| Y    |   phi(Y) |\n+======+==========+\n| Y(0) |   0.6000 |\n+------+----------+\n| Y(1) |   0.4000 |\n+------+----------+\n```", "```py\nprint(joint / dist)\n```", "```py\n+------+------+------------+\n| X    | Y    |   phi(X,Y) |\n+======+======+============+\n| X(1) | Y(0) |     0.5556 |\n+------+------+------------+\n| X(1) | Y(1) |     0.4444 |\n+------+------+------------+\n| X(2) | Y(0) |     0.6667 |\n+------+------+------------+\n| X(2) | Y(1) |     0.3333 |\n+------+------+------------+\n| X(3) | Y(0) |     0.6000 |\n+------+------+------------+\n| X(3) | Y(1) |     0.4000 |\n+------+------+------------+\n```", "```py\nfrom pgmpy.factors.discrete.CPD import TabularCPD\nPYgivenX = TabularCPD(\n    variable='Y',    #1\n    variable_card=2,     #2\n    values=[  \n        [.25/.45, .20/.30, .15/.25],     #3\n        [.20/.45, .10/.30, .10/.25],     #3\n    ], \n    evidence=['X'],\n    evidence_card=[3],\n    state_names = {\n        'X': ['1', '2', '3'],\n        'Y': ['0', '1']\n    })\n\n**print(PYgivenX)**\n```", "```py\n+------+--------------------+---------------------+------+\n| X    | X(1)               | X(2)                | X(3) |\n+------+--------------------+---------------------+------+\n| Y(0) | 0.5555555555555556 | 0.6666666666666667  | 0.6  |\n+------+--------------------+---------------------+------+\n| Y(1) | 0.4444444444444445 | 0.33333333333333337 | 0.4  |\n+------+--------------------+---------------------+------+\n```", "```py\nimport torch\nfrom pyro.distributions import Bernoulli, Categorical, Gamma, Normal    #1\n\nprint(Categorical(probs=torch.tensor([.45, .30, .25])))    #2\nprint(Normal(loc=0.0, scale=1.0))\nprint(Bernoulli(probs=0.4))\nprint(Gamma(concentration=1.0, rate=2.0))\n```", "```py\nCategorical(probs: torch.Size([3]))\nNormal(loc: 0.0, scale: 1.0)\nBernoulli(probs: 0.4000)\nGamma(concentration: 1.0, rate: 2.0)\n```", "```py\nbern = Bernoulli(0.4)\n```", "```py\nlprob = bern.log_prob(torch.tensor(1.0))\n\nimport math\nprint(math.exp(lprob))\n```", "```py\n0.3999999887335489\n```", "```py\nfrom pgmpy.factors.discrete import DiscreteFactor\ndist = DiscreteFactor(\n    variables=[\"X\"],\n    cardinality=[3],\n    values=[.45, .30, .25],\n    state_names= {'X': ['1', '2', '3']}\n)\n\ndist.sample(n=1)    #1\n```", "```py\njoint = DiscreteFactor(\n    variables=['X', 'Y'],\n    cardinality=[3, 2],\n    values=[.25, .20, .20, .10, .15, .10],\n    state_names= {\n        'X': ['1', '2', '3'],\n        'Y': ['0', '1']\n    }\n)\n\njoint.sample(n=1)\n```", "```py\nimport torch\nfrom pyro.distributions import Categorical\nCategorical(probs=torch.tensor([.45, .30, .25])).sample()\n```", "```py\ntensor(1.)\n```", "```py\nfrom pgmpy.factors.discrete.CPD import TabularCPD\nfrom pgmpy.models import BayesianNetwork\nfrom pgmpy.sampling import BayesianModelSampling\n\nPZ = TabularCPD(     #1\n    variable='Z',     #1\n    variable_card=2,     #1\n    values=[[.65], [.35]],     #1\n    state_names = {     #1\n        'Z': ['0', '1']     #1\n    })     #1\n\nPXgivenZ = TabularCPD(     #2\n    variable='X',    #2\n    variable_card=2,   #2\n    values=[   #2\n        [.8, .6],   #2\n        [.2, .4],   #2\n    ],    #2\n    evidence=['Z'],    #2\n    evidence_card=[2],  #2\n    state_names = {    #2\n        'X': ['0', '1'],    #2\n        'Z': ['0', '1'] #2\n    })   #2\n\nPYgivenX = TabularCPD(     #3\n    variable='Y',     #3\n    variable_card=3,     #3\n    values=[    #3\n        [.1, .8],     #3\n        [.2, .1],     #3\n        [.7, .1],    #3\n    ],    #3\n    evidence=['X'],     #3\n    evidence_card=[2],    #3\n    state_names = {    #3\n        'Y': ['1', '2', '3'],    #3\n        'X': ['0', '1']    #3\n    })    #3\n\nmodel = BayesianNetwork([('Z', 'X'), ('X', 'Y')])   #4\nmodel.add_cpds(PZ, PXgivenZ, PYgivenX)     #5\n\ngenerator = BayesianModelSampling(model)    #6\ngenerator.forward_sample(size=1)    #7\n```", "```py\nimport torch\nfrom pyro.distributions import Bernoulli, Poisson, Gamma\n\nz = Gamma(7.5, 1.0).sample()    #1\nx = Poisson(z).sample()    #2\ny = Bernoulli(x / (5+x)).sample()   #3\nprint(z, x, y)\n```", "```py\ntensor(7.1545) tensor(5.) tensor(1.)\n```", "```py\nz ~ P(Z)\nx ~ P(X|Z=z)\ny = 0\nfor i in range(0, x){     #1\n    y_i ~ P(Y|X=x)    #1\n    y += y_i     #2\n}\n```", "```py\nimport torch\nfrom pyro.distributions import Bernoulli, Poisson, Gamma\nz = Gamma(7.5, 1.0).sample()\nx = Poisson(z).sample()\ny = torch.tensor(0.0)    #1\nfor i in range(int(x)):     #1\n    y += Bernoulli(.5).sample()     #1\nprint(z, x, y)\n```", "```py\nimport torch\nimport pyro\ndef random_process():\n    z = pyro.sample(\"z\", Gamma(7.5, 1.0))\n    x = pyro.sample(\"x\", Poisson(z))\n    y = torch.tensor(0.0)\n    for i in range(int(x)):\n        y += pyro.sample(f\"y{i}\", Bernoulli(.5))    #1\n    return y\n```", "```py\ngenerated_samples = generator.forward_sample(size=100)\ngenerated_samples['Y'].apply(int).mean()\n```", "```py\ngenerated_samples = torch.stack([random_process() for _ in range(100)])\n```", "```py\ngenerated_samples.mean()\n```", "```py\ntorch.square(generated_samples).mean()\n```", "```py\nimport torch\nimport pyro\nfrom pyro.distributions import Bernoulli, Gamma, Poisson\ndef random_process():\n    z = pyro.sample(\"z\", Gamma(7.5, 1.0))\n    x = pyro.sample(\"x\", Poisson(z))\n    y = torch.tensor(0.0)\n    for i in range(int(x)):\n\n        y += pyro.sample(f\"{i}\", Bernoulli(.5))\n    return z, y    #1\n\ngenerated_samples = [random_process() for _ in range(1000)]     #2\nz_mean = torch.stack([z for z, _ in generated_samples]).mean()     #3\nprint(z_mean)\n```", "```py\nz_given_y = torch.stack([z for z, y in generated_samples if y == 3])\nprint(z_given_y.mean())\n```", "```py\ngenerator.forward_sample(size=10)\n```", "```py\nimport pyro\nfrom pyro.distributions import Bernoulli, Poisson, Gamma\n\ndef model():\n    z = pyro.sample(\"z\", Gamma(7.5, 1.0))\n    x = pyro.sample(\"x\", Poisson(z))\n    with pyro.plate(\"IID\", 10):     #1\n        y = pyro.sample(\"y\", Bernoulli(x / (5+x)))    #2\n    return y\n\nmodel()\n```", "```py\ndef true_dgp(jenny_inclination, brian_inclination, window_strength):     #1\n    jenny_throws_rock = jenny_inclination > 0.5     #2\n    brian_throws_rock = brian_inclination > 0.5    #2\n    if jenny_throws_rock and brian_throws_rock: #3\n        strength_of_impact = 0.8   #3\n    elif jenny_throws_rock or brian_throws_rock:     #4\n        strength_of_impact = 0.6    #4\n    else:     #5\n        strength_of_impact = 0.0   #5\n    window_breaks = window_strength < strength_of_impact    #6\n    return jenny_throws_rock, brian_throws_rock, window_breaks\n```", "```py\ninitials = [\n    (0.6, 0.31, 0.83),\n    (0.48, 0.53, 0.33),\n    (0.66, 0.63, 0.75),\n    (0.65, 0.66, 0.8),\n    (0.48, 0.16, 0.27)\n]\n```", "```py\ndata_points = []\nfor jenny_inclination, brian_inclination, window_strength in initials:    \n    data_points.append(\n        true_dgp(\n            jenny_inclination, brian_inclination, window_strength\n        )\n    )\n```"]