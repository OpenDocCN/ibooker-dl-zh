- en: Chapter 5\. Documenting Your API
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第5章。记录您的API
- en: Documentation is where developers come to learn about your API. Whether you’re
    providing a simple README file or developing a full website for your developers,
    it is critical to clearly document how they can most effectively use your API.
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 文档是开发者了解您的API的地方。无论您是提供一个简单的README文件还是为开发者开发一个完整的网站，清楚地记录他们如何最有效地使用您的API至关重要。
- en: ''
  id: totrans-2
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Brenda Jin, Saurabh Sahni, and Amir Shevat, *Designing Web APIs* (O’Reilly,
    2018)
  id: totrans-3
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 布伦达·金、萨乌拉布·沙尼和阿米尔·谢瓦特，《设计Web API》（O'Reilly，2018）
- en: In [Chapter 4](ch04.html#chapter_4), you created your first API to fulfill the
    user stories identified in [Chapter 1](ch01.html#chapter_1). The primary users
    you developed these for are data science users and advice website providers. The
    API will enable them to create analytics products such as dashboards, charts,
    and models using the SportsWorldCentral (SWC) fantasy data. Now you will create
    documentation to help them use your API. Documentation and features such as software
    development kits (SDKs) improve the *developer experience* (DX) for your technical
    users.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 在[第4章](ch04.html#chapter_4)中，您创建了第一个API来满足[第1章](ch01.html#chapter_1)中确定的用户故事。您为这些主要用户开发的是数据科学用户和咨询网站提供商。该API将使他们能够使用SportsWorldCentral
    (SWC)的幻想数据创建分析产品，如仪表板、图表和模型。现在您将创建文档来帮助他们使用您的API。文档和如软件开发工具包（SDK）等特性可以改善您的技术用户的*开发者体验*（DX）。
- en: Sending a Signal of Trust
  id: totrans-5
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 发送信任信号
- en: An important job of your API docs is to signal trust to potential API consumers.
    If they don’t trust you, they won’t use your API. If API consumers are going to
    call your API multiple times, they will build an *integration*, which is basically
    code that calls your code repeatedly. For the SWC API, this might be a fantasy
    advice website that will be adding SWC to its list of supported websites. Another
    example would be a data science user who is going to schedule an Extract, Transform,
    Load (ETL) process to get the latest stats every week.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 您的API文档的重要任务是向潜在的API消费者传达信任信号。如果他们不信任您，他们就不会使用您的API。如果API消费者将要多次调用您的API，他们将会构建一个*集成*，这基本上是反复调用您的代码的代码。对于SWC
    API来说，这可能是一个将SWC添加到其支持网站列表的幻想咨询网站。另一个例子是一个数据科学用户，他将安排一个提取、转换、加载（ETL）过程，以每周获取最新的统计数据。
- en: 'These repeat users are asking the following when they consider using your API:
    Can I count on you? Will your API be available for me a month from now? A year
    from now?'
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 这些重复用户在考虑使用您的API时会问以下问题：我能依赖您吗？我的API一个月后、一年后还会可用吗？
- en: Many public API websites have a dusty, neglected feel. They have blog posts
    that are a few years old, message boards where posts get no response, or feature
    road maps that are out of date. If your docs are a ghost town, potential users
    will go elsewhere.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 许多公共API网站给人一种尘封、被忽视的感觉。它们有几年前的博客文章，留言板上的帖子无人回应，或者过时的功能路线图。如果您的文档像一座空城，潜在的用户会去别处。
- en: You can signal trust to these users by ensuring that your feedback mechanism
    is up to date and any questions are responded to quickly. A current release history
    and a clear versioning strategy are also good signs of life.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以通过确保您的反馈机制是最新的，并且任何问题都能得到快速响应，向这些用户传达信任信号。当前的发布历史和清晰的版本策略也是生命力的良好迹象。
- en: 'Data science users may be looking for one-time data loads and have less interest
    in long-term support. They may be asking different questions: Can I trust your
    data? Do the definitions match the contents? What level of quality is your data?
    Signal trust to these users by stating information about the quality of your data,
    and giving specific commitments on update frequency.'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 数据科学用户可能正在寻找一次性数据加载，对长期支持的兴趣较少。他们可能会问不同的问题：我能信任您的数据吗？定义与内容是否匹配？您的数据质量水平如何？通过说明您数据的质量信息，并给出具体的更新频率承诺，向这些用户传达信任信号。
- en: Making Great API Docs
  id: totrans-11
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 制作优秀的API文档
- en: When you begin the documentation for a new API, you can start with the core
    features discussed in this section. These give users what they need to get the
    job done. As your API matures, continue to improve the documentation and add features
    that set yours apart from competitors’.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 当您开始为新API编写文档时，可以从本节讨论的核心功能开始。这些功能为用户提供完成任务所需的内容。随着您的API成熟，继续改进文档并添加使您的API与众不同的特性。
- en: Core Features
  id: totrans-13
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 核心功能
- en: 'All API documentation should include a few core features. Without these basics,
    it is unlikely that an API will be used by many consumers. They allow a user to
    understand the value of the API, get the address and any necessary authorization
    information, and easily test the API. Terms of service and a feedback mechanism
    ensure that users use the API appropriately and know where to go for help. Following
    are the core feature that are expected for someone to use the API:'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 所有API文档都应该包含一些核心功能。没有这些基本功能，API不太可能被许多消费者使用。它们使用户能够理解API的价值，获取地址和任何必要的授权信息，并轻松测试API。服务条款和反馈机制确保用户适当使用API，并知道在哪里寻求帮助。以下是一些期望用户使用API的核心功能：
- en: Getting started
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 入门指南
- en: This is an overview or introduction that explains the purpose of the API and
    how consumers can interact with it. It also provides the address of the API, security
    requirements, and instructions for requesting user IDs or API keys.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 这是一个概述或介绍，解释了API的目的以及消费者如何与之互动。它还提供了API的地址、安全要求以及请求用户ID或API密钥的说明。
- en: Endpoint definitions
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 端点定义
- en: These explain the purpose of each endpoint, along with the format of requests,
    responses, and any errors. An endpoint is the full address and resource name that
    API users will make a call to. For example, [*https://api.sportsworldcentral.com/v0/players*](https://api.sportsworldcentral.com/v0/players)
    is an endpoint that returns a list of players.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 这些解释了每个端点的目的，以及请求、响应和任何错误的格式。端点是API用户将进行调用的完整地址和资源名称。例如，[*https://api.sportsworldcentral.com/v0/players*](https://api.sportsworldcentral.com/v0/players)
    是一个返回玩家列表的端点。
- en: OAS file
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: OAS文件
- en: The OpenAPI Specification (OAS) file is a machine-readable file that defines
    the connection instructions and endpoint definitions.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: OpenAPI规范（OAS）文件是一个机器可读文件，它定义了连接指令和端点定义。
- en: Terms of service
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 服务条款
- en: These explain the allowed usage of the API and any rate limits or restrictions
    that apply.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 这些解释了API的允许使用方式以及适用的任何速率限制或限制。
- en: Feedback mechanism
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 反馈机制
- en: For people to use your API, they need to have a method to reach out and ask
    questions. Some common methods include support email addresses, contact forms,
    and GitHub issue trackers.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 为了让人们使用您的API，他们需要有一种方法来联系并提问。一些常见的方法包括支持电子邮件地址、联系表单和GitHub问题跟踪器。
- en: SDKs
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: SDKs
- en: By creating SDKs in popular programming languages, an API provider can make
    the process of using the API much easier for consumers. These can help enforce
    responsible usage of the API, reducing some common problems such as overuse. If
    an API’s primary users are data scientists, this will greatly smooth the process
    of using your API. You will create an SDK for your API in [Chapter 7](ch07.html#chapter_7).
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 通过在流行的编程语言中创建SDKs（软件开发工具包），API提供商可以使消费者使用API的过程更加容易。这些可以帮助强制执行API的负责任使用，减少一些常见问题，如过度使用。如果API的主要用户是数据科学家，这将大大简化使用您的API的过程。您将在[第7章](ch07.html#chapter_7)中为您的API创建SDK。
- en: Extra Features
  id: totrans-27
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 额外功能
- en: 'In addition to the basics, several other items improve the DX of the API by
    simplifying the process of using the API or making it easier to try it out:'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 除了基本功能外，还有一些其他项目通过简化使用API的过程或使其更容易尝试来提高API的DX（开发者体验）：
- en: Sample program code
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 示例程序代码
- en: These are example snippets of code in popular software languages that demonstrate
    how to properly use the API.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 这些是流行软件语言中的代码示例片段，展示了如何正确使用API。
- en: Interactive documentation
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 交互式文档
- en: Interactive documentation allows users to submit sample API calls to a development
    environment to get hands-on experience using the API. Swagger UI is used to generate
    interactive documentation for FastAPI projects.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 交互式文档允许用户向开发环境提交样本API调用，以获得使用API的实践经验。Swagger UI用于为FastAPI项目生成交互式文档。
- en: Sandbox environment
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 沙盒环境
- en: Going beyond interactive documentation, a full-featured sandbox environment
    will enable developers to submit multiple API calls in an environment that saves
    the sample data. For example, they might create an order with one API call and
    then retrieve the results of the order in another API call.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 超越交互式文档，一个功能齐全的沙盒环境将使开发者能够在保存样本数据的环境中提交多个API调用。例如，他们可能通过一个API调用创建一个订单，然后通过另一个API调用检索订单的结果。
- en: Additional features
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 额外功能
- en: There are a variety of other extras that API providers provide. One that has
    been increasing in popularity is creating a *Postman collection*, which includes
    example requests and tests that can be run with the Postman API testing tool.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: API 提供商还提供各种其他额外功能。其中之一是越来越受欢迎的创建 *Postman 收集*，它包括可以与 Postman API 测试工具一起运行的示例请求和测试。
- en: Some of these require a commitment of time and resources to create, and also
    to keep current as the APIs change. This is often the role of dedicated developer
    relations (devrel) staff. API providers must consider the business proposition
    of the API before investing the resources in these.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 其中一些需要投入时间和资源来创建，并且随着 API 的变化而保持最新。这通常是专门负责开发者关系（devrel）的员工的工作。API 提供商在投资这些资源之前必须考虑
    API 的商业提案。
- en: Note
  id: totrans-38
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 注意
- en: Advanced features can significantly reduce the friction a consumer faces to
    use the API, and get them up and running quickly. Sometimes this is referred to
    as reducing the *time to hello world* (TTHW). The quicker a potential consumer
    can make a basic prototype with your API, the more likely they are to use it.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 高级功能可以显著减少消费者使用 API 面临的摩擦，并快速启动。有时这被称为减少 *时间到 Hello World*（TTHW）。潜在消费者能够更快地使用你的
    API 制作基本原型，他们使用它的可能性就越大。
- en: Reviewing Examples of API Documentation
  id: totrans-40
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 检查 API 文档的示例
- en: A tour of some real-world API documentation will demonstrate the features mentioned
    previously. These examples illustrate some core features and extra features.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 对一些现实世界 API 文档的浏览将展示之前提到的功能。这些示例说明了核心功能和额外功能。
- en: Sleeper App
  id: totrans-42
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Sleeper App
- en: The Sleeper app is a real-life fantasy football league host, like your imaginary
    SportsWorldCentral. Its [API documentation](https://docs.sleeper.com) demonstrates
    several of the basic features of documentation ([Figure 5-1](#sleeper_documentation_1_ch3)).
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: Sleeper 应用程序是一个现实生活中的幻想足球联赛主办方，就像你想象中的 SportsWorldCentral。它的 [API 文档](https://docs.sleeper.com)
    展示了文档的几个基本功能（[图 5-1](#sleeper_documentation_1_ch3)）。
- en: '![Sleeper landing page](assets/haad_0501.png)'
  id: totrans-44
  prefs: []
  type: TYPE_IMG
  zh: '![Sleeper 登录页面](assets/haad_0501.png)'
- en: 'Figure 5-1\. Core feature: Getting started page'
  id: totrans-45
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 5-1\. 核心功能：入门页面
- en: The landing page gives some basic information about using the API, including
    authentication requirements (no authentication) and general usage limits (under
    1,000 API calls per minute). The documentation provides a search function and
    navigation bar showing the major endpoints and errors. [Figure 5-2](#sleeper_documentation_2_ch3)
    shows the more detailed information available for the Drafts endpoint.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 登录页面提供了有关使用 API 的一些基本信息，包括身份验证要求（无需身份验证）和一般使用限制（每分钟少于 1,000 个 API 调用）。文档提供了搜索功能和显示主要端点和错误的导航栏。[图
    5-2](#sleeper_documentation_2_ch3) 展示了 Drafts 端点可用的更详细的信息。
- en: '![Sleeper Drafts endpoints](assets/haad_0502.png)'
  id: totrans-47
  prefs: []
  type: TYPE_IMG
  zh: '![Sleeper Drafts 端点](assets/haad_0502.png)'
- en: 'Figure 5-2\. Core feature: Endpoint definitions'
  id: totrans-48
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 5-2\. 核心功能：端点定义
- en: This page includes the production API URL along with the HTTP verb and required
    parameters. The righthand column demonstrates an example API call and the output
    of the API call in JSON format.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 此页面包括生产 API URL、HTTP 动词和所需参数。右侧列展示了示例 API 调用和 API 调用的 JSON 格式输出。
- en: MyFantasyLeague
  id: totrans-50
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: MyFantasyLeague
- en: MyFantasyLeague is a fantasy league host that provides a [full-featured developer
    portal](https://oreil.ly/t7tSf) and is known for providing quality support to
    developers.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: MyFantasyLeague 是一个幻想联赛主办方，提供 [功能齐全的开发者门户](https://oreil.ly/t7tSf)，并且以其为开发者提供高质量支持而闻名。
- en: The welcome page begins with a focus on release notes of API versions ([Figure 5-3](#mfl_documentation_1_ch3)).
    It provides links to a request reference page and sample code, and then prominently
    features the terms of service for using the API.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 欢迎页面从关注 API 版本的发布说明开始（[图 5-3](#mfl_documentation_1_ch3)）。它提供了请求参考页面和示例代码的链接，然后突出显示了使用
    API 的服务条款。
- en: '![MyFantasyLeague Welcome Page](assets/haad_0503.png)'
  id: totrans-53
  prefs: []
  type: TYPE_IMG
  zh: '![MyFantasyLeague 欢迎页面](assets/haad_0503.png)'
- en: Figure 5-3\. MyFantasyLeague welcome page
  id: totrans-54
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 5-3\. MyFantasyLeague 欢迎页面
- en: Following the “test the requests” link from the welcome page brings you to the
    interactive API documentation ([Figure 5-4](#mfl_documentation_2_ch3)). What is
    the difference between interactive API documentation and a sandbox environment?
    Interactive documentation supports test API calls, but it doesn’t store the results
    between test calls. A sandbox environment keeps track of previous API calls to
    allow you to test multiple tasks together.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 从欢迎页面上的“测试请求”链接进入将带你到交互式 API 文档（[图 5-4](#mfl_documentation_2_ch3)）。交互式 API 文档和沙盒环境之间有什么区别？交互式文档支持测试
    API 调用，但不会在测试调用之间存储结果。沙盒环境跟踪之前的 API 调用，以便你可以一起测试多个任务。
- en: '![Extra feature: Interactive documentation](assets/haad_0504.png)'
  id: totrans-56
  prefs: []
  type: TYPE_IMG
  zh: '![额外功能：交互式文档](assets/haad_0504.png)'
- en: 'Figure 5-4\. Extra feature: Interactive documentation'
  id: totrans-57
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 5-4\. 额外功能：交互式文档
- en: Yahoo! Fantasy Football
  id: totrans-58
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Yahoo! 梦幻足球
- en: Yahoo! is another fantasy football league host that provides detailed [API documentation](https://oreil.ly/4YIxy).
    Yahoo! provides sample PHP code for accessing its APIs. This sample code provides
    detailed instructions on authentication, which can be especially tricky ([Figure 5-5](#yahoo_documentation_2_ch3)).
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: Yahoo! 是另一个提供详细 [API 文档](https://oreil.ly/4YIxy) 的梦幻足球联赛主办方。Yahoo! 提供了访问其 API
    的示例 PHP 代码。此示例代码提供了详细的认证说明，这可能特别棘手（[图 5-5](#yahoo_documentation_2_ch3)）。
- en: '![Extra feature: Sample program code](assets/haad_0505.png)'
  id: totrans-60
  prefs: []
  type: TYPE_IMG
  zh: '![额外功能：示例程序代码](assets/haad_0505.png)'
- en: 'Figure 5-5\. Extra feature: Sample program code'
  id: totrans-61
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 5-5\. 额外功能：示例程序代码
- en: Viewing Your API’s Built-in Documentation
  id: totrans-62
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 查看你的 API 内置文档
- en: In [Chapter 4](ch04.html#chapter_4), you built an API with the endpoints to
    fulfill your top-priority use cases. In this chapter, you will view the built-in
    documentation for the API. You will also make a few updates to the API code to
    improve the documentation.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 在 [第 4 章](ch04.html#chapter_4) 中，你构建了一个 API，其端点用于满足你的最高优先级用例。在本章中，你将查看 API 的内置文档。你还将对
    API 代码进行一些更新，以改进文档。
- en: Copying Files from Chapter 4
  id: totrans-64
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 从第 4 章复制文件
- en: 'To continue your portfolio project where you left it in the previous chapter,
    change the directory to *chapter5* and then copy the previous chapter’s files
    into it. The following shows the commands and expected output:'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 要继续你在上一章中停止的你的项目组合，请将目录更改为 *chapter5*，然后将上一章的文件复制到其中。以下显示了命令和预期输出：
- en: '[PRE0]'
  id: totrans-66
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'Now launch your API using `fastapi dev` instead of `fastapi run`, as you did
    in the previous chapter. This tells FastAPI to automatically reload the application
    each time you make any changes to the program code:'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 现在请使用 `fastapi dev` 而不是 `fastapi run` 启动你的 API，就像你在上一章中所做的那样。这告诉 FastAPI 每次你对程序代码进行任何更改时自动重新加载应用程序：
- en: '[PRE1]'
  id: totrans-68
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: You will see a dialog stating “Your application running on port 8000 is available,”
    as shown in [Figure 5-6](#codespaces_open_browser_ch3).
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 你将看到一个对话框，显示“你的运行在端口 8000 的应用程序可用”，如图 [图 5-6](#codespaces_open_browser_ch3)
    所示。
- en: '![Codespaces browser window popup](assets/haad_0506.png)'
  id: totrans-70
  prefs: []
  type: TYPE_IMG
  zh: '![Codespaces 浏览器窗口弹出](assets/haad_0506.png)'
- en: Figure 5-6\. Codespaces browser window pop-up
  id: totrans-71
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 5-6\. Codespaces 浏览器窗口弹出
- en: 'Click “Open in Browser” to open a browser tab outside your Codespaces. This
    browser will show a base URL that ends in *app.github.dev* that contains the response
    from your API running on Codespaces. You should see the following health check
    message in your web browser:'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 点击“在浏览器中打开”以在 Codespaces 外部打开一个浏览器标签页。此浏览器将显示一个以 *app.github.dev* 结尾的基本 URL，其中包含在
    Codespaces 上运行的 API 的响应。你应该在你的网页浏览器中看到以下健康检查信息：
- en: '[PRE2]'
  id: totrans-73
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'Documentation Option 1: Swagger UI'
  id: totrans-74
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 文档选项 1：Swagger UI
- en: 'I will go into more detail on the Swagger UI documentation than the Redoc documentation,
    because the former allows you to test your API. To view the Swagger UI interactive
    API documentation for your API, copy and paste the following onto the end of the
    base URL in your browser: ***/docs***. For example, the full URL in the browser
    might be *[*https://happy-pine-tree-1234-8000.app.github.dev/docs*](https://happy-pine-tree-1234-8000.app.github.dev/docs)*.
    You should see documentation as shown in [Figure 5-7](#swagger_docs_1_ch5).'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 我将对 Swagger UI 文档的说明比 Redoc 文档更详细，因为前者允许你测试你的 API。要查看你的 API 的 Swagger UI 交互式
    API 文档，请在浏览器中基本 URL的末尾复制并粘贴以下内容：***/docs***。例如，浏览器中的完整 URL 可能是 *[*https://happy-pine-tree-1234-8000.app.github.dev/docs*](https://happy-pine-tree-1234-8000.app.github.dev/docs)*。你应该看到如图
    [图 5-7](#swagger_docs_1_ch5) 所示的文档。
- en: You may recognize this list of endpoints from [Table 4-1](ch04.html#swc_endpoints_ch4)
    in the last chapter. You can see that all the endpoints you implemented in your
    API are listed here. You can click on any of these endpoints to expand the section
    that is specific to that endpoint and interact with it.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 您可能已经从上一章的 [表 4-1](ch04.html#swc_endpoints_ch4) 中认出了这个端点列表。您可以看到，您在 API 中实现的所有端点都列在这里。您可以点击任何一个端点来展开特定于该端点的部分，并与它交互。
- en: '![Initial Swagger UI interactive documentation](assets/haad_0507.png)'
  id: totrans-77
  prefs: []
  type: TYPE_IMG
  zh: '![初始 Swagger UI 交互式文档](assets/haad_0507.png)'
- en: Figure 5-7\. Initial Swagger UI interactive documentation
  id: totrans-78
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 5-7\. 初始 Swagger UI 交互式文档
- en: Click on the bar that says “Get /v0/players/{player_id}” and then click the
    “Try it out” button. This button changes to Cancel, as seen in [Figure 5-8](#swagger_docs_2_ch5).
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 点击显示“Get /v0/players/{player_id}”的栏位，然后点击“Try it out”按钮。此按钮将变为“取消”，如图 [图 5-8](#swagger_docs_2_ch5)
    所示。
- en: '![Expanded endpoint section, top half](assets/haad_0508.png)'
  id: totrans-80
  prefs: []
  type: TYPE_IMG
  zh: '![展开的端点部分，上半部分](assets/haad_0508.png)'
- en: Figure 5-8\. Expanded endpoint section, top half
  id: totrans-81
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 5-8\. 展开的端点部分，上半部分
- en: The Parameters section includes the `player_id` parameter that is defined for
    this endpoint. This parameter is required, it has a data type of integer, and
    it is a path parameter, which means that when this API is called, the URL path
    includes the `player_id` value, as shown in the endpoint definition. [Figure 5-9](#swagger_docs_3_ch5)
    displays the bottom half of this endpoint section.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 参数部分包括为此端点定义的 `player_id` 参数。此参数是必需的，其数据类型为整数，它是一个路径参数，这意味着当调用此 API 时，URL 路径将包含
    `player_id` 值，如图端点定义所示。[图 5-9](#swagger_docs_3_ch5) 显示了此端点部分的下半部分。
- en: '![Expanded endpoint section, bottom half](assets/haad_0509.png)'
  id: totrans-83
  prefs: []
  type: TYPE_IMG
  zh: '![展开的端点部分，下半部分](assets/haad_0509.png)'
- en: Figure 5-9\. Expanded endpoint section, bottom half
  id: totrans-84
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 5-9\. 展开的端点部分，下半部分
- en: 'This section describes two expected responses that consumers should plan for.
    If a request to this endpoint is successful, an HTTP status code 200 (successful
    response) will be returned, and the response body will be in this format:'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 本节描述了消费者应该准备的两种预期响应。如果对端点的请求成功，将返回 HTTP 状态码 200（成功响应），并且响应体将采用以下格式：
- en: '[PRE3]'
  id: totrans-86
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'However, if the request is invalid, the consumer will receive a response with
    an HTTP status code 422 (unprocessable content) and an error message in this format:'
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，如果请求无效，消费者将收到一个包含 HTTP 状态码 422（不可处理的内容）的错误信息的响应：
- en: '[PRE4]'
  id: totrans-88
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: To interact with the interactive documentation, click the Execute button. You
    should see the error result displayed in [Figure 5-10](#swagger_docs_4_ch5), or
    something similar.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 要与交互式文档交互，请点击执行按钮。您应该看到错误结果显示在 [图 5-10](#swagger_docs_4_ch5)，或类似的内容。
- en: '![Player endpoint error message](assets/haad_0510.png)'
  id: totrans-90
  prefs: []
  type: TYPE_IMG
  zh: '![玩家端点错误信息](assets/haad_0510.png)'
- en: Figure 5-10\. Player endpoint error message
  id: totrans-91
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 5-10\. 玩家端点错误信息
- en: The documentation has enforced the required `player_id` parameter and displayed
    the message “Required field is not provided.” Enter a value of **`1385`** in the
    `player_id` field, and click Execute again. This request should be successful,
    and the Responses section of the web page should look similar to [Figure 5-11](#swagger_docs_5_ch5).
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 文档强制执行所需的 `player_id` 参数，并显示消息“必需字段未提供。”在 `player_id` 字段中输入 **`1385`** 的值，然后再次点击执行。此请求应该成功，并且网页的响应部分应该类似于
    [图 5-11](#swagger_docs_5_ch5)。
- en: '![Successful player response](assets/haad_0511.png)'
  id: totrans-93
  prefs: []
  type: TYPE_IMG
  zh: '![成功的玩家响应](assets/haad_0511.png)'
- en: Figure 5-11\. Successful player response
  id: totrans-94
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 5-11\. 成功的玩家响应
- en: This part of the page shows useful information about the HTTP request that is
    constructed by the documentation and the HTTP response that is sent back by your
    API.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 页面的这部分显示了有关由文档构建的 HTTP 请求和您的 API 发送回的 HTTP 响应的有用信息。
- en: First, look at the response. In the `curl` section, the documentation displays
    the command-line statement that could be used to call this API. This is helpful
    to understand the exact HTTP request that is constructed by the parameters you
    entered earlier. (cURL is a common command-line utility used to make HTTP requests
    to web applications and APIs.) You could copy that URL into your browser bar and
    make the same API call directly.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，查看响应。在 `curl` 部分，文档显示了可以用来调用此 API 的命令行语句。这有助于理解您之前输入的参数构建的确切 HTTP 请求。（cURL
    是一种常用的命令行工具，用于向 Web 应用程序和 API 发送 HTTP 请求。）您可以将该 URL 复制到浏览器地址栏中，直接进行相同的 API 调用。
- en: Remember, the endpoint is a combination of an HTTP verb and a URL. In [Figure 5-11](#swagger_docs_5_ch5),
    the HTTP verb is `GET`, as displayed in the documentation. The URL points to the
    address that Codespaces generates.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 记住，端点是 HTTP 动词和 URL 的组合。在 [图 5-11](#swagger_docs_5_ch5) 中，HTTP 动词是 `GET`，正如文档中显示的那样。URL
    指向 Codespaces 生成的地址。
- en: In the Request URL section, you see the URL without the HTTP verb. Note that
    the end of the URL is *v0/players/1385*. This matches the expected */v0/players/{player_id}*
    from our program code and the earlier documentation. Since `player_id` is a path
    parameter, it is added to the end of the URL.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 在请求 URL 部分，您可以看到没有 HTTP 动词的 URL。请注意，URL 的结尾是 *v0/players/1385*。这与程序代码和早期文档中预期的
    */v0/players/{player_id}* 匹配。由于 `player_id` 是路径参数，它被添加到 URL 的末尾。
- en: Now let’s look at the response. Under “Server response,” you see that the response
    received was an HTTP 200, which is a successful response. The “Response body”
    shows the JSON data that was returned by the API. It matches the format of the
    `Player` object, and it contains the data for `player_id` 1385, which is what
    you entered in the path parameter. It also includes the `Performance` records
    that are associated with this `Player`.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 现在让我们看看响应。在“服务器响应”下，您可以看到收到的响应是 HTTP 200，这是一个成功的响应。“响应体”显示了 API 返回的 JSON 数据。它与
    `Player` 对象的格式相匹配，并包含了 `player_id` 1385 的数据，这是您在路径参数中输入的内容。它还包括与该 `Player` 相关的
    `Performance` 记录。
- en: The “Response headers” section displays the HTTP headers, which are additional
    metadata the API sent along with the response body. This is information you would
    not see if you were calling the API directly in your browser.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: “响应头”部分显示了 HTTP 头部，这是 API 与响应体一起发送的附加元数据。如果您直接在浏览器中调用 API，您将看不到这些信息。
- en: As you have seen, this interactive API documentation is very powerful. It compares
    well to the features of any of the API documentation demonstrated on the real-world
    fantasy league hosts in this chapter. Since you did not create this code yourself,
    where is it coming from? This documentation is generated by [Swagger UI](https://oreil.ly/r6P--),
    which is an open source project led by SmartBear software. The Swagger UI has
    been heavily used in API documentation for many years. Many times when people
    use the term *API documentation*, Swagger UI is what they mean. It is not an exaggeration
    to say that this open source project deserves a lot of credit for expanding the
    popularity of REST APIs as a core technology across the IT industry.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 正如您所看到的，这个交互式 API 文档非常强大。它与本章中展示的任何真实世界幻想联赛主机上的 API 文档功能相媲美。由于您没有自己创建此代码，它从哪里来？此文档是由
    [Swagger UI](https://oreil.ly/r6P--) 生成的，这是一个由 SmartBear 软件领导的开源项目。Swagger UI
    多年来在 API 文档中得到了广泛的应用。很多时候，当人们使用术语 *API 文档* 时，他们指的是 Swagger UI。说这个开源项目为扩大 REST
    API 作为 IT 行业核心技术的影响力做出了巨大贡献，并不夸张。
- en: Swagger UI is included in the FastAPI code. It generates this documentation
    automatically from the OpenAPI Specification (OAS) file that is named *openapi.json*
    and is linked under the title of this page. FastAPI generates this OAS file automatically
    from the *main.py* code.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: Swagger UI 包含在 FastAPI 代码中。它自动从名为 *openapi.json* 的 OpenAPI 规范 (OAS) 文件生成此文档，该文件位于本页标题下方。FastAPI
    自动从 *main.py* 代码生成此 OAS 文件。
- en: 'If you look at this endpoint definition in *main.py* that you developed in
    [Chapter 4](ch04.html#chapter_4), you will see the following:'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您查看您在 [第 4 章](ch04.html#chapter_4) 中开发的 *main.py* 端点定义，您将看到以下内容：
- en: '[PRE5]'
  id: totrans-104
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: Looking again at [Figure 5-8](#swagger_docs_2_ch5), you can see that the HTTP
    verb, URL, and path parameter are generated from `@app.get("/v0/players/{player_id}"`.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 再次查看 [图 5-8](#swagger_docs_2_ch5)，您可以看到 HTTP 动词、URL 和路径参数是从 `@app.get("/v0/players/{player_id}"`
    生成的。
- en: Looking at [Figure 5-9](#swagger_docs_3_ch5), you can see that the Successful
    Response definition is generated from the Pydantic schema `Player`, which you
    defined in *schemas.py*. The time you spent defining each piece of the Python
    code continues to pay off in this well-crafted API.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 查看 [图 5-9](#swagger_docs_3_ch5)，您可以看到成功响应定义是由您在 *schemas.py* 中定义的 Pydantic 架构
    `Player` 生成的。您花费在定义每段 Python 代码上的时间，在这精心制作的 API 中继续得到回报。
- en: 'Documentation Option 2: Redoc'
  id: totrans-107
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 文档选项 2：Redoc
- en: 'In addition to Swagger UI, FastAPI includes a second API documentation option:
    Redoc. [Redoc](https://oreil.ly/redoc) is an open source API documentation product
    that is led by Redocly.'
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 除了 Swagger UI，FastAPI 还包括第二个 API 文档选项：Redoc。[Redoc](https://oreil.ly/redoc)
    是一个由 Redocly 领导的开源 API 文档产品。
- en: 'To view the Redoc API documentation for your API, copy and paste the following
    onto the end of the base URL in your browser: ***/redoc***. For example, the full
    URL might be *[*https://happy-pine-tree-1234-8000.app.github.dev/redoc*](https://happy-pine-tree-1234-8000.app.github.dev/redoc)*
    in the browser. Click Read Player in the navigation pane on the left. You should
    see documentation as shown in [Figure 5-12](#redoc_docs_1_ch5).'
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 要查看您的 API 的 Redoc API 文档，请在浏览器中基 URL 的末尾复制并粘贴以下内容：***/redoc***。例如，完整的 URL 可能是
    *[*https://happy-pine-tree-1234-8000.app.github.dev/redoc*](https://happy-pine-tree-1234-8000.app.github.dev/redoc)*。在左侧导航窗格中单击“阅读器”。您应该会看到如图
    5-12 所示的文档。[图 5-12](#redoc_docs_1_ch5)。
- en: '![Redoc documentation page](assets/haad_0512.png)'
  id: totrans-110
  prefs: []
  type: TYPE_IMG
  zh: '![Redoc 文档页面](assets/haad_0512.png)'
- en: Figure 5-12\. Redoc documentation page
  id: totrans-111
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 5-12\. Redoc 文档页面
- en: As you can see, the Redoc documentation has an attractive three-column layout
    with the API endpoints in the navigation bar on the left, along with a search
    function. The center column has the bulk of the information about the endpoint,
    including parameters, responses, and errors. The righthand column displays example
    response bodies for successful (200) and error (422) responses.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 如您所见，Redoc 文档具有吸引人的三列布局，左侧导航栏中包含 API 端点，以及搜索功能。中间列包含关于端点的详细信息，包括参数、响应和错误。右侧列显示成功（200）和错误（422）响应的示例响应体。
- en: In general, the contents of the documentation are quite similar to Swagger UI,
    because both are generated from the same OAS file. The biggest difference in functionality
    between the two included documentation options is that the Redoc library included
    in FastAPI doesn’t provide a method for submitting API requests. So it is not
    an interactive option.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 通常，文档的内容与 Swagger UI 非常相似，因为两者都是从相同的 OAS 文件生成的。这两个包含的文档选项在功能上的最大区别是，FastAPI
    中包含的 Redoc 库不提供提交 API 请求的方法。因此，它不是一个交互式选项。
- en: What advantages does Redoc have over Swagger UI? In my opinion, the mobile browser
    layout of Redoc is more attractive than that of Swagger UI. While I generally
    don’t consider mobile functionality important for a technical reference page like
    API docs, this might be important to some organizations. In addition, the Redoc
    layout and appearance might be preferred.
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: Redoc 相比 Swagger UI 有哪些优势？在我看来，Redoc 的移动浏览器布局比 Swagger UI 更吸引人。虽然我通常不认为移动功能对于像
    API 文档这样的技术参考页面很重要，但这可能对某些组织很重要。此外，Redoc 的布局和外观可能更受欢迎。
- en: Working with Your OpenAPI Specification File
  id: totrans-115
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用您的 OpenAPI 规范文件
- en: Although these documentation pages are quite impressive, they are nothing without
    the OAS file. This is literally true, since FastAPI and Pydantic generate the
    OAS file at the */openapi.json* path, and Redoc and Swagger UI generate their
    documentation from this file.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然这些文档页面相当令人印象深刻，但没有 OAS 文件就毫无价值。这字面意义上是真的，因为 FastAPI 和 Pydantic 在 */openapi.json*
    路径生成 OAS 文件，而 Redoc 和 Swagger UI 则从该文件生成其文档。
- en: 'But the OAS file is more than simply a way to generate documentation: it is
    a powerful API definition standard that allows many other tools to interact with
    your API. One quick example is that in [Part III](part03.html#part_3) you will
    create a custom action that enables ChatGPT to answer questions using the data
    from your API. What information does it need for this? Your OAS file. This is
    just a drop in the bucket of what the OAS file is used for. The [OpenApi.Tools](https://openapi.tools)
    website lists code generators, data validators, SDK generators, mock servers,
    and a dozen other categories of tools that use the OAS file.'
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 但 OAS 文件不仅仅是生成文档的一种方式：它是一个强大的 API 定义标准，允许许多其他工具与您的 API 交互。一个快速的例子是，在 [第三部分](part03.html#part_3)
    中，您将创建一个自定义操作，使 ChatGPT 能够使用您的 API 数据来回答问题。它需要哪些信息来完成这个任务？您的 OAS 文件。这只是 OAS 文件用途的一小部分。OpenApi.Tools（https://openapi.tools）网站列出了代码生成器、数据验证器、SDK
    生成器、模拟服务器以及使用 OAS 文件的十二类其他工具。
- en: For many years, the software development industry was divided between competing
    vendor-specific API specifications and response formats. The Swagger specification
    was made open source in 2015 by Swagger, and in 2017 several companies and groups
    presented a united front at the API Strategy and Practice Conference promoting
    OAS as the de facto standard for REST API specifications. (Coincidentally, I was
    a speaker at that conference and got to witness the events unfold.) At the time,
    [Bill Doerrfield](https://oreil.ly/m6XNK) summarized the events by saying that
    the data format wars are over. You’ll read more from Doerrfield in [Chapter 13](ch13.html#chapter_13).
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 多年来，软件开发行业在竞争的供应商特定API规范和响应格式之间分裂。Swagger规范在2015年由Swagger开源，2017年，几家公司和团体在API策略和实践会议上联合起来，推广OAS作为REST
    API规范的既定标准。（巧合的是，我参加了那次会议，并目睹了事件的发展。）当时，[比尔·多尔夫菲尔德](https://oreil.ly/m6XNK)通过总结说数据格式战争已经结束。您将在第13章（ch13.html#chapter_13）中了解更多关于多尔夫菲尔德的内容。
- en: 'The [OAS format](https://oreil.ly/J9v0i) is quite extensive, so this chapter
    will focus on the items that are implemented in FastAPI. To view the raw OAS file
    for your API, copy and paste the following onto the end of the base URL in your
    browser: ***/openapi.json***. For example, the full URL might be *[*https://happy-pine-tree-1234-8000.app.github.dev/openapi.json*](https://happy-pine-tree-1234-8000.app.github.dev/openapi.json)*
    in the browser. You should see the raw JSON file, which begins with `{"openapi":"3.1.0","info":{"title":"Fas⁠t​API","version":"0.1.0"},"paths":`.'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: '[OAS格式](https://oreil.ly/J9v0i)相当广泛，因此本章将重点介绍在FastAPI中实现的项目。要查看您API的原始OAS文件，请在浏览器中基URL的末尾复制并粘贴以下内容：***/openapi.json***。例如，完整的URL可能是浏览器中的*[*https://happy-pine-tree-1234-8000.app.github.dev/openapi.json*](https://happy-pine-tree-1234-8000.app.github.dev/openapi.json)*。您应该看到原始的JSON文件，它以`{"openapi":"3.1.0","info":{"title":"Fas⁠t​API","version":"0.1.0"},"paths":`开始。'
- en: Tip
  id: totrans-120
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 小贴士
- en: The OAS file defines a single API, but the OpenAPI Initiative is working on
    a new specification called [Arazzo](https://oreil.ly/arazzo) that will define
    workflows involving sequences of API calls. One of the potential use cases for
    this specification is to assist generative AI applications that are based on *large
    language models* (LLMs). For more information about these applications, read [Part III](part03.html#part_3)
    of this book.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: OAS文件定义了一个单一的API，但OpenAPI倡议正在制定一个新的规范，称为[Arazzo](https://oreil.ly/arazzo)，该规范将定义涉及一系列API调用的工作流程。该规范的潜在用例之一是帮助基于*大型语言模型*（LLMs）的生成式AI应用。有关这些应用的更多信息，请参阅本书的第三部分（part03.html#part_3）。
- en: 'To understand the structure of this file, you will need to view the file somewhere
    that formats JSON in an easier-to-read format. Two convenient approaches to this
    would be installing a JSON formatter browser extension or opening the file in
    your IDE. If you save the file and open it in VS Code, you can choose “Format
    document” from the context menu to see the formatted JSON. Using a browser extension
    to format JSON has one advantage: as you make changes to the API that modify the
    JSON file, they can be refreshed and viewed instead of requiring you to download
    the file repeatedly. I typically install a browser extension for the convenience
    of viewing API responses. Take a look at the top two levels of the *openapi.json*
    file hierarchy:'
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 要理解这个文件的结构，您需要在某个地方查看该文件，以便以更易于阅读的格式格式化JSON。两种方便的方法是安装一个JSON格式化浏览器扩展或在该IDE中打开文件。如果您保存文件并在VS
    Code中打开，您可以从上下文菜单中选择“格式化文档”来查看格式化的JSON。使用浏览器扩展格式化JSON有一个优点：当您对API进行更改以修改JSON文件时，它们可以刷新并查看，而无需您反复下载文件。我通常安装一个浏览器扩展来方便地查看API响应。查看*openapi.json*文件的前两级结构：
- en: '[PRE6]'
  id: totrans-123
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: '[![1](assets/1.png)](#co_documenting_your_api_CO1-1)'
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: '![1](assets/1.png)(#co_documenting_your_api_CO1-1)'
- en: This is a `string` that contains the OpenAPI specification version. For your
    API, the version is 3.1.0, which was published in 2021.
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 这是一个包含OpenAPI规范版本的`string`。对于您的API，版本是3.1.0，该版本于2021年发布。
- en: '[![2](assets/2.png)](#co_documenting_your_api_CO1-2)'
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: '![2](assets/2.png)(#co_documenting_your_api_CO1-2)'
- en: This field is an `Info` object, which provides metadata about the API. The API’s
    `title` and `version` are the required fields, and they are populated in this
    example. Optional fields include _summary+, `description`, `termsOfService`, `contact`,
    and `license`.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 此字段是一个`Info`对象，它提供了有关API的元数据。API的`title`和`version`是必填字段，并在本例中进行了填充。可选字段包括`summary`、`description`、`termsOfService`、`contact`和`license`。
- en: '[![3](assets/3.png)](#co_documenting_your_api_CO1-3)'
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: '![3](assets/3.png)(#co_documenting_your_api_CO1-3)'
- en: This field contains the list of `paths`, which are relative URLs for API endpoints.
    You may notice that this list does not contain the HTTP verbs, which make up the
    other half of an API endpoint. The verbs and additional details are contained
    one level down inside the `path` objects.
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 此字段包含 `paths` 列表，这些是 API 端点的相对 URL。您可能会注意到，此列表不包含 HTTP 动词，它们构成了 API 端点的另一半。动词和附加细节包含在
    `path` 对象的一级之下。
- en: '[![4](assets/4.png)](#co_documenting_your_api_CO1-4)'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: '[![4](assets/4.png)](#co_documenting_your_api_CO1-4)'
- en: This field can contain a wide range of reusable items that can be referenced
    in other parts of the OAS. In this example, it contains schemas, which are data
    structures used by the API.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 此字段可以包含各种可重复使用的项目，这些项目可以在 OAS 的其它部分引用。在这个例子中，它包含架构，这些是 API 使用的数据结构。
- en: 'To see the details of one `path`, expand the */v0/players/{player_id}* item.
    This `path` object has only one field: `get`, which is an operation object. Expand
    `get`, and you should see the following:'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 要查看一个 `path` 的详细信息，展开 */v0/players/{player_id}* 项。此 `path` 对象只有一个字段：`get`，它是一个操作对象。展开
    `get`，您应该看到以下内容：
- en: '[PRE7]'
  id: totrans-133
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: '[![1](assets/1.png)](#co_documenting_your_api_CO2-1)'
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: '[![1](assets/1.png)](#co_documenting_your_api_CO2-1)'
- en: You will recognize that this section contains the information that was displayed
    in Swagger UI in [Figure 5-9](#swagger_docs_3_ch5). Swagger UI generated it from
    this section of the OAS file.
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 您将认识到这一部分包含在 [图 5-9](#swagger_docs_3_ch5) 中显示的 Swagger UI 中的信息。Swagger UI 从
    OAS 文件的这一部分生成了它。
- en: '[![2](assets/2.png)](#co_documenting_your_api_CO2-2)'
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: '[![2](assets/2.png)](#co_documenting_your_api_CO2-2)'
- en: This is an operation identifier. This was not displayed in Swagger UI, but some
    tools use it when processing the OAS. This is also useful to generative AI applications
    that will process the file.
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 这是一个操作标识符。在 Swagger UI 中没有显示，但一些工具在处理 OAS 时会使用它。这对于将处理文件的可生成 AI 应用程序也很有用。
- en: '[![3](assets/3.png)](#co_documenting_your_api_CO2-3)'
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: '[![3](assets/3.png)](#co_documenting_your_api_CO2-3)'
- en: This is a reference to the `Player` schema that is defined in the `Components`
    section. These references allow for data structures to be defined a single time
    in the OAS and referenced in other parts of the file.
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 这是 `Components` 部分中定义的 `Player` 架构的引用。这些引用允许在 OAS 中一次定义数据结构，并在文件的其它部分引用它们。
- en: Continuing Your Portfolio Project
  id: totrans-140
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 继续您的项目组合
- en: Although the default information generated in the OAS file is very powerful,
    you can make it more complete by updating the FastAPI code that generates it.
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然在 OAS 文件中生成的默认信息非常强大，但您可以通过更新生成它的 FastAPI 代码来使其更加完整。
- en: '[Table 5-1](#oas_updates_table) summarizes the enhancements you will make to
    the OAS file by modifying the *main.py* file in your project.'
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: '[表 5-1](#oas_updates_table) 总结了您通过修改项目中的 *main.py* 文件对 OAS 文件进行的增强。'
- en: Table 5-1\. Updates to the OAS file
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 表 5-1\. OAS 文件更新
- en: '| Update made | Change in *main.py* | OAS field affected |'
  id: totrans-144
  prefs: []
  type: TYPE_TB
  zh: '| 更新内容 | *main.py* 中的更改 | 受影响的 OAS 字段 |'
- en: '| --- | --- | --- |'
  id: totrans-145
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- |'
- en: '| Add API title, version, description | Add elements to `FastAPI()` constructor
    | `info` |'
  id: totrans-146
  prefs: []
  type: TYPE_TB
  zh: '| 添加 API 标题、版本、描述 | 向 `FastAPI()` 构造函数添加元素 | `info` |'
- en: '| Add path summaries | Add parameters to path function decorator | paths |'
  id: totrans-147
  prefs: []
  type: TYPE_TB
  zh: '| 添加路径摘要 | 向路径函数装饰器添加参数 | paths |'
- en: '| Add detailed path descriptions | Add parameters to path function decorator
    | `paths` |'
  id: totrans-148
  prefs: []
  type: TYPE_TB
  zh: '| 添加详细的路径描述 | 向路径函数装饰器添加参数 | `paths` |'
- en: '| Add path tags to group endpoints in Swagger UI | Add parameters to path function
    decorator | `paths` |'
  id: totrans-149
  prefs: []
  type: TYPE_TB
  zh: '| 向 Swagger UI 中的端点分组添加路径标签 | 向路径函数装饰器添加参数 | `paths` |'
- en: '| Add unique path operation IDs | Update the built-in operation IDs | `paths`
    |'
  id: totrans-150
  prefs: []
  type: TYPE_TB
  zh: '| 添加唯一的路径操作 ID | 更新内置的操作 ID | `paths` |'
- en: '| Add description to query parameters | Update the parameters in the FastAPI
    functions | `parameters` |'
  id: totrans-151
  prefs: []
  type: TYPE_TB
  zh: '| 为查询参数添加描述 | 更新 FastAPI 函数中的参数 | `parameters` |'
- en: Adding Details to the OAS info Object
  id: totrans-152
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 向 OAS 信息对象添加详细信息
- en: The OAS `info` field contains information about the entire API. The default
    information in the current OAS file is very generic. You will add content that
    helps consumers of the API understand its purpose. This involves changes to the
    `FastAPI()` constructor function.
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: OAS `info` 字段包含有关整个 API 的信息。当前 OAS 文件中的默认信息非常通用。您将添加帮助 API 消费者了解其目的的内容。这涉及到对
    `FastAPI()` 构造函数函数的更改。
- en: 'Open the *main.py* file and make the following updates to the initial application
    constructor:'
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 打开 *main.py* 文件，并对初始应用程序构造函数进行以下更新：
- en: '[PRE8]'
  id: totrans-155
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'Notice the following items that you changed:'
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 注意以下您所做的更改：
- en: '[![1](assets/1.png)](#co_documenting_your_api_CO3-1)'
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: '[![1](assets/1.png)](#co_documenting_your_api_CO3-1)'
- en: The first new statement is the creation of the `api_description` variable with
    a description of the API. The three quotation marks are used to include a multiline
    string.
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 第一条新语句是创建 `api_description` 变量，其中包含 API 的描述。三个引号用于包含多行字符串。
- en: '[![2](assets/2.png)](#co_documenting_your_api_CO3-2)'
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: '[![2](assets/2.png)](#co_documenting_your_api_CO3-2)'
- en: You are passing that `api_description` to the application constructor.
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 您正在将 `api_description` 传递给应用程序构造函数。
- en: '[![3](assets/3.png)](#co_documenting_your_api_CO3-3)'
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: '[![3](assets/3.png)](#co_documenting_your_api_CO3-3)'
- en: You also give the app a `title`.
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 您还给了应用程序一个 `标题`。
- en: '[![4](assets/4.png)](#co_documenting_your_api_CO3-4)'
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: '[![4](assets/4.png)](#co_documenting_your_api_CO3-4)'
- en: And you give the app a `version`. Notice that you are using a `version` of 0.1\.
    The major version of 0 communicates that breaking changes can still occur, and
    it is consistent with the *V0* in the API’s URL. I typically start all new API
    projects with a zero version. The minor version of 1 communicates that this is
    the first published iteration of this API.
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 您还给了应用程序一个 `版本`。注意您正在使用版本 0.1。主版本 0 表示仍然可能发生破坏性更改，并且与 API URL 中的 *V0* 保持一致。我通常用零版本开始所有新的
    API 项目。次版本 1 表示这是此 API 的第一个发布版本。
- en: Adding Tags to Categorize Your Paths
  id: totrans-165
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 为您的路径添加标签以进行分类
- en: Now you move to changes to each individual endpoint, which are described by
    the `path` object in the OAS file. The first change to the paths is the addition
    of *tags*, which are general-purpose attributes that can be used for a variety
    of purposes. In this case, the reason to add them is that Swagger UI uses them
    to group API paths together. This is extremely helpful to consumers when an API
    has several dozen endpoints. To make this change, you will add another element
    to the path function decorator.
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 现在您将转向每个单独端点的更改，这些更改由 OAS 文件中的 `path` 对象描述。路径的第一个更改是添加 *标签*，这些是通用属性，可用于各种目的。在这种情况下，添加它们的原因是
    Swagger UI 使用它们将 API 路径分组在一起。当 API 有几十个端点时，这对消费者来说非常有帮助。为了进行此更改，您将向路径函数装饰器添加另一个元素。
- en: 'Here is what the changes will look like for the `@app.get("/v0/players/{player_id}")`
    decorator in *main.py*. Make these changes to this decorator:'
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 这里是 `@app.get("/v0/players/{player_id}")` 装饰器在 *main.py* 中的更改外观。对此装饰器进行以下更改：
- en: '[PRE9]'
  id: totrans-168
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: '[![1](assets/1.png)](#co_documenting_your_api_CO4-1)'
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: '[![1](assets/1.png)](#co_documenting_your_api_CO4-1)'
- en: This tag will be used to group endpoints into categories.
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: 此标签将用于将端点分组到类别中。
- en: You have updated one endpoint. Now use the `tag` values in [Table 5-2](#endpoint_tag_table_ch3)
    to update the endpoints in *main.py*.
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 您已更新了一个端点。现在使用 [表 5-2](#endpoint_tag_table_ch3) 中的 `tag` 值来更新 *main.py* 中的端点。
- en: Table 5-2\. Tags for endpoints in main.py
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 表 5-2\. main.py 中端点的标签
- en: '| Endpoint | tag |'
  id: totrans-173
  prefs: []
  type: TYPE_TB
  zh: '| 端点 | 标签 |'
- en: '| --- | --- |'
  id: totrans-174
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| */* | `analytics` |'
  id: totrans-175
  prefs: []
  type: TYPE_TB
  zh: '| */* | `analytics` |'
- en: '| */v0/players/* | `player` |'
  id: totrans-176
  prefs: []
  type: TYPE_TB
  zh: '| */v0/players/* | `player` |'
- en: '| */v0/players/{player_id}* | `player` |'
  id: totrans-177
  prefs: []
  type: TYPE_TB
  zh: '| */v0/players/{player_id}* | `player` |'
- en: '| */v0/performances/* | `scoring` |'
  id: totrans-178
  prefs: []
  type: TYPE_TB
  zh: '| */v0/performances/* | `scoring` |'
- en: '| */v0/leagues/* | `membership` |'
  id: totrans-179
  prefs: []
  type: TYPE_TB
  zh: '| */v0/leagues/* | `membership` |'
- en: '| */v0/leagues/{league_id}* | `membership` |'
  id: totrans-180
  prefs: []
  type: TYPE_TB
  zh: '| */v0/leagues/{league_id}* | `membership` |'
- en: '| */v0/teams/* | `membership` |'
  id: totrans-181
  prefs: []
  type: TYPE_TB
  zh: '| */v0/teams/* | `membership` |'
- en: '| */v0/counts/* | `analytics` |'
  id: totrans-182
  prefs: []
  type: TYPE_TB
  zh: '| */v0/counts/* | `analytics` |'
- en: Adding More Details to Individual Endpoints
  id: totrans-183
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 为单个端点添加更多详细信息
- en: 'Next, you will add information about individual endpoints. In the OAS file,
    these are contained in the `paths` field. To make updates, you will modify each
    path function decorator. Here are the changes that will be made for each of the
    paths:'
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，您将添加有关单个端点的信息。在 OAS 文件中，这些信息包含在 `paths` 字段中。要更新，您将修改每个路径函数装饰器。以下是每个路径将进行的更改：
- en: Add a summary
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 添加摘要
- en: This summarizes the path and will be displayed on the operation title by Swagger
    UI.
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 这总结了路径，并将由 Swagger UI 显示在操作标题上。
- en: Add a description
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 添加描述
- en: This gives any additional details about the path and will be displayed below
    the title by Swagger UI.
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 这提供了关于路径的额外详细信息，并将由 Swagger UI 显示在标题下方。
- en: Add a description to the 200 response
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 为 200 响应添加描述
- en: This replaces the default “Successful response” with a clearer description.
    It will be used when the HTTP 200 successful message occurs.
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 这将替换默认的“成功响应”，并使用更清晰的描述。它将在 HTTP 200 成功消息发生时使用。
- en: Modify the `operationID`
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: 修改 `operationID`
- en: This standardizes the `operationID` value, which will be used by a variety of
    tools that are using the OAS file.
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 这将标准化 `operationID` 值，该值将由使用 OAS 文件的各种工具使用。
- en: 'Here is what the changes will look like for the `@app.get("/v0/players/{player_id}"`
    decorator in *main.py*:'
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 下面是*main.py*中`@app.get("/v0/players/{player_id}"`装饰器的更改将看起来如何：
- en: '[PRE10]'
  id: totrans-194
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: '[![1](assets/1.png)](#co_documenting_your_api_CO5-1)'
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: '![1](assets/1.png)(#co_documenting_your_api_CO5-1)'
- en: Improved summary of the endpoint.
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 改进端点摘要。
- en: '[![2](assets/2.png)](#co_documenting_your_api_CO5-2)'
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: '![2](assets/2.png)(#co_documenting_your_api_CO5-2)'
- en: Very detailed description, to help developers and AI use it correctly.
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: 非常详细的描述，以帮助开发人员和AI正确使用。
- en: '[![3](assets/3.png)](#co_documenting_your_api_CO5-3)'
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: '![3](assets/3.png)(#co_documenting_your_api_CO5-3)'
- en: Improved description of the response. Keep this under 300 characters to make
    ChatGPT happy.
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 改进响应描述。请保持描述在300个字符以下，以使ChatGPT满意。
- en: '[![4](assets/4.png)](#co_documenting_your_api_CO5-4)'
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: '![4](assets/4.png)(#co_documenting_your_api_CO5-4)'
- en: Custom operation ID to replace the auto-generated one.
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 自定义操作ID以替换自动生成的ID。
- en: Apply these changes to the rest of the endpoints in *main.py*.
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: 将这些更改应用到*main.py*中的其余端点。
- en: Adding Parameter Descriptions
  id: totrans-204
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 添加参数描述
- en: Another recommendation for AI to use the API is to add descriptions to parameters
    used to call the APIs. You will replace the default values of the parameters with
    the `Query()` statement and a description.
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: 另一项推荐AI使用API的建议是添加用于调用API的参数描述。您将使用`Query()`语句和描述替换参数的默认值。
- en: 'The `read_players` function is beneath the decorator you updated. To add descriptions
    for the parameters, update that function now:'
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: '`read_players`函数位于您更新的装饰器下方。要为参数添加描述，现在更新该函数：'
- en: '[PRE11]'
  id: totrans-207
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: You have modified the `read_players` function. Update the rest of the API endpoints
    to add descriptions to all the query parameters.
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 您已修改了`read_players`函数。更新其余的API端点，为所有查询参数添加描述。
- en: Viewing the Changes in Swagger UI
  id: totrans-209
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 在Swagger UI中查看更改
- en: With all of these changes made to the OAS file, Swagger UI has much more information
    than it did previously. Open the */docs* endpoint and you will first notice that
    the details added to the `info` field are displayed prominently at the top of
    the documentation, as shown in [Figure 5-13](#swagger_docs_6_ch5).
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: 在对OAS文件进行所有这些更改后，Swagger UI比之前拥有更多信息。打开*/docs*端点，您首先会注意到添加到`info`字段的详细信息在文档顶部突出显示，如图[图5-13](#swagger_docs_6_ch5)所示。
- en: '![Updated Swagger UI information section](assets/haad_0513.png)'
  id: totrans-211
  prefs: []
  type: TYPE_IMG
  zh: '![更新的Swagger UI信息部分](assets/haad_0513.png)'
- en: Figure 5-13\. Updated Swagger UI information section
  id: totrans-212
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图5-13\. 更新的Swagger UI信息部分
- en: Scrolling down, you will see the effect that the `tags` attributes and the endpoint
    `summary` values have on Swagger UI, as shown in [Figure 5-14](#swagger_docs_7_ch5).
    The endpoints are now arranged in categories, and their summaries are displayed
    to explain their purpose.
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: 滚动到下方，您将看到`tags`属性和端点`summary`值对Swagger UI的影响，如图[图5-14](#swagger_docs_7_ch5)所示。端点现在按类别排列，并显示其摘要以解释其目的。
- en: '![Tags used to group endpoints](assets/haad_0514.png)'
  id: totrans-214
  prefs: []
  type: TYPE_IMG
  zh: '![用于分组端点的标签](assets/haad_0514.png)'
- en: Figure 5-14\. Tags used to group endpoints
  id: totrans-215
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图5-14\. 用于分组端点的标签
- en: Note
  id: totrans-216
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 注意
- en: With all of the changes you made in this chapter, *main.py* is too long to show
    here. You can view the updated *main.py* file in the *chapter5/complete* folder.
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中进行的所有更改后，*main.py*文件太长，无法在此显示。您可以在*chapter5/complete*文件夹中查看更新的*main.py*文件。
- en: Regression-Testing Your API
  id: totrans-218
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 回归测试您的API
- en: With all the changes you made to your API code, you should *regression-test*
    your code, which is running your existing tests to make sure you didn’t break
    anything. Regression testing is helpful for coding changes that you make and updates
    to software libraries that you use in your code.
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: 在您的API代码中进行了所有这些更改后，您应该进行*回归测试*您的代码，即运行现有测试以确保没有破坏任何内容。回归测试对于您做出的编码更改和更新到您代码中使用的软件库非常有帮助。
- en: 'In the terminal window, press Ctrl-C to stop the API and display the command
    prompt. Enter the **`pytest test_main.py`** command and you should see an output
    that looks similar to this:'
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: 在终端窗口中，按Ctrl-C停止API并显示命令提示符。输入**`pytest test_main.py`**命令，你应该会看到类似以下输出的内容：
- en: '[PRE12]'
  id: totrans-221
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: Updating Your README.md
  id: totrans-222
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 更新您的README.md
- en: With the updates you made to your built-in Swagger documentation, you are well
    on your way to providing a good developer experience. But there are a few API
    documentation features that you have not provided yet, including getting started,
    terms of service, and example code. You will update your *README.md* file to fill
    in the gaps of your documentation.
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: 通过你对内置Swagger文档所做的更新，你正朝着提供良好的开发者体验的道路上迈进。但还有一些API文档功能你尚未提供，包括入门指南、服务条款和示例代码。你需要更新你的*README.md*文件来填补文档的空白。
- en: 'Update *README.md* with the following contents:'
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: 使用以下内容更新*README.md*文件：
- en: '[PRE13]'
  id: totrans-225
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: import httpx
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: import httpx
- en: HEALTH_CHECK_ENDPOINT = "/"
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: HEALTH_CHECK_ENDPOINT = "/"
- en: 'with httpx.Client(base_url=self.swc_base_url) as client:'
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: 'with httpx.Client(base_url=self.swc_base_url) as client:'
- en: response = client.get(self.HEALTH_CHECK_ENDPOINT)
  id: totrans-229
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: response = client.get(self.HEALTH_CHECK_ENDPOINT)
- en: print(response.json())
  id: totrans-230
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: print(response.json())
- en: '[PRE14]'
  id: totrans-231
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: Additional Resources
  id: totrans-232
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 其他资源
- en: 'For a comprehensive discussion of the role that API documentation and developer
    portals play in an API effort, read Chapter 7 of James Higginbotham’s *Principles
    of Web API Design: Delivering Value with APIs and Microservices* (Addison-Wesley,
    2021).'
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
  zh: 关于API文档和开发者门户在API努力中所起的作用的全面讨论，请阅读詹姆斯·希金博瑟姆（James Higginbotham）的《Web API设计原则：使用API和微服务创造价值》第7章（Addison-Wesley，2021年）。
- en: For a great short overview of API design concepts, I recommend *Designing Web
    APIs* by Brenda Jin, Saurabh Sahni, and Amir Shevat (O’Reilly, 2018).
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: 对于API设计概念的简要概述，我推荐布伦达·金（Brenda Jin）、萨乌拉布·沙尼（Saurabh Sahni）和阿米尔·谢瓦特（Amir Shevat）合著的《设计Web
    API》（O’Reilly，2018年）。
- en: The [NordicAPIs.com blog](https://oreil.ly/pyatT) publishes articles about [developer
    experience](https://oreil.ly/YGseq) and [API documentation](https://oreil.ly/xpcUd)
    that have a lot of useful information.
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
  zh: '[NordicAPIs.com博客](https://oreil.ly/pyatT)发布了关于[开发者体验](https://oreil.ly/YGseq)和[API文档](https://oreil.ly/xpcUd)的文章，其中包含大量有用的信息。'
- en: 'For more information about DX metrics, read [“Developer Experience: The Metrics
    That Matter Most”](https://oreil.ly/id-00).'
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
  zh: 关于DX指标的信息，请阅读“开发者体验：最重要的指标”（https://oreil.ly/id-00）。
- en: To see examples of individuals publishing tips or tools for consuming undocumented
    APIs, check out [Steven Morse’s blog](https://oreil.ly/stmorse) and [Joey Greco’s
    Leeger app](https://oreil.ly/leeger).
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: 要查看个人发布关于使用未记录API的提示或工具的示例，请查看[史蒂文·莫尔斯的博客](https://oreil.ly/stmorse)和[乔伊·格雷科的Leeger应用](https://oreil.ly/leeger)。
- en: For more information about using Swagger UI websites, view the [Swagger UI installation
    instructions](https://oreil.ly/cSPsX).
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: 关于使用Swagger UI网站的信息，请查看[Swagger UI安装说明](https://oreil.ly/cSPsX)。
- en: For advice about working with your OAS, read [Speakeasy’s OpenAPI Guide](https://oreil.ly/beRNI).
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
  zh: 关于使用OAS的建议，请阅读[Speakeasy的OpenAPI指南](https://oreil.ly/beRNI)。
- en: Summary
  id: totrans-240
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: 'In this chapter, you focused on your consumers by providing API documentation:'
  id: totrans-241
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，你通过提供API文档来关注你的消费者：
- en: You learned about the built-in API documentation that FastAPI provides using
    both Swagger UI and Redoc.
  id: totrans-242
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你了解了FastAPI提供的内置API文档，包括Swagger UI和Redoc。
- en: You learned about the OpenAPI specification that FastAPI generates and the value
    of this specification for users.
  id: totrans-243
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你了解了FastAPI生成的OpenAPI规范及其对用户的价值。
- en: You learned about the components of great API documentation.
  id: totrans-244
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你了解了优秀API文档的组成部分。
- en: In [Chapter 6](ch06.html#chapter_6), you will focus on deploying your application
    to the cloud, where real-world consumers can use it.
  id: totrans-245
  prefs: []
  type: TYPE_NORMAL
  zh: 在[第6章](ch06.html#chapter_6)中，你将专注于将你的应用程序部署到云端，那里真实世界的消费者可以使用它。
