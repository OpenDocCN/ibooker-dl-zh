- en: Chapter 5\. Documenting Your API
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Documentation is where developers come to learn about your API. Whether you’re
    providing a simple README file or developing a full website for your developers,
    it is critical to clearly document how they can most effectively use your API.
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Brenda Jin, Saurabh Sahni, and Amir Shevat, *Designing Web APIs* (O’Reilly,
    2018)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: In [Chapter 4](ch04.html#chapter_4), you created your first API to fulfill the
    user stories identified in [Chapter 1](ch01.html#chapter_1). The primary users
    you developed these for are data science users and advice website providers. The
    API will enable them to create analytics products such as dashboards, charts,
    and models using the SportsWorldCentral (SWC) fantasy data. Now you will create
    documentation to help them use your API. Documentation and features such as software
    development kits (SDKs) improve the *developer experience* (DX) for your technical
    users.
  prefs: []
  type: TYPE_NORMAL
- en: Sending a Signal of Trust
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: An important job of your API docs is to signal trust to potential API consumers.
    If they don’t trust you, they won’t use your API. If API consumers are going to
    call your API multiple times, they will build an *integration*, which is basically
    code that calls your code repeatedly. For the SWC API, this might be a fantasy
    advice website that will be adding SWC to its list of supported websites. Another
    example would be a data science user who is going to schedule an Extract, Transform,
    Load (ETL) process to get the latest stats every week.
  prefs: []
  type: TYPE_NORMAL
- en: 'These repeat users are asking the following when they consider using your API:
    Can I count on you? Will your API be available for me a month from now? A year
    from now?'
  prefs: []
  type: TYPE_NORMAL
- en: Many public API websites have a dusty, neglected feel. They have blog posts
    that are a few years old, message boards where posts get no response, or feature
    road maps that are out of date. If your docs are a ghost town, potential users
    will go elsewhere.
  prefs: []
  type: TYPE_NORMAL
- en: You can signal trust to these users by ensuring that your feedback mechanism
    is up to date and any questions are responded to quickly. A current release history
    and a clear versioning strategy are also good signs of life.
  prefs: []
  type: TYPE_NORMAL
- en: 'Data science users may be looking for one-time data loads and have less interest
    in long-term support. They may be asking different questions: Can I trust your
    data? Do the definitions match the contents? What level of quality is your data?
    Signal trust to these users by stating information about the quality of your data,
    and giving specific commitments on update frequency.'
  prefs: []
  type: TYPE_NORMAL
- en: Making Great API Docs
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: When you begin the documentation for a new API, you can start with the core
    features discussed in this section. These give users what they need to get the
    job done. As your API matures, continue to improve the documentation and add features
    that set yours apart from competitors’.
  prefs: []
  type: TYPE_NORMAL
- en: Core Features
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'All API documentation should include a few core features. Without these basics,
    it is unlikely that an API will be used by many consumers. They allow a user to
    understand the value of the API, get the address and any necessary authorization
    information, and easily test the API. Terms of service and a feedback mechanism
    ensure that users use the API appropriately and know where to go for help. Following
    are the core feature that are expected for someone to use the API:'
  prefs: []
  type: TYPE_NORMAL
- en: Getting started
  prefs: []
  type: TYPE_NORMAL
- en: This is an overview or introduction that explains the purpose of the API and
    how consumers can interact with it. It also provides the address of the API, security
    requirements, and instructions for requesting user IDs or API keys.
  prefs: []
  type: TYPE_NORMAL
- en: Endpoint definitions
  prefs: []
  type: TYPE_NORMAL
- en: These explain the purpose of each endpoint, along with the format of requests,
    responses, and any errors. An endpoint is the full address and resource name that
    API users will make a call to. For example, [*https://api.sportsworldcentral.com/v0/players*](https://api.sportsworldcentral.com/v0/players)
    is an endpoint that returns a list of players.
  prefs: []
  type: TYPE_NORMAL
- en: OAS file
  prefs: []
  type: TYPE_NORMAL
- en: The OpenAPI Specification (OAS) file is a machine-readable file that defines
    the connection instructions and endpoint definitions.
  prefs: []
  type: TYPE_NORMAL
- en: Terms of service
  prefs: []
  type: TYPE_NORMAL
- en: These explain the allowed usage of the API and any rate limits or restrictions
    that apply.
  prefs: []
  type: TYPE_NORMAL
- en: Feedback mechanism
  prefs: []
  type: TYPE_NORMAL
- en: For people to use your API, they need to have a method to reach out and ask
    questions. Some common methods include support email addresses, contact forms,
    and GitHub issue trackers.
  prefs: []
  type: TYPE_NORMAL
- en: SDKs
  prefs: []
  type: TYPE_NORMAL
- en: By creating SDKs in popular programming languages, an API provider can make
    the process of using the API much easier for consumers. These can help enforce
    responsible usage of the API, reducing some common problems such as overuse. If
    an API’s primary users are data scientists, this will greatly smooth the process
    of using your API. You will create an SDK for your API in [Chapter 7](ch07.html#chapter_7).
  prefs: []
  type: TYPE_NORMAL
- en: Extra Features
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'In addition to the basics, several other items improve the DX of the API by
    simplifying the process of using the API or making it easier to try it out:'
  prefs: []
  type: TYPE_NORMAL
- en: Sample program code
  prefs: []
  type: TYPE_NORMAL
- en: These are example snippets of code in popular software languages that demonstrate
    how to properly use the API.
  prefs: []
  type: TYPE_NORMAL
- en: Interactive documentation
  prefs: []
  type: TYPE_NORMAL
- en: Interactive documentation allows users to submit sample API calls to a development
    environment to get hands-on experience using the API. Swagger UI is used to generate
    interactive documentation for FastAPI projects.
  prefs: []
  type: TYPE_NORMAL
- en: Sandbox environment
  prefs: []
  type: TYPE_NORMAL
- en: Going beyond interactive documentation, a full-featured sandbox environment
    will enable developers to submit multiple API calls in an environment that saves
    the sample data. For example, they might create an order with one API call and
    then retrieve the results of the order in another API call.
  prefs: []
  type: TYPE_NORMAL
- en: Additional features
  prefs: []
  type: TYPE_NORMAL
- en: There are a variety of other extras that API providers provide. One that has
    been increasing in popularity is creating a *Postman collection*, which includes
    example requests and tests that can be run with the Postman API testing tool.
  prefs: []
  type: TYPE_NORMAL
- en: Some of these require a commitment of time and resources to create, and also
    to keep current as the APIs change. This is often the role of dedicated developer
    relations (devrel) staff. API providers must consider the business proposition
    of the API before investing the resources in these.
  prefs: []
  type: TYPE_NORMAL
- en: Note
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: Advanced features can significantly reduce the friction a consumer faces to
    use the API, and get them up and running quickly. Sometimes this is referred to
    as reducing the *time to hello world* (TTHW). The quicker a potential consumer
    can make a basic prototype with your API, the more likely they are to use it.
  prefs: []
  type: TYPE_NORMAL
- en: Reviewing Examples of API Documentation
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: A tour of some real-world API documentation will demonstrate the features mentioned
    previously. These examples illustrate some core features and extra features.
  prefs: []
  type: TYPE_NORMAL
- en: Sleeper App
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The Sleeper app is a real-life fantasy football league host, like your imaginary
    SportsWorldCentral. Its [API documentation](https://docs.sleeper.com) demonstrates
    several of the basic features of documentation ([Figure 5-1](#sleeper_documentation_1_ch3)).
  prefs: []
  type: TYPE_NORMAL
- en: '![Sleeper landing page](assets/haad_0501.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 5-1\. Core feature: Getting started page'
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: The landing page gives some basic information about using the API, including
    authentication requirements (no authentication) and general usage limits (under
    1,000 API calls per minute). The documentation provides a search function and
    navigation bar showing the major endpoints and errors. [Figure 5-2](#sleeper_documentation_2_ch3)
    shows the more detailed information available for the Drafts endpoint.
  prefs: []
  type: TYPE_NORMAL
- en: '![Sleeper Drafts endpoints](assets/haad_0502.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 5-2\. Core feature: Endpoint definitions'
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: This page includes the production API URL along with the HTTP verb and required
    parameters. The righthand column demonstrates an example API call and the output
    of the API call in JSON format.
  prefs: []
  type: TYPE_NORMAL
- en: MyFantasyLeague
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: MyFantasyLeague is a fantasy league host that provides a [full-featured developer
    portal](https://oreil.ly/t7tSf) and is known for providing quality support to
    developers.
  prefs: []
  type: TYPE_NORMAL
- en: The welcome page begins with a focus on release notes of API versions ([Figure 5-3](#mfl_documentation_1_ch3)).
    It provides links to a request reference page and sample code, and then prominently
    features the terms of service for using the API.
  prefs: []
  type: TYPE_NORMAL
- en: '![MyFantasyLeague Welcome Page](assets/haad_0503.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 5-3\. MyFantasyLeague welcome page
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: Following the “test the requests” link from the welcome page brings you to the
    interactive API documentation ([Figure 5-4](#mfl_documentation_2_ch3)). What is
    the difference between interactive API documentation and a sandbox environment?
    Interactive documentation supports test API calls, but it doesn’t store the results
    between test calls. A sandbox environment keeps track of previous API calls to
    allow you to test multiple tasks together.
  prefs: []
  type: TYPE_NORMAL
- en: '![Extra feature: Interactive documentation](assets/haad_0504.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 5-4\. Extra feature: Interactive documentation'
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: Yahoo! Fantasy Football
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Yahoo! is another fantasy football league host that provides detailed [API documentation](https://oreil.ly/4YIxy).
    Yahoo! provides sample PHP code for accessing its APIs. This sample code provides
    detailed instructions on authentication, which can be especially tricky ([Figure 5-5](#yahoo_documentation_2_ch3)).
  prefs: []
  type: TYPE_NORMAL
- en: '![Extra feature: Sample program code](assets/haad_0505.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 5-5\. Extra feature: Sample program code'
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: Viewing Your API’s Built-in Documentation
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In [Chapter 4](ch04.html#chapter_4), you built an API with the endpoints to
    fulfill your top-priority use cases. In this chapter, you will view the built-in
    documentation for the API. You will also make a few updates to the API code to
    improve the documentation.
  prefs: []
  type: TYPE_NORMAL
- en: Copying Files from Chapter 4
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'To continue your portfolio project where you left it in the previous chapter,
    change the directory to *chapter5* and then copy the previous chapter’s files
    into it. The following shows the commands and expected output:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: 'Now launch your API using `fastapi dev` instead of `fastapi run`, as you did
    in the previous chapter. This tells FastAPI to automatically reload the application
    each time you make any changes to the program code:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: You will see a dialog stating “Your application running on port 8000 is available,”
    as shown in [Figure 5-6](#codespaces_open_browser_ch3).
  prefs: []
  type: TYPE_NORMAL
- en: '![Codespaces browser window popup](assets/haad_0506.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 5-6\. Codespaces browser window pop-up
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: 'Click “Open in Browser” to open a browser tab outside your Codespaces. This
    browser will show a base URL that ends in *app.github.dev* that contains the response
    from your API running on Codespaces. You should see the following health check
    message in your web browser:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: 'Documentation Option 1: Swagger UI'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'I will go into more detail on the Swagger UI documentation than the Redoc documentation,
    because the former allows you to test your API. To view the Swagger UI interactive
    API documentation for your API, copy and paste the following onto the end of the
    base URL in your browser: ***/docs***. For example, the full URL in the browser
    might be *[*https://happy-pine-tree-1234-8000.app.github.dev/docs*](https://happy-pine-tree-1234-8000.app.github.dev/docs)*.
    You should see documentation as shown in [Figure 5-7](#swagger_docs_1_ch5).'
  prefs: []
  type: TYPE_NORMAL
- en: You may recognize this list of endpoints from [Table 4-1](ch04.html#swc_endpoints_ch4)
    in the last chapter. You can see that all the endpoints you implemented in your
    API are listed here. You can click on any of these endpoints to expand the section
    that is specific to that endpoint and interact with it.
  prefs: []
  type: TYPE_NORMAL
- en: '![Initial Swagger UI interactive documentation](assets/haad_0507.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 5-7\. Initial Swagger UI interactive documentation
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: Click on the bar that says “Get /v0/players/{player_id}” and then click the
    “Try it out” button. This button changes to Cancel, as seen in [Figure 5-8](#swagger_docs_2_ch5).
  prefs: []
  type: TYPE_NORMAL
- en: '![Expanded endpoint section, top half](assets/haad_0508.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 5-8\. Expanded endpoint section, top half
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: The Parameters section includes the `player_id` parameter that is defined for
    this endpoint. This parameter is required, it has a data type of integer, and
    it is a path parameter, which means that when this API is called, the URL path
    includes the `player_id` value, as shown in the endpoint definition. [Figure 5-9](#swagger_docs_3_ch5)
    displays the bottom half of this endpoint section.
  prefs: []
  type: TYPE_NORMAL
- en: '![Expanded endpoint section, bottom half](assets/haad_0509.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 5-9\. Expanded endpoint section, bottom half
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: 'This section describes two expected responses that consumers should plan for.
    If a request to this endpoint is successful, an HTTP status code 200 (successful
    response) will be returned, and the response body will be in this format:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: 'However, if the request is invalid, the consumer will receive a response with
    an HTTP status code 422 (unprocessable content) and an error message in this format:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: To interact with the interactive documentation, click the Execute button. You
    should see the error result displayed in [Figure 5-10](#swagger_docs_4_ch5), or
    something similar.
  prefs: []
  type: TYPE_NORMAL
- en: '![Player endpoint error message](assets/haad_0510.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 5-10\. Player endpoint error message
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: The documentation has enforced the required `player_id` parameter and displayed
    the message “Required field is not provided.” Enter a value of **`1385`** in the
    `player_id` field, and click Execute again. This request should be successful,
    and the Responses section of the web page should look similar to [Figure 5-11](#swagger_docs_5_ch5).
  prefs: []
  type: TYPE_NORMAL
- en: '![Successful player response](assets/haad_0511.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 5-11\. Successful player response
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: This part of the page shows useful information about the HTTP request that is
    constructed by the documentation and the HTTP response that is sent back by your
    API.
  prefs: []
  type: TYPE_NORMAL
- en: First, look at the response. In the `curl` section, the documentation displays
    the command-line statement that could be used to call this API. This is helpful
    to understand the exact HTTP request that is constructed by the parameters you
    entered earlier. (cURL is a common command-line utility used to make HTTP requests
    to web applications and APIs.) You could copy that URL into your browser bar and
    make the same API call directly.
  prefs: []
  type: TYPE_NORMAL
- en: Remember, the endpoint is a combination of an HTTP verb and a URL. In [Figure 5-11](#swagger_docs_5_ch5),
    the HTTP verb is `GET`, as displayed in the documentation. The URL points to the
    address that Codespaces generates.
  prefs: []
  type: TYPE_NORMAL
- en: In the Request URL section, you see the URL without the HTTP verb. Note that
    the end of the URL is *v0/players/1385*. This matches the expected */v0/players/{player_id}*
    from our program code and the earlier documentation. Since `player_id` is a path
    parameter, it is added to the end of the URL.
  prefs: []
  type: TYPE_NORMAL
- en: Now let’s look at the response. Under “Server response,” you see that the response
    received was an HTTP 200, which is a successful response. The “Response body”
    shows the JSON data that was returned by the API. It matches the format of the
    `Player` object, and it contains the data for `player_id` 1385, which is what
    you entered in the path parameter. It also includes the `Performance` records
    that are associated with this `Player`.
  prefs: []
  type: TYPE_NORMAL
- en: The “Response headers” section displays the HTTP headers, which are additional
    metadata the API sent along with the response body. This is information you would
    not see if you were calling the API directly in your browser.
  prefs: []
  type: TYPE_NORMAL
- en: As you have seen, this interactive API documentation is very powerful. It compares
    well to the features of any of the API documentation demonstrated on the real-world
    fantasy league hosts in this chapter. Since you did not create this code yourself,
    where is it coming from? This documentation is generated by [Swagger UI](https://oreil.ly/r6P--),
    which is an open source project led by SmartBear software. The Swagger UI has
    been heavily used in API documentation for many years. Many times when people
    use the term *API documentation*, Swagger UI is what they mean. It is not an exaggeration
    to say that this open source project deserves a lot of credit for expanding the
    popularity of REST APIs as a core technology across the IT industry.
  prefs: []
  type: TYPE_NORMAL
- en: Swagger UI is included in the FastAPI code. It generates this documentation
    automatically from the OpenAPI Specification (OAS) file that is named *openapi.json*
    and is linked under the title of this page. FastAPI generates this OAS file automatically
    from the *main.py* code.
  prefs: []
  type: TYPE_NORMAL
- en: 'If you look at this endpoint definition in *main.py* that you developed in
    [Chapter 4](ch04.html#chapter_4), you will see the following:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: Looking again at [Figure 5-8](#swagger_docs_2_ch5), you can see that the HTTP
    verb, URL, and path parameter are generated from `@app.get("/v0/players/{player_id}"`.
  prefs: []
  type: TYPE_NORMAL
- en: Looking at [Figure 5-9](#swagger_docs_3_ch5), you can see that the Successful
    Response definition is generated from the Pydantic schema `Player`, which you
    defined in *schemas.py*. The time you spent defining each piece of the Python
    code continues to pay off in this well-crafted API.
  prefs: []
  type: TYPE_NORMAL
- en: 'Documentation Option 2: Redoc'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'In addition to Swagger UI, FastAPI includes a second API documentation option:
    Redoc. [Redoc](https://oreil.ly/redoc) is an open source API documentation product
    that is led by Redocly.'
  prefs: []
  type: TYPE_NORMAL
- en: 'To view the Redoc API documentation for your API, copy and paste the following
    onto the end of the base URL in your browser: ***/redoc***. For example, the full
    URL might be *[*https://happy-pine-tree-1234-8000.app.github.dev/redoc*](https://happy-pine-tree-1234-8000.app.github.dev/redoc)*
    in the browser. Click Read Player in the navigation pane on the left. You should
    see documentation as shown in [Figure 5-12](#redoc_docs_1_ch5).'
  prefs: []
  type: TYPE_NORMAL
- en: '![Redoc documentation page](assets/haad_0512.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 5-12\. Redoc documentation page
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: As you can see, the Redoc documentation has an attractive three-column layout
    with the API endpoints in the navigation bar on the left, along with a search
    function. The center column has the bulk of the information about the endpoint,
    including parameters, responses, and errors. The righthand column displays example
    response bodies for successful (200) and error (422) responses.
  prefs: []
  type: TYPE_NORMAL
- en: In general, the contents of the documentation are quite similar to Swagger UI,
    because both are generated from the same OAS file. The biggest difference in functionality
    between the two included documentation options is that the Redoc library included
    in FastAPI doesn’t provide a method for submitting API requests. So it is not
    an interactive option.
  prefs: []
  type: TYPE_NORMAL
- en: What advantages does Redoc have over Swagger UI? In my opinion, the mobile browser
    layout of Redoc is more attractive than that of Swagger UI. While I generally
    don’t consider mobile functionality important for a technical reference page like
    API docs, this might be important to some organizations. In addition, the Redoc
    layout and appearance might be preferred.
  prefs: []
  type: TYPE_NORMAL
- en: Working with Your OpenAPI Specification File
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Although these documentation pages are quite impressive, they are nothing without
    the OAS file. This is literally true, since FastAPI and Pydantic generate the
    OAS file at the */openapi.json* path, and Redoc and Swagger UI generate their
    documentation from this file.
  prefs: []
  type: TYPE_NORMAL
- en: 'But the OAS file is more than simply a way to generate documentation: it is
    a powerful API definition standard that allows many other tools to interact with
    your API. One quick example is that in [Part III](part03.html#part_3) you will
    create a custom action that enables ChatGPT to answer questions using the data
    from your API. What information does it need for this? Your OAS file. This is
    just a drop in the bucket of what the OAS file is used for. The [OpenApi.Tools](https://openapi.tools)
    website lists code generators, data validators, SDK generators, mock servers,
    and a dozen other categories of tools that use the OAS file.'
  prefs: []
  type: TYPE_NORMAL
- en: For many years, the software development industry was divided between competing
    vendor-specific API specifications and response formats. The Swagger specification
    was made open source in 2015 by Swagger, and in 2017 several companies and groups
    presented a united front at the API Strategy and Practice Conference promoting
    OAS as the de facto standard for REST API specifications. (Coincidentally, I was
    a speaker at that conference and got to witness the events unfold.) At the time,
    [Bill Doerrfield](https://oreil.ly/m6XNK) summarized the events by saying that
    the data format wars are over. You’ll read more from Doerrfield in [Chapter 13](ch13.html#chapter_13).
  prefs: []
  type: TYPE_NORMAL
- en: 'The [OAS format](https://oreil.ly/J9v0i) is quite extensive, so this chapter
    will focus on the items that are implemented in FastAPI. To view the raw OAS file
    for your API, copy and paste the following onto the end of the base URL in your
    browser: ***/openapi.json***. For example, the full URL might be *[*https://happy-pine-tree-1234-8000.app.github.dev/openapi.json*](https://happy-pine-tree-1234-8000.app.github.dev/openapi.json)*
    in the browser. You should see the raw JSON file, which begins with `{"openapi":"3.1.0","info":{"title":"Fas⁠t​API","version":"0.1.0"},"paths":`.'
  prefs: []
  type: TYPE_NORMAL
- en: Tip
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: The OAS file defines a single API, but the OpenAPI Initiative is working on
    a new specification called [Arazzo](https://oreil.ly/arazzo) that will define
    workflows involving sequences of API calls. One of the potential use cases for
    this specification is to assist generative AI applications that are based on *large
    language models* (LLMs). For more information about these applications, read [Part III](part03.html#part_3)
    of this book.
  prefs: []
  type: TYPE_NORMAL
- en: 'To understand the structure of this file, you will need to view the file somewhere
    that formats JSON in an easier-to-read format. Two convenient approaches to this
    would be installing a JSON formatter browser extension or opening the file in
    your IDE. If you save the file and open it in VS Code, you can choose “Format
    document” from the context menu to see the formatted JSON. Using a browser extension
    to format JSON has one advantage: as you make changes to the API that modify the
    JSON file, they can be refreshed and viewed instead of requiring you to download
    the file repeatedly. I typically install a browser extension for the convenience
    of viewing API responses. Take a look at the top two levels of the *openapi.json*
    file hierarchy:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: '[![1](assets/1.png)](#co_documenting_your_api_CO1-1)'
  prefs: []
  type: TYPE_NORMAL
- en: This is a `string` that contains the OpenAPI specification version. For your
    API, the version is 3.1.0, which was published in 2021.
  prefs: []
  type: TYPE_NORMAL
- en: '[![2](assets/2.png)](#co_documenting_your_api_CO1-2)'
  prefs: []
  type: TYPE_NORMAL
- en: This field is an `Info` object, which provides metadata about the API. The API’s
    `title` and `version` are the required fields, and they are populated in this
    example. Optional fields include _summary+, `description`, `termsOfService`, `contact`,
    and `license`.
  prefs: []
  type: TYPE_NORMAL
- en: '[![3](assets/3.png)](#co_documenting_your_api_CO1-3)'
  prefs: []
  type: TYPE_NORMAL
- en: This field contains the list of `paths`, which are relative URLs for API endpoints.
    You may notice that this list does not contain the HTTP verbs, which make up the
    other half of an API endpoint. The verbs and additional details are contained
    one level down inside the `path` objects.
  prefs: []
  type: TYPE_NORMAL
- en: '[![4](assets/4.png)](#co_documenting_your_api_CO1-4)'
  prefs: []
  type: TYPE_NORMAL
- en: This field can contain a wide range of reusable items that can be referenced
    in other parts of the OAS. In this example, it contains schemas, which are data
    structures used by the API.
  prefs: []
  type: TYPE_NORMAL
- en: 'To see the details of one `path`, expand the */v0/players/{player_id}* item.
    This `path` object has only one field: `get`, which is an operation object. Expand
    `get`, and you should see the following:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: '[![1](assets/1.png)](#co_documenting_your_api_CO2-1)'
  prefs: []
  type: TYPE_NORMAL
- en: You will recognize that this section contains the information that was displayed
    in Swagger UI in [Figure 5-9](#swagger_docs_3_ch5). Swagger UI generated it from
    this section of the OAS file.
  prefs: []
  type: TYPE_NORMAL
- en: '[![2](assets/2.png)](#co_documenting_your_api_CO2-2)'
  prefs: []
  type: TYPE_NORMAL
- en: This is an operation identifier. This was not displayed in Swagger UI, but some
    tools use it when processing the OAS. This is also useful to generative AI applications
    that will process the file.
  prefs: []
  type: TYPE_NORMAL
- en: '[![3](assets/3.png)](#co_documenting_your_api_CO2-3)'
  prefs: []
  type: TYPE_NORMAL
- en: This is a reference to the `Player` schema that is defined in the `Components`
    section. These references allow for data structures to be defined a single time
    in the OAS and referenced in other parts of the file.
  prefs: []
  type: TYPE_NORMAL
- en: Continuing Your Portfolio Project
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Although the default information generated in the OAS file is very powerful,
    you can make it more complete by updating the FastAPI code that generates it.
  prefs: []
  type: TYPE_NORMAL
- en: '[Table 5-1](#oas_updates_table) summarizes the enhancements you will make to
    the OAS file by modifying the *main.py* file in your project.'
  prefs: []
  type: TYPE_NORMAL
- en: Table 5-1\. Updates to the OAS file
  prefs: []
  type: TYPE_NORMAL
- en: '| Update made | Change in *main.py* | OAS field affected |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| Add API title, version, description | Add elements to `FastAPI()` constructor
    | `info` |'
  prefs: []
  type: TYPE_TB
- en: '| Add path summaries | Add parameters to path function decorator | paths |'
  prefs: []
  type: TYPE_TB
- en: '| Add detailed path descriptions | Add parameters to path function decorator
    | `paths` |'
  prefs: []
  type: TYPE_TB
- en: '| Add path tags to group endpoints in Swagger UI | Add parameters to path function
    decorator | `paths` |'
  prefs: []
  type: TYPE_TB
- en: '| Add unique path operation IDs | Update the built-in operation IDs | `paths`
    |'
  prefs: []
  type: TYPE_TB
- en: '| Add description to query parameters | Update the parameters in the FastAPI
    functions | `parameters` |'
  prefs: []
  type: TYPE_TB
- en: Adding Details to the OAS info Object
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The OAS `info` field contains information about the entire API. The default
    information in the current OAS file is very generic. You will add content that
    helps consumers of the API understand its purpose. This involves changes to the
    `FastAPI()` constructor function.
  prefs: []
  type: TYPE_NORMAL
- en: 'Open the *main.py* file and make the following updates to the initial application
    constructor:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs: []
  type: TYPE_PRE
- en: 'Notice the following items that you changed:'
  prefs: []
  type: TYPE_NORMAL
- en: '[![1](assets/1.png)](#co_documenting_your_api_CO3-1)'
  prefs: []
  type: TYPE_NORMAL
- en: The first new statement is the creation of the `api_description` variable with
    a description of the API. The three quotation marks are used to include a multiline
    string.
  prefs: []
  type: TYPE_NORMAL
- en: '[![2](assets/2.png)](#co_documenting_your_api_CO3-2)'
  prefs: []
  type: TYPE_NORMAL
- en: You are passing that `api_description` to the application constructor.
  prefs: []
  type: TYPE_NORMAL
- en: '[![3](assets/3.png)](#co_documenting_your_api_CO3-3)'
  prefs: []
  type: TYPE_NORMAL
- en: You also give the app a `title`.
  prefs: []
  type: TYPE_NORMAL
- en: '[![4](assets/4.png)](#co_documenting_your_api_CO3-4)'
  prefs: []
  type: TYPE_NORMAL
- en: And you give the app a `version`. Notice that you are using a `version` of 0.1\.
    The major version of 0 communicates that breaking changes can still occur, and
    it is consistent with the *V0* in the API’s URL. I typically start all new API
    projects with a zero version. The minor version of 1 communicates that this is
    the first published iteration of this API.
  prefs: []
  type: TYPE_NORMAL
- en: Adding Tags to Categorize Your Paths
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Now you move to changes to each individual endpoint, which are described by
    the `path` object in the OAS file. The first change to the paths is the addition
    of *tags*, which are general-purpose attributes that can be used for a variety
    of purposes. In this case, the reason to add them is that Swagger UI uses them
    to group API paths together. This is extremely helpful to consumers when an API
    has several dozen endpoints. To make this change, you will add another element
    to the path function decorator.
  prefs: []
  type: TYPE_NORMAL
- en: 'Here is what the changes will look like for the `@app.get("/v0/players/{player_id}")`
    decorator in *main.py*. Make these changes to this decorator:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE9]'
  prefs: []
  type: TYPE_PRE
- en: '[![1](assets/1.png)](#co_documenting_your_api_CO4-1)'
  prefs: []
  type: TYPE_NORMAL
- en: This tag will be used to group endpoints into categories.
  prefs: []
  type: TYPE_NORMAL
- en: You have updated one endpoint. Now use the `tag` values in [Table 5-2](#endpoint_tag_table_ch3)
    to update the endpoints in *main.py*.
  prefs: []
  type: TYPE_NORMAL
- en: Table 5-2\. Tags for endpoints in main.py
  prefs: []
  type: TYPE_NORMAL
- en: '| Endpoint | tag |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| */* | `analytics` |'
  prefs: []
  type: TYPE_TB
- en: '| */v0/players/* | `player` |'
  prefs: []
  type: TYPE_TB
- en: '| */v0/players/{player_id}* | `player` |'
  prefs: []
  type: TYPE_TB
- en: '| */v0/performances/* | `scoring` |'
  prefs: []
  type: TYPE_TB
- en: '| */v0/leagues/* | `membership` |'
  prefs: []
  type: TYPE_TB
- en: '| */v0/leagues/{league_id}* | `membership` |'
  prefs: []
  type: TYPE_TB
- en: '| */v0/teams/* | `membership` |'
  prefs: []
  type: TYPE_TB
- en: '| */v0/counts/* | `analytics` |'
  prefs: []
  type: TYPE_TB
- en: Adding More Details to Individual Endpoints
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Next, you will add information about individual endpoints. In the OAS file,
    these are contained in the `paths` field. To make updates, you will modify each
    path function decorator. Here are the changes that will be made for each of the
    paths:'
  prefs: []
  type: TYPE_NORMAL
- en: Add a summary
  prefs: []
  type: TYPE_NORMAL
- en: This summarizes the path and will be displayed on the operation title by Swagger
    UI.
  prefs: []
  type: TYPE_NORMAL
- en: Add a description
  prefs: []
  type: TYPE_NORMAL
- en: This gives any additional details about the path and will be displayed below
    the title by Swagger UI.
  prefs: []
  type: TYPE_NORMAL
- en: Add a description to the 200 response
  prefs: []
  type: TYPE_NORMAL
- en: This replaces the default “Successful response” with a clearer description.
    It will be used when the HTTP 200 successful message occurs.
  prefs: []
  type: TYPE_NORMAL
- en: Modify the `operationID`
  prefs: []
  type: TYPE_NORMAL
- en: This standardizes the `operationID` value, which will be used by a variety of
    tools that are using the OAS file.
  prefs: []
  type: TYPE_NORMAL
- en: 'Here is what the changes will look like for the `@app.get("/v0/players/{player_id}"`
    decorator in *main.py*:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE10]'
  prefs: []
  type: TYPE_PRE
- en: '[![1](assets/1.png)](#co_documenting_your_api_CO5-1)'
  prefs: []
  type: TYPE_NORMAL
- en: Improved summary of the endpoint.
  prefs: []
  type: TYPE_NORMAL
- en: '[![2](assets/2.png)](#co_documenting_your_api_CO5-2)'
  prefs: []
  type: TYPE_NORMAL
- en: Very detailed description, to help developers and AI use it correctly.
  prefs: []
  type: TYPE_NORMAL
- en: '[![3](assets/3.png)](#co_documenting_your_api_CO5-3)'
  prefs: []
  type: TYPE_NORMAL
- en: Improved description of the response. Keep this under 300 characters to make
    ChatGPT happy.
  prefs: []
  type: TYPE_NORMAL
- en: '[![4](assets/4.png)](#co_documenting_your_api_CO5-4)'
  prefs: []
  type: TYPE_NORMAL
- en: Custom operation ID to replace the auto-generated one.
  prefs: []
  type: TYPE_NORMAL
- en: Apply these changes to the rest of the endpoints in *main.py*.
  prefs: []
  type: TYPE_NORMAL
- en: Adding Parameter Descriptions
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Another recommendation for AI to use the API is to add descriptions to parameters
    used to call the APIs. You will replace the default values of the parameters with
    the `Query()` statement and a description.
  prefs: []
  type: TYPE_NORMAL
- en: 'The `read_players` function is beneath the decorator you updated. To add descriptions
    for the parameters, update that function now:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE11]'
  prefs: []
  type: TYPE_PRE
- en: You have modified the `read_players` function. Update the rest of the API endpoints
    to add descriptions to all the query parameters.
  prefs: []
  type: TYPE_NORMAL
- en: Viewing the Changes in Swagger UI
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: With all of these changes made to the OAS file, Swagger UI has much more information
    than it did previously. Open the */docs* endpoint and you will first notice that
    the details added to the `info` field are displayed prominently at the top of
    the documentation, as shown in [Figure 5-13](#swagger_docs_6_ch5).
  prefs: []
  type: TYPE_NORMAL
- en: '![Updated Swagger UI information section](assets/haad_0513.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 5-13\. Updated Swagger UI information section
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: Scrolling down, you will see the effect that the `tags` attributes and the endpoint
    `summary` values have on Swagger UI, as shown in [Figure 5-14](#swagger_docs_7_ch5).
    The endpoints are now arranged in categories, and their summaries are displayed
    to explain their purpose.
  prefs: []
  type: TYPE_NORMAL
- en: '![Tags used to group endpoints](assets/haad_0514.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 5-14\. Tags used to group endpoints
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: Note
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: With all of the changes you made in this chapter, *main.py* is too long to show
    here. You can view the updated *main.py* file in the *chapter5/complete* folder.
  prefs: []
  type: TYPE_NORMAL
- en: Regression-Testing Your API
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: With all the changes you made to your API code, you should *regression-test*
    your code, which is running your existing tests to make sure you didn’t break
    anything. Regression testing is helpful for coding changes that you make and updates
    to software libraries that you use in your code.
  prefs: []
  type: TYPE_NORMAL
- en: 'In the terminal window, press Ctrl-C to stop the API and display the command
    prompt. Enter the **`pytest test_main.py`** command and you should see an output
    that looks similar to this:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE12]'
  prefs: []
  type: TYPE_PRE
- en: Updating Your README.md
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: With the updates you made to your built-in Swagger documentation, you are well
    on your way to providing a good developer experience. But there are a few API
    documentation features that you have not provided yet, including getting started,
    terms of service, and example code. You will update your *README.md* file to fill
    in the gaps of your documentation.
  prefs: []
  type: TYPE_NORMAL
- en: 'Update *README.md* with the following contents:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE13]'
  prefs: []
  type: TYPE_PRE
- en: import httpx
  prefs: []
  type: TYPE_NORMAL
- en: HEALTH_CHECK_ENDPOINT = "/"
  prefs: []
  type: TYPE_NORMAL
- en: 'with httpx.Client(base_url=self.swc_base_url) as client:'
  prefs: []
  type: TYPE_NORMAL
- en: response = client.get(self.HEALTH_CHECK_ENDPOINT)
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: print(response.json())
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[PRE14]'
  prefs: []
  type: TYPE_PRE
- en: Additional Resources
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'For a comprehensive discussion of the role that API documentation and developer
    portals play in an API effort, read Chapter 7 of James Higginbotham’s *Principles
    of Web API Design: Delivering Value with APIs and Microservices* (Addison-Wesley,
    2021).'
  prefs: []
  type: TYPE_NORMAL
- en: For a great short overview of API design concepts, I recommend *Designing Web
    APIs* by Brenda Jin, Saurabh Sahni, and Amir Shevat (O’Reilly, 2018).
  prefs: []
  type: TYPE_NORMAL
- en: The [NordicAPIs.com blog](https://oreil.ly/pyatT) publishes articles about [developer
    experience](https://oreil.ly/YGseq) and [API documentation](https://oreil.ly/xpcUd)
    that have a lot of useful information.
  prefs: []
  type: TYPE_NORMAL
- en: 'For more information about DX metrics, read [“Developer Experience: The Metrics
    That Matter Most”](https://oreil.ly/id-00).'
  prefs: []
  type: TYPE_NORMAL
- en: To see examples of individuals publishing tips or tools for consuming undocumented
    APIs, check out [Steven Morse’s blog](https://oreil.ly/stmorse) and [Joey Greco’s
    Leeger app](https://oreil.ly/leeger).
  prefs: []
  type: TYPE_NORMAL
- en: For more information about using Swagger UI websites, view the [Swagger UI installation
    instructions](https://oreil.ly/cSPsX).
  prefs: []
  type: TYPE_NORMAL
- en: For advice about working with your OAS, read [Speakeasy’s OpenAPI Guide](https://oreil.ly/beRNI).
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'In this chapter, you focused on your consumers by providing API documentation:'
  prefs: []
  type: TYPE_NORMAL
- en: You learned about the built-in API documentation that FastAPI provides using
    both Swagger UI and Redoc.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: You learned about the OpenAPI specification that FastAPI generates and the value
    of this specification for users.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: You learned about the components of great API documentation.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: In [Chapter 6](ch06.html#chapter_6), you will focus on deploying your application
    to the cloud, where real-world consumers can use it.
  prefs: []
  type: TYPE_NORMAL
