<html><head></head><body>
<div id="sbo-rt-content"><div class="readable-text" id="p1">
<h1 class="readable-text-h1"><span class="chapter-title-numbering"><span class="num-string">appendix B</span></span> <span class="chapter-title-text">Python pandas DataFrame</span></h1>
</div>
<div class="readable-text" id="p2">
<p>This appendix describes an overview of the pandas DataFrame and the methods used in this book.</p>
</div>
<div class="readable-text" id="p3">
<h2 class="readable-text-h2"><span class="num-string">B.1</span> An overview of pandas DataFrame</h2>
</div>
<div class="readable-text" id="p4">
<p>Python pandas is a data manipulation, analysis, and visualization library. It provides tools to load and allow you to manipulate, analyze, and visualize data. In this book, we use the pandas DataFrame, a two-dimensional structure composed of rows and columns. The DataFrame stores data in a tabular form, enabling you to manipulate, analyze, filter, and aggregate data quickly and easily.</p>
</div>
<div class="readable-text intended-text" id="p5">
<p>There are different ways to create a pandas DataFrame. In this book, we consider two ways: from a Python dictionary and from a CSV file. You can download the code described in this appendix from the GitHub repository for the book under AppendixB/Pandas DataFrame.ipynb.</p>
</div>
<div class="readable-text" id="p6">
<h3 class="readable-text-h3"><span class="num-string">B.1.1</span> Building from a dictionary</h3>
</div>
<div class="readable-text" id="p7">
<p>Consider the following listing, which creates a pandas DataFrame from a Python dictionary.</p>
</div>
<div class="browsable-container listing-container" id="p8">
<h5 class="listing-container-h5 browsable-container-h5"><span class="num-string">Listing B.1</span> Creating a DataFrame from a dictionary</h5>
<div class="code-area-container">
<pre class="code-area">import pandas as pd

data = {
    'Name': ['Alice', 'Bob', 'Charlie'],
    'BirthDate': ['2000-01-30', '2001-02-03', '2001-04-05'],
    'MathsScore': [90, 85, None],
    'PhysicsScore': [87, 92, 89],
    'ChemistryScore': [92, None, 90],
    'Grade' : ['A', 'B', 'A']
}                                 <span class="aframe-location"/> #1

df = pd.DataFrame(data)   <span class="aframe-location"/> #2

df['BirthDate'] = pd.to_datetime(df['BirthDate'], format='%Y-%m-%d')   <span class="aframe-location"/> #3</pre>
<div class="code-annotations-overlay-container">
     #1 Defines the dictionary
     <br/>#2 Creates the DataFrame
     <br/>#3 Parses the BirthDate field as a date
     <br/>
</div>
</div>
</div>
<div class="readable-text print-book-callout" id="p9">
<p><span class="print-book-callout-head">Note</span>  Use <code>DataFrame()</code> to create a new DataFrame from a dictionary.</p>
</div>
<div class="readable-text" id="p10">
<h3 class="readable-text-h3"><span class="num-string">B.1.2</span> Building from a CSV file</h3>
</div>
<div class="readable-text" id="p11">
<p>Use the <code>read_csv()</code> file to load a CSV file into a pandas DataFrame.</p>
</div>
<div class="browsable-container listing-container" id="p12">
<h5 class="listing-container-h5 browsable-container-h5"><span class="num-string">Listing B.2</span> Creating a DataFrame from a CSV file</h5>
<div class="code-area-container">
<pre class="code-area">import pandas as pd

df = pd.read_csv('data.csv')</pre>
</div>
</div>
<div class="readable-text print-book-callout" id="p13">
<p><span class="print-book-callout-head">Note</span>  Use <code>read_csv()</code> to create a new DataFrame from a CSV file.</p>
</div>
<div class="readable-text" id="p14">
<p>Now that you have seen how to create a pandas DataFrame, we’ll discuss the main DataFrame functions used in this book.</p>
</div>
<div class="readable-text" id="p15">
<h2 class="readable-text-h2"><span class="num-string">B.2</span> dt</h2>
</div>
<div class="readable-text" id="p16">
<p>The <code>dt</code> variable within a pandas Dataframe enables you to access Python’s built-in DateTime library. Use it to store and manipulate DateTime values, such as the year, month, day, hour, minute, and second. Consider the following listing, which extracts the year from a DateTime column.</p>
</div>
<div class="browsable-container listing-container" id="p17">
<h5 class="listing-container-h5 browsable-container-h5"><span class="num-string">Listing B.3</span> How to use pandas <code>dt</code></h5>
<div class="code-area-container">
<pre class="code-area">import pandas as pd

data = {
    'Name': ['Alice', 'Bob', 'Charlie'],
    'BirthDate': ['2000-01-30', '2001-02-03', '2001-04-05'],
    'MathsScore': [90, 85, None],
    'PhysicsScore': [87, 92, 89],
    'ChemistryScore': [92, None, 90],
    'Grade' : ['A', 'B', 'A']
}

df = pd.DataFrame(data)
df['BirthDate'] = pd.to_datetime(df['BirthDate'], format='%Y-%m-%d')

year = df['BirthDate'].dt.year   <span class="aframe-location"/> #1
month = df['BirthDate'].dt.month    <span class="aframe-location"/> #2
day = df['BirthDate'].dt.day                      <span class="aframe-location"/> #3
weekOfYear = df['BirthDate'].dt.isocalendar().week  <span class="aframe-location"/> #4</pre>
<div class="code-annotations-overlay-container">
     #1 Extracts the year from the BirthDate column
     <br/>#2 Extracts the month from the BirthDate column
     <br/>#3 Extracts the day from the BirthDate column
     <br/>#4 Extracts the week from the BirthDate column
     <br/>
</div>
</div>
</div>
<div class="readable-text print-book-callout" id="p18">
<p><span class="print-book-callout-head">Note</span>  Use pandas <code>dt</code> to access the DateTime functions of Python’s DateTime library.</p>
</div>
<div class="readable-text" id="p19">
<h2 class="readable-text-h2"><span class="num-string">B.3</span> groupby()</h2>
</div>
<div class="readable-text" id="p20">
<p>The pandas <code>groupby()</code> method splits data into groups based on the values of certain columns. This process often involves creating an aggregate statistic for each group, such as a sum or mean.</p>
</div>
<div class="browsable-container listing-container" id="p21">
<h5 class="listing-container-h5 browsable-container-h5"><span class="num-string">Listing B.4</span> How to use pandas <code>groupby</code></h5>
<div class="code-area-container">
<pre class="code-area">import pandas as pd

data = {
    'Name': ['Alice', 'Bob', 'Charlie'],
    'BirthDate': ['2000-01-30', '2001-02-03', '2001-04-05'],
    'MathsScore': [90, 85, None],
    'PhysicsScore': [87, 92, 89],
    'ChemistryScore': [92, None, 90],
    'Grade' : ['A', 'B', 'A']
}

df = pd.DataFrame(data)
df_grouped = df.groupby(by='Grade').mean().reset_index()</pre>
</div>
</div>
<div class="readable-text print-book-callout" id="p22">
<p><span class="print-book-callout-head">Note</span>  Use pandas <code>groupby</code> to group by instrument and calculate the average score by grade. Use the <code>reset_index()</code> method to restore the indexer column (<code>Grade</code> in the example).</p>
</div>
<div class="readable-text" id="p23">
<p>Table B.1 shows the result.</p>
</div>
<div class="browsable-container browsable-table-container framemaker-table-container" id="p24">
<h5 class="browsable-container-h5"><span class="num-string">Table B.1</span> The result of <code>groupby()</code> in listing B.4</h5>
<table>
<thead>
<tr>
<th>
<div>
<strong>Grade</strong>
</div></th>
<th>
<div>
<strong>MathsScore</strong>
</div></th>
<th>
<div>
<strong>PhysicsScore</strong>
</div></th>
<th>
<div>
<strong>ChemistryScore</strong>
</div></th>
</tr>
</thead>
<tbody>
<tr>
<td>  A <br/></td>
<td>  90.0 <br/></td>
<td>  88.0 <br/></td>
<td>  91.0 <br/></td>
</tr>
<tr>
<td>  B <br/></td>
<td>  85.0 <br/></td>
<td>  92.0 <br/></td>
<td/>
</tr>
</tbody>
</table>
</div>
<div class="readable-text" id="p25">
<h2 class="readable-text-h2"><span class="num-string">B.4</span> isnull()</h2>
</div>
<div class="readable-text" id="p26">
<p>The pandas DataFrame <code>isnull()</code> method returns a new Boolean DataFrame indicating which values in the DataFrame are null (<code>NaN</code>). Use this method to detect missing values in a DataFrame.</p>
</div>
<div class="browsable-container listing-container" id="p27">
<h5 class="listing-container-h5 browsable-container-h5"><span class="num-string">Listing B.5</span> How to use pandas <code>isnull</code></h5>
<div class="code-area-container">
<pre class="code-area">import pandas as pd

data = {
    'Name': ['Alice', 'Bob', 'Charlie'],
    'BirthDate': ['2000-01-30', '2001-02-03', '2001-04-05'],
    'MathsScore': [90, 85, None],
    'PhysicsScore': [87, 92, 89],
    'ChemistryScore': [92, None, 90],
    'Grade' : ['A', 'B', 'A']
}

df = pd.DataFrame(data)
df_isnull = df.isnull()</pre>
</div>
</div>
<div class="readable-text print-book-callout" id="p28">
<p><span class="print-book-callout-head">Note</span>  Use pandas <code>isnull()</code> to check if a DataFrame contains missing values. You can apply the <code>isnull()</code> method to a single column as well (e.g., <code>df['ChemistryScore'].isnull()</code>).</p>
</div>
<div class="readable-text" id="p29">
<p>Table B.2 shows the result, a Boolean DataFrame indicating which values in the DataFrame are null (<code>NaN</code>).</p>
</div>
<div class="browsable-container browsable-table-container framemaker-table-container" id="p30">
<h5 class="browsable-container-h5"><span class="num-string">Table B.2</span> The result of <code>isnull()</code> in listing B.5</h5>
<table>
<thead>
<tr>
<th>
<div>
<strong>Name</strong>
</div></th>
<th>
<div>
<strong>BirthDate</strong>
</div></th>
<th>
<div>
<strong>MathsScore</strong>
</div></th>
<th>
<div>
<strong>PhysicsScore</strong>
</div></th>
<th>
<div>
<strong>ChemistryScore</strong>
</div></th>
<th>
<div>
<strong>Grade</strong>
</div></th>
</tr>
</thead>
<tbody>
<tr>
<td>  False <br/></td>
<td>  False <br/></td>
<td>  False <br/></td>
<td>  False <br/></td>
<td>  False <br/></td>
<td>  False <br/></td>
</tr>
<tr>
<td>  False <br/></td>
<td>  False <br/></td>
<td>  False <br/></td>
<td>  False <br/></td>
<td>  True <br/></td>
<td>  False <br/></td>
</tr>
<tr>
<td>  False <br/></td>
<td>  False <br/></td>
<td>  True <br/></td>
<td>  False <br/></td>
<td>  False <br/></td>
<td>  False <br/></td>
</tr>
</tbody>
</table>
</div>
<div class="readable-text" id="p31">
<h2 class="readable-text-h2"><span class="num-string">B.5</span> melt()</h2>
</div>
<div class="readable-text" id="p32">
<p>We use the pandas <code>melt()</code> function to reshape data by turning columns into rows. This function unpivots a DataFrame from wide to long format, optionally leaving identifiers set.</p>
</div>
<div class="browsable-container listing-container" id="p33">
<h5 class="listing-container-h5 browsable-container-h5"><span class="num-string">Listing B.6</span> How to use pandas <code>melt</code></h5>
<div class="code-area-container">
<pre class="code-area">import pandas as pd

data = {
    'Name': ['Alice', 'Bob', 'Charlie'],
    'BirthDate': ['2000-01-30', '2001-02-03', '2001-04-05'],
    'MathsScore': [90, 85, None],
    'PhysicsScore': [87, 92, 89],
    'ChemistryScore': [92, None, 90],
    'Grade' : ['A', 'B', 'A']
}

df = pd.DataFrame(data)

df_melted = df.melt(id_vars='Name', 
        var_name='Subject', 
        value_name='Score', 
        value_vars=['MathsScore', 'PhysicsScore', 'ChemistryScore']
)</pre>
</div>
</div>
<div class="readable-text print-book-callout" id="p34">
<p><span class="print-book-callout-head">Note</span>  Use pandas <code>melt()</code> to transform the DataFrame from wide to long format. Set the <code>id_vars</code> argument to specify which variables to keep as an identifier and the <code>var_name</code> and <code>value_name</code> arguments to set the column names for the new variables in the resulting melted DataFrame. Use <code>value_ vars</code> to select the columns to group.</p>
</div>
<div class="readable-text" id="p35">
<p>Table B.3 shows the result of melting the data used in listing B.6.</p>
</div>
<div class="browsable-container browsable-table-container framemaker-table-container" id="p36">
<h5 class="browsable-container-h5"><span class="num-string">Table B.3</span> The result of the melting operation described in listing B.6</h5>
<table>
<thead>
<tr>
<th>
<div>
<strong>Name</strong>
</div></th>
<th>
<div>
<strong>Subject</strong>
</div></th>
<th>
<div>
<strong>Score</strong>
</div></th>
</tr>
</thead>
<tbody>
<tr>
<td>  Alice <br/></td>
<td> <code>MathsScore</code> <br/></td>
<td>  90.0 <br/></td>
</tr>
<tr>
<td>  Bob <br/></td>
<td> <code>MathsScore</code> <br/></td>
<td>  85.0 <br/></td>
</tr>
<tr>
<td>  Charlie <br/></td>
<td> <code>MathsScore</code> <br/></td>
<td>  Null <br/></td>
</tr>
<tr>
<td>  Alice <br/></td>
<td> <code>PhysicsScore</code> <br/></td>
<td>  87.0 <br/></td>
</tr>
<tr>
<td>  Bob <br/></td>
<td> <code>PhysicsScore</code> <br/></td>
<td>  92.0 <br/></td>
</tr>
<tr>
<td>  Charlie <br/></td>
<td> <code>PhysicsScore</code> <br/></td>
<td>  89.0 <br/></td>
</tr>
<tr>
<td>  Alice <br/></td>
<td> <code>ChemistryScore</code> <br/></td>
<td>  92.0 <br/></td>
</tr>
<tr>
<td>  Bob <br/></td>
<td> <code>ChemistryScore</code> <br/></td>
<td>  Null <br/></td>
</tr>
</tbody>
</table>
</div>
<div class="readable-text" id="p37">
<h2 class="readable-text-h2"><span class="num-string">B.6</span> unique()</h2>
</div>
<div class="readable-text" id="p38">
<p>We use the pandas <code>unique()</code> method to obtain distinct values from a specific column in a DataFrame. This method returns an array-like object, containing the unique values found in the specified column.</p>
</div>
<div class="browsable-container listing-container" id="p39">
<h5 class="listing-container-h5 browsable-container-h5"><span class="num-string">Listing B.7</span> How to use pandas <code>unique</code></h5>
<div class="code-area-container">
<pre class="code-area">import pandas as pd

data = {
    'Name': ['Alice', 'Bob', 'Charlie'],
    'BirthDate': ['2000-01-30', '2001-02-03', '2001-04-05'],
    'MathsScore': [90, 85, None],
    'PhysicsScore': [87, 92, 89],
    'ChemistryScore': [92, None, 90],
    'Grade' : ['A', 'B', 'A']
}
df = pd.DataFrame(data)
unique_grades = df['Grade'].unique()</pre>
</div>
</div>
<div class="readable-text print-book-callout" id="p40">
<p><span class="print-book-callout-head">Note</span>  Use pandas <code>unique()</code> to get the unique values of a column.</p>
</div>
<div class="readable-text" id="p41">
<p>The following listing shows the result of calculating the unique values for the column <code>Grade</code> (from listing B.7).</p>
</div>
<div class="browsable-container listing-container" id="p42">
<h5 class="listing-container-h5 browsable-container-h5"><span class="num-string">Listing B.8</span> The results of pandas <code>unique()</code></h5>
<div class="code-area-container">
<pre class="code-area">array(['A', 'B'], dtype=object)</pre>
</div>
</div>
<div class="readable-text print-book-callout" id="p43">
<p><span class="print-book-callout-head">Note</span>  The method returns an array containing the unique values for a column.</p>
</div>
</div></body></html>