["```py\n# Judgment(grade, keywords, doc_id)\nsample_judgments = [\n  # for 'social network' query\n  Judgment(1, \"social network\", 37799),  # The Social Network\n  Judgment(0, \"social network\", 267752), # #chicagoGirl\n  Judgment(0, \"social network\", 38408),  # Life As We Know It\n  Judgment(0, \"social network\", 28303),  # The Cheyenne Social Club\n  # for 'star wars' query\n  Judgment(1, \"star wars\", 11),          # Star Wars\n  Judgment(1, \"star wars\", 1892),        # Return of the Jedi\n  Judgment(0, \"star wars\", 54138),       # Star Trek Into Darkness\n  Judgment(0, \"star wars\", 85783),       # The Star\n  Judgment(0, \"star wars\", 325553)       # Battlestar Galactica\n]\n```", "```py\n# Judgment(grade, keywords, doc_id),\nsample_judgments = [\n  Judgment(0.99, \"social network\", 37799),  # The Social Network\n  Judgment(0.01, \"social network\", 267752), # #chicagoGirl\n  Judgment(0.01, \"social network\", 38408),  # Life As We Know It\n  Judgment(0.01, \"social network\", 28303),  # The Cheyenne Social Club\n  Judgment(0.99, \"star wars\", 11),          # Star Wars\n  Judgment(0.80, \"star wars\", 1892),        # Return of the Jedi\n  Judgment(0.20, \"star wars\", 54138),       # Star Trek Into Darkness\n  Judgment(0.01, \"star wars\", 85783),       # The Star\n  Judgment(0.20, \"star wars\", 325553)       # Battlestar Galactica\n]\n```", "```py\nquery = \"transformers dark of the moon\"\nsessions = get_sessions(query)  #1\nprint(sessions.loc[3]) #2\n```", "```py\nsess_id  query                          rank    doc_id          clicked\n3        transformers dark of the moon  0.0     47875842328     False\n3        transformers dark of the moon  1.0     24543701538     False\n...\n3        transformers dark of the moon  7.0     97360810042     True\n...\n3        transformers dark of the moon  13.0    47875841406     False\n3        transformers dark of the moon  14.0    400192926087    False\n```", "```py\ndef calculate_ctr(sessions):\n  click_counts = sessions.groupby(\"doc_id\")[\"clicked\"].sum()\n  sess_counts = sessions.groupby(\"doc_id\")[\"sess_id\"].nunique()\n  ctrs = click_counts / sess_counts\n  return ctrs.sort_values(ascending=False)\n\nquery = \"transformers dark of the moon\"\nsessions = get_sessions(query, index=False)\nclick_through_rates = calculate_ctr(sessions)\nprint_series_data(click_through_rates, column=\"CTR\")\n```", "```py\ndoc_id         CTR       name\n97360810042    0.0824    Transformers: Dark of the Moon - Blu-ray Disc\n47875842328    0.0734    Transformers: Dark of the Moon Stealth Force E...\n47875841420    0.0434    Transformers: Dark of the Moon Decepticons - N...\n...\n93624956037    0.0082    Transformers: Dark of the Moon - Original Soun...\n47875841369    0.0074    Transformers: Dark of the Moon - PlayStation 3\n24543750949    0.0062    X-Men: First Class - Widescreen Dubbed Subtitl...\n```", "```py\nsessions = all_sessions()\nnum_sessions = len(sessions[\"sess_id\"].unique())\nctr_by_rank = sessions.groupby(\"rank\")[\"clicked\"].sum() / num_sessions\nprint(ctr_by_rank)\n```", "```py\nrank\n0     0.249727\n1     0.142673\n2     0.084218\n3     0.063073\n4     0.056255\n5     0.042255\n6     0.033236\n7     0.038000\n8     0.020964\n9     0.017364\n10    0.013982\n```", "```py\ndef calculate_average_rank(sessions):\n  avg_rank = sessions.groupby(\"doc_id\")[\"rank\"].mean()\n  return avg_rank.sort_values(ascending=True)\n\nsessions = get_sessions(\"transformers dark of the moon\")\naverage_rank = calculate_average_rank(sessions)\nprint_series_data(average_rank, \"mean_rank\")\n```", "```py\ndoc_id        mean_rank    name\n400192926087    13.0526    Transformers: Dark of the Moon - Original Soun...\n97363532149     12.1494    Transformers: Revenge of the Fallen - Widescre...\n93624956037     11.3298    Transformers: Dark of the Moon - Original Soun...\n...\n25192107191      2.6596    Fast Five - Widescreen - Blu-ray Disc\n24543701538      1.8626    The A-Team - Widescreen Dubbed Subtitle AC3 - ...\n47875842328      0.9808    Transformers: Dark of the Moon Stealth Force E...\n```", "```py\ndef calculate_examine_probability(sessions):\n  last_click_per_session = sessions.groupby(  #1\n    [\"clicked\", \"sess_id\"])[\"rank\"].max()[True]  #1\n  sessions[\"last_click_rank\"] = last_click_per_session  #2\n  sessions[\"examined\"] = \\  #3\n    sessions[\"rank\"] <= sessions[\"last_click_rank\"]  #3\n  return sessions\n\nsessions = get_sessions(\"dryer\")\nprobability_data = calculate_examine_probability(sessions).loc[3]\nprint(probability_data)\n```", "```py\nsess_id  query   rank    doc_id          clicked  last_click_rank  examined\n3        dryer   0.0     12505451713     False    9.0              True\n3        dryer   1.0     84691226727     False    9.0              True\n3        dryer   2.0     883049066905    False    9.0              True\n...\n3        dryer   8.0     14381196320     True     9.0              True\n3        dryer   9.0     74108096487     True     9.0              True\n3        dryer   10.0    74108007469     False    9.0              False\n3        dryer   11.0    12505525766     False    9.0              False\n...\n```", "```py\ndef calculate_clicked_examined(sessions):\n  sessions = calculate_examine_probability(sessions)\n  return sessions[sessions[\"examined\"]] \\\n    .groupby(\"doc_id\")[[\"clicked\", \"examined\"]].sum()\n\nsessions = get_sessions(\"dryer\")\nclicked_examined_data = calculate_clicked_examined(sessions)\nprint_dataframe(clicked_examined_data)\n```", "```py\ndoc_id        clicked  examined    name\n12505451713       355      2707    Frigidaire - Semi-Rigid Dryer Ve...\n12505525766       268       974    Smart Choice - 6' 30 Amp 3-Prong...\n...\n36172950027        97       971    Tools in the Dryer: A Rarities C...\n...\n883049066905      286      2138    Whirlpool - Affresh Washer Cleaner\n883929085118       44       578    A Charlie Brown Christmas - AC3 ...\n```", "```py\ndef calculate_grade(sessions):\n  sessions = calculate_clicked_examined(sessions)\n  sessions[\"grade\"] = sessions[\"clicked\"] / sessions[\"examined\"]\n  return sessions.sort_values(\"grade\", ascending=False)\n\nquery = \"dryer\"\nsessions = get_sessions(query)\ngrade_data = calculate_grade(sessions)\nprint_dataframe(grade_data)\n```", "```py\ndoc_id      clicked  examined  grade     name\n856751002097    133       323  0.411765  Practecol - Dryer Balls (2-Pack)\n48231011396     166       423  0.392435  LG - 3.5 Cu. Ft. 7-Cycle High-Ef...\n84691226727     804      2541  0.316411  GE - 6.0 Cu. Ft. 3-Cycle Electri...\n...\n12505451713     355      2707  0.131141  Frigidaire - Semi-Rigid Dryer Ve...\n36172950027      97       971  0.099897  Tools in the Dryer: A Rarities C...\n883929085118     44       578  0.076125  A Charlie Brown Christmas - AC3 ...\n```", "```py\nquery = \"transformers dark of the moon\"\nsessions = get_sessions(query)\ngrade_data = calculate_grade(sessions)\nprint_dataframe(grade_data)\n```", "```py\ndoc_id      clicked  examined  grade     name\n97360810042     412       642  0.641745  Transformers: Dark of the Moon -...\n400192926087     62       129  0.480620  Transformers: Dark of the Moon -...\n97363560449      96       243  0.395062  Transformers: Dark of the Moon -...\n...\n47875841406      80       626  0.127796  Transformers: Dark of the Moon A...\n24543750949      31       313  0.099042  X-Men: First Class - Widescreen ...\n47875842335      53       681  0.077827  Transformers: Dark of the Moon S...\n```", "```py\ndef get_sample_sessions(query):\n  sessions = get_sessions(query, index=False)\n  sessions = sessions[sessions[\"sess_id\"] < 50050]  #1\n  return sessions.set_index(\"sess_id\")\n\nsessions = get_sample_sessions(\"blue ray\")\ngrade_data = calculate_grade(sessions)\nprint_dataframe(grade_data)\n```", "```py\ndoc_id        clicked  examined  grade      name\n600603132872  1        1         1.000000   Blu-ray Disc Cases (10-Pack)\n827396513927  14       34        0.411765   Panasonic - Blu-Ray Player\n25192073007   8        20        0.400000   The Blues Brothers - Widescree...\n...\n25192107191   0        7         0.000000   Fast Five - Widescreen - Blu-r...\n23942972389   0        15        0.000000   Verbatim - 10-Pack 6x BD-R Dis...\n885170038875  0        5         0.000000   Panasonic - 9\" Widescreen Port...\n```", "```py\ndef calculate_prior(sessions, prior_grade, prior_weight):\n  sessions = calculate_grade(sessions)\n  sessions[\"prior_a\"] = prior_grade * prior_weight  #1\n  sessions[\"prior_b\"] = (1 - prior_grade) * prior_weight  #1\n  return sessions\n\nprior_grade = 0.3  #2\nprior_weight = 100  #3\nquery = \"blue ray\"\nsessions = get_sample_sessions(query)\nprior_data = calculate_prior(sessions, prior_grade, prior_weight)\nprint(prior_data)\n```", "```py\ndoc_id          clicked  examined  grade     prior_a  prior_b\n600603132872    1.0      1.0       1.000000  30.0     70.0\n827396513927    14.0     34.0      0.411765  30.0     70.0\n25192073007     8.0      20.0      0.400000  30.0     70.0\n885170033412    6.0      19.0      0.315789  30.0     70.0\n...\n```", "```py\ndef calculate_sdbn(sessions, prior_grade=0.3, prior_weight=100):\n  sessions = calculate_prior(sessions, prior_grade, prior_weight)\n  sessions[\"posterior_a\"] = (sessions[\"prior_a\"] +  #1\n                             sessions[\"clicked\"])  #1\n sessions[\"posterior_b\"] = (sessions[\"prior_b\"] +    #2\n    sessions[\"examined\"] - sessions[\"clicked\"])  #2\n  sessions[\"beta_grade\"] = (sessions[\"posterior_a\"] /  #3\n    (sessions[\"posterior_a\"] + sessions[\"posterior_b\"]))  #3\n  return sessions.sort_values(\"beta_grade\", ascending=False)\n\nquery = \"blue ray\"\nsessions = get_sample_sessions(query)\nbluray_sdbn_data = calculate_sdbn(sessions)\nprint(bluray_sdbn_data)\n```", "```py\ndoc_id        cl  ex  grade  pr_a  pr_b  posterior_a posterior_b beta_grade\n827396513927  14  34  0.411  30.0  70.0  44.0        90.0        0.328358\n25192073007   8   20  0.400  30.0  70.0  38.0        82.0        0.316667\n600603132872  1   1   1.000  30.0  70.0  31.0        70.0        0.306931\n...\n786936805017  1   14  0.071  30.0  70.0  31.0        83.0        0.271930\n36725608511   0   11  0.000  30.0  70.0  30.0        81.0        0.270270\n23942972389   0   15  0.000  30.0  70.0  30.0        85.0        0.260870\n```"]