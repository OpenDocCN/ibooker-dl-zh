["```py\npip install sounddevice==0.4\n```", "```py\npip install scipy==1.11\n```", "```py\npip install playsound==1.3\n```", "```py\npip install PyObjC==10.0\n```", "```py\npip install requests==2.31.0\n```", "```py\nimport openai\nclient = openai.OpenAI()\n\nwith open(audio_path, 'rb') as audio_file:  #1\n     #2\n    transcription = client.audio.transcriptions.create(\n        file=audio_file, model='whisper-1')\n```", "```py\nimport argparse\nimport openai\n\nclient = openai.OpenAI()\n\ndef transcribe(audio_path):        #1\n    \"\"\" Transcribe audio file to text.\n\n    Args:\n        audio_path: path to audio file.\n\n    Returns:\n        transcribed text.\n    \"\"\"\n    with open(audio_path, 'rb') as audio_file:\n        transcription = client.audio.transcriptions.create(\n            file=audio_file, model='whisper-1')\n        return transcription.text\n\nif __name__ == '__main__':         #2\n\n    parser = argparse.ArgumentParser()\n    parser.add_argument('audiopath', type=str, help='Path to audio file')\n    args = parser.parse_args()\n\n    transcript = transcribe(args.audiopath)\n    print(transcript)\n```", "```py\npython listing1.py QuoteFromTheAlchemist.mp3\n```", "```py\nTwo years ago, right here on this spot, \nI had a recurrent dream, too.\n```", "```py\nimport sounddevice       #1\nimport scipy.io.wavfile  #2\n```", "```py\nsample_rate = 44100\nnr_frames = 5 * sample_rate\n```", "```py\nrecording = sounddevice.rec(                   #1\n    nr_frames, samplerate=sample_rate, channels=1)\nsounddevice.wait()                             #2\n```", "```py\nscipy.io.wavfile.write(output_path, sample_rate, recording)\n```", "```py\nimport argparse  #1\nimport openai\nimport re\nimport scipy.io.wavfile\nimport sounddevice\nimport sqlite3\nimport time\n\nclient = openai.OpenAI()\n\ndef get_structure(data_path):               #2\n    \"\"\" Extract structure from SQLite database.\n\n    Args:\n        data_path: path to SQLite data file.\n\n    Returns:\n        text description of database structure.\n    \"\"\"\n    with sqlite3.connect(data_path) as connection:\n        cursor = connection.cursor()\n        cursor.execute(\"select sql from sqlite_master where type = 'table';\")\n        table_rows = cursor.fetchall()\n        table_ddls = [r[0] for r in table_rows]\n        return '\\n'.join(table_ddls)\n\ndef record(output_path):                 #3\n    \"\"\" Record audio and store in .wav file. \n\n    Args:\n        output_path: store audio recording there.\n    \"\"\"\n    sample_rate = 44100\n    nr_frames = 5 * sample_rate\n    recording = sounddevice.rec(\n        nr_frames, samplerate=sample_rate, channels=1)\n    sounddevice.wait()\n    scipy.io.wavfile.write(output_path, sample_rate, recording)\n\ndef transcribe(audio_path):        #4\n    \"\"\" Transcribe audio file to text.\n\n    Args:\n        audio_path: path to audio file.\n\n    Returns:\n        transcribed text.\n    \"\"\"\n    with open(audio_path, 'rb') as audio_file:\n        transcription = client.audio.transcriptions.create(\n            file=audio_file, model='whisper-1')\n        return transcription.text\n\ndef create_prompt(description, question):        #5\n    \"\"\" Generate prompt to translate question into SQL query.\n\n    Args:\n        description: text description of database structure.\n        question: question about data in natural language.\n\n    Returns:\n        prompt for question translation.\n    \"\"\"\n    parts = []\n    parts += ['Database:']\n    parts += [description]\n    parts += ['Translate this question into SQL query:']\n    parts += [question]\n    parts += ['SQL Query:']\n    return '\\n'.join(parts)\n\ndef call_llm(prompt):                             #6\n    \"\"\" Query large language model and return answer.\n\n    Args:\n        prompt: input prompt for language model.\n\n    Returns:\n        Answer by language model.\n    \"\"\"\n    for nr_retries in range(1, 4):\n        try:\n            response = client.chat.completions.create(\n                model='gpt-4o',\n                messages=[\n                    {'role':'user', 'content':prompt}\n                    ]\n                )\n            return response.choices[0].message.content\n        except:\n            time.sleep(nr_retries * 2)\n    raise Exception('Cannot query OpenAI model!')\n\ndef process_query(data_path, query):        #7\n    \"\"\" Processes SQL query and returns result.\n\n    Args:\n        data_path: path to SQLite data file.\n        query: process this query on database.\n\n    Returns:\n        query result.\n    \"\"\"\n    with sqlite3.connect(data_path) as connection:\n        cursor = connection.cursor()\n        cursor.execute(query)\n        table_rows = cursor.fetchall()\n        table_strings = [str(r) for r in table_rows]\n        return '\\n'.join(table_strings)\n\nif __name__ == '__main__':   #8\n\n    parser = argparse.ArgumentParser()\n    parser.add_argument('dbpath', type=str, help='Path to SQLite data')\n    args = parser.parse_args()\n\n    data_structure = get_structure(args.dbpath)\n\n    while True:  #9\n\n        user_input = input('Press enter to record (type quit to quit).')\n        if user_input == 'quit':\n            break\n\n        audio_path = 'question.wav'  #10\n        record(audio_path)\n        question = transcribe(audio_path)\n        print(f'Question: {question}')\n\n        prompt = create_prompt(data_structure, question)  #11\n        answer = call_llm(prompt)\n        query = re.findall('\"`sql(.*)\"`', answer, re.DOTALL)[0]\n        print(f'SQL: {query}')\n\n        try:                                       #12\n            answer = process_query(args.dbpath, query)\n            print(f'Answer: {answer}')\n        except:\n            print('Error processing query! Try to reformulate.')\n```", "```py\npython listing1.py games.db\n```", "```py\nPress enter to record (type quit to quit).\nQuestion: How many games were released for each genre?\nSQL: SELECT genre, COUNT(*) as num_games\nFROM games\nGROUP BY genre\nAnswer: ('Action', 3316)\n('Adventure', 1286)\n('Fighting', 848)\n('Genre', 1)\n('Misc', 1739)\n('Platform', 886)\n('Puzzle', 582)\n('Racing', 1249)\n('Role-Playing', 1488)\n('Shooter', 1310)\n('Simulation', 867)\n('Sports', 2346)\n('Strategy', 681)\n```", "```py\nimport openai\nclient = openai.OpenAI()\n\nresponse = client.audio.speech.create(\n    model='tts-1', voice='alloy', \n    input=speech_text)\n```", "```py\nimport argparse  #1\nimport openai\nimport playsound\nimport requests\nimport scipy.io.wavfile\nimport sounddevice\nimport time\n\nclient = openai.OpenAI()\n\ndef record(output_path):                 #2\n    \"\"\" Record audio and store in .wav file. \n\n    Args:\n        output_path: store audio recording there.\n    \"\"\"\n    sample_rate = 44100\n    nr_frames = 5 * sample_rate\n    recording = sounddevice.rec(\n        nr_frames, samplerate=sample_rate, channels=1)\n    sounddevice.wait()\n    scipy.io.wavfile.write(output_path, sample_rate, recording)\n\ndef transcribe(audio_path):        #3\n    \"\"\" Transcribe audio file to text.\n\n    Args:\n        audio_path: path to audio file.\n\n    Returns:\n        transcribed text.\n    \"\"\"\n    with open(audio_path, 'rb') as audio_file:\n        transcription = client.audio.transcriptions.create(\n            file=audio_file, model='whisper-1')\n        return transcription.text\n #4\ndef create_prompt(to_translate, to_language):\n    \"\"\" Generate prompt to translate text to target language.\n\n    Args:\n        to_translate: translate this text.\n        to_language: translate text to this language.\n\n    Returns:\n        Translated text.\n    \"\"\"\n    parts = []\n    parts += [f'Translate this text to {to_language}:']\n    parts += [to_translate]\n    parts += ['Translated text:']\n    return '\\n'.join(parts)\n\ndef call_llm(prompt):                             #5\n    \"\"\" Query large language model and return answer.\n\n    Args:\n        prompt: input prompt for language model.\n\n    Returns:\n        Answer by language model.\n    \"\"\"\n    for nr_retries in range(1, 4):\n        try:\n            response = client.chat.completions.create(\n                model='gpt-4o',\n                messages=[\n                    {'role':'user', 'content':prompt}\n                    ]\n                )\n            return response.choices[0].message.content\n        except:\n            time.sleep(nr_retries * 2)\n    raise Exception('Cannot query OpenAI model!')\n\ndef generate_speech(speech_text):    #6\n    \"\"\" Generates speech for given text.\n\n    Args:\n        speech_text: generate speech for this text.\n\n    Returns:\n        query result.\n    \"\"\"\n    response = client.audio.speech.create(\n        model='tts-1', voice='alloy', \n        input=speech_text)\n    return response.content\n\nif __name__ == '__main__':        #7\n\n    parser = argparse.ArgumentParser()\n    parser.add_argument('tolanguage', type=str, help='Target language')\n    args = parser.parse_args()\n\n    while True:  #8\n\n        user_input = input('Press enter to record (type quit to quit).')\n        if user_input == 'quit':\n            break\n\n        audio_path = 'to_translate.wav'  #9\n        record(audio_path)\n        to_translate = transcribe(audio_path)\n        print(f'Original text: {to_translate}')\n         #10\n        prompt = create_prompt(to_translate, args.tolanguage)\n        translated = call_llm(prompt)\n        print(f'Translated text: {translated}')\n\n        speech = generate_speech(translated)    #11\n        with open('translation.mp3', 'wb') as file:\n            file.write(speech)\n\n        playsound.playsound('translation.mp3')  #12\n```", "```py\npython listing3.py \"French\"\n```", "```py\nPress enter to record (type quit to quit).\nOriginal text: Hello my colleagues in Paris.\nTranslated text: Bonjour mes collègues à Paris.\nPress enter to record (type quit to quit).\nOriginal text: Let me teach you something \nabout language models.\nTranslated text: Laisse-moi t'apprendre \nquelque chose à propos des modèles de langage.\n```", "```py\npython listing3.py \"English in the style of Shakespeare\"\n```", "```py\nPress enter to record (type quit to quit).\nOriginal text: Hello, my dear colleagues.\nTranslated text: Hark, my fair allies, I bid thee well met!\nPress enter to record (type quit to quit).\nOriginal text: Let me teach you \nsomething about language models.\nTranslated text: Pray, lend me thine ear \nas I shalt educate thee on language models.\n```"]