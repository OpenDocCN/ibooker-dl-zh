<html><head></head><body>
<div id="book-content">
<div id="sbo-rt-content"><section data-type="chapter" epub:type="chapter" data-pdf-bookmark="Chapter 11. Using APIs in Streamlit Data Apps"><div class="chapter" id="chapter_11">
<h1><span class="label">Chapter 11. </span>Using APIs in Streamlit Data Apps</h1>

<blockquote data-type="epigraph" epub:type="epigraph">
  <p>A simple app today is better than an over-designed app three months late.</p>
  <p data-type="attribution">Thiago Teixeira, cofounder of Streamlit</p>
</blockquote>

<p>If you want to demonstrate your <a data-type="indexterm" data-primary="Streamlit" data-secondary="co-founder Thiago Teixeira" id="id2090"/><a data-type="indexterm" data-primary="Teixeira, Thiago" id="id2091"/><a data-type="indexterm" data-primary="data apps" data-secondary="about" id="id2092"/><a data-type="indexterm" data-primary="Streamlit" data-secondary="about data apps" id="id2093"/><a data-type="indexterm" data-primary="Streamlit" data-secondary="about Streamlit" id="ch11strm"/><a data-type="indexterm" data-primary="data apps" data-secondary="about Streamlit" id="ch11strm2"/>data science skills to other people, it’s hard to beat a <em>data app</em>—a web application displaying your data science models, graphs, charts, and spreadsheets. Sending a recruiter or potential client a link to a data app you created is a sure way to get their attention.</p>

<p>In this chapter, you will build a data app with Streamlit, an open source library that helps you create colorful and interactive web apps using Python. Streamlit handles all the complexity of the web interface so that you can focus on the data backend code, such as data files, pandas DataFrames, and APIs.</p>

<p>Streamlit apps can be deployed<a data-type="indexterm" data-primary="Streamlit" data-secondary="about Streamlit" data-tertiary="Streamlit Community Cloud" id="id2094"/> in a limited fashion for free on the Streamlit Community Cloud or paid web hosting platforms.</p>






<section data-type="sect1" data-pdf-bookmark="Engaging Users with Interactive Visualizations"><div class="sect1" id="id116">
<h1>Engaging Users with Interactive Visualizations</h1>

<p>Two main types of analytics products<a data-type="indexterm" data-primary="data apps" data-secondary="tabular reports versus visualizations" data-seealso="Streamlit" id="id2095"/><a data-type="indexterm" data-primary="data analytics" data-secondary="tabular report products versus visualizations" id="id2096"/><a data-type="indexterm" data-primary="tabular report analytics products" data-seealso="Streamlit" id="id2097"/><a data-type="indexterm" data-primary="visualization analytics products" data-seealso="LangGraph; Streamlit" id="id2098"/> are <em>tabular reports</em> and <em>visualizations</em>. Tabular reports present rows and columns of data in a spreadsheet format, which provides a detailed view of data. Visualizations replace tabular data with charts, graphs, maps, and other images that give context and color to the data. Visualizations can communicate ideas that are hard to see in a spreadsheet.</p>

<p>Streamlit supports both tabular data and visualizations in a very interactive way. It provides built-in <em>widgets</em>, which are application controls such as sliders and select boxes that allow the user to filter and interact with the data in real time. For a fun example, take a look at <a data-type="xref" href="#fantasy_history_streamlit_app_ch11">Figure 11-1</a>, which shows a data app I built to track the championship titles in one of my long-running fantasy leagues.</p>

<figure><div id="fantasy_history_streamlit_app_ch11" class="figure">
<img src="assets/haad_1101.png" alt="Fantasy league data app" width="913" height="597"/>
<h6><span class="label">Figure 11-1. </span>Fantasy league data app</h6>
</div></figure>

<p>The built-in widgets allow a data scientist to focus on providing accurate and useful data, while Streamlit components make a great-looking app. Streamlit designs its product to have simple defaults that get users up and running quickly; this is Streamlit’s design principle of <a href="https://oreil.ly/strlit">promoting forward progress</a>.</p>
</div></section>






<section data-type="sect1" data-pdf-bookmark="Software Used in This Chapter"><div class="sect1" id="id117">
<h1>Software Used in This Chapter</h1>

<p>This chapter builds on the tools you have learned in previous chapters, especially pandas. <a data-type="xref" href="#tools_table_chapter_11">Table 11-1</a> displays the new tools you will use.<a data-type="indexterm" data-primary="data apps" data-secondary="software used" id="id2099"/><a data-type="indexterm" data-primary="Streamlit" data-secondary="software used" id="id2100"/><a data-type="indexterm" data-primary="Streamlit" data-secondary="software used" data-tertiary="Streamlit" id="id2101"/><a data-type="indexterm" data-primary="Streamlit" data-secondary="software used" data-tertiary="nfl_data_py" id="id2102"/><a data-type="indexterm" data-primary="nfl_data_py NFL data library" id="id2103"/><a data-type="indexterm" data-primary="nflverse open source libraries" data-secondary="nfl_data_py data library" id="id2104"/><a data-type="indexterm" data-primary="data apps" data-secondary="software used" data-tertiary="Streamlit" id="id2105"/><a data-type="indexterm" data-startref="ch11strm" id="id2106"/><a data-type="indexterm" data-startref="ch11strm2" id="id2107"/></p>
<table id="tools_table_chapter_11">
<caption><span class="label">Table 11-1. </span>Key tools or services used in this chapter</caption>
<thead>
<tr>
<th>Software name</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td><p>nfl_data_py</p></td>
<td><p>NFL data library</p></td>
</tr>
<tr>
<td><p>Streamlit</p></td>
<td><p>Web-based analytics software</p></td>
</tr>
</tbody>
</table>








<section data-type="sect2" class="less_space pagebreak-before" data-pdf-bookmark="nfl_data_py"><div class="sect2" id="id118">
<h2>nfl_data_py</h2>

<p>To perform data analytics, you often want to add data from multiple sources to make your analytics products more informative or give them wider context. <a data-type="indexterm" data-primary="nflverse open source libraries" id="id2108"/><a data-type="indexterm" data-primary="resources online" data-secondary="nflverse open source libraries" id="id2109"/>For football data, <a href="https://oreil.ly/nfLV">nflverse</a> is a rich set of open source libraries and data files containing NFL data. The Python library for interacting with the data is <a href="https://oreil.ly/2U7P8">nfl_data_py</a>.</p>

<p>You will use the most current version of nfl_data_py that is available.</p>
</div></section>








<section data-type="sect2" data-pdf-bookmark="Streamlit"><div class="sect2" id="id204">
<h2>Streamlit</h2>

<p>Streamlit is an open source <a data-type="indexterm" data-primary="Streamlit" data-secondary="about Streamlit" id="id2110"/><a data-type="indexterm" data-primary="data apps" data-secondary="software used" data-tertiary="Streamlit" id="id2111"/><a data-type="indexterm" data-primary="data apps" data-secondary="about Streamlit" id="id2112"/><a data-type="indexterm" data-primary="Streamlit" data-secondary="software used" data-tertiary="Streamlit" id="id2113"/>Python library that you can download using <code>pip3</code>. By including the library, a single Python file can generate an app using the command <code>streamlit run your_script.py</code>. The library is easy to learn using the <a href="https://oreil.ly/-qxBe">Streamlit getting started guide</a>.</p>
</div></section>
</div></section>






<section data-type="sect1" data-pdf-bookmark="Installing Streamlit and nfl_data_py"><div class="sect1" id="streamlit_nfl_data_py">
<h1>Installing Streamlit and nfl_data_py</h1>

<p>To install the libraries you need for this chapter, create a file named <em>chapter11/requirements.txt</em>:<a data-type="indexterm" data-primary="data apps" data-secondary="software used" data-tertiary="installing" id="id2114"/><a data-type="indexterm" data-primary="Streamlit" data-secondary="software used" data-tertiary="installing" id="id2115"/><a data-type="indexterm" data-primary="requirements.txt file for pip" data-secondary="installing Streamlit and nfl_data_py" id="id2116"/></p>

<pre data-type="programlisting" data-code-language="shell">.../analytics-project (main) $ cd chapter11
.../chapter11 (main) $ touch requirements.txt</pre>

<p>Update <em>chapter11/requirements.txt</em> with the following contents:</p>

<pre data-type="programlisting" data-code-language="shell">streamlit&gt;=1.38.0
httpx&gt;=0.27.0
nfl_data_py
matplotlib
backoff&gt;=2.2.1</pre>

<p>Execute the following command to install the new libraries in your Codespace:</p>

<pre data-type="programlisting" data-code-language="shell">.../chapter11 (main) $ pip3 install -r requirements.txt</pre>

<p>You should see a message that states that these libraries were successfully installed.</p>
</div></section>






<section data-type="sect1" data-pdf-bookmark="Launching Your API in Codespaces"><div class="sect1" id="id206">
<h1>Launching Your API in Codespaces</h1>

<p><a data-type="xref" href="#ch11_architecture_streamlit">Figure 11-2</a> shows<a data-type="indexterm" data-primary="Streamlit" data-secondary="API launched in Codespaces" id="id2117"/> the high-level architecture of the project you will create in this chapter.</p>

<figure><div id="ch11_architecture_streamlit" class="figure">
<img src="assets/haad_1102.png" alt="Architecture of Streamlit project" width="683" height="489"/>
<h6><span class="label">Figure 11-2. </span>Architecture of the Streamlit project</h6>
</div></figure>

<p>To access your API data, you will need to launch v0.2 of your API in the terminal. For instructions, follow <a data-type="xref" href="ch08.html#sportsworldcentral">“Running the SportsWorldCentral (SWC) API Locally”</a>. When the API is running, copy the URL of your API from the browser address bar to use as the base URL in this chapter.</p>
<div data-type="tip"><h6>Tip</h6>
<p>When your API or Streamlit app is running in the terminal and you want to stop it, press Ctrl-C.<a data-type="indexterm" data-primary="Ctrl-C" data-secondary="to stop API in terminal" id="id2118"/><a data-type="indexterm" data-primary="Codespaces (GitHub)" data-secondary="terminal window" data-tertiary="Ctrl-C to stop API" id="id2119"/><a data-type="indexterm" data-primary="GitHub" data-secondary="Codespaces" data-tertiary="terminal window Ctrl-C to stop API" id="id2120"/><a data-type="indexterm" data-primary="Streamlit" data-secondary="API launched in Codespaces" data-tertiary="Ctrl-C to stop API" id="id2121"/><a data-type="indexterm" data-primary="terminal window of GitHub Codespace" data-secondary="Ctrl-C to stop API" id="id2122"/></p>
</div>
</div></section>






<section data-type="sect1" data-pdf-bookmark="Reusing the Chapter 9 API Client File"><div class="sect1" id="id231">
<h1>Reusing the Chapter 9 API Client File</h1>

<p>In <a data-type="xref" href="ch09.html#chapter_9">Chapter 9</a>, you created a standalone Python client file to make the calls to your API, while adding logging, error handling, and backoff-retry functionality. You will reuse this file in your Streamlit app. Maintaining your API client outside your Streamlit app gives you reusability.</p>

<p>Copy the client file from<a data-type="indexterm" data-primary="resources online" data-secondary="chapter code" data-tertiary="chapter 9 complete" id="id2123"/> the <em>chapter9/notebooks</em> directory (or the <em>chapter9/complete/notebooks</em> directory if you haven’t completed <a data-type="xref" href="ch09.html#chapter_9">Chapter 9</a> yet) into the <em>chapter11/streamlit</em> directory:</p>

<pre data-type="programlisting" data-code-language="shell">.../chapter11 (main) $ mkdir streamlit
.../chapter11 (main) $ cp ../chapter9/notebooks/swc_simple_client.py streamlit</pre>
</div></section>






<section data-type="sect1" data-pdf-bookmark="Creating Your Streamlit App"><div class="sect1" id="id207">
<h1>Creating Your Streamlit App</h1>

<p>Your Streamlit app will include<a data-type="indexterm" data-primary="Streamlit" data-secondary="creating Streamlit app" id="id2124"/><a data-type="indexterm" data-primary="Streamlit" data-secondary="creating Streamlit app" data-tertiary="entrypoint file" id="ch11entry"/> an <em>entrypoint file</em>, which is the file that Streamlit loads first. In this app, you will use the entrypoint file to set the initial configuration and create the page navigation. Your app will also include individual page files that perform the work.</p>

<p>Since your API is running in the terminal window, you will need to open a second terminal window and execute the following command:</p>

<pre data-type="programlisting" data-code-language="shell">.../chapter11 (main) $ mkdir streamlit
.../chapter11 (main) $ cd streamlit
.../streamlit (main) $ touch streamlit_football_app.py
.../streamlit (main) $ touch page1.py
.../streamlit (main) $ touch page2.py</pre>
</div></section>






<section data-type="sect1" data-pdf-bookmark="Updating the Entrypoint File"><div class="sect1" id="id119">
<h1>Updating the Entrypoint File</h1>

<p>The entrypoint file contains a couple<a data-type="indexterm" data-primary="Streamlit" data-secondary="creating Streamlit app" data-tertiary="st.session_state" id="id2125"/><a data-type="indexterm" data-primary="Streamlit" data-secondary="creating Streamlit app" data-tertiary="st.navigation" id="id2126"/> of items that are fundamental to a Streamlit app. The first is <code>st.session_state</code>, which is the mechanism to share information between pages in the application. The next is <code>st.navigation</code>, which is how you make a multi-page app with a shared navigation bar.</p>

<p>Add the following code to <em>streamlit_football_app.py</em>, and replace the statement <code>[insert your API base URL]</code> with the base API URL from the API running locally:<a data-type="indexterm" data-primary="Streamlit" data-secondary="streamlit_football_app.py" id="id2127"/><a data-type="indexterm" data-primary="Python" data-secondary="Streamlit files" data-tertiary="streamlit_football_app.py" id="id2128"/></p>

<pre data-type="programlisting" data-code-language="python">import streamlit as st
import logging
import pandas as pd

if 'base_url' not in st.session_state:
    st.session_state['base_url'] = "[insert your API base URL]" <a class="co" id="co_using_apis_in_streamlit_data_apps_CO1-1" href="#callout_using_apis_in_streamlit_data_apps_CO1-1"><img src="assets/1.png" alt="1" width="12" height="12"/></a>

logging.basicConfig( <a class="co" id="co_using_apis_in_streamlit_data_apps_CO1-2" href="#callout_using_apis_in_streamlit_data_apps_CO1-2"><img src="assets/2.png" alt="2" width="12" height="12"/></a>
    filename='football_app.log',  
    level=logging.INFO,  
)

st.set_page_config(page_title="Football App",
                  page_icon=":material/sports_football:") <a class="co" id="co_using_apis_in_streamlit_data_apps_CO1-3" href="#callout_using_apis_in_streamlit_data_apps_CO1-3"><img src="assets/3.png" alt="3" width="12" height="12"/></a>

page_1 = st.Page("page1.py", title="Team Rosters", icon=":material/trophy:") <a class="co" id="co_using_apis_in_streamlit_data_apps_CO1-4" href="#callout_using_apis_in_streamlit_data_apps_CO1-4"><img src="assets/4.png" alt="4" width="12" height="12"/></a>

page_2 = st.Page("page2.py", title="Team Stats", icon=":material/star_border:")

pg = st.navigation([page_1, page_2]) <a class="co" id="co_using_apis_in_streamlit_data_apps_CO1-5" href="#callout_using_apis_in_streamlit_data_apps_CO1-5"><img src="assets/5.png" alt="5" width="12" height="12"/></a>
pg.run() <a class="co" id="co_using_apis_in_streamlit_data_apps_CO1-6" href="#callout_using_apis_in_streamlit_data_apps_CO1-6"><img src="assets/6.png" alt="6" width="12" height="12"/></a></pre>
<dl class="calloutlist">
<dt><a class="co" id="callout_using_apis_in_streamlit_data_apps_CO1-1" href="#co_using_apis_in_streamlit_data_apps_CO1-1"><img src="assets/1.png" alt="1" width="12" height="12"/></a></dt>
<dd><p>Replace the statement <code>[insert your API base URL]</code> with the base API URL from the API running locally.</p></dd>
<dt><a class="co" id="callout_using_apis_in_streamlit_data_apps_CO1-2" href="#co_using_apis_in_streamlit_data_apps_CO1-2"><img src="assets/2.png" alt="2" width="12" height="12"/></a></dt>
<dd><p>This sets up the logging configuration<a data-type="indexterm" data-primary="logging" data-secondary="Streamlit app" id="id2129"/> for the application. All logging messages at <code>INFO</code> level or more severe will be saved in this file.</p></dd>
<dt><a class="co" id="callout_using_apis_in_streamlit_data_apps_CO1-3" href="#co_using_apis_in_streamlit_data_apps_CO1-3"><img src="assets/3.png" alt="3" width="12" height="12"/></a></dt>
<dd><p>This sets the configuration for the entire application, including the title and icon to display in the browser tab.</p></dd>
<dt><a class="co" id="callout_using_apis_in_streamlit_data_apps_CO1-4" href="#co_using_apis_in_streamlit_data_apps_CO1-4"><img src="assets/4.png" alt="4" width="12" height="12"/></a></dt>
<dd><p>This command defines the settings for the first subpage, along with the title and icon to display in the navigation bar.</p></dd>
<dt><a class="co" id="callout_using_apis_in_streamlit_data_apps_CO1-5" href="#co_using_apis_in_streamlit_data_apps_CO1-5"><img src="assets/5.png" alt="5" width="12" height="12"/></a></dt>
<dd><p>This creates the navigation bar and orders the subpages.</p></dd>
<dt><a class="co" id="callout_using_apis_in_streamlit_data_apps_CO1-6" href="#co_using_apis_in_streamlit_data_apps_CO1-6"><img src="assets/6.png" alt="6" width="12" height="12"/></a></dt>
<dd><p>This statement executes the current page.<a data-type="indexterm" data-startref="ch11entry" id="id2130"/></p></dd>
</dl>
</div></section>






<section data-type="sect1" data-pdf-bookmark="Running Your Streamlit App"><div class="sect1" id="id120">
<h1>Running Your Streamlit App</h1>

<p>To run your app, execute the following command in the terminal:<a data-type="indexterm" data-primary="Streamlit" data-secondary="running Streamlit app" id="id2131"/></p>

<pre data-type="programlisting" data-code-language="shell">.../streamlit (main) $ streamlit run streamlit_football_app.py</pre>

<p>You will see the display shown in <a data-type="xref" href="#launching_streamlit_ch11">Figure 11-3</a>.</p>

<figure><div id="launching_streamlit_ch11" class="figure">
<img src="assets/haad_1103.png" alt="Launching your Streamlit app" width="658" height="137"/>
<h6><span class="label">Figure 11-3. </span>Launching your Streamlit app</h6>
</div></figure>

<p>Click “Open in Browser.” You will see a blank browser window with a vertical ellipsis in the top right. Select the ellipsis and choose Settings. On the Settings screen select “Run on save,” then close the Settings window to save.</p>
<div data-type="tip"><h6>Tip</h6>
<p>If you are prompted with “Source code changed,” select “Always rerun.” This ensures that coding changes are applied to the running app immediately.</p>
</div>

<p>You will see the blank app with a navigation bar, as shown in <a data-type="xref" href="#blank_app_ch11">Figure 11-4</a>.</p>

<figure><div id="blank_app_ch11" class="figure">
<img src="assets/haad_1104.png" alt="Initial blank data app" width="437" height="99"/>
<h6><span class="label">Figure 11-4. </span>Initial blank data app</h6>
</div></figure>
<div data-type="tip" class="less_space pagebreak-before"><h6>Tip</h6>
<p>You can open the VS Code Simple Browser<a data-type="indexterm" data-primary="VS Code Simple Browser" id="id2132"/> and have it running next to your code window. Open the VS Code Command Palette by clicking Ctrl-Shift-P. Enter <strong>Simple Browser:Show</strong>, then enter the address of the application (the one that ends with <em>app.github.dev</em>).</p>
</div>
</div></section>






<section data-type="sect1" data-pdf-bookmark="Creating the Team Rosters Page"><div class="sect1" id="id121">
<h1>Creating the Team Rosters Page</h1>

<p>The Team Rosters subpage <a data-type="indexterm" data-primary="Streamlit" data-secondary="team rosters page created" id="ch11rost"/>will be displayed when your application executes. It will call the SportsWorldCentral API, manipulate the data using pandas, and then display the pandas DataFrame.</p>

<p>The first half of this file performs some library imports and sets up the logging. Then, it calls the API to retrieve all the data that will be used on the page for both filtering and display. The data is used to create a pandas DataFrame, which is a handy way of processing data in Python. The pandas library supports many powerful data manipulation functions, which you will see in the next section.</p>

<p>Add the following code to <em>page1.py</em>:</p>

<pre data-type="programlisting" data-code-language="python">import streamlit as st
import swc_simple_client as swc
import pandas as pd
import logging

logger = logging.getLogger(__name__) <a class="co" id="co_using_apis_in_streamlit_data_apps_CO2-1" href="#callout_using_apis_in_streamlit_data_apps_CO2-1"><img src="assets/1.png" alt="1" width="12" height="12"/></a>

st.header("SportsWorldCentral Data App") <a class="co" id="co_using_apis_in_streamlit_data_apps_CO2-2" href="#callout_using_apis_in_streamlit_data_apps_CO2-2"><img src="assets/2.png" alt="2" width="12" height="12"/></a>
st.subheader("Team Rosters Page")

base_url = st.session_state['base_url'] <a class="co" id="co_using_apis_in_streamlit_data_apps_CO2-3" href="#callout_using_apis_in_streamlit_data_apps_CO2-3"><img src="assets/3.png" alt="3" width="12" height="12"/></a>

try: <a class="co" id="co_using_apis_in_streamlit_data_apps_CO2-4" href="#callout_using_apis_in_streamlit_data_apps_CO2-4"><img src="assets/4.png" alt="4" width="12" height="12"/></a>
   team_api_response = swc.call_api_endpoint(base_url,swc.LIST_TEAMS_ENDPOINT)<a class="co" id="co_using_apis_in_streamlit_data_apps_CO2-5" href="#callout_using_apis_in_streamlit_data_apps_CO2-5"><img src="assets/5.png" alt="5" width="12" height="12"/></a>

   if team_api_response.status_code == 200: <a class="co" id="co_using_apis_in_streamlit_data_apps_CO2-6" href="#callout_using_apis_in_streamlit_data_apps_CO2-6"><img src="assets/6.png" alt="6" width="12" height="12"/></a>

       team_data = team_api_response.json() <a class="co" id="co_using_apis_in_streamlit_data_apps_CO2-7" href="#callout_using_apis_in_streamlit_data_apps_CO2-7"><img src="assets/7.png" alt="7" width="12" height="12"/></a>

       teams_df = pd.DataFrame.from_dict(team_data) <a class="co" id="co_using_apis_in_streamlit_data_apps_CO2-8" href="#callout_using_apis_in_streamlit_data_apps_CO2-8"><img src="assets/8.png" alt="8" width="12" height="12"/></a>

       unique_leagues = teams_df['league_id'].unique() <a class="co" id="co_using_apis_in_streamlit_data_apps_CO2-9" href="#callout_using_apis_in_streamlit_data_apps_CO2-9"><img src="assets/9.png" alt="9" width="12" height="12"/></a>
       unique_leagues = sorted(unique_leagues.astype(str)) 

       if 'unique_leagues' not in st.session_state: <a class="co" id="co_using_apis_in_streamlit_data_apps_CO2-10" href="#callout_using_apis_in_streamlit_data_apps_CO2-10"><img src="assets/10.png" alt="10" width="12" height="12"/></a>
           st.session_state['unique_leagues'] = unique_leagues</pre>
<dl class="calloutlist less_space pagebreak-before">
<dt><a class="co" id="callout_using_apis_in_streamlit_data_apps_CO2-1" href="#co_using_apis_in_streamlit_data_apps_CO2-1"><img src="assets/1.png" alt="1" width="12" height="12"/></a></dt>
<dd><p>This statement creates a reference to the logging file that was configured in the entrypoint file.<a data-type="indexterm" data-primary="logging" data-secondary="Streamlit app" data-tertiary="team rosters page" id="id2133"/></p></dd>
<dt><a class="co" id="callout_using_apis_in_streamlit_data_apps_CO2-2" href="#co_using_apis_in_streamlit_data_apps_CO2-2"><img src="assets/2.png" alt="2" width="12" height="12"/></a></dt>
<dd><p>These headings will be printed at the top of the page.</p></dd>
<dt><a class="co" id="callout_using_apis_in_streamlit_data_apps_CO2-3" href="#co_using_apis_in_streamlit_data_apps_CO2-3"><img src="assets/3.png" alt="3" width="12" height="12"/></a></dt>
<dd><p>This retrieves the <code>base_url</code> variable from the session state.</p></dd>
<dt><a class="co" id="callout_using_apis_in_streamlit_data_apps_CO2-4" href="#co_using_apis_in_streamlit_data_apps_CO2-4"><img src="assets/4.png" alt="4" width="12" height="12"/></a></dt>
<dd><p>All of the page’s code is wrapped in a <code>try…​except</code> structure. If any unhandled exception occurs, it logs the error and writes an error message to the screen.</p></dd>
<dt><a class="co" id="callout_using_apis_in_streamlit_data_apps_CO2-5" href="#co_using_apis_in_streamlit_data_apps_CO2-5"><img src="assets/5.png" alt="5" width="12" height="12"/></a></dt>
<dd><p>This uses <em>swc_simple_client.py</em> to call the API and stores the <code>httpx.response</code> in a variable.<a data-type="indexterm" data-primary="swc_simple_client.py file" data-secondary="calling API in Streamlit app" id="id2134"/><a data-type="indexterm" data-primary="Python" data-secondary="API files" data-tertiary="swc_simple_client.py via Streamlit" id="id2135"/></p></dd>
<dt><a class="co" id="callout_using_apis_in_streamlit_data_apps_CO2-6" href="#co_using_apis_in_streamlit_data_apps_CO2-6"><img src="assets/6.png" alt="6" width="12" height="12"/></a></dt>
<dd><p>A <code>200</code> value in the <code>status_code</code> indicates a successful API call. It proceeds to populate the page.<a data-type="indexterm" data-primary="HTTP" data-secondary="status codes" data-tertiary="200 as successful response" id="id2136"/></p></dd>
<dt><a class="co" id="callout_using_apis_in_streamlit_data_apps_CO2-7" href="#co_using_apis_in_streamlit_data_apps_CO2-7"><img src="assets/7.png" alt="7" width="12" height="12"/></a></dt>
<dd><p>This converts the JSON data<a data-type="indexterm" data-primary="httpx Python library" data-secondary="httpx.Response" data-tertiary="httpx.Response.json() to extract data" id="id2137"/> from the API to a Python representation of the data. The <code>.json()</code> name is a bit confusing since it doesn’t return JSON data. It might help to think of this as the “converting from JSON” method.</p></dd>
<dt><a class="co" id="callout_using_apis_in_streamlit_data_apps_CO2-8" href="#co_using_apis_in_streamlit_data_apps_CO2-8"><img src="assets/8.png" alt="8" width="12" height="12"/></a></dt>
<dd><p>This uses pandas to create a DataFrame<a data-type="indexterm" data-primary="pandas library" data-secondary="DataFrame storage of data" data-tertiary="DataFrame.from_dict() method" id="id2138"/> using the <code>from_dict</code> method. pandas DataFrames are convenient data structures for manipulating data.</p></dd>
<dt><a class="co" id="callout_using_apis_in_streamlit_data_apps_CO2-9" href="#co_using_apis_in_streamlit_data_apps_CO2-9"><img src="assets/9.png" alt="9" width="12" height="12"/></a></dt>
<dd><p>These two lines get a list of unique <code>league_id</code> values, convert them to a string, and sort them.</p></dd>
<dt><a class="co" id="callout_using_apis_in_streamlit_data_apps_CO2-10" href="#co_using_apis_in_streamlit_data_apps_CO2-10"><img src="assets/10.png" alt="10" width="12" height="12"/></a></dt>
<dd><p>This command stores the unique list of leagues in the <code>session_state</code> object so that all pages in the app can use them.</p></dd>
</dl>

<p>This page contains a navigation bar with a select box titled “Pick league ID.” When users select a league that has rosters, the team rosters page will be filtered with teams that match that <code>league_id</code> value. This filtering is accomplished by filtering the DataFrame and by Streamlit updating the display to match.</p>

<p>The remaining code creates the navigation bar, then uses pandas to format the data and display it on the page. It also contains matching error handling and exception handling statements from the previous code.</p>

<p class="less_space pagebreak-before">Add the following code to <em>page1.py</em>:<a data-type="indexterm" data-primary="Streamlit" data-secondary="page1.py" id="id2139"/><a data-type="indexterm" data-primary="Python" data-secondary="Streamlit files" data-tertiary="page1.py" id="id2140"/><a data-type="indexterm" data-primary="Streamlit" data-secondary="team rosters page created" data-tertiary="gsis_id" id="id2141"/><a data-type="indexterm" data-primary="Streamlit" data-secondary="page1.py" data-tertiary="gsis_id" id="id2142"/><a data-type="indexterm" data-primary="gsis_id" data-secondary="Streamlit team rosters page" id="id2143"/></p>

<pre data-type="programlisting" data-code-language="python">        selected_league = st.sidebar.selectbox('Pick league ID',unique_leagues)<a class="co" id="co_using_apis_in_streamlit_data_apps_CO3-1" href="#callout_using_apis_in_streamlit_data_apps_CO3-1"><img src="assets/1.png" alt="1" width="12" height="12"/></a>
  
        st.sidebar.divider()
        st.sidebar.subheader(":blue[Data sources]")
        st.sidebar.text("SportsWorldCentral")
        
        flat_team_df = pd.json_normalize(
           team_data, 'players', ['team_id', 'team_name','league_id']) <a class="co" id="co_using_apis_in_streamlit_data_apps_CO3-2" href="#callout_using_apis_in_streamlit_data_apps_CO3-2"><img src="assets/2.png" alt="2" width="12" height="12"/></a>
       column_order = ['league_id','team_id','team_name','position',
                       'player_id', 'gsis_id', 'first_name', 'last_name']
        flat_team_df_ordered = flat_team_df[column_order]
        
        if 'flat_team_df_ordered' not in st.session_state:
            st.session_state['flat_team_df_ordered'] = flat_team_df_ordered

        display_df = flat_team_df_ordered.drop(columns=['team_id','player_id'])

        display_df['league_id'] = display_df['league_id'].astype(str) 
        display_df = display_df[display_df['league_id'] == selected_league] <a class="co" id="co_using_apis_in_streamlit_data_apps_CO3-3" href="#callout_using_apis_in_streamlit_data_apps_CO3-3"><img src="assets/3.png" alt="3" width="12" height="12"/></a>
        
        st.dataframe(display_df,hide_index=True) <a class="co" id="co_using_apis_in_streamlit_data_apps_CO3-4" href="#callout_using_apis_in_streamlit_data_apps_CO3-4"><img src="assets/4.png" alt="4" width="12" height="12"/></a>
    
    else:
        logger.error(f"Error encountered: {team_api_response.status_code} 
                     {team_api_response.text}") <a class="co" id="co_using_apis_in_streamlit_data_apps_CO3-5" href="#callout_using_apis_in_streamlit_data_apps_CO3-5"><img src="assets/5.png" alt="5" width="12" height="12"/></a>
        st.write("Error encountered while accessing data source.")

except Exception as e:
    logger.error(f"Exception encountered: {str(e)}") <a class="co" id="co_using_apis_in_streamlit_data_apps_CO3-6" href="#callout_using_apis_in_streamlit_data_apps_CO3-6"><img src="assets/6.png" alt="6" width="12" height="12"/></a>
    st.write(f"An unexpected error occurred.")</pre>
<dl class="calloutlist">
<dt><a class="co" id="callout_using_apis_in_streamlit_data_apps_CO3-1" href="#co_using_apis_in_streamlit_data_apps_CO3-1"><img src="assets/1.png" alt="1" width="12" height="12"/></a></dt>
<dd><p>Create a select box in the navigation bar to select a <code>league_id</code> value.</p></dd>
<dt><a class="co" id="callout_using_apis_in_streamlit_data_apps_CO3-2" href="#co_using_apis_in_streamlit_data_apps_CO3-2"><img src="assets/2.png" alt="2" width="12" height="12"/></a></dt>
<dd><p>Use the pandas <code>json_normalize()</code> function to reformat the nested JSON data into rows and columns. Then create a new variable with a different column order.<a data-type="indexterm" data-primary="pandas library" data-secondary="json_normalize() function" id="id2144"/></p></dd>
<dt><a class="co" id="callout_using_apis_in_streamlit_data_apps_CO3-3" href="#co_using_apis_in_streamlit_data_apps_CO3-3"><img src="assets/3.png" alt="3" width="12" height="12"/></a></dt>
<dd><p>Create a filter DataFrame that<a data-type="indexterm" data-primary="pandas library" data-secondary="DataFrame storage of data" data-tertiary="filtering data" id="id2145"/> contains only the values matching <code>selected_​lea⁠gue</code>, which the user chose in the select box.</p></dd>
<dt><a class="co" id="callout_using_apis_in_streamlit_data_apps_CO3-4" href="#co_using_apis_in_streamlit_data_apps_CO3-4"><img src="assets/4.png" alt="4" width="12" height="12"/></a></dt>
<dd><p>Use Streamlit’s built-in <code>DataFrame()</code> function to display the filtered DataFrame on the page.<a data-type="indexterm" data-primary="pandas library" data-secondary="DataFrame storage of data" data-tertiary="Streamlit DataFrame() to display" id="id2146"/><a data-type="indexterm" data-primary="Streamlit" data-secondary="DataFrame() function to display pandas DataFrame" id="id2147"/></p></dd>
<dt><a class="co" id="callout_using_apis_in_streamlit_data_apps_CO3-5" href="#co_using_apis_in_streamlit_data_apps_CO3-5"><img src="assets/5.png" alt="5" width="12" height="12"/></a></dt>
<dd><p>This will display an error if the API call is not successful and returns an HTTP status code other than 200.</p></dd>
<dt><a class="co" id="callout_using_apis_in_streamlit_data_apps_CO3-6" href="#co_using_apis_in_streamlit_data_apps_CO3-6"><img src="assets/6.png" alt="6" width="12" height="12"/></a></dt>
<dd><p>This is a general exception handling block that will be entered if anything goes wrong in the main processing of the page.</p></dd>
</dl>

<p>As you rerun the code on this page, you will see the display of the Team Rosters page, as shown in <a data-type="xref" href="#team_rosters_page_ch11">Figure 11-5</a>.<a data-type="indexterm" data-startref="ch11rost" id="id2148"/></p>

<figure><div id="team_rosters_page_ch11" class="figure">
<img src="assets/haad_1105.png" alt="Team rosters page" width="1208" height="645"/>
<h6><span class="label">Figure 11-5. </span>Team Rosters page</h6>
</div></figure>
</div></section>






<section data-type="sect1" data-pdf-bookmark="Creating the Team Stats Page"><div class="sect1" id="id122">
<h1>Creating the Team Stats Page</h1>

<p>The Team Stats page will be displayed<a data-type="indexterm" data-primary="Streamlit" data-secondary="team stats page created" id="ch11stats"/> when users select Team Stats in the navigation bar. Instead of calling the SportsWorldCentral API, it reuses the data that was stored in <code>SessionState</code> as a pandas DataFrame.</p>

<p>The first portion of this file imports libraries and sets up the logging. Next, it creates items for the sidebar and filters the dataset to match the selected entry in the select box.</p>

<p>Add the following code to <em>page2.py</em>:<a data-type="indexterm" data-primary="Streamlit" data-secondary="page2.py" id="id2149"/><a data-type="indexterm" data-primary="Python" data-secondary="Streamlit files" data-tertiary="page2.py" id="id2150"/></p>

<pre data-type="programlisting" data-code-language="python">import streamlit as st
import pandas as pd
import logging
import nfl_data_py as nfl
import matplotlib.pyplot as plt <a class="co" id="co_using_apis_in_streamlit_data_apps_CO4-1" href="#callout_using_apis_in_streamlit_data_apps_CO4-1"><img src="assets/1.png" alt="1" width="12" height="12"/></a>


logger = logging.getLogger(__name__) 

st.header("SportsWorldCentral Data App")
st.subheader("Team Touchdown Totals")

try:

    flat_team_df_ordered = st.session_state['flat_team_df_ordered'] <a class="co" id="co_using_apis_in_streamlit_data_apps_CO4-2" href="#callout_using_apis_in_streamlit_data_apps_CO4-2"><img src="assets/2.png" alt="2" width="12" height="12"/></a>

    unique_leagues = st.session_state['unique_leagues'] <a class="co" id="co_using_apis_in_streamlit_data_apps_CO4-3" href="#callout_using_apis_in_streamlit_data_apps_CO4-3"><img src="assets/3.png" alt="3" width="12" height="12"/></a>
    selected_league = st.sidebar.selectbox('Pick league ID',unique_leagues)

    st.sidebar.divider()
    st.sidebar.subheader(":blue[Data sources]")
    st.sidebar.text("SportsWorldCentral")
    st.sidebar.text("NFLDataPy")


  flat_team_df_ordered['league_id'] = flat_team_df_ordered[
       'league_id'].astype(str) <a class="co" id="co_using_apis_in_streamlit_data_apps_CO4-4" href="#callout_using_apis_in_streamlit_data_apps_CO4-4"><img src="assets/4.png" alt="4" width="12" height="12"/></a>
    flat_team_df_ordered = flat_team_df_ordered[
        flat_team_df_ordered['league_id'] == selected_league]</pre>
<dl class="calloutlist">
<dt><a class="co" id="callout_using_apis_in_streamlit_data_apps_CO4-1" href="#co_using_apis_in_streamlit_data_apps_CO4-1"><img src="assets/1.png" alt="1" width="12" height="12"/></a></dt>
<dd><p>This library will be used to format a bar chart on this page.</p></dd>
<dt><a class="co" id="callout_using_apis_in_streamlit_data_apps_CO4-2" href="#co_using_apis_in_streamlit_data_apps_CO4-2"><img src="assets/2.png" alt="2" width="12" height="12"/></a></dt>
<dd><p>This retrieves the API data that was created in the Team Rosters page.</p></dd>
<dt><a class="co" id="callout_using_apis_in_streamlit_data_apps_CO4-3" href="#co_using_apis_in_streamlit_data_apps_CO4-3"><img src="assets/3.png" alt="3" width="12" height="12"/></a></dt>
<dd><p>This retrieves the <code>unique_leagues</code> that was created on the Team Rosters page and adds a select box to the sidebar.</p></dd>
<dt><a class="co" id="callout_using_apis_in_streamlit_data_apps_CO4-4" href="#co_using_apis_in_streamlit_data_apps_CO4-4"><img src="assets/4.png" alt="4" width="12" height="12"/></a></dt>
<dd><p>These filter the DataFrame to match the <code>league_id</code> from the select box in the navigation bar.</p></dd>
</dl>

<p>You are not limited to the data available in the SportsWorldCentral API—​you can combine it with external sources. <a data-type="indexterm" data-primary="nflverse open source libraries" data-secondary="nfl_data_py data library" data-tertiary="gsis_id to join Streamlit stats page" id="id2151"/><a data-type="indexterm" data-primary="Streamlit" data-secondary="team stats page created" data-tertiary="joining nfl_data_py library on gsis_id" id="id2152"/><a data-type="indexterm" data-primary="gsis_id" data-secondary="Streamlit team stats page joining nfl_data_py library" id="id2153"/>For the Team Stats page, you will enrich your data from the nfl_data_py library by joining on the <code>GSIS_ID</code> value. This allows your app to build a bar chart with touchdown data, which was not available in the API.</p>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p>In <a data-type="xref" href="part01.html#part_1">Part I</a> of this book, you chose to include the <code>gsis_id</code> in your API, which comes from the NFL’s Game Statistics and Information System. You didn’t need it for your internal operations, but you decided it would benefit data science users who wanted to join your data to external sources. That extra thought is going to pay off now for your users, because it allows you to join your API data to data from nfl_data_py.</p>
</div>

<p>The remaining code in this page first loads the data from nfl_data_py into a pandas DataFrame, selects four columns, then creates a new <code>total_tds</code> column. Next, the code uses the <code>merge</code> command to join the API data to the nfl_data_py data, aggregates it, and displays a chart.</p>

<p class="less_space pagebreak-before">Add the following code to <em>page2.py</em>:</p>

<pre data-type="programlisting" data-code-language="python">nfl_data_2023_df = nfl.import_seasonal_data([2023], 'REG') <a class="co" id="co_using_apis_in_streamlit_data_apps_CO5-1" href="#callout_using_apis_in_streamlit_data_apps_CO5-1"><img src="assets/1.png" alt="1" width="12" height="12"/></a>

 columns_to_select = [
       'player_id', 'passing_tds', 'rushing_tds', 'receiving_tds'] <a class="co" id="co_using_apis_in_streamlit_data_apps_CO5-2" href="#callout_using_apis_in_streamlit_data_apps_CO5-2"><img src="assets/2.png" alt="2" width="12" height="12"/></a>
    nfl_data_2023_subset_df = nfl_data_2023_df[columns_to_select].copy() 

    nfl_data_2023_subset_df['total_tds'] = ( <a class="co" id="co_using_apis_in_streamlit_data_apps_CO5-3" href="#callout_using_apis_in_streamlit_data_apps_CO5-3"><img src="assets/3.png" alt="3" width="12" height="12"/></a>
        nfl_data_2023_subset_df['passing_tds'] + 
        nfl_data_2023_subset_df['rushing_tds'] + 
        nfl_data_2023_subset_df['receiving_tds']
    )

    merged_df = pd.merge(  <a class="co" id="co_using_apis_in_streamlit_data_apps_CO5-4" href="#callout_using_apis_in_streamlit_data_apps_CO5-4"><img src="assets/4.png" alt="4" width="12" height="12"/></a>
        flat_team_df_ordered,
        nfl_data_2023_subset_df,
        how='left',   
        left_on='gsis_id',
        right_on='player_id'
    )

    grouped_df = merged_df.groupby('team_name')['total_tds'].sum() <a class="co" id="co_using_apis_in_streamlit_data_apps_CO5-5" href="#callout_using_apis_in_streamlit_data_apps_CO5-5"><img src="assets/5.png" alt="5" width="12" height="12"/></a>

    fig, ax = plt.subplots() <a class="co" id="co_using_apis_in_streamlit_data_apps_CO5-6" href="#callout_using_apis_in_streamlit_data_apps_CO5-6"><img src="assets/6.png" alt="6" width="12" height="12"/></a>
    grouped_df.plot(kind="barh", xlabel='Total TDs', 
                    ylabel="Team Name", title="Total TDs - 2023", ax=ax)
    
    st.pyplot(fig) <a class="co" id="co_using_apis_in_streamlit_data_apps_CO5-7" href="#callout_using_apis_in_streamlit_data_apps_CO5-7"><img src="assets/7.png" alt="7" width="12" height="12"/></a>


except Exception as e:
    st.write(f"An unexpected error occurred: {str(e)}")</pre>
<dl class="calloutlist">
<dt><a class="co" id="callout_using_apis_in_streamlit_data_apps_CO5-1" href="#co_using_apis_in_streamlit_data_apps_CO5-1"><img src="assets/1.png" alt="1" width="12" height="12"/></a></dt>
<dd><p>This command calls the <code>import_seasonal_data</code> method from nfl_data_py and requests 2023 regular season data.</p></dd>
<dt><a class="co" id="callout_using_apis_in_streamlit_data_apps_CO5-2" href="#co_using_apis_in_streamlit_data_apps_CO5-2"><img src="assets/2.png" alt="2" width="12" height="12"/></a></dt>
<dd><p>The next two lines build a list with the column names you want and create a DataFrame with the columns identified in the previous step.</p></dd>
<dt><a class="co" id="callout_using_apis_in_streamlit_data_apps_CO5-3" href="#co_using_apis_in_streamlit_data_apps_CO5-3"><img src="assets/3.png" alt="3" width="12" height="12"/></a></dt>
<dd><p>These add a new calculated field to the DataFrame with the combined touchdowns for the team.</p></dd>
<dt><a class="co" id="callout_using_apis_in_streamlit_data_apps_CO5-4" href="#co_using_apis_in_streamlit_data_apps_CO5-4"><img src="assets/4.png" alt="4" width="12" height="12"/></a></dt>
<dd><p>This statement uses the <code>pandas.merge()</code> function,<a data-type="indexterm" data-primary="pandas library" data-secondary="DataFrame storage of data" data-tertiary="merging DataFrames into single" id="id2154"/><a data-type="indexterm" data-primary="pandas library" data-secondary="pandas.merge() function to join DataFrames" id="id2155"/> which allows you to join two DataFrames. You are merging the API DataFrame and the nfl_data_py <span class="keep-together">DataFrame.</span></p></dd>
<dt><a class="co" id="callout_using_apis_in_streamlit_data_apps_CO5-5" href="#co_using_apis_in_streamlit_data_apps_CO5-5"><img src="assets/5.png" alt="5" width="12" height="12"/></a></dt>
<dd><p>The pandas <code>groupby</code> statement<a data-type="indexterm" data-primary="pandas library" data-secondary="groupby statement" id="id2156"/> combines all the players for each team and sums the value in the <code>total_tds</code> column.</p></dd>
<dt><a class="co" id="callout_using_apis_in_streamlit_data_apps_CO5-6" href="#co_using_apis_in_streamlit_data_apps_CO5-6"><img src="assets/6.png" alt="6" width="12" height="12"/></a></dt>
<dd><p>The next two statements build a bar chart using pandas and the matplotlib library.</p></dd>
<dt><a class="co" id="callout_using_apis_in_streamlit_data_apps_CO5-7" href="#co_using_apis_in_streamlit_data_apps_CO5-7"><img src="assets/7.png" alt="7" width="12" height="12"/></a></dt>
<dd><p>This uses Streamlit’s <code>pyplot()</code> function to display the plot created in the previous steps.<a data-type="indexterm" data-primary="Streamlit" data-secondary="pyplot() function" id="id2157"/></p></dd>
</dl>

<p>You will see the display of the Team Rosters page, as shown in <a data-type="xref" href="#team_stats_page_ch11">Figure 11-6</a>.</p>

<figure><div id="team_stats_page_ch11" class="figure">
<img src="assets/haad_1106.png" alt="Team stats page" width="1424" height="856"/>
<h6><span class="label">Figure 11-6. </span>Team Stats page</h6>
</div></figure>

<p>To see the final structure of your Streamlit app, execute the <code>tree</code> command as <span class="keep-together">follows:</span></p>

<pre data-type="programlisting" data-code-language="shell">.../streamlit (main) $  tree --prune -I 'build|*.egg-info|__pycache__'
.
├── football_app.log
├── page1.py
├── page2.py
├── streamlit_football_app.py
└── swc_simple_client.py

1 directory, 5 files</pre>

<p>Congratulations, you’ve created a data app using Streamlit that calls the SportsWorldCentral API and combines it with NFL data from the nfl_data_py library.<a data-type="indexterm" data-startref="ch11stats" id="id2158"/></p>
</div></section>






<section data-type="sect1" data-pdf-bookmark="Deploying Your Streamlit App"><div class="sect1" id="id208">
<h1>Deploying Your Streamlit App</h1>

<p>If you are going to show off <a data-type="indexterm" data-primary="Streamlit" data-secondary="deploying Streamlit app" id="id2159"/>your data science apps, you need to have them on the web. <a data-type="indexterm" data-primary="deploying to the cloud" data-secondary="Streamlit Community Cloud" id="id2160"/><a data-type="indexterm" data-primary="Streamlit" data-secondary="deploying Streamlit app" data-tertiary="Streamlit Community Cloud" id="id2161"/>Streamlit Community Cloud is a free hosting option that allows you to deploy your app from your GitHub repository. One downside is that the app does not run continually—it periodically goes to sleep and the user has to wake it up. <a data-type="indexterm" data-primary="Streamlit" data-secondary="deploying Streamlit app" data-tertiary="Streamlit Community Cloud instructions online" id="id2162"/><a data-type="indexterm" data-primary="resources online" data-secondary="Streamlit" data-tertiary="deploying to Community Cloud" id="id2163"/>To deploy to Streamlit Community Cloud, follow the <a href="https://oreil.ly/rJgTG">instructions from the Streamlit documentation</a>.</p>

<p>In addition to these two hosts, <a data-type="indexterm" data-primary="Streamlit" data-secondary="deploying Streamlit app" data-tertiary="tutorials on deployment online" id="id2164"/><a data-type="indexterm" data-primary="resources online" data-secondary="Streamlit" data-tertiary="deployment tutorials" id="id2165"/>Streamlit links to other <a href="https://oreil.ly/ZQXl4">deployment tutorials</a> that you can follow. For the most part, these charge for <span class="keep-together">hosting.</span></p>
</div></section>






<section data-type="sect1" data-pdf-bookmark="Completing Your Part II Portfolio Project"><div class="sect1" id="id209">
<h1>Completing Your Part II Portfolio Project</h1>

<p>You have reached the end of Part II,<a data-type="indexterm" data-primary="portfolio projects" data-secondary="Part II project ready to share" id="id2166"/><a data-type="indexterm" data-primary="Codespaces (GitHub)" data-secondary="Part II project ready to share" id="id2167"/><a data-type="indexterm" data-primary="GitHub" data-secondary="Part II project ready to share" id="id2168"/><a data-type="indexterm" data-primary="publishing" data-secondary="Part II project ready to share" id="id2169"/> congratulations! As you did with <a data-type="xref" href="part01.html#part_1">Part I</a>, you will perform some housekeeping to get the portfolio project cleaned up and ready to share. You’ll move the code out of the chapter folders into functional folders.</p>

<p>Before you make these changes, you’ll save a copy of your files to a separate GitHub branch, named <em>learning-branch</em>, so that the files are still available if you want to continue working through the code.</p>

<p>Create the new branch from the command line as follows:<a data-type="indexterm" data-primary="Codespaces (GitHub)" data-secondary="Part II project ready to share" data-tertiary="creating new branch" id="id2170"/><a data-type="indexterm" data-primary="GitHub" data-secondary="Part II project ready to share" data-tertiary="creating new branch" id="id2171"/></p>

<pre data-type="programlisting" data-code-language="shell">.../analytics-project/ (main) $ git checkout -b learning-branch <a class="co" id="co_using_apis_in_streamlit_data_apps_CO6-1" href="#callout_using_apis_in_streamlit_data_apps_CO6-1"><img src="assets/1.png" alt="1" width="12" height="12"/></a>
Switched to a new branch 'learning-branch'
.../analytics-project/ (main) $ git push -u origin learning-branch <a class="co" id="co_using_apis_in_streamlit_data_apps_CO6-2" href="#callout_using_apis_in_streamlit_data_apps_CO6-2"><img src="assets/2.png" alt="2" width="12" height="12"/></a>
 * [new branch]      learning-branch -&gt; learning-branch
branch 'learning-branch' set up to track 'origin/learning-branch'.</pre>
<dl class="calloutlist">
<dt><a class="co" id="callout_using_apis_in_streamlit_data_apps_CO6-1" href="#co_using_apis_in_streamlit_data_apps_CO6-1"><img src="assets/1.png" alt="1" width="12" height="12"/></a></dt>
<dd><p>Create a new branch named <em>learning-branch</em> locally based on the <em>main</em> branch.</p></dd>
<dt><a class="co" id="callout_using_apis_in_streamlit_data_apps_CO6-2" href="#co_using_apis_in_streamlit_data_apps_CO6-2"><img src="assets/2.png" alt="2" width="12" height="12"/></a></dt>
<dd><p>Push this new branch to your remote repository on GitHub.com.</p></dd>
</dl>

<p>Next, you will make some changes to the directory structure. Enter these  commands:<a data-type="indexterm" data-primary="Codespaces (GitHub)" data-secondary="Part II project ready to share" data-tertiary="moving files" id="id2172"/><a data-type="indexterm" data-primary="GitHub" data-secondary="Part II project ready to share" data-tertiary="moving files" id="id2173"/></p>

<pre data-type="programlisting" data-code-language="shell">.../analytics-project/ (learning-branch) $ git checkout main <a class="co" id="co_using_apis_in_streamlit_data_apps_CO7-1" href="#callout_using_apis_in_streamlit_data_apps_CO7-1"><img src="assets/1.png" alt="1" width="12" height="12"/></a>
Switched to branch 'main'
Your branch is up to date with 'origin/main'.
.../analytics-project/ (main) $ rm -rf chapter9/complete
.../analytics-project/ (main) $ rm -rf chapter10/complete
.../analytics-project/ (main) $ rm -rf chapter11/complete
.../analytics-project/ (main) $ mv chapter9/notebooks .
.../analytics-project/ (main) $ mkdir airflow <a class="co" id="co_using_apis_in_streamlit_data_apps_CO7-2" href="#callout_using_apis_in_streamlit_data_apps_CO7-2"><img src="assets/2.png" alt="2" width="12" height="12"/></a>
.../analytics-project/ (main) $ mv chapter10/* airflow <a class="co" id="co_using_apis_in_streamlit_data_apps_CO7-3" href="#callout_using_apis_in_streamlit_data_apps_CO7-3"><img src="assets/3.png" alt="3" width="12" height="12"/></a>
.../analytics-project/ (main) $ mv chapter11/streamlit . <a class="co" id="co_using_apis_in_streamlit_data_apps_CO7-4" href="#callout_using_apis_in_streamlit_data_apps_CO7-4"><img src="assets/4.png" alt="4" width="12" height="12"/></a>
.../analytics-project/ (main) $ rm -rf chapter9 <a class="co" id="co_using_apis_in_streamlit_data_apps_CO7-5" href="#callout_using_apis_in_streamlit_data_apps_CO7-5"><img src="assets/5.png" alt="5" width="12" height="12"/></a>
.../analytics-project/ (main) $ rm -rf chapter10
.../analytics-project/ (main) $ rm -rf chapter11</pre>
<dl class="calloutlist">
<dt><a class="co" id="callout_using_apis_in_streamlit_data_apps_CO7-1" href="#co_using_apis_in_streamlit_data_apps_CO7-1"><img src="assets/1.png" alt="1" width="12" height="12"/></a></dt>
<dd><p>Switch your Codespace back to the <em>main</em> branch of your repository.</p></dd>
<dt><a class="co" id="callout_using_apis_in_streamlit_data_apps_CO7-2" href="#co_using_apis_in_streamlit_data_apps_CO7-2"><img src="assets/2.png" alt="2" width="12" height="12"/></a></dt>
<dd><p>Make a new directory for the files from Chapter 10.</p></dd>
<dt><a class="co" id="callout_using_apis_in_streamlit_data_apps_CO7-3" href="#co_using_apis_in_streamlit_data_apps_CO7-3"><img src="assets/3.png" alt="3" width="12" height="12"/></a></dt>
<dd><p>Move Chapter 10’s <em>airflow</em> files to the new folder.</p></dd>
<dt><a class="co" id="callout_using_apis_in_streamlit_data_apps_CO7-4" href="#co_using_apis_in_streamlit_data_apps_CO7-4"><img src="assets/4.png" alt="4" width="12" height="12"/></a></dt>
<dd><p>Move Chapter 11’s <em>streamlit</em> folder to the root directory.</p></dd>
<dt><a class="co" id="callout_using_apis_in_streamlit_data_apps_CO7-5" href="#co_using_apis_in_streamlit_data_apps_CO7-5"><img src="assets/5.png" alt="5" width="12" height="12"/></a></dt>
<dd><p>Remove all the subdirectories and their files.</p></dd>
</dl>

<p>To see the directory structure of the completed project, run the following command:</p>

<pre data-type="programlisting" data-code-language="shell">.../portfolio-project (main) $ tree -d  --prune -I 'build|*.egg-info|__pycache__'
.
├── airflow
├── api
├── notebooks
└── streamlit

4 directories</pre>

<p>Update the <em>README.md</em> file with<a data-type="indexterm" data-primary="Codespaces (GitHub)" data-secondary="Part II project ready to share" data-tertiary="updating README.md" id="id2174"/><a data-type="indexterm" data-primary="GitHub" data-secondary="Part II project ready to share" data-tertiary="updating README.md" id="id2175"/> the following at a minimum, then add your own thoughts about what you’ve learned in your project and how you’ve customized it:</p>

<pre data-type="programlisting" data-code-language="markdown"># Analytics Portfolio Project
This repository contains programs using industry-standard Python frameworks,
based on projects from the book _Hands-on APIs for AI and Data Science_
written by Ryan Day.</pre>

<p>Now commit these changes to GitHub, and your Part II portfolio project is ready to share with the world. Congratulations on completing your Part II capstone!</p>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="id2176">
<h1>Extending Your Portfolio Project</h1>
<p>Here are a few ideas to extend your Streamlit project:<a data-type="indexterm" data-primary="portfolio projects" data-secondary="Streamlit project extended" id="id2177"/><a data-type="indexterm" data-primary="Streamlit" data-secondary="portfolio project extended" id="id2178"/></p>

<ul>
<li>
<p>Implement <a href="https://oreil.ly/_CVQ6">Streamlit caching</a> in your API calls to improve performance in your application.</p>
</li>
<li>
<p>Create additional visualizations with the built-in <a href="https://oreil.ly/SdstJ">Streamlit chart elements</a>.</p>
</li>
</ul>
</div></aside>
</div></section>






<section data-type="sect1" data-pdf-bookmark="Additional Resources"><div class="sect1" id="id123">
<h1>Additional Resources</h1>

<p>If you’d like to learn more about the components of Streamlit, the <a href="https://docs.streamlit.io">Streamlit documentation</a> is well written and easy to use.<a data-type="indexterm" data-primary="Streamlit" data-secondary="documentation online" id="id2179"/><a data-type="indexterm" data-primary="resources online" data-secondary="Streamlit" data-tertiary="documentation" id="id2180"/></p>

<p>Tyler Richards’ <em>Streamlit for Data Science, 2nd Edition</em> (Packt Publishing, 2023), is a thorough reference for using Streamlit in data science applications.<a data-type="indexterm" data-primary="Streamlit for Data Science, 2nd Edition (Richards)" id="id2181"/><a data-type="indexterm" data-primary="Richards, Tyler" id="id2182"/></p>

<p>For a quick reference on Streamlit commands, view the official <a href="https://oreil.ly/RirMd">Streamlit Cheat Sheet</a>.<a data-type="indexterm" data-primary="Streamlit" data-secondary="command cheat sheet online" id="id2183"/><a data-type="indexterm" data-primary="resources online" data-secondary="Streamlit" data-tertiary="command cheat sheet" id="id2184"/></p>
</div></section>






<section data-type="sect1" data-pdf-bookmark="Summary"><div class="sect1" id="id391">
<h1>Summary</h1>

<p>In this chapter, you built an interactive data app with Streamlit. You consumed data from your SportsWorldCentral API and displayed that data in your app. Then, you combined it with NFL data from a Python library and created a chart with the data.</p>

<p>In <a data-type="xref" href="ch12.html#chapter_12">Chapter 12</a>, you will start learning how to use APIs with artificial intelligence.</p>
</div></section>
</div></section></div>
</div>
</body></html>