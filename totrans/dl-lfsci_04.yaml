- en: Chapter 4\. Machine Learning for Molecules
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 分子是复杂的实体，研究人员已经开发了许多不同的技术来对其进行特征化。这些表示包括化学描述符向量，2D图表示，3D静电网格表示，轨道基函数表示等等。
- en: This chapter covers the basics of performing machine learning on molecular data.
    Before we dive into the chapter, it might help for us to briefly discuss why molecular
    machine learning can be a fruitful subject of study. Much of modern materials
    science and chemistry is driven by the need to design new molecules that have
    desired properties. While significant scientific work has gone into new design
    strategies, much random search is sometimes still needed to construct interesting
    molecules. The dream of molecular machine learning is to replace such random experimentation
    with guided search, where machine-learned predictors can propose which new molecules
    might have desired properties. Such accurate predictors could enable the creation
    of radically new materials and chemicals with useful properties.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦特征化，分子仍然需要进行学习。我们将回顾一些用于学习分子功能的算法，包括简单的全连接网络以及更复杂的技术，如图卷积。我们还将描述图卷积技术的一些局限性，以及我们应该期望和不应该期望的内容。我们将以一个有趣数据集上的分子机器学习案例研究结束本章。
- en: This dream is compelling, but how can we get started on this path? The first
    step is to construct technical methods for transforming molecules into vectors
    of numbers that can then be passed to learning algorithms. Such methods are called
    *molecular featurizations*. We will cover a number of them in this chapter, and
    more in the next chapter.Molecules are complex entities, and researchers have
    developed a host of different techniques for featurizing them. These representations
    include chemical descriptor vectors, 2D graph representations, 3D electrostatic
    grid representations, orbital basis function representations, and more.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 这个梦想很吸引人，但我们如何开始这条道路呢？第一步是构建技术方法，将分子转化为数字向量，然后将其传递给学习算法。这些方法被称为*分子特征化*。我们将在本章中涵盖其中一些，并在下一章中涵盖更多。
- en: Once featurized, a molecule still needs to be learned from. We will review some
    algorithms for learning functions on molecules, including simple fully connected
    networks as well as more sophisticated techniques like graph convolutions. We’ll
    also describe some of the limitations of graph convolutional techniques, and what
    we should and should not expect from them. We’ll end the chapter with a molecular
    machine learning case study on an interesting dataset.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 在深入研究分子机器学习之前，回顾一下分子到底是什么将是有用的。这个问题听起来有点愚蠢，因为像H[2]O和CO[2]这样的分子甚至被介绍给年幼的孩子。答案不是显而易见的。然而，事实是，对于绝大多数人类的存在，我们根本不知道分子的存在。考虑一个思想实验：你如何说服一个怀疑的外星人分子实体存在？答案是相当复杂的。例如，你可能需要使用质谱仪！
- en: What Is a Molecule?
  id: totrans-4
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 本章涵盖了在分子数据上执行机器学习的基础知识。在深入研究本章之前，我们简要讨论一下为什么分子机器学习可能是一个有益的研究课题。现代材料科学和化学的许多工作都是出于设计具有期望性质的新分子的需要。虽然已经进行了大量的科学工作来开发新的设计策略，但有时仍然需要进行大量的随机搜索来构建有趣的分子。分子机器学习的梦想是用引导搜索取代这种随机实验，机器学习预测器可以提出哪些新分子可能具有期望的性质。这样准确的预测器可以促进创造具有有用性质的全新材料和化学品。什么是分子？
- en: 'Before we dive into molecular machine learning in depth, it will be useful
    to review what exactly a molecule is. This question sounds a little silly, since
    molecules like H[2]O and CO[2] are introduced to even young children. Isn’t the
    answer obvious? The fact is, though, that for the vast majority of human existence,
    we had no idea that molecules existed at all. Consider a thought experiment: how
    would you convince a skeptical alien that entities called molecules exist? The
    answer turns out to be quite sophisticated. You might, for example, need to break
    out a mass spectrometer!'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 确定给定样本中存在的分子可能是非常具有挑战性的。目前最流行的技术依赖于质谱。质谱的基本思想是用电子轰击样本。这种轰击会将分子破碎成碎片。这些碎片通常会*电离*，即吸收或失去电子而带电。这些带电碎片被电场推动，根据它们的质荷比分离它们。检测到的带电碎片的分布被称为*光谱*。[图4-1](#a_simple_schematic_of_a_mass_spectrometer)说明了这个过程。从检测到的碎片集合中，通常可以确定原始样本中存在的精确分子。然而，这个过程仍然是有损失和困难的。许多研究人员正在积极研究利用深度学习算法改进质谱技术，以便从检测到的带电光谱中更容易地识别原始分子。
- en: Mass Spectroscopy
  id: totrans-6
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 质谱
- en: Identifying the molecules that are present in a given sample can be quite challenging.
    The most popular technique at present relies on mass spectroscopy. The basic idea
    of mass spectroscopy is to bombard a sample with electrons. This bombardment shatters
    the molecules into fragments. These fragments typically *ionize*—that is, pick
    up or lose electrons to become charged. These charged fragments are propelled
    by an electric field which separates them based on their mass-to-charge ratio.
    The spread of detected charged fragments is called the *spectrum*. [Figure 4-1](#a_simple_schematic_of_a_mass_spectrometer)
    illustrates this process. From the collection of detected fragments, it is often
    possible to identify the precise molecules that were in the original sample. However,
    this process is still lossy and difficult. A number of researchers are actively
    researching techniques to improve mass spectroscopy with deep learning algorithms
    to ease the identification of the original molecules from the detected charged
    spectrum.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 第四章。分子的机器学习
- en: Note the complexity of performing this detection! Molecules are complicated
    entities that are tricky to pin down precisely.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 注意执行此检测的复杂性！分子是复杂的实体，很难准确地确定。
- en: For the sake of getting started, let’s presume a definition of a molecule as
    a group of atoms joined together by physical forces. Molecules are the smallest
    fundamental unit of a chemical compound that can take part in a chemical reaction.
    Atoms in a molecule are connected with one another by *chemical bonds*, which
    hold them together and restrict their motion relative to each other. Molecules
    come in a huge range of sizes, from just a few atoms up to many thousands of atoms.
    [Figure 4-2](#heres_a_simple_representation_of_a_caffeine) provides a simple depiction
    of a molecule in this model.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 为了开始，让我们假设一个分子的定义是一组由物理力连接在一起的原子。分子是化合物中最小的基本单位，可以参与化学反应。分子中的原子通过*化学键*连接在一起，这些键将它们粘在一起并限制它们相对于彼此的运动。分子的大小范围很广，从只有几个原子到成千上万个原子不等。[图4-2](#这里是一个咖啡因的简单表示)提供了这种模型中分子的简单描述。
- en: '![A simple schematic of a mass spectrometer.](Images/dlls_0401.png)'
  id: totrans-10
  prefs: []
  type: TYPE_IMG
  zh: '![一个质谱仪的简单示意图。](Images/dlls_0401.png)'
- en: 'Figure 4-1\. A simple schematic of a mass spectrometer. (Source: [Wikimedia](https://commons.wikimedia.org/wiki/File:Mass_Spectrometer_Schematic.svg).)'
  id: totrans-11
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图4-1. 一个质谱仪的简单示意图。（来源：[Wikimedia](https://commons.wikimedia.org/wiki/File:Mass_Spectrometer_Schematic.svg).）
- en: '![A simple representation of a caffeine molecule as a ball-and-stick diagram.
    Atoms are represented as colored balls (black is carbon, red is oxygen, blue is
    nitrogen, white is hydrogen) joined by sticks which represent chemical bonds.](Images/dlls_0402.png)'
  id: totrans-12
  prefs: []
  type: TYPE_IMG
  zh: '![一个咖啡因分子的球棒图示。原子用彩色球体表示（黑色是碳，红色是氧，蓝色是氮，白色是氢），由代表化学键的棍子连接。](Images/dlls_0402.png)'
- en: Figure 4-2\. A simple representation of a caffeine molecule as a “ball-and-stick”
    diagram. Atoms are represented as colored balls (black is carbon, red is oxygen,
    blue is nitrogen, white is hydrogen) joined by sticks which represent chemical
    bonds.
  id: totrans-13
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图4-2. 一个咖啡因分子的“球棒”图示。原子用彩色球体表示（黑色是碳，红色是氧，蓝色是氮，白色是氢），由代表化学键的棍子连接。
- en: With this basic description in hand, we’ll spend the next couple of sections
    diving into more detail about various aspects of molecular chemistry. It’s not
    critical that you get all of these concepts on your first reading of this chapter,
    but it can be useful to have some basic knowledge of the chemical landscape at
    hand.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 有了这个基本描述，我们将在接下来的几节中深入探讨分子化学的各个方面的更多细节。在第一次阅读本章时，您不必完全掌握所有这些概念，但掌握一些化学领域的基本知识可能会有用。
- en: Molecules Are Dynamic, Quantum Entities
  id: totrans-15
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 分子是动态的、量子实体
- en: We’ve just provided a simplistic description of molecules in terms of atoms
    and bonds. It’s very important to keep in the back of your mind that there’s a
    lot more going on within any molecule. For one, molecules are dynamic entities,
    so all the atoms within a given molecule are in rapid motion with respect to one
    another. The bonds themselves are stretching back and forth and perhaps oscillating
    in length rapidly. It’s quite common for atoms to rapidly break off from and rejoin
    molecules. We’ll see a bit more about the dynamic nature of molecules shortly,
    when we discuss molecular conformations.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 我们刚刚提供了一个关于原子和键的分子的简单描述。非常重要的是要记住，在任何分子内部都有更多的事情发生。首先，分子是动态实体，因此给定分子内的所有原子都在相互之间快速运动。键本身在伸缩和快速振动长度方面。原子很常见地会迅速从分子中脱离并重新加入。当我们讨论分子构象时，我们很快会看到更多关于分子动态性质的内容。
- en: Even more strangely, molecules are quantum. There are a lot of layers to saying
    that an entity is quantum, but as a simple description, it’s important to note
    that “atoms” and “bonds” are much less well defined than a simple ball-and-stick
    diagram might imply. There’s a lot of fuzziness in the definitions here. It’s
    not important that you grasp these complexities at this stage, but remember that
    our depictions of molecules are very approximate. This can have practical relevance,
    since some learning tasks may require describing molecules with different depictions
    than others.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 更奇怪的是，分子是量子的。说一个实体是量子有很多层面，但简单来说，重要的是要注意，“原子”和“键”远没有简单的球棒图表所暗示的那么明确定义。在这里的定义中有很多模糊性。在这个阶段理解这些复杂性并不重要，但要记住我们对分子的描述是非常近似的。这可能具有实际意义，因为有些学习任务可能需要用不同的描述来描述分子。
- en: What Are Molecular Bonds?
  id: totrans-18
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 分子键是什么？
- en: It may have been a while since you studied basic chemistry, so we will spend
    time reviewing basic chemical concepts here and there. The most basic question
    is, what is a chemical bond?
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 您可能已经有一段时间没有学习基础化学了，所以我们将花时间在这里和那里复习基本化学概念。最基本的问题是，化学键是什么？
- en: The molecules that make up everyday life are made of atoms, often very large
    numbers of them. These atoms are joined together by chemical bonds. These bonds
    essentially “glue” together atoms by their shared electrons. There are many different
    types of molecular bonds, including covalent bonds and several types of noncovalent
    bonds.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 构成日常生活的分子由原子组成，通常是非常大量的原子。这些原子通过化学键连接在一起。这些键基本上通过它们共享的电子将原子“粘”在一起。有许多不同类型的分子键，包括共价键和几种非共价键。
- en: Covalent bonds
  id: totrans-21
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 共价键
- en: 'Covalent bonds involve sharing electrons between two atoms, such that the same
    electrons spend time around both atoms ([Figure 4-3](#two-atomic-nuclei)). In
    general, covalent bonds are the strongest type of chemical bond. They are formed
    and broken in chemical reactions. Covalent bonds tend to be very stable: once
    they form, it takes a lot of energy to break them, so the atoms can remain bonded
    for a very long time. This is why molecules behave as distinct objects rather
    than loose collections of unrelated atoms. In fact, covalent bonds are what define
    molecules: a molecule is a set of atoms joined by covalent bonds.'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 共价键涉及两个原子之间的电子共享，使得相同的电子在两个原子周围花费时间（[图4-3](#two-atomic-nuclei)）。一般来说，共价键是最强的化学键类型。它们在化学反应中形成和断裂。共价键往往非常稳定：一旦形成，就需要大量能量来断裂，因此原子可以长时间保持结合。这就是为什么分子表现为独立的对象而不是无关的原子松散集合。事实上，共价键是定义分子的东西：分子是由共价键连接的一组原子。
- en: '![Left: two atomic nuclei, each surrounded by a cloud of electrons. Right:
    as the atoms come close together, the electrons start spending more time in the
    space between the nuclei. This attracts the nuclei together, forming a covalent
    bond between the atoms.](Images/dlls_0403.png)'
  id: totrans-23
  prefs: []
  type: TYPE_IMG
  zh: '![左：两个被电子云包围的原子核。右：当原子靠近时，电子开始在原子核之间的空间中花费更多时间。这会吸引原子核靠近，形成原子之间的共价键。](Images/dlls_0403.png)'
- en: 'Figure 4-3\. Left: two atomic nuclei, each surrounded by a cloud of electrons.
    Right: as the atoms come close together, the electrons start spending more time
    in the space between the nuclei. This attracts the nuclei together, forming a
    covalent bond between the atoms.'
  id: totrans-24
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图4-3。左：两个被电子云包围的原子核。右：当原子靠近时，电子开始在原子核之间的空间中花费更多时间。这会吸引原子核靠近，形成原子之间的共价键。
- en: Noncovalent bonds
  id: totrans-25
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 非共价键
- en: Noncovalent bonds don’t involve the direct sharing of electrons between atoms,
    but they do involve weaker electromagnetic interactions. Since they are not as
    strong as covalent bonds, they are more ephemeral, constantly breaking and reforming.
    Noncovalent bonds do not “define” molecules in the same sense that covalent bonds
    do, but they have a huge effect on determining the shapes molecules take on and
    the ways different molecules associate with each other.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 非共价键不涉及原子之间的电子直接共享，但涉及较弱的电磁相互作用。由于它们不像共价键那样强，它们更加短暂，不断地断裂和重组。非共价键不像共价键那样“定义”分子，但它们对决定分子形状和不同分子之间相互关联的方式有巨大影响。
- en: “Noncovalent bonds” is a generic term covering several different types of interactions.
    Some examples of noncovalent bonds include hydrogen bonds ([Figure 4-4](#water-molecules)),
    salt bridges, pi-stacking, and more. These types of interactions often play crucial
    roles in drug design, since most drugs interact with biological molecules in the
    human body through noncovalent interactions.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: “非共价键”是一个泛指，涵盖了几种不同类型的相互作用。一些非共价键的例子包括氢键（[图4-4](#water-molecules)）、盐桥、π-堆叠等。这些类型的相互作用在药物设计中通常起着至关重要的作用，因为大多数药物通过非共价相互作用与人体内的生物分子相互作用。
- en: '![Water molecules have strong hydrogen bonding interactions between hydrogen
    and oxygen on adjacent molecules. A strong network of hydrogen bonds contributes
    in part to water''s power as a solvent.](Images/dlls_0404.png)'
  id: totrans-28
  prefs: []
  type: TYPE_IMG
  zh: '![水分子之间的氢键相互作用很强，氢与相邻分子上的氧之间存在氢键。强大的氢键网络在一定程度上有助于水作为溶剂的作用。](Images/dlls_0404.png)'
- en: 'Figure 4-4\. Water molecules have strong hydrogen bonding interactions between
    hydrogen and oxygen on adjacent molecules. A strong network of hydrogen bonds
    contributes in part to water’s power as a solvent. (Source: [Wikimedia](https://commons.wikimedia.org/wiki/File:SimpleBayesNet.svg).)'
  id: totrans-29
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图4-4。水分子之间的氢键相互作用很强，氢与相邻分子上的氧之间存在氢键。强大的氢键网络在一定程度上有助于水作为溶剂的作用。（来源：[维基共享资源](https://commons.wikimedia.org/wiki/File:SimpleBayesNet.svg)。）
- en: We’ll run into each of these types of bonds at various points in the book. In
    this chapter, we will mostly deal with covalent bonds, but noncovalent interactions
    will become much more crucial when we start studying some biophysical deep models.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 在本书的不同部分我们会遇到这些类型的键。在本章中，我们将主要讨论共价键，但当我们开始研究一些生物物理深度模型时，非共价相互作用将变得更加关键。
- en: Molecular Graphs
  id: totrans-31
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 分子图
- en: A *graph* is a mathematical data structure made up of *nodes* connected together
    by *edges* ([Figure 4-5](#math-graph-six-nodes)). Graphs are incredibly useful
    abstractions in computer science. In fact, there is a whole branch of mathematics
    called graph theory dedicated to understanding the properties of graphs and finding
    ways to manipulate and analyze them. Graphs are used to describe everything from
    the computers that make up a network, to the pixels that make up an image, to
    actors who have appeared in movies with Kevin Bacon.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: '*图*是由*节点*通过*边*连接在一起的数学数据结构（[图4-5](#math-graph-six-nodes)）。图在计算机科学中是非常有用的抽象。事实上，有一个称为图论的数学分支专门用于理解图的属性并找到操纵和分析它们的方法。图被用来描述从构成网络的计算机到构成图像的像素，再到曾与凯文·贝肯一起出演电影的演员等各种事物。'
- en: '![An example of a mathematical graph with six nodes connected by edges.](Images/dlls_0405.png)'
  id: totrans-33
  prefs: []
  type: TYPE_IMG
  zh: '![一个由六个节点通过边连接的数学图的示例。](Images/dlls_0405.png)'
- en: 'Figure 4-5\. An example of a mathematical graph with six nodes connected by
    edges. (Source: [Wikimedia](https://commons.wikimedia.org/wiki/File:6n-graf.svg).)'
  id: totrans-34
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图4-5。一个由六个节点通过边连接的数学图的示例。（来源：[维基共享资源](https://commons.wikimedia.org/wiki/File:6n-graf.svg)。）
- en: Importantly, molecules can be viewed as graphs as well ([Figure 4-6](#converting-benzene)).
    In this description, the atoms are the nodes in the graph, and the chemical bonds
    are the edges. Any molecule can be converted into a corresponding molecular graph.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 重要的是，分子也可以被视为图（[图4-6](#converting-benzene)）。在这种描述中，原子是图中的节点，化学键是边。任何分子都可以转换为相应的分子图。
- en: '![An example of converting a benzene molecule into a molecular graph. Note
    that atoms are converted into nodes and chemical bonds into edges.](Images/dlls_0406.png)'
  id: totrans-36
  prefs: []
  type: TYPE_IMG
  zh: '![将苯分子转化为分子图的示例。请注意，原子被转换为节点，化学键被转换为边。](Images/dlls_0406.png)'
- en: Figure 4-6\. An example of converting a benzene molecule into a molecular graph.
    Note that atoms are converted into nodes and chemical bonds into edges.
  id: totrans-37
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图4-6。将苯分子转化为分子图的示例。请注意，原子被转换为节点，化学键被转换为边。
- en: In the remainder of this chapter, we will repeatedly convert molecules into
    graphs in order to analyze them and learn to make predictions about them.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章的其余部分，我们将反复将分子转化为图形，以便分析它们并学会对它们进行预测。
- en: Molecular Conformations
  id: totrans-39
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 分子构象
- en: 'A molecular graph describes the set of atoms in a molecule and how they are
    bonded together. But there is another very important thing we need to know: how
    the atoms are positioned relative to each other in 3D space. This is called the
    molecule’s *conformation*.'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 分子图描述了分子中的原子集合以及它们如何相互结合。但还有另一件非常重要的事情我们需要知道：原子在3D空间中相对于彼此的位置。这被称为分子的*构象*。
- en: Atoms, bonds, and conformation are related to each other. If two atoms are covalently
    bonded, that tends to fix the distance between them, strongly restricting the
    possible conformations. The angles formed by sets of three or four bonded atoms
    are also often restricted. Sometimes there will be whole clusters of atoms that
    are completely rigid, all moving together as a single unit. But other pieces of
    molecules are flexible, allowing atoms to move relative to each other. For example,
    many (but not all) covalent bonds allow the groups of atoms they connect to freely
    rotate around the axis of the bond. This lets the molecule take on many different
    conformations.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 原子、键和构象彼此相关。如果两个原子共价结合，那么它们之间的距离往往会固定，严格限制可能的构象。由三个或四个共价结合原子组成的角度也经常受到限制。有时会有整个原子团是完全刚性的，作为一个单一单位一起移动。但分子的其他部分是灵活的，允许原子相对于彼此移动。例如，许多（但不是所有）共价键允许它们连接的原子团绕键的轴自由旋转。这使得分子可以呈现许多不同的构象。
- en: 'Figure [4-7](#figure_four_seven) shows a very popular molecule: sucrose, also
    known as table sugar. It is shown both as a 2D chemical structure and as a 3D
    conformation. Sucrose consists of two rings linked together. Each of the rings
    is fairly rigid, so its shape changes very little over time. But the linker connecting
    them is much more flexible, allowing the rings to move relative to each other.'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 图[4-7](#figure_four_seven)展示了一个非常流行的分子：蔗糖，也称为食糖。它既以2D化学结构形式展示，也以3D构象形式展示。蔗糖由两个环连接在一起。每个环都相当刚性，因此其形状随时间变化很少。但连接它们的连接物更加灵活，允许环相对于彼此移动。
- en: '![Sucrose, represented as a 3D conformation and a 2D chemical structure.](Images/dlls_0407.png)'
  id: totrans-43
  prefs: []
  type: TYPE_IMG
  zh: '![蔗糖，以3D构象和2D化学结构表示。](Images/dlls_0407.png)'
- en: Figure 4-7\. Sucrose, represented as a 3D conformation and a 2D chemical structure.
    (Adapted from Wikimedia images ([Wikimedia](https://commons.wikimedia.org/wiki/File:Sucrose-3D-balls.png)
    and [Wikipedia](https://en.wikipedia.org/wiki/File:Saccharose2.svg).)
  id: totrans-44
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图4-7。蔗糖，以3D构象和2D化学结构表示。 （改编自维基媒体图像（[维基媒体](https://commons.wikimedia.org/wiki/File:Sucrose-3D-balls.png)和[维基百科](https://en.wikipedia.org/wiki/File:Saccharose2.svg)）。）
- en: As molecules get larger, the number of feasible conformations they can take
    grows enormously. For large macromolecules such as proteins ([Figure 4-8](#beta-2-microglobulin)),
    computationally exploring the set of possible conformations currently requires
    very expensive simulations.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 随着分子变得更大，它们可以采取的构象数量急剧增加。对于大型大分子，如蛋白质（[图4-8](#beta-2-microglobulin)），目前需要非常昂贵的模拟来探索可能构象的集合。
- en: '![A conformation of bacteriorhodopsin (used to capture light energy) rendered
    in 3D. Protein conformations are particularly complex, with multiple 3D geometric
    motifs, and serve as a good reminder that molecules have geometry in addition
    to their chemical formulas.](Images/dlls_0408.png)'
  id: totrans-46
  prefs: []
  type: TYPE_IMG
  zh: '![以3D形式呈现的细菌紫质的构象（用于捕获光能）。蛋白质的构象特别复杂，具有多个3D几何图案，并提醒我们分子除了化学式外还具有几何形状。](Images/dlls_0408.png)'
- en: 'Figure 4-8\. A conformation of bacteriorhodopsin (used to capture light energy)
    rendered in 3D. Protein conformations are particularly complex, with multiple
    3D geometric motifs, and serve as a good reminder that molecules have geometry
    in addition to their chemical formulas. (Source: [Wikimedia](https://upload.wikimedia.org/wikipedia/commons/thumb/d/dd/1M0K.png/480px-1M0K.png).)'
  id: totrans-47
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图4-8。以3D形式呈现的细菌紫质的构象（用于捕获光能）。蛋白质的构象特别复杂，具有多个3D几何图案，并提醒我们分子除了化学式外还具有几何形状。（来源：[维基媒体](https://upload.wikimedia.org/wikipedia/commons/thumb/d/dd/1M0K.png/480px-1M0K.png)。）
- en: Chirality of Molecules
  id: totrans-48
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 分子的手性
- en: Some molecules (including many drugs) come in two forms that are mirror images
    of each other. This is called *chirality*. A chiral molecule has both a “right-handed”
    form (also known as the “R” form) and a “left-handed” form (also known as the
    “S” form), as illustrated in [Figure 4-9](#axial-chirality).
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 一些分子（包括许多药物）有两种镜像形式。这被称为*手性*。手性分子既有“右手”形式（也称为“R”形式），也有“左手”形式（也称为“S”形式），如[图4-9](#axial-chirality)所示。
- en: '![](Images/dlls_0409.png)'
  id: totrans-50
  prefs: []
  type: TYPE_IMG
  zh: '![](Images/dlls_0409.png)'
- en: Figure 4-9\. Axial chirality of a spiro compound (a compound made up of two
    or more rings joined together). Note that the two chiral variants are respectively
    denoted as “R” and “S.” This convention is widespread in the chemistry literature.
  id: totrans-51
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图4-9。螺环化合物的轴向手性（由两个或更多环连接在一起的化合物）。请注意，这两种手性变体分别标记为“R”和“S”。这种约定在化学文献中很普遍。
- en: Chirality is very important, and also a source of much frustration both for
    laboratory chemists and computational chemists. To begin with, the chemical reactions
    that produce chiral molecules often don’t distinguish between the forms, producing
    both chiralities in equal amounts. (These products are called *racemic mixtures*.)
    So if you want to end up with just one form, your manufacturing process immediately
    becomes more complicated. In addition, many physical properties are identical
    for both chiralities, so many experiments can’t distinguish between chiral versions
    of a given molecule. The same is true of computational models. For example, both
    chiralities have identical molecular graphs, so any machine learning model that
    depends only on the molecular graph will be unable to distinguish between them.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 手性非常重要，也是实验室化学家和计算化学家的许多挫折的根源。首先，产生手性分子的化学反应通常不区分形式，会产生相等数量的两种手性。如果你想最终只得到一种形式，你的制造过程立即变得更加复杂。此外，许多物理性质对两种手性是相同的，因此许多实验无法区分给定分子的手性版本。计算模型也是如此。例如，两种手性具有相同的分子图，因此任何仅依赖于分子图的机器学习模型将无法区分它们。
- en: This wouldn’t matter so much if the two forms behaved identically in practice,
    but that often is not the case. It is possible for the two chiral forms of a drug
    to bind to totally different proteins, and to have very different effects in your
    body. In many cases, only one form of a drug has the desired therapeutic effect.
    The other form just produces extra side effects without having any benefit.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 如果两种形式在实践中表现相同，这就不会那么重要，但情况通常并非如此。一种药物的两种手性形式可能结合到完全不同的蛋白质上，并在体内产生非常不同的效果。在许多情况下，只有一种形式的药物具有期望的治疗效果。另一种形式只会产生额外的副作用而没有任何好处。
- en: One specific example of the differing effects of chiral compounds is the drug
    thalidomide, which was prescribed as a sedative in the 1950s and 1960s. This drug
    was subsequently available over the counter as a treatment for nausea and morning
    sickness associated with pregnancy. The R form of thalidomide is an effective
    sedative, while the S form is teratogenic and has been shown to cause severe birth
    defects. These difficulties are further compounded by the fact that thalidomide
    interconverts, or racemizes, between the two different forms in the body.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 手性化合物不同效应的一个具体例子是扑热息痛，这种药物在20世纪50年代和60年代被开出作为镇静剂。这种药物后来作为治疗与怀孕相关的恶心和晨吐的非处方药出售。扑热息痛的R型是有效的镇静剂，而S型是致畸的，已被证明会导致严重的先天缺陷。这些困难进一步加剧了扑热息痛在体内两种不同形式之间的相互转化或消旋。
- en: Featurizing a Molecule
  id: totrans-55
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 对分子进行特征化
- en: With these descriptions of basic chemistry in hand, how do we get started with
    featurizing molecules? In order to perform machine learning on molecules, we need
    to transform them into feature vectors that can be used as inputs to models. In
    this section, we will discuss the DeepChem featurization submodule `dc.feat`,
    and explain how to use it to featurize molecules in a variety of fashions.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 有了这些基本化学描述，我们如何开始对分子进行特征化呢？为了对分子进行机器学习，我们需要将它们转换为可以用作模型输入的特征向量。在本节中，我们将讨论DeepChem特征化子模块`dc.feat`，并解释如何使用它以各种方式对分子进行特征化。
- en: SMILES Strings and RDKit
  id: totrans-57
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: SMILES字符串和RDKit
- en: SMILES is a popular method for specifying molecules with text strings. The acronym
    stands for “Simplified Molecular-Input Line-Entry System”, which is sufficiently
    awkward-sounding that someone must have worked hard to come up with it. A SMILES
    string describes the atoms and bonds of a molecule in a way that is both concise
    and reasonably intuitive to chemists. To nonchemists, these strings tend to look
    like meaningless patterns of random characters. For example, “OCCc1c(C)[n+](cs1)Cc2cnc(C)nc2N”
    describes the important nutrient thiamine, also known as vitamin B1.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: SMILES是一种用文本字符串指定分子的流行方法。该首字母缩略词代表“简化分子输入线条系统”，这个名字听起来相当别扭，肯定有人费了很大劲才想出来。SMILES字符串以一种既简洁又相对直观的方式描述了分子的原子和键，对化学家来说很直观。对非化学家来说，这些字符串往往看起来像是毫无意义的随机字符模式。例如，“OCCc1c(C)[n+](cs1)Cc2cnc(C)nc2N”描述了重要的营养素硫胺素，也被称为维生素B1。
- en: DeepChem uses SMILES strings as its format for representing molecules inside
    datasets. There are some deep learning models that directly accept SMILES strings
    as their inputs, attempting to learn to identify meaningful features in the text
    representation. But much more often, we first convert the string into a different
    representation (or featurize it) better suited to the problem at hand.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: DeepChem使用SMILES字符串作为其数据集中表示分子的格式。有一些深度学习模型直接接受SMILES字符串作为输入，试图学习识别文本表示中的有意义特征。但更常见的情况是，我们首先将字符串转换为适合手头问题的不同表示形式（或特征化）。
- en: DeepChem depends on another open source chemoinformatics package, RDKit, to
    facilitate its handling of molecules. RDKit provides lots of features for working
    with SMILES strings. It plays a central role in converting the strings in datasets
    to molecular graphs and the other representations described below.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: DeepChem依赖于另一个开源化学信息学软件包RDKit，以便处理分子。RDKit提供了许多功能，用于处理SMILES字符串。它在将数据集中的字符串转换为分子图和下面描述的其他表示形式中起着核心作用。
- en: Extended-Connectivity Fingerprints
  id: totrans-61
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 扩展连接指纹
- en: Chemical fingerprints are vectors of 1s and 0s that represent the presence or
    absence of specific features in a molecule. Extended-connectivity fingerprints
    (ECFPs) are a class of featurizations that combine several useful features. They
    take molecules of arbitrary size and convert them into fixed-length vectors. This
    is important because lots of models require their inputs to all have exactly the
    same size. ECFPs let you take molecules of many different sizes and use them all
    with the same model. ECFPs are also very easy to compare. You can simply take
    the fingerprints for two molecules and compare corresponding elements. The more
    elements that match, the more similar the molecules are. Finally, ECFPs are fast
    to compute.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 化学指纹是由1和0组成的向量，表示分子中特定特征的存在或缺失。扩展连接性指纹（ECFPs）是一类结合了几个有用特征的特征化。它们将任意大小的分子转换为固定长度的向量。这很重要，因为许多模型要求它们的输入具有完全相同的大小。ECFPs让您可以使用具有许多不同大小的分子的相同模型。ECFPs也非常容易比较。您只需取两个分子的指纹并比较相应元素。匹配的元素越多，分子越相似。最后，ECFPs计算速度很快。
- en: 'Each element of the fingerprint vector indicates the presence or absence of
    a particular molecular feature, defined by some local arrangement of atoms. The
    algorithm begins by considering every atom independently and looking at a few
    properties of the atom: its element, the number of covalent bonds it forms, etc.
    Each unique combination of these properties is a feature, and the corresponding
    elements of the vector are set to 1 to indicate their presence. The algorithm
    then works outward, combining each atom with all the ones it is bonded to. This
    defines a new set of larger features, and the corresponding elements of the vector
    are set. The most common variant of this technique is the ECFP4 algorithm, which
    allows for sub-fragments to have a radius of two bonds around a central atom.'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 指纹向量的每个元素表示特定分子特征的存在或缺失，由原子的某种局部排列定义。算法首先独立考虑每个原子，并查看原子的一些属性：其元素，形成的共价键数等。这些属性的每种独特组合都是一个特征，相应的向量元素设置为1以表示其存在。然后算法向外工作，将每个原子与其所有键合的原子结合。这定义了一组更大的特征，并设置了相应的向量元素。这种技术的最常见变体是ECFP4算法，允许子片段在中心原子周围有两个键的半径。
- en: 'The RDKit library provides utilities for computing ECFP4 fingerprints for molecules.
    DeepChem provides convenient wrappers around these functions. The `dc.feat.CircularFingerprint`
    class inherits from `Featurizer` and provides a standard interface to featurize
    molecules:'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: RDKit库提供了计算ECFP4指纹的工具函数。DeepChem提供了这些函数的便捷封装。`dc.feat.CircularFingerprint`类继承自`Featurizer`，并提供了对分子进行特征化的标准接口：
- en: '[PRE0]'
  id: totrans-65
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'ECFPs do have one important disadvantage: the fingerprint encodes a large amount
    of information about the molecule, but some information does get lost. It is possible
    for two different molecules to have identical fingerprints, and given a fingerprint,
    it is impossible to uniquely determine what molecule it came from.'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: ECFPs确实有一个重要的缺点：指纹编码了大量关于分子的信息，但也会丢失一些信息。两种不同的分子可能具有相同的指纹，而且给定一个指纹，不可能唯一确定它来自哪个分子。
- en: Molecular Descriptors
  id: totrans-67
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 分子描述符
- en: 'An alternative line of thought holds that it’s useful to describe molecules
    with a set of physiochemical descriptors. These usually correspond to various
    computed quantities that describe the molecule’s structure. These quantities,
    such as the log partition coefficient or the polar surface area, are often derived
    from classical physics or chemistry. The RDKit package computes many such physical
    descriptors on molecules. The DeepChem featurizer `dc.feat.RDKitDescriptors()`
    provides a simple way to perform the same computations:'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 另一种思路认为，用一组物理化学描述符描述分子是有用的。这些通常对应于描述分子结构的各种计算量。这些量，如对数分配系数或极性表面积，通常是从经典物理学或化学中导出的。RDKit软件包在分子上计算了许多这样的物理描述符。DeepChem的特征化器`dc.feat.RDKitDescriptors()`提供了执行相同计算的简单方法：
- en: '[PRE1]'
  id: totrans-69
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: This featurization is obviously more useful for some problems than others. It
    will tend to work best for predicting things that depend on relatively generic
    properties of the molecules. It is unlikely to work for predicting properties
    that depend on the detailed arrangement of atoms.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 这种特征化对于某些问题显然更有用。它通常最适合用于预测依赖于分子相对通用性质的事物。它不太可能用于预测依赖于原子详细排列的性质。
- en: Graph Convolutions
  id: totrans-71
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 图卷积
- en: 'The featurizations described in the preceding section were designed by humans.
    An expert thought carefully about how to represent molecules in a way that could
    be used as input to machine learning models, then coded the representation by
    hand. Can we instead let the model figure out for itself the best way to represent
    molecules? That is what machine learning is all about, after all: instead of designing
    a featurization ourselves, we can try to learn one automatically from the data.'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 前一节中描述的特征化是由人类设计的。专家仔细考虑了如何以可用作机器学习模型输入的方式表示分子，然后手动编码了表示。我们是否可以让模型自己找出最佳的分子表示方式呢？这正是机器学习的全部意义：我们可以尝试从数据中自动学习特征化，而不是自己设计特征化。
- en: As an analogy, consider a convolutional neural network for image recognition.
    The input to the network is the raw image. It consists of a vector of numbers
    for each pixel, for example the three color components. This is a very simple,
    totally generic representation of the image. The first convolutional layer learns
    to recognize simple patterns such as vertical or horizontal lines. Its output
    is again a vector of numbers for each pixel, but now it is represented in a more
    abstract way. Each number represents the presence of some local geometric feature.
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 作为类比，考虑图像识别的卷积神经网络。网络的输入是原始图像。它由每个像素的数字向量组成，例如三个颜色分量。这是图像的一个非常简单、完全通用的表示。第一个卷积层学习识别简单的模式，比如垂直或水平线。它的输出再次是每个像素的数字向量，但现在以更抽象的方式表示。每个数字代表某些局部几何特征的存在。
- en: The network continues through a series of layers. Each one outputs a new representation
    of the image that is more abstract than the previous layer’s representation, and
    less closely connected to the raw color components. And these representations
    are automatically learned from the data, not designed by a human. No one tells
    the model what patterns to look for to identify whether the image contains a cat.
    The model figures that out by itself through training.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 网络通过一系列层继续。每一层输出图像的新表示，比前一层的表示更抽象，与原始颜色分量的联系更少。这些表示是从数据中自动学习的，而不是由人类设计的。没有人告诉模型要寻找什么模式来识别图像中是否包含猫。模型通过训练自己找出这一点。
- en: '*Graph convolutional networks* take this same idea and apply it to graphs.
    Just as a regular CNN begins with a vector of numbers for each pixel, a graph
    convolutional network begins with a vector of numbers for each node and/or edge.
    When the graph represents a molecule, those numbers could be high-level chemical
    properties of each atom, such as its element, charge, and hybridization state.
    Just as a regular convolutional layer computes a new vector for each pixel based
    on a local region of its input, a graph convolutional layer computes a new vector
    for each node and/or edge. The output is computed by applying a learned convolutional
    kernel to each local region of the graph, where “local” is now defined in terms
    of edges between nodes. For example, it might compute an output vector for each
    atom based on the input vector for that same atom and any other atoms it is directly
    bonded to.'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: '*图卷积网络*采用相同的思想，并将其应用于图形。正如常规CNN从每个像素的数字向量开始，图卷积网络从每个节点和/或边的数字向量开始。当图表示一个分子时，这些数字可以是每个原子的高级化学性质，比如其元素、电荷和杂化状态。正如常规卷积层根据其输入的局部区域计算每个像素的新向量一样，图卷积层根据每个节点和/或边计算一个新向量。输出是通过将学习的卷积核应用于图的每个局部区域来计算的，其中“局部”现在是根据节点之间的边来定义的。例如，它可能根据同一原子的输入向量和直接键合到的任何其他原子的输入向量为每个原子计算一个输出向量。'
- en: That is the general idea. When it comes to the details, many different variations
    have been proposed. Fortunately, DeepChem includes implementations of lots of
    those architectures, so you can try them out even without understanding all the
    details. Examples include graph convolutions (`GraphConvModel`), Weave models
    (`WeaveModel`), message passing neural networks (`MPNNModel`), deep tensor neural
    networks (`DTNNModel`), and more.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 这就是一般的想法。当涉及到细节时，许多不同的变体已经被提出。幸运的是，DeepChem包括了许多这些架构的实现，所以即使不理解所有细节，你也可以尝试它们。示例包括图卷积（`GraphConvModel`）、编织模型（`WeaveModel`）、消息传递神经网络（`MPNNModel`）、深度张量神经网络（`DTNNModel`）等。
- en: 'Graph convolutional networks are a powerful tool for analyzing molecules, but
    they have one important limitation: the calculation is based solely on the molecular
    graph. They receive no information about the molecule’s conformation, so they
    cannot hope to predict anything that is conformation-dependent. This makes them
    most suitable for small, mostly rigid molecules. In the next chapter we will discuss
    methods that are more appropriate for large, flexible molecules that can take
    on many conformations.'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 图卷积网络是分析分子的强大工具，但它们有一个重要的限制：计算仅基于分子图。它们不接收有关分子构象的信息，因此它们无法希望预测任何依赖构象的东西。这使它们最适合于小型、大部分刚性的分子。在下一章中，我们将讨论更适用于可以呈现许多构象的大型、灵活分子的方法。
- en: Training a Model to Predict Solubility
  id: totrans-78
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 训练模型以预测溶解度
- en: 'Let’s put all the pieces together and train a model on a real chemical dataset
    to predict an important molecular property. First we’ll load the data:'
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们把所有的部分放在一起，在真实的化学数据集上训练一个模型，以预测一个重要的分子性质。首先我们将加载数据：
- en: '[PRE2]'
  id: totrans-80
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: This dataset contains information about solubility, which is a measure of how
    easily a molecule dissolves in water. This property is vitally important for any
    chemical you hope to use as a drug. If it does not dissolve easily, getting enough
    of it into a patient’s bloodstream to have a therapeutic effect may be impossible.
    Medicinal chemists spend a lot of time modifying molecules to try to increase
    their solubility.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 这个数据集包含有关溶解度的信息，这是衡量分子在水中溶解程度的指标。这个性质对于任何希望用作药物的化学物质都非常重要。如果它不容易溶解，将足够量的化合物注入患者的血液以产生治疗效果可能是不可能的。药物化学家花费大量时间修改分子，试图增加它们的溶解度。
- en: Notice that we specify the option `featurizer='GraphConv'`. We are going to
    use a graph convolutional model, and this tells MoleculeNet to transform the SMILES
    string for each molecule into the format required by the model.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，我们指定了选项`featurizer='GraphConv'`。我们将使用图卷积模型，这告诉MoleculeNet将每个分子的SMILES字符串转换为模型所需的格式。
- en: 'Now let’s construct and train the model:'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 现在让我们构建并训练模型：
- en: '[PRE3]'
  id: totrans-84
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: We specify that there is only one task—that is to say, one output value (the
    solubility)—for each sample. We also specify that this is a regression model,
    meaning that the labels are continuous numbers and the model should try to reproduce
    them as accurately as possible. That is in contrast to a classification model,
    which tries to predict which of a fixed set of classes each sample belongs to.
    To reduce overfitting, we specify a dropout rate of 0.2, meaning that 20% of the
    outputs from each convolutional layer will randomly be set to 0.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 我们指定只有一个任务，也就是说，每个样本只有一个输出值（溶解度）。我们还指定这是一个回归模型，意味着标签是连续的数字，模型应尽可能准确地复制它们。这与分类模型相反，分类模型试图预测每个样本属于固定类别中的哪一个。为了减少过拟合，我们指定了一个0.2的丢弃率，意味着每个卷积层的输出的20%将随机设置为0。
- en: 'That’s all there is to it! Now we can evaluate the model and see how well it
    works. We will use the Pearson correlation coefficient as our evaluation metric:'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 就是这样！现在我们可以评估模型，看看它的表现如何。我们将使用皮尔逊相关系数作为我们的评估指标：
- en: '[PRE4]'
  id: totrans-87
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: This reports a correlation coefficient of 0.95 for the training set, and 0.83
    for the test set. Apparently it is overfitting a little bit, but not too badly.
    And a correlation coefficient of 0.83 is quite respectable. Our model is successfully
    predicting the solubilities of molecules based on their molecular structures!
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 这报告了训练集的相关系数为0.95，测试集为0.83。显然有点过拟合，但不是太严重。相关系数为0.83是相当可观的。我们的模型成功地根据分子结构预测了分子的溶解度！
- en: 'Now that we have the model, we can use it to predict the solubilities of new
    molecules. Suppose we are interested in the following five molecules, specified
    as SMILES strings:'
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们有了模型，我们可以用它来预测新分子的溶解度。假设我们对以下五种分子感兴趣，以SMILES字符串指定：
- en: '[PRE5]'
  id: totrans-90
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'To use these as inputs to the model, we must first use RDKit to parse the SMILES
    strings, then use a DeepChem featurizer to convert them to the format expected
    by the graph convolution:'
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 要将这些作为模型的输入，我们必须首先使用RDKit解析SMILES字符串，然后使用DeepChem特征化器将其转换为图卷积所期望的格式：
- en: '[PRE6]'
  id: totrans-92
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'Now we can pass them to the model and ask it to predict their solubilities:'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们可以将它们传递给模型，并要求它预测它们的溶解度：
- en: '[PRE7]'
  id: totrans-94
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: MoleculeNet
  id: totrans-95
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: MoleculeNet
- en: 'We have now seen two datasets loaded from the `molnet` module: the Tox21 toxicity
    dataset in the previous chapter, and the Delaney solubility dataset in this chapter.
    MoleculeNet is a large collection of datasets useful for molecular machine learning.
    As shown in [Figure 4-10](#moleculenet_hosts_many), it contains data on many sorts
    of molecular properties. They range from low-level physical properties that can
    be calculated with quantum mechanics up to very high-level information about interactions
    with a human body, such as toxicity and side effects.'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在已经看到从`molnet`模块加载的两个数据集：上一章的Tox21毒性数据集，以及本章的Delaney溶解度数据集。MoleculeNet是一个大型的数据集合，对于分子机器学习非常有用。如[图4-10](#moleculenet_hosts_many)所示，它包含许多种分子属性的数据。这些属性从可以用量子力学计算的低级物理属性到与人体相互作用的非常高级信息，如毒性和副作用。
- en: '![](Images/dlls_0410.png)'
  id: totrans-97
  prefs: []
  type: TYPE_IMG
  zh: '![](Images/dlls_0410.png)'
- en: Figure 4-10\. MoleculeNet hosts many different datasets from different molecular
    sciences. Scientists find it useful to predict quantum, physical chemistry, biophysical,
    and physiological characteristics of molecules.
  id: totrans-98
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图4-10。MoleculeNet托管许多不同的数据集，来自不同的分子科学。科学家们发现预测分子的量子、物理化学、生物物理和生理特性非常有用。
- en: When developing new machine learning methods, you can use MoleculeNet as a collection
    of standard benchmarks to test your method on. At *[http://moleculenet.ai](http://moleculenet.ai)*
    you can view data on how well a collection of standard models perform on each
    of the datasets, giving insight into how your own method compares to established
    techniques.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 在开发新的机器学习方法时，您可以使用MoleculeNet作为一组标准基准来测试您的方法。在*[http://moleculenet.ai](http://moleculenet.ai)*上，您可以查看一组标准模型在每个数据集上的表现数据，从而了解您的方法与已建立技术相比如何。
- en: SMARTS Strings
  id: totrans-100
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: SMARTS字符串
- en: 'In many commonly used applications, such as word processing, we need to search
    for a particular text string. In cheminformatics, we encounter similar situations
    where we want to determine whether atoms in a molecule match a particular pattern.
    There are a number of use cases where this may arise:'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 在许多常用的应用程序中，例如文字处理，我们需要搜索特定的文本字符串。在化学信息学中，我们遇到类似的情况，我们想确定分子中的原子是否与特定模式匹配。有许多可能出现这种情况的用例：
- en: Searching a database of molecules to identify molecules containing a particular
    substructure
  id: totrans-102
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 搜索包含特定亚结构的分子的数据库
- en: Aligning a set of molecules on a common substructure to improve visualization
  id: totrans-103
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将一组分子对齐在一个共同的亚结构上以改善可视化
- en: Highlighting a substructure in a plot
  id: totrans-104
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在图中突出显示一个亚结构
- en: Constraining a substructure during a calculation
  id: totrans-105
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在计算过程中约束一个亚结构
- en: SMARTS is an extension of the SMILES language described previously that can
    be used to create queries. One can think of SMARTS patterns as similar to regular
    expressions used for searching text. For instance, when searching a filesystem,
    one can specify a query like “foo*.bar”, which will match foo.bar, foo3.bar, and
    foolish.bar. At the simplest level, any SMILES string can also be a SMARTS string.
    The SMILES string “CCC” is also a valid SMARTS string and will match sequences
    of three adjacent aliphatic carbon atoms. Let’s take a look at a code example
    showing how we can define molecules from SMILES strings, display those molecules,
    and highlight the atoms matching a SMARTS pattern.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: SMARTS是先前描述的SMILES语言的扩展，可用于创建查询。人们可以将SMARTS模式视为用于搜索文本的正则表达式。例如，在搜索文件系统时，可以指定类似于“foo*.bar”的查询，这将匹配foo.bar、foo3.bar和foolish.bar。在最简单的级别上，任何SMILES字符串也可以是SMARTS字符串。SMILES字符串“CCC”也是一个有效的SMARTS字符串，将匹配三个相邻脂肪碳原子的序列。让我们看一个代码示例，展示如何从SMILES字符串定义分子，显示这些分子，并突出显示与SMARTS模式匹配的原子。
- en: 'First, we will import the necessary libraries and create a list of molecules
    from a list of SMILES strings. [Figure 4-11](#gen-from-smiles) shows the result:'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，我们将导入必要的库并从一组SMILES字符串中创建一个分子列表。[图4-11](#gen-from-smiles)显示了结果：
- en: '[PRE8]'
  id: totrans-108
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: '![](Images/dlls_0411.png)'
  id: totrans-109
  prefs: []
  type: TYPE_IMG
  zh: '![](Images/dlls_0411.png)'
- en: Figure 4-11\. Chemical structures generated from SMILES
  id: totrans-110
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图4-11。从SMILES生成的化学结构
- en: 'Now we can see which SMILES strings match the SMARTS pattern “CCC” ([Figure 4-12](#matching-smiles)):'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们可以看到哪些SMILES字符串与SMARTS模式“CCC”匹配（参见[图4-12](#matching-smiles)）：
- en: '[PRE9]'
  id: totrans-112
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: '![](Images/dlls_0412.png)'
  id: totrans-113
  prefs: []
  type: TYPE_IMG
  zh: '![](Images/dlls_0412.png)'
- en: Figure 4-12\. Molecules matching the SMARTS expression “CCC.”
  id: totrans-114
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图4-12。与SMARTS表达式“CCC”匹配的分子。
- en: There are a couple of things to note in this figure. The first is that the SMARTS
    expression only matches the first structure. The other structures do not contain
    three adjacent carbons. Note also that there are multiple ways that the SMARTS
    pattern could match the first molecule in this figure—it could match three adjacent
    carbon atoms by starting at the first, second, or third carbon atom. There are
    additional functions in RDKit that will return all possible SMARTS matches, but
    we won’t cover those now.
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 在这张图中有几点需要注意。首先是SMARTS表达式只匹配第一个结构。其他结构不包含三个相邻的碳。还要注意，SMARTS模式可以以多种方式匹配此图中的第一个分子——它可以从第一个、第二或第三个碳原子开始匹配三个相邻的碳原子。RDKit中还有其他函数可以返回所有可能的SMARTS匹配，但我们现在不会涵盖这些内容。
- en: Additional wildcard characters can be used to match specific sets of atoms.
    As with text, the “*” character can be used to match any atom. The SMARTS pattern
    “C*C” will match an aliphatic carbon attached to any atom attached to another
    aliphatic carbon (see [Figure 4-13](#smarts-c-c)).
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 可以使用额外的通配符字符来匹配特定的原子集。与文本一样，“*”字符可用于匹配任何原子。SMARTS模式“C*C”将匹配一个连接到另一个脂肪碳的脂肪碳（参见[图4-13](#smarts-c-c)）。
- en: '[PRE10]'
  id: totrans-117
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: '![](Images/dlls_0413.png)'
  id: totrans-118
  prefs: []
  type: TYPE_IMG
  zh: '![](Images/dlls_0413.png)'
- en: Figure 4-13\. Molecules matching the SMARTS expression “C*C”.
  id: totrans-119
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图4-13。与SMARTS表达式“C*C”匹配的分子。
- en: 'The SMARTS syntax can be extended to only allow specific sets of atoms. For
    instance, the string “C[C,O,N]C” will match carbon attached to carbon, oxygen,
    or nitrogen, attached to another carbon ([Figure 4-14](#smarts-c-c-n-0-c)):'
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: SMARTS语法可以扩展为仅允许特定的原子集。例如，字符串“C[C,O,N]C”将匹配连接到另一个碳原子的碳、氧或氮原子（参见[图4-14](#smarts-c-c-n-0-c)）：
- en: '[PRE11]'
  id: totrans-121
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: '![](Images/dlls_0414.png)'
  id: totrans-122
  prefs: []
  type: TYPE_IMG
  zh: '![](Images/dlls_0414.png)'
- en: Figure 4-14\. Molecules matching the SMARTS expression “C[C,N,O]C”.
  id: totrans-123
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图4-14。与SMARTS表达式“C[C,N,O]C”匹配的分子。
- en: There is a lot more to SMARTS that is beyond the scope of this brief introduction.
    Interested readers are urged to read the “Daylight Theory Manual” to get deeper
    insight into SMILES and SMARTS.^([1](ch04.xhtml#idm45806170348920)) As we will
    see in [Chapter 11](ch11.xhtml#a_virtual_screening_workflow_example), SMARTS can
    be used to build up sophisticated queries that can identify molecules that may
    be problematic in biological assays.
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: SMARTS还有很多内容超出了这个简短介绍的范围。建议感兴趣的读者阅读“Daylight Theory Manual”以深入了解SMILES和SMARTS。^([1](ch04.xhtml#idm45806170348920))
    正如我们将在[第11章](ch11.xhtml#a_virtual_screening_workflow_example)中看到的，SMARTS可以用于构建复杂的查询，以识别在生物测定中可能存在问题的分子。
- en: Conclusion
  id: totrans-125
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 结论
- en: In this chapter, you’ve learned the basics of molecular machine learning. After
    a brief review of basic chemistry, we explored how molecules have traditionally
    been represented for computing systems. You also learned about graph convolutions,
    which are a newer approach to modeling molecules in deep learning, and saw a complete
    working example of how to use machine learning on molecules to predict an important
    physical property. These techniques will serve as the foundations upon which later
    chapters will build.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 在这一章中，您已经学习了分子机器学习的基础知识。在简要回顾基础化学知识之后，我们探讨了分子在计算系统中传统的表示方法。您还学习了图卷积，这是一种在深度学习中对分子建模的较新方法，并看到了如何使用机器学习来预测重要物理性质的完整工作示例。这些技术将成为后续章节构建的基础。
- en: ^([1](ch04.xhtml#idm45806170348920-marker)) Daylight Chemical Information Systems,
    Inc. “Daylight Theory Manual.” [*http://www.daylight.com/dayhtml/doc/theory/*](http://www.daylight.com/dayhtml/doc/theory/).
    2011.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: ^([1](ch04.xhtml#idm45806170348920-marker)) Daylight Chemical Information Systems,
    Inc. “Daylight Theory Manual.” [*http://www.daylight.com/dayhtml/doc/theory/*](http://www.daylight.com/dayhtml/doc/theory/).
    2011.
