- en: appendix B Installing and configuring PyTorch Geometric
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: B.1 Installing PyTorch Geometric
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'PyTorch Geometric (PyG) is a library built on top of PyTorch for working with
    graph neural networks (GNNs). The newest pytorch geometric versions can be installed
    with: pip install torch_geometric. Only PyTorch is needed as a dependency. To
    install PyG with its extensions, you need to ensure that you have the correct
    versions of Compute Unified Device Architecture (CUDA), PyTorch, and PyG installed
    and compatible with each other.'
  prefs: []
  type: TYPE_NORMAL
- en: B.1.1 On Windows/Linux
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'If you’re on a Windows or Linux system, follow these steps:'
  prefs: []
  type: TYPE_NORMAL
- en: '*Install PyTorch*. First, install the appropriate version of PyTorch for your
    system. You can find the instructions on the official PyTorch website ([https://pytorch.org/get-started/locally/](https://pytorch.org/get-started/locally/)).
    Make sure to select the correct CUDA version if you have an NVIDIA GPU.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*Find the PyTorch CUDA version*. After installing PyTorch, check its version
    and the CUDA version it was built with by running the following from Python:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: 'This can also be run from the command line as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: The outputs from this code will be used in the next step.
  prefs: []
  type: TYPE_NORMAL
- en: '*Install PyG dependencies*. Install the PyG dependencies (`torch-scatter`,
    `torch-sparse`, `torch-cluster`, `torch-spline-conv`) from the PyG repository,
    specifying the correct CUDA version:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: In this code, replace `${PYTORCH}` with your PyTorch version (e.g., 1.13.1)
    and `${CUDA}` with the CUDA version from the previous step (e.g., cu117).
  prefs: []
  type: TYPE_NORMAL
- en: '*Install PyG*. Finally, install the PyG library itself:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: B.1.2 On MacOS
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Since Macs don’t come with Nvidia GPUs, you can install the `cpu` version of
    PyG by following the same steps as in the previous section, but using `cpu` instead
    of a `CUDA` version when installing the dependencies.
  prefs: []
  type: TYPE_NORMAL
- en: B.1.3 Compatibility issues
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: For installing the extensions, it’s crucial to match the versions of CUDA, PyTorch,
    and PyG to avoid compatibility issues. Using mismatched versions can lead to errors
    during installation or runtime. Always refer to the official documentation for
    the latest installation instructions and version compatibility information. When
    writing this book, we encountered a few frustrating errors that were solved only
    by installing the correct combination of CUDA, PyTorch, and PyG.
  prefs: []
  type: TYPE_NORMAL
- en: One particular insight we gained from dealing with tools designed to work with
    PyG, such as Open Graph Benchmark (OGB) and DistributedDataParallel (DDP), is
    that they may only work with specific versions of PyTorch. In chapter 7, the distributed
    computing example would only work with PyTorch v2.0.1 and CUDA v11.8\.
  prefs: []
  type: TYPE_NORMAL
