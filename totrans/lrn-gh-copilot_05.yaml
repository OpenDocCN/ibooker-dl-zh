- en: Chapter 4\. Advanced Editing and Autonomous Workflows in the IDE
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第 4 章\. 在 IDE 中的高级编辑和自主工作流程
- en: In Chapters [2](ch02.html#ch02) and [3](ch03.html#ch03), we covered the basics
    of creating code and using the chat interface to get things done with Copilot
    in the IDE. The items we’ve discussed will help handle basic use cases. But for
    more intensive coding efforts like refactoring, making significant edits, or automatically
    handling more complex changes, Copilot provides advanced features.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在第 [2](ch02.html#ch02) 章和第 [3](ch03.html#ch03) 章中，我们介绍了使用 Copilot 在 IDE 中创建代码和使用聊天界面完成任务的基础知识。我们讨论的项目将有助于处理基本用例。但对于像重构、进行重大编辑或自动处理更复杂更改等更密集的编码工作，Copilot
    提供了高级功能。
- en: 'In this chapter, we’ll look at a powerful set of features that leverage the
    AI to handle larger sets of changes and code generation for you. These include
    the following:'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将探讨一组强大的功能，这些功能利用 AI 来处理更大的更改集和代码生成。以下包括以下内容：
- en: Predictive edits with Next Edit Suggestions
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 基于下一个编辑建议的预测性编辑
- en: Batch changes with Copilot Edits
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 Copilot 编辑批量更改
- en: Automated end-to-end updates with Copilot Agent mode
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 Copilot 代理模式进行自动端到端更新
- en: Producing code based on images with Copilot Vision
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 Copilot 视觉生成基于图像的代码
- en: Debugging with Copilot
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 Copilot 进行调试
- en: Let’s start off looking at a feature that can predict where your next edit should
    be.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们从查看一个可以预测你的下一个编辑应该在哪里进行的特性开始。
- en: Predictive Edits with Next Edit Suggestions
  id: totrans-9
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 基于下一个编辑建议的预测性编辑
- en: Have you ever been trying to refactor your code in some way and found yourself
    searching through your file to locate all the places you need to make changes?
    Co­pilot’s Next Edit Suggestions (NES) is designed to eliminate the need for that
    and simplify the process of identifying and making the *next change*.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 你是否曾经试图以某种方式重构你的代码，却发现自己在文件中搜索需要更改的所有位置？Copilot 的下一个编辑建议（NES）旨在消除这种需求，并简化识别和进行*下一个更改*的过程。
- en: NES predicts and suggests edits based on ongoing changes in your code, typos,
    or logic errors. The changes it suggests can range from a single symbol to multiple
    lines of code. In the refactoring use case, NES can analyze the edits you’re making
    and locate the next place in the logic where a change needs to be made, then the
    next place, and so on.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: NES 根据你代码中的持续更改、打字错误或逻辑错误来预测和建议编辑。它建议的更改可以从单个符号到多行代码不等。在重构用例中，NES 可以分析你正在进行的编辑，并定位到逻辑中需要更改的下一个位置，然后是下一个位置，依此类推。
- en: 'When enabled, and after you make an edit, NES looks at your code and tries
    to anticipate what else is related and should be changed next. NES highlights
    its suggestion for the next change by putting an arrow in the editor’s gutter.
    The *gutter* refers to the empty strip of space to the left of the line numbers
    in the editor. As an example, say we have a Python class that represents a 2D
    point and includes a method to calculate the distance between two points. It also
    includes a simple example. The code might look like this:'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 当启用时，在你进行编辑后，NES 会查看你的代码并尝试预测其他相关内容以及应该更改的内容。NES 通过在编辑器的空白区域（gutter）中放置箭头来突出显示其下一个更改的建议。*空白区域*指的是编辑器中行号左侧的空白条带。例如，假设我们有一个表示二维点的
    Python 类，它包括一个计算两点之间距离的方法。它还包括一个简单的示例。代码可能看起来像这样：
- en: '[PRE0]'
  id: totrans-13
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'We want to change this class to work for 3D points, so we change the `__init__`
    statement to add a `z` value. If NES is enabled, after we make that change, Copilot
    will look for the next place where the code needs to be changed to handle the
    new `z` coordinate. Copilot determines it needs to add a constructor for that
    value in the `init` method, suggests the code change, and highlights it with the
    arrow in the gutter, as shown in [Figure 4-2](#nes-identifying-next):'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 我们想将这个类更改为适用于三维点，因此我们将 `__init__` 语句更改为添加一个 `z` 值。如果 NES 已启用，在我们进行更改后，Copilot
    将寻找代码中需要更改以处理新的 `z` 坐标的下一个位置。Copilot 确定它需要在 `init` 方法中添加该值的构造函数，建议代码更改，并用箭头在空白区域中突出显示，如图
    [图 4-2](#nes-identifying-next) 所示。
- en: '![](assets/lghc_0402.png)'
  id: totrans-15
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/lghc_0402.png)'
- en: Figure 4-2\. NES identifying the next change
  id: totrans-16
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-2\. NES 识别下一个更改
- en: To get to this change quickly, you just hit Tab. Hovering over the arrow in
    the gutter presents an informational dialog with extended options for working
    with NES ([Figure 4-3](#nes-options-popup)). In most cases, you won’t need these.
    You can just press Tab to accept the suggested change or Escape to reject it and
    move on.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
- en: '![](assets/lghc_0403.png)'
  id: totrans-18
  prefs: []
  type: TYPE_IMG
- en: Figure 4-3\. NES options pop-up
  id: totrans-19
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: Once we process this change (accept or reject), the process continues, and Copilot
    identifies the next suggested edit ([Figure 4-4](#next-change)). The process will
    then repeat as long as there are eligible changes that Copilot identifies.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
- en: '![](assets/lghc_0404.png)'
  id: totrans-21
  prefs: []
  type: TYPE_IMG
- en: Figure 4-4\. The next change
  id: totrans-22
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: Don’t Lose Focus
  id: totrans-23
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: If you have a pending NES change (with the arrow visible in the gutter) and
    switch focus away from the editor, the pending change will disappear, and the
    NES process will stop.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
- en: While the NES functionality can substantially help with common changes, such
    as intentional refactoring, it can also catch and point out independent issues,
    like typos and logic errors.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
- en: Assume we had coded the changes to the distance function ourselves and accidentally
    used the multiplication operator instead of the exponent operator. With NES activated,
    Copilot would catch that and suggest a change to correct it, as shown in [Figure 4-6](#nes-suggesting-change).
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
- en: '![](assets/lghc_0406.png)'
  id: totrans-27
  prefs: []
  type: TYPE_IMG
- en: Figure 4-6\. NES suggesting a change to fix a logic error
  id: totrans-28
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: NES can also help catch changes that need to be made across multiple files,
    but that currently seems to be limited to files that are open in the editor. If
    you need to make batch changes or automatically add a feature that spans multiple
    files, consider the advanced edit functionality discussed in our next section
    instead.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
- en: Copilot Edits
  id: totrans-30
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Copilot includes functionality to make AI-driven changes across a selected set
    of files. This functionality, called *Copilot Edits*, allows Copilot to update
    multiple files in response to a natural language prompt. You can think of this
    as a sort of batch edit functionality driven by AI. It can be useful for tasks
    ranging from simple refactoring all the way to extensive changes, like adding
    features, across a subset of existing code.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
- en: Copilot Edits is a separate mode in Copilot Chat. To use it, you first need
    to switch from the default Ask mode in chat to Edit mode. This is done via a menu
    that shows up when you click the drop-down arrow next to Ask*,* at the bottom
    of the prompt entry area ([Figure 4-7](#switching-chat-to-edi)).
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
- en: '![](assets/lghc_0407.png)'
  id: totrans-33
  prefs: []
  type: TYPE_IMG
- en: Figure 4-7\. Switching chat to Edit mode
  id: totrans-34
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: In this mode, you select which files to edit and provide a prompt along with
    any needed context. Copilot then suggests edits to your code across the files
    that you can accept or reject. Let’s take a look at a simple example.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
- en: Suppose we have a simple set of calculator functions written in Python along
    with some basic tests and a README file.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
- en: Our Example
  id: totrans-37
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: I’m sharing the code here because it provides the background for the changes
    we’re going to talk about in the rest of the chapter. And even though this is
    written in Python, you don’t have to know Python to understand what we’ll be doing.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 我在这里分享代码，因为它为我们将在本章其余部分讨论的更改提供了背景。尽管这是用 Python 编写的，但你不必了解 Python 就能理解我们将要做什么。
- en: 'Here’s the *README.md* file:'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 这是 *README.md* 文件：
- en: '[PRE1]'
  id: totrans-40
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'The code for the calculator functions is in a file named *calculator.py*, shown
    here:'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 计算器函数的代码位于名为 *calculator.py* 的文件中，如下所示：
- en: '[PRE2]'
  id: totrans-42
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'The code for the test cases is in a file named *test_calculator.py*:'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 测试用例的代码位于名为 *test_calculator.py* 的文件中：
- en: '[PRE3]'
  id: totrans-44
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: (We also have a standard *.gitignore* file and a LICENSE file in the project.)
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: （我们还在项目中有一个标准的 *.gitignore* 文件和一个 LICENSE 文件。）
- en: 'Let’s suppose we want to improve our code in the Python files. Here’s a set
    of tasks we can prompt Copilot to do in Edit mode:'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 假设我们想要改进 Python 文件中的代码。以下是一组我们可以提示 Copilot 在编辑模式中执行的任务：
- en: Refactor the `divide` function to handle division by zero more gracefully.
  id: totrans-47
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将 `divide` 函数重构以更优雅地处理除以零的情况。
- en: Add [type hints](https://oreil.ly/H6bfq) to all functions in *calculator.py*.
  id: totrans-48
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在 *calculator.py* 中的所有函数中添加 [类型提示](https://oreil.ly/H6bfq)。
- en: Write additional unit tests for edge cases in *test_calculator.py*.
  id: totrans-49
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在 *test_calculator.py* 中为边缘情况编写额外的单元测试。
- en: To start the Edits process, we need to add the files we want Copilot to work
    with. In our simple case, for the prompts we’re using, we just need the two Python
    files. We can add them most easily by selecting them from the file list and dragging
    and dropping them into the text entry area of the chat dialog. Alternatively,
    you can include them by using the `#file` chat variable. Or you can use the Add
    Context control to pick them from the list. [Figure 4-8](#selected-files-ready)
    shows the files added as context and the prompts supplied in the dialog.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 要开始编辑过程，我们需要添加 Copilot 将要处理的文件。在我们的简单案例中，对于我们使用的提示，我们只需要两个 Python 文件。我们可以通过从文件列表中选择并将它们拖放到聊天对话框的文本输入区域来最轻松地添加它们。或者，你可以使用
    `#file` 聊天变量来包含它们。或者，你可以使用添加上下文控件从列表中选择它们。[图 4-8](#selected-files-ready) 展示了作为上下文添加的文件和对话框中提供的提示。
- en: '![](assets/lghc_0408.png)'
  id: totrans-51
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/lghc_0408.png)'
- en: Figure 4-8\. Selected files ready for Copilot Edits
  id: totrans-52
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-8\. 准备好供 Copilot 编辑的选定文件
- en: Once we submit this, Copilot will process the prompts against the selected files
    and propose any needed changes to accomplish the prompts. These proposed changes
    will be shown inline in the editor. You can choose to review each one and Keep/Undo
    each proposed change or Keep/Undo all proposed changes at once based on the new
    “files changed” section in the chat area. [Figure 4-9](#edited-files-ready-fo)
    shows the results of running the prompts in Edit mode for the specified context.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 提交后，Copilot 将处理所选文件中的提示，并提议任何必要的更改以完成提示。这些提议的更改将在编辑器中显示。你可以选择审查每个提议的更改并保留/撤销每个提议的更改，或者根据聊天区域中的新“文件更改”部分一次性保留/撤销所有提议的更改。[图
    4-9](#edited-files-ready-fo) 展示了在编辑模式下运行指定上下文提示的结果。
- en: '![](assets/lghc_0409.png)'
  id: totrans-54
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/lghc_0409.png)'
- en: Figure 4-9\. Edited files ready for review
  id: totrans-55
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-9\. 准备审查的已编辑文件
- en: There are controls for keeping or undoing each suggested edit if you need to
    get that granular. Also, files with proposed/pending changes have a symbol (dot
    inside a square) in the file list and for ones that are open in the editor. Once
    you’ve decided what to keep or undo for the proposed changes, the Keep/Undo buttons
    in the “files changed” area will change to a Done button. You click this to stop
    this round of editing.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 如果需要达到更细致的控制，有控制按钮用于保留或撤销每个建议的编辑。对于有提议/待定更改的文件，在文件列表和编辑器中都有一个符号（方形内的点）。一旦你决定保留或撤销提议的更改，"文件更改"区域中的保留/撤销按钮将变为完成按钮。点击此按钮即可停止这一轮编辑。
- en: Until you click the Done button, you can change your mind and roll back the
    edits Copilot suggested, even if you chose to keep some or all. You can do this
    in a couple of ways. You can use the Undo option in the “files changed” area above
    the entry area. Or you can click the left-curving arrow at the top of the chat
    panel. Or, you can hover over the top of the conversation in the chat and click
    the X there, as shown in [Figure 4-10](#one-of-several-option).
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 在你点击完成按钮之前，你可以改变主意并撤销 Copilot 提出的编辑，即使你选择保留一些或全部。你可以通过以下几种方式做到这一点。你可以在输入区域上方的“文件更改”区域使用撤销选项。或者，你可以点击聊天面板顶部的左曲箭头。或者，你可以将鼠标悬停在聊天对话的顶部，然后点击那里的
    X，如图 [图 4-10](#one-of-several-option) 所示。
- en: '![](assets/lghc_0410.png)'
  id: totrans-58
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/lghc_0410.png)'
- en: Figure 4-10\. One of several options to roll back proposed edits
  id: totrans-59
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-10\. 回滚建议的编辑的几种选项之一
- en: 'To persist the changes in the files, click the Done button. In our example,
    the *calculator.py* file has the type hints included, and the divide function
    has been refactored:'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 要在文件中保留更改，请点击“完成”按钮。在我们的例子中，*calculator.py* 文件已包含类型提示，并且 divide 函数已被重构：
- en: '[PRE4]'
  id: totrans-61
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'And additional test cases have been added per the other prompt:'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 根据其他提示，已添加了额外的测试用例：
- en: '[PRE5]'
  id: totrans-63
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: Here’s one more tip for using Copilot Edits. Instead of selecting individual
    files, you can use the `#codebase` chat variable (see [Chapter 3](ch03.html#ch03))
    in your prompt to let Copilot try to select the appropriate files to change. For
    example, if you used the prompt
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 这是关于使用 Copilot Edits 的另一个小贴士。你不必选择单个文件，可以在你的提示中使用 `#codebase` 聊天变量（见[第 3 章](ch03.html#ch03)），让
    Copilot 尝试选择合适的文件进行修改。例如，如果你使用了以下提示
- en: '[PRE6]'
  id: totrans-65
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: Copilot selects the *README.md* file to add the documentation to ([Figure 4-11](#using-codebase-to-up)).
    Of course, you might want to create a separate documentation file, but the point
    is that Copilot selected the best fit among the ones that were available.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: Copilot 选择 *README.md* 文件来添加文档（[图 4-11](#using-codebase-to-up)）。当然，你可能会想创建一个单独的文档文件，但重点是
    Copilot 在可用的文件中选择了最合适的。
- en: '![](assets/lghc_0411.png)'
  id: totrans-67
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/lghc_0411.png)'
- en: Figure 4-11\. Using `#codebase` to update files
  id: totrans-68
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-11\. 使用 `#codebase` 更新文件
- en: This is meant to show a simple use case, but you can use Copilot Edits at a
    much larger scale and for more complex changes. The mechanics and approach apply
    the same way. The more specific you can be with the files you want changed, and
    the more directive you can be with your prompts, the better. As with any suggestions
    from the AI, the results may or may not be what you expect and may or may not
    be correct. This is why the step of reviewing the proposed changes in the editor
    is so important. If you don’t get the set of changes you expect, you can try going
    back and tweaking the prompt to see if you can get improved suggestions.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 这是为了展示一个简单的用例，但你可以在更大规模和更复杂的修改中使用 Copilot Edits。文件的具体性越高，你的提示越具体，效果越好。与任何来自
    AI 的建议一样，结果可能符合或不符合你的预期，可能正确或错误。这就是为什么在编辑器中审查建议的更改步骤如此重要的原因。如果你没有得到预期的更改集，你可以尝试返回并调整提示，看看是否可以得到改进的建议。
- en: While the AI edit capabilities in Copilot Edits are useful for suggesting changes
    in files that you select and review, sometimes we may not know which content needs
    to be *picked* for a change. And we may not want to do as many manual steps to
    get the changes in place for review. For those reasons (among others), Copilot
    can leverage the AI to make simple or complex changes more autonomously. This
    happens by using Copilot’s other mode, which uses an AI agent to handle the heavy
    lifting for you.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然 Copilot Edits 中的 AI 编辑功能对于建议修改你选择和审查的文件很有用，但有时我们可能不知道哪些内容需要被*挑选*进行修改。我们可能也不希望进行许多手动步骤来确保修改到位以便审查。出于这些原因（以及其他原因），Copilot
    可以利用 AI 来更自主地执行简单或复杂的修改。这通过使用 Copilot 的其他模式来实现，该模式使用 AI 代理来为你处理繁重的工作。
- en: Agent Mode
  id: totrans-71
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 代理模式
- en: In AI terminology, an AI *agent* is software that gathers input from its environment,
    makes decisions, and takes actions autonomously using available *tools* to achieve
    specific goals. Agents use the underlying AI models as their *brain* to help translate
    between natural language or code and develop plans and make decisions. GitHub
    Copilot’s Agent mode is your own coding agent.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 在 AI 术语中，一个 AI *代理* 是一种软件，它从其环境中收集输入，做出决策，并使用可用的 *工具* 自主地采取行动以实现特定目标。代理使用其底层的
    AI 模型作为其 *大脑*，以帮助在自然语言或代码之间进行翻译，制定计划和做出决策。GitHub Copilot 的 Agent 模式是你的个人编码代理。
- en: 'In Agent mode, Copilot takes one or more prompts as tasks to complete. It then
    runs in a more autonomous way by using this basic workflow for each task:'
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 在代理模式中，Copilot 将一个或多个提示作为任务来完成。然后它通过使用以下基本工作流程为每个任务以更自主的方式运行：
- en: Determines the needed context and files to edit (as opposed to you having to
    specify them). Also, it can create new files if needed.
  id: totrans-74
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 确定需要编辑的上下文和文件（而不是你必须指定它们）。此外，如果需要，它还可以创建新文件。
- en: Suggests code changes and terminal commands to complete the task. For example,
    Copilot might suggest or run commands to install dependencies or run tests.
  id: totrans-75
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 建议代码更改和终端命令以完成任务。例如，Copilot 可能会建议或运行安装依赖项或运行测试的命令。
- en: Checks for correctness of code edits and terminal commands output.
  id: totrans-76
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 检查代码编辑和终端命令输出的正确性。
- en: Prompts for human review or interaction if needed.
  id: totrans-77
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如有必要，提示人工审查或交互。
- en: Repeats the preceding steps until it assesses that the task is completed successfully
    or it can go no further on its own.
  id: totrans-78
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: While it is processing, the agent is leveraging a set of tools defined by GitHub
    to help accomplish tasks. These tools read files, run commands in the terminal,
    read output, apply proposed changes, and more. The list of tools is updated as
    new ones become available for Agent mode to use.
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
- en: Identifying Context
  id: totrans-80
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: While the agent usually does a very good job of identifying the appropriate
    context to use or update, you can use the usual methods (`#file` chat variables,
    Add Context control, etc.) to also target specific files.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
- en: These autonomous capabilities and use of iteration to complete a task are key
    features. They differentiate Copilot’s Agent mode from more selective, directed
    approaches like Copilot Edits.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
- en: Let’s get an idea of how Agent mode works in practice. We’ll use the same set
    of files from [“Copilot Edits”](#copilot-edits) that implement the calculator
    functionality.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
- en: First, we need to switch to Agent mode. We can do that in the same way we did
    to get to Copilot Edits. In the text entry section of the chat panel, click the
    downward arrow and select Agent from the list ([Figure 4-12](#switch-to-agent-mode)).
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
- en: '![](assets/lghc_0412.png)'
  id: totrans-85
  prefs: []
  type: TYPE_IMG
- en: Figure 4-12\. Switch to Agent mode
  id: totrans-86
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: Because Agent mode is more powerful and autonomous than Edits, we can prompt
    Copilot to do sets of changes that are more significant. We’ll still keep them
    fairly simple here to introduce the process. But in [“Debugging with Copilot”](#debugging-with-copilot),
    you’ll see how to leverage Agent mode for a much more advanced task.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
- en: 'With Copilot in Agent mode, we’re going to have it make three sets of changes
    to our calculator code. Those changes are as follows:'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
- en: Add logging to all functions in *calculator.py*.
  id: totrans-89
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Create a CLI for the calculator application and validate that it works as expected.
  id: totrans-90
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Generate documentation for all functions by using docstrings.
  id: totrans-91
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: As usual, we need to add the prompts to the text input area, as shown in [Figure 4-14](#prompts-for-changes-v2).
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
- en: '![](assets/lghc_0414.png)'
  id: totrans-93
  prefs: []
  type: TYPE_IMG
- en: Figure 4-14\. Prompts for changes via Agent mode
  id: totrans-94
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: Now we are ready to submit the prompts. Notice, however, that we didn’t specify
    any additional context. We didn’t specify files as we did in Edits mode. In Agent
    mode, Copilot can autonomously figure out what tasks need to be done and what
    files need to be changed. Copilot can even go further, by applying code edits
    for review, suggesting terminal commands, and even creating new files—depending
    on the prompt. As you work with Agent mode and notice any problems or desired
    changes, you can prompt it further, and it will iterate to resolve any issues.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
- en: Once we submit our prompts, Copilot proceeds to analyze them and create a plan
    to accomplish them ([Figure 4-15](#agent-planning-approa2)).
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
- en: '![](assets/lghc_0415.png)'
  id: totrans-97
  prefs: []
  type: TYPE_IMG
- en: Figure 4-15\. Agent planning an approach
  id: totrans-98
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: After figuring out the plan and what needs to be changed, Copilot will apply
    edits *inline* with theexisting code. As with Edit mode, after Copilot is done,
    the proposed changes will be shown inline in the editor. You can choose to review
    each one and Keep/Undo each proposed change or Keep/Undo all proposed changes
    at once based on the new “files changed” section in the chat area, as seen in
    [Figure 4-16](#agent-changes-made-in).
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 在确定计划和需要更改的内容后，Copilot将对现有代码进行*内联*编辑。与编辑模式一样，Copilot完成后，建议的更改将以内联形式显示在编辑器中。您可以选择逐一审查每个更改并保留/撤销每个建议的更改，或者根据聊天区域中新的“文件更改”部分一次性保留/撤销所有建议的更改，如图[图4-16](#agent-changes-made-in)所示。
- en: '![](assets/lghc_0416.png)'
  id: totrans-100
  prefs: []
  type: TYPE_IMG
  zh: '![图片](assets/lghc_0416.png)'
- en: Figure 4-16\. Agent changes made inline
  id: totrans-101
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图4-16\. 内联进行的代理更改
- en: Time to Complete
  id: totrans-102
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 完成时间
- en: Since Agent mode is performing a large number of operations and iterating until
    the code is working acceptably or it can go no further, execution usually does
    take more time (sometimes considerably more) than operations in Edit or Ask mode.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 由于代理模式执行大量操作，并且迭代直到代码可接受或无法进一步进行，执行通常比编辑或询问模式中的操作花费更多时间（有时会显著更多）。
- en: Files with proposed or pending changes have a symbol (dot inside a square) in
    the file list and on their editor tab, if they’re open in the editor. Once you’ve
    reviewed the proposed changes and chosen what to keep or undo, the Keep/Undo buttons
    in the “files changed” area will change to a Done button. You click this to stop
    this round of editing.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 包含建议或待处理更改的文件在文件列表和它们的编辑器标签上都有一个符号（方形内的点），如果它们在编辑器中打开。一旦您审查了建议的更改并选择了要保留或撤销的内容，位于“文件更改”区域的保留/撤销按钮将变为完成按钮。您点击此按钮以停止这一轮编辑。
- en: Proposed Changes Available for Execution
  id: totrans-105
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 可执行的建议更改
- en: It may not be obvious, but suggested changes that have not been reviewed yet
    will still be factored in when code is executed.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然可能不明显，但尚未审查的建议更改在代码执行时仍将被考虑。
- en: Until you click the Done button, you can change your mind and roll back the
    edits Copilot suggested, even if you chose to keep some or all. You can do this
    in a couple of ways. You can use the Undo option in the “files changed” area above
    the entry area. Or you can click the left-curving arrow at the top of the chat
    panel. Or you can hover over the top of the conversation in the chat and click
    the X there, as shown previously in [Figure 4-10](#one-of-several-option).
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 在您点击完成按钮之前，您可以改变主意并撤销Copilot建议的编辑，即使您选择保留一些或全部。您可以通过以下几种方式做到这一点。您可以使用位于输入区域上方“文件更改”区域中的撤销选项。或者您可以在聊天面板顶部点击左弯曲箭头。或者您可以在聊天中悬停在对话顶部并点击那里的X，如图[图4-10](#one-of-several-option)中所示。
- en: The idea is that you can iterate as much as needed. Once you click the Done
    button, the changes will be persisted in the files.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 理念是您可以迭代所需次数。一旦您点击完成按钮，更改将被保存在文件中。
- en: One other note here is that since we told the agent we wanted it to validate
    that the CLI it created worked as expected, the agent suggested commands to be
    run in the terminal. To run each of these, it was only necessary to copy or direct
    them into the terminal and hit Enter. As shown in [Figure 4-17](#agent-driving-verific2),
    the agent was able in most cases to validate that the output was what was expected
    and conclude that the CLI was working as expected. (For some reason, it could
    not parse the output from the `add` function, but that was working correctly,
    along with the others.)
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 另一点需要注意的是，由于我们告诉代理我们需要它验证创建的CLI是否按预期工作，代理建议在终端中运行的命令。要运行这些命令中的每一个，只需复制或直接将它们输入到终端并按回车键即可。如图[图4-17](#agent-driving-verific2)所示，代理在大多数情况下能够验证输出是否符合预期，并得出CLI按预期工作的结论。（由于某种原因，它无法解析`add`函数的输出，但该函数工作正常，与其他函数一样。）
- en: '![](assets/lghc_0417.png)'
  id: totrans-110
  prefs: []
  type: TYPE_IMG
  zh: '![图片](assets/lghc_0417.png)'
- en: Figure 4-17\. Agent driving the verification
  id: totrans-111
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图4-17\. 代理驱动验证
- en: 'This is only a quick overview and example of Copilot’s agentic AI capabilities.
    As you can likely already tell, this powerful feature can help in many areas of
    making changes—with appropriate prompts and reviews. Expect to see it becoming
    more ubiquitous throughout Copilot and GitHub. To further get an idea of what
    Copilot and its agentic AI functions are capable of, you’ll see how to use them
    in the next section along with another impressive feature of Copilot: parsing
    visual images to derive context and generate code!'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 这只是一个关于Copilot的代理AI能力的快速概述和示例。正如你很可能已经注意到的，这个强大的功能可以帮助在许多需要更改的领域——通过适当的提示和审查。预计它将在Copilot和GitHub中变得更加普遍。为了进一步了解Copilot及其代理AI功能的能力，你将看到如何在下一节中如何使用它们，以及Copilot的另一个令人印象深刻的功能：解析视觉图像以推导上下文并生成代码！
- en: Using Agent Mode with Copilot Free
  id: totrans-113
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用Copilot Free的Agent模式
- en: If you’re relying on the Copilot Free plan, be aware that you have a limited
    number of interactions available per month, and Agent mode can use many interactions.
    Depending on your usage pattern, Agent mode use may consume much of your available
    quota.
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你依赖于Copilot Free计划，请注意你每月可用的交互次数有限，并且Agent模式可能会使用许多交互。根据你的使用模式，Agent模式的使用可能会消耗你大部分的可用配额。
- en: Copilot Vision
  id: totrans-115
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Copilot Vision
- en: Have you ever taken a screenshot of an issue you were running into in the IDE
    and sent it to a coworker because it was easier than trying to explain? Or have
    you ever seen an app interface and wanted to be able to create the code to implement
    one similar in style or appearance?
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 你是否曾经截取过在IDE中遇到的问题截图并发送给同事，因为这样做比试图解释更容易？或者你是否曾经看到过某个应用程序界面，并希望能够创建出风格或外观相似的代码？
- en: If so, or if you expect this might happen at some point, Copilot has visual-based
    functionality that can help you out. *Copilot Vision* is an advanced feature that
    lets you attach and work with images directly in Copilot Chat within certain IDEs.
    Given an image, the AI can interpret and analyze it to provide answers. But it
    can also generate code based on an image.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 如果是这样，或者你预计将来可能会发生这种情况，Copilot具有基于视觉的功能可以帮助你。*Copilot Vision* 是一个高级功能，允许你在某些IDE中的Copilot
    Chat中直接附加并处理图像。给定一个图像，AI可以解释和分析它以提供答案。但它也可以根据图像生成代码。
- en: 'Images supplied to Copilot for analysis or as a basis for code can be of many
    types. Here are some example use cases:'
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 提供给Copilot用于分析或作为代码基础的图像可以是多种类型。以下是一些示例用例：
- en: Supply a screenshot or a mockup of a UI you want Copilot to emulate.
  id: totrans-119
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 提供一个你希望Copilot模仿的UI截图或原型。
- en: Provide an architecture diagram for analysis and explanation.
  id: totrans-120
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 提供一个架构图进行分析和解释。
- en: Provide a screenshot of an issue you’re encountering in the IDE for it to help
    with debugging.
  id: totrans-121
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 提供一个你在IDE中遇到的问题的截图，以便它帮助进行调试。
- en: Provide an image with text that is difficult to read and have Copilot extract
    and report the text so it can be digested.
  id: totrans-122
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 提供一个包含难以阅读文本的图像，让Copilot提取并报告文本以便消化。
- en: Convert hand-drawn diagrams to code.
  id: totrans-123
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将手绘图表转换为代码。
- en: Validate entity relationship diagrams against SQL.
  id: totrans-124
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将实体关系图与SQL进行验证。
- en: Results May Vary
  id: totrans-125
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 结果可能不同
- en: While the various capabilities of Copilot Vision are impressive, your experience
    may vary depending on image quality, the model you choose, and more. As with any
    AI-generated results, you should always be prepared to tweak the input you give
    Copilot if needed and also review the response it produces.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然Copilot Vision的各种功能令人印象深刻，但你的体验可能会因图像质量、你选择的模型等因素而有所不同。与任何AI生成的结果一样，你应该始终准备好在需要时调整提供给Copilot的输入，并审查它产生的响应。
- en: Let’s do a quick example of using Copilot Vision to tell us about an image.
    For this exercise, we’ll use a screenshot of a web app built with a Python library
    named Gradio and hosted on a platform called Hugging Face Spaces. The screenshot
    is shown in [Figure 4-18](#starting-image-for-us2).
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们快速举例说明如何使用Copilot Vision来了解一个图像。为此练习，我们将使用一个使用名为Gradio的Python库构建并托管在Hugging
    Face Spaces平台上的Web应用程序的截图。该截图显示在[图4-18](#starting-image-for-us2)中。
- en: '![](assets/lghc_0418.png)'
  id: totrans-128
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/lghc_0418.png)'
- en: Figure 4-18\. The starting image for use with Vision
  id: totrans-129
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图4-18。用于Vision的起始图像
- en: To use Copilot Vision at the time of this writing, you must attach the image
    to the chat input area. But you don’t have to be in any particular mode. We’ll
    start out working in Ask mode. You can attach the image either by dragging the
    image, pasting it, or selecting it via the usual context methods.  [Figure 4-19](#starting-image-attach)
    shows the image attached.
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
- en: '![](assets/lghc_0419.png)'
  id: totrans-131
  prefs: []
  type: TYPE_IMG
- en: Figure 4-19\. The starting image attached to chat
  id: totrans-132
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: If we then ask Copilot to “Tell me about this,” it examines the image and is
    able to pull a lot of details from it. [Figure 4-20](#initial-image-analysi2)
    shows the start of the output after Copilot’s analysis.
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
- en: '![](assets/lghc_0420.png)'
  id: totrans-134
  prefs: []
  type: TYPE_IMG
- en: Figure 4-20\. Initial image analysis from Copilot
  id: totrans-135
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: 'Here’s the full output from Copilot regarding the image:'
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  id: totrans-137
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: While this is useful, even more interesting is that Copilot can create code
    based on the image. If we prompt it with “Can you write the code for this?”, Copilot
    responds by producing a set of code for it ([Figure 4-21](#creating-code-from-an2)).
    Interestingly, the implementation it chose here uses Python, the Gradio library,
    and Hugging Face’s Transformers library for sentiment analysis. These are the
    same items that were used to originally create the app!
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
- en: '![](assets/lghc_0421.png)'
  id: totrans-139
  prefs: []
  type: TYPE_IMG
- en: Figure 4-21\. Creating code from an image
  id: totrans-140
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: Now let’s see how to incorporate Copilot Vision with Copilot’s agentic AI (via
    Agent mode) to make some impressive changes to the calculator files we’ve used
    in the other sections of this chapter.
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
- en: As it stands right now, our calculator has a command-line interface but no visual
    interface. Suppose we’ve found a picture of an interface ([Figure 4-22](#image-of-desired-inte))
    that we like and would like to have for our calculator.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
- en: '![](assets/lghc_0422.png)'
  id: totrans-143
  prefs: []
  type: TYPE_IMG
- en: Figure 4-22\. The image of the desired interface
  id: totrans-144
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: Let’s use that as context and see if Copilot can create a web interface for
    our calculator based on that image. At the same time, we also want to add a new
    function to do exponents. And since we’re adding the web interface, to simplify
    things when we’re running the app, let’s remove the CLI.
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
- en: 'Our prompt then might look something like this:'
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE8]'
  id: totrans-147
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: '[Figure 4-23](#prompts-and-image-for2) shows the image attached and the prompts
    ready to go. Note that, given the level of change and complexity, we switched
    back to Agent mode for Copilot to accomplish this.'
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
- en: '![](assets/lghc_0423.png)'
  id: totrans-149
  prefs: []
  type: TYPE_IMG
- en: Figure 4-23\. Prompts and the image for calculator updates
  id: totrans-150
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: 'After submitting the prompts, the Copilot agent will assess what needs to be
    done, come up with a plan, and start proposing and making changes.  [Figure 4-24](#agent-creating-web-in)
    shows example output where the agent is working on the needed changes to create
    the web app based on the image. Notice the multiple processes it’s handling, including
    these:'
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
- en: Getting Flask installed
  id: totrans-152
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Adding web interface pieces and updating routes for all operations in the main
    file
  id: totrans-153
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Creating new files where needed, such as *index.html*
  id: totrans-154
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](assets/lghc_0424.png)'
  id: totrans-155
  prefs: []
  type: TYPE_IMG
- en: Figure 4-24\. Agent creating the web interface
  id: totrans-156
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图4-24\. 代理创建Web界面
- en: Depending on the prompt and complexity, Copilot may stop and suggest code for
    you to use to create a new file, or it can create the file itself. Similarly,
    it may install dependencies and run terminal commands or suggest them and have
    you execute the needed commands. If you don’t see as much autonomous behavior
    as you were expecting, you can revise the prompt to tell/give permission to Copilot
    to do more up front. Examples would be telling it to create any needed files or
    to update requirements.
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 根据提示和复杂度，Copilot可能会停止并建议你使用代码来创建新文件，或者它可以自己创建文件。同样，它可能会安装依赖项并运行终端命令，或者建议你执行所需的命令。如果你没有看到你期望的那么多自主行为，你可以修改提示，告诉/给予Copilot更多前置权限。例如，可以告诉它创建所需的任何文件或更新需求。
- en: Sometimes Copilot may require multiple iterations with Agent mode to get the
    results you want. For example, if an issue or problem occurs when the generated
    code changes are run, you may have to go back and tell Copilot about the issue
    in the agent prompt and ask it to make additional changes to fix it. When first
    running through the examples for this chapter, the results were not being shown
    correctly in the web app. After going through two more iterations, Copilot found
    and fixed the issue.
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 有时Copilot可能需要使用代理模式进行多次迭代才能得到你想要的结果。例如，如果生成的代码更改运行时出现问题或问题，你可能需要返回并告诉Copilot代理提示中的问题，并要求它进行额外的更改以修复它。在第一次运行本章的示例时，Web应用中的结果没有正确显示。经过两次更多迭代后，Copilot找到了并修复了这个问题。
- en: 'Any iteration with the Agent mode follows the same process of making a plan,
    updating content with suggested changes inline, and running commands. The output
    is the same: a set of changes that can be run to test out the code and reviewed
    to Keep or Undo. [Figure 4-25](#ready-after-iteration) shows an example after
    the agent fixed a reported issue of results not being shown initially.'
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 任何使用代理模式的迭代都遵循制定计划、使用建议的更改更新内容以及运行命令的过程。输出是相同的：一组可以运行以测试代码并审查以保留或撤销的更改。[图4-25](#ready-after-iteration)显示了代理修复了最初未显示结果的问题后的一个示例。
- en: '![](assets/lghc_0425.png)'
  id: totrans-160
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/lghc_0425.png)'
- en: Figure 4-25\. Ready after iterations
  id: totrans-161
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图4-25\. 迭代后准备就绪
- en: '[Figure 4-26](#final-webapp2) shows the final result running the actual calculator
    code web app interface created by the Copilot agent. As you can see, it is impressively
    similar to the reference image it was given and works as expected. Also note that
    per the prompt to add a function to handle exponents, the web app interface Copilot
    produced has a calculator button (second from left in the first row) to do exponents
    (**) that was not in the original image.'
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: '[图4-26](#final-webapp2)显示了Copilot代理创建的实际计算器代码Web应用界面的最终结果。正如你所见，它与提供的参考图像非常相似，并且按预期工作。此外，请注意，根据添加处理指数函数的提示，Copilot生成的Web应用界面有一个计算器按钮（第一行从左数第二个），用于执行指数（**），这在原始图像中并不存在。'
- en: '![](assets/lghc_0426.png)'
  id: totrans-163
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/lghc_0426.png)'
- en: Figure 4-26\. Final web app
  id: totrans-164
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图4-26\. 最终Web应用
- en: Copilot Vision, along with NES and Agent mode, can certainly simplify getting
    code created and updated. But, of course, you need to make sure you can figure
    out what’s wrong when the generated code isn’t working as intended. To help when
    that happens, we’ll briefly discuss how Copilot can assist you with debugging.
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: Copilot Vision，连同NES和代理模式，无疑可以简化代码的创建和更新。但当然，你需要确保当你生成的代码没有按预期工作的时候，你能找出问题所在。为了帮助这种情况，我们将简要讨论Copilot如何帮助你进行调试。
- en: Debugging with Copilot
  id: totrans-166
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用Copilot进行调试
- en: We’ve previously discussed several Copilot capabilities that are useful for
    helping you debug problems. We’ve talked about the `/explain` command to help
    explain code that might be having issues, and the `/fix` command to have Copilot
    suggest fixes for bugs. Copilot also has a few other features that can be helpful.
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 我们之前讨论了几个对帮助调试问题有用的Copilot功能。我们谈到了`/explain`命令，它可以帮助解释可能存在问题的代码，以及`/fix`命令，让Copilot为错误提出修复建议。Copilot还有一些其他功能可能很有帮助。
- en: In VS Code, Copilot can help set up and customize debug configurations. For
    example, you can use the `/startDebugging` shortcut command to create a *launch.json*
    file if one doesn’t exist, as shown in [Figure 4-27](#using-startdebugging). The
    same could also be done via a prompt in the chat.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 在VS Code中，Copilot可以帮助设置和自定义调试配置。例如，你可以使用`/startDebugging`快捷命令创建一个`*launch.json*`文件（如果不存在的话），如[图4-27](#using-startdebugging)所示。同样，这也可以通过聊天中的提示来完成。
- en: '![](assets/lghc_0427.png)'
  id: totrans-169
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/lghc_0427.png)'
- en: Figure 4-27\. Using `/startDebugging` to generate the launch configuration
  id: totrans-170
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-27\. 使用 `/startDebugging` 生成启动配置
- en: The same `/startDebugging` command can also be used to start a debugging session.
    When running the command, if a suitable launch config is not found, Copilot will
    generate one first. In the same conversation, Copilot will then typically include
    a button that you can click to start the actual debug process ([Figure 4-28](#debugging-session-fro)).
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 同样的 `/startDebugging` 命令也可以用来启动调试会话。在运行命令时，如果没有找到合适的启动配置，Copilot 会首先生成一个。在同一个对话中，Copilot
    通常会包含一个您可以点击的按钮，以启动实际的调试过程（[图 4-28](#debugging-session-fro)）。
- en: '![](assets/lghc_0428.png)'
  id: totrans-172
  prefs: []
  type: TYPE_IMG
  zh: '![图片](assets/lghc_0428.png)'
- en: Figure 4-28\. A debugging session from Copilot
  id: totrans-173
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-28\. Copilot 的调试会话
- en: In some IDEs, like Visual Studio, Copilot integration includes an *exception
    helper*. This means that if an exception like `IndexOutOfRangeException` occurs
    during a debugging exception, a pop-up will display an Ask Copilot option. Copilot
    will provide an explanation of the error, a suggested code fix, and can even preview
    and apply the fix directly in your IDE. For more details on how to use this, see
    [the documentation](https://oreil.ly/QopeF).
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 在某些 IDE 中，如 Visual Studio，Copilot 集成包括一个 *异常助手*。这意味着如果在调试过程中发生 `IndexOutOfRangeException`
    等异常，将显示一个弹出窗口，并提供“询问 Copilot”选项。Copilot 将提供错误解释、建议的代码修复，甚至可以直接在您的 IDE 中预览并应用修复。有关如何使用此功能的更多详细信息，请参阅
    [文档](https://oreil.ly/QopeF)。
- en: 'If you’re doing unit testing with Test Explorer in Visual Studio 2022, you
    have a Debug with Copilot button available. With this feature, Copilot does the
    following when a test fails:'
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您在 Visual Studio 2022 的测试资源管理器中进行单元测试，您将有一个“使用 Copilot 调试”按钮可用。使用此功能时，如果测试失败，Copilot
    会执行以下操作：
- en: Generates a comprehensive debug plan
  id: totrans-176
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 生成全面的调试计划
- en: Sets breakpoints
  id: totrans-177
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 设置断点
- en: Watches critical variables
  id: totrans-178
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 监视关键变量
- en: Guides you through the debugging process
  id: totrans-179
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 引导您完成调试过程
- en: Along the way, Copilot analyzes values of variables at breakpoints, providing
    guidance and suggestions in a feedback loop.
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 在此过程中，Copilot 会分析断点处的变量值，在反馈循环中提供指导和建议。
- en: IDE-Specific Features
  id: totrans-181
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: IDE 特定功能
- en: Some features in Copilot are only available in certain IDEs. The exception helper
    and Debug with Copilot option in Test Explorer are only available in Visual Studio
    (not in other IDEs like VS Code) at the time of this writing.
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: Copilot 的一些功能仅在特定 IDE 中可用。在撰写本文时，异常助手和测试资源管理器中的“使用 Copilot 调试”选项仅在 Visual Studio
    中可用（在其他 IDE 如 VS Code 中不可用）。
- en: 'Copilot also provides another command in some IDEs called `copilot-debug`.
    You can run this command from a terminal with your application to start a debug
    session. Here’s an example:'
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: Copilot 在某些 IDE 中还提供另一个名为 `copilot-debug` 的命令。您可以从终端运行此命令并使用您的应用程序启动调试会话。以下是一个示例：
- en: '[PRE9]'
  id: totrans-184
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: copilot-debug Issues
  id: totrans-185
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: copilot-debug 问题
- en: While `copilot-debug` can be convenient in the terminal, it seems to get *stuck*
    in some cases waiting for the IDE to connect. If you encounter an issue running
    it, try the `/startDebugging` command or built-in functionality in the IDE to
    run a debug session.
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然 `copilot-debug` 在终端中可能很方便，但在某些情况下它似乎会 *卡住*，等待 IDE 连接。如果您在运行它时遇到问题，请尝试 `/startDebugging`
    命令或 IDE 内置功能来运行调试会话。
- en: Finally, you can use one other technique to debug issues that ties back in with
    the Copilot Vision functionality we discussed previously. You can have Copilot
    debug a problem from a screenshot.
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，您还可以使用另一种技术来调试问题，这与我们之前讨论的 Copilot 视觉功能相关。您可以让 Copilot 从截图调试问题。
- en: Suppose we have a screenshot of some simple C# code (as shown in [Figure 4-29](#screenshot-of-c-sharp))
    saved as the file *Screenshot 2025-04-28 at 12.37.05 PM.png*.
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 假设我们有一个简单 C# 代码的截图（如图 [图 4-29](#screenshot-of-c-sharp) 所示），保存为文件 *Screenshot
    2025-04-28 at 12.37.05 PM.png*。
- en: '![](assets/lghc_0429.png)'
  id: totrans-189
  prefs: []
  type: TYPE_IMG
  zh: '![图片](assets/lghc_0429.png)'
- en: Figure 4-29\. Screenshot of C# code
  id: totrans-190
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-29\. C# 代码的截图
- en: We can attach that file to our chat dialog and then ask Copilot to help us debug
    any issues with it. [Figure 4-30](#prompt-to-debug-from) shows one possible prompt.
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以将该文件附加到我们的聊天对话框中，然后要求 Copilot 帮助我们调试其中任何问题。[图 4-30](#prompt-to-debug-from)
    显示了一个可能的提示。
- en: '![](assets/lghc_0430.png)'
  id: totrans-192
  prefs: []
  type: TYPE_IMG
  zh: '![图片](assets/lghc_0430.png)'
- en: Figure 4-30\. A prompt to debug from the screenshot
  id: totrans-193
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-30\. 从截图进行调试的提示
- en: After processing the prompt and the screenshot, Copilot responds by detailing
    an unhandled exception that can result from a divide-by-zero condition and suggesting
    code to resolve the issue ([Figure 4-31](#results-of-analyzing)).
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 在处理提示和截图后，Copilot 通过详细说明可能由除以零条件导致的未处理异常，并建议解决该问题的代码来响应([图 4-31](#results-of-analyzing))。
- en: '![](assets/lghc_0431.png)'
  id: totrans-195
  prefs: []
  type: TYPE_IMG
- en: Figure 4-31\. Results of analyzing the screenshot
  id: totrans-196
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: Ultimately, whether you take advantage of any of the built-in features for debugging
    in Copilot, the chat interface is still one of your best tools. When you encounter
    an issue and aren’t sure why it happens, try asking Copilot via a query. Remember
    that specific queries like “Why does this API call fail for valid input?” yield
    better results than vague requests.
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
- en: Conclusion
  id: totrans-198
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this chapter, we’ve looked at several advanced editing and workflow functionalities,
    including NES, Copilot Edits, Copilot Agent mode, and Copilot Vision. If you have
    a limited set of changes, deciding which of the first three to use can be confusing.
    [Table 4-1](#comparing-advanced-co) provides some suggestions to try to clarify
    when to use each.
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
- en: 'In terms of scope, a simple way to think about the differences is as follows:'
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
- en: NES works at the code-edit level (single file).
  id: totrans-201
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Copilot Edits operates at the project session level (multiple files).
  id: totrans-202
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Agent mode functions at the system level (code + terminal + testing).
  id: totrans-203
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: For quick inline fixes, NES provides instant suggestions. Copilot Edits is great
    for guided multifile changes. Agent mode handles complete development lifecycle
    tasks including code updates and creation, validation, and execution.
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
- en: With all these features, Copilot provides developer control through Keep/Undo
    mechanisms and the ability to *roll back* changes.
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
- en: Copilot Vision allows Copilot to extract information from images, such as screenshots
    of a problem, design diagrams, application interfaces, and more. With the extracted
    information, Copilot can answer questions about the image, do analysis, create
    text or code based on the image, or leverage parts of the image to solve problems
    or complete a task. The functionality is easy to use by simply pasting/dragging
    an image into the chat input area, regardless of which chat mode you’re in.
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
- en: There’s one other key point to make about Agent mode. AI agents are growing
    in capabilities, utility, abilities to interact with their environment, and adaptability
    for handling all kinds of tasks. Expect Copilot’s agentic AI capabilities to continue
    to expand and grow and be used in other parts of the IDEs and Copilot interfaces.
    There is really no limit to what the agent component can do, given the right prompting
    and tools.
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
- en: Copilot also includes tools to help with debugging, such as the shortcut `/startDebugging`
    command. You can even have Copilot analyze and debug from screenshots. Along with
    other functionality previously discussed to explain and fix problems via Copilot,
    these tools can help you more quickly determine the causes of issues. It’s important
    to note, though, that not all Copilot debug features are provided in all IDEs.
    Your best bet may still be asking Copilot specific *why* questions about issues
    in the chat interface.
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
- en: With this solid foundation on the basic and advanced use of Copilot, we can
    move on to some of the targeted tasks it can help with, such as test generation,
    documentation, and code translation. These capabilities can be among the most
    valuable to reduce your time spent doing routine tasks and allowing for more focus
    on the interesting and fun parts of writing code. We’ll discuss how to leverage
    Copilot to handle these in the next few chapters, starting with using Copilot
    for testing in [Chapter 5](ch05.html#ch05).
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: 在掌握了Copilot的基本和高级用法这个坚实基础之后，我们可以继续探讨它可以帮助完成的一些特定任务，例如测试生成、文档编写和代码翻译。这些功能可能是最宝贵的，可以帮助您减少在常规任务上的时间投入，让您有更多精力专注于编写代码的有趣和愉快部分。我们将在接下来的几章中讨论如何利用Copilot来处理这些任务，从第5章开始，我们将探讨如何使用Copilot进行测试。[第5章](ch05.html#ch05)。
