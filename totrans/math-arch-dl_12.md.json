["```py\nimport torch\n\ndef inference_unknown_mean(X, prior_dist, sigma_known):\n    mu_mle = X.mean()\n    n = X.shape[0]\n\n    mu_0 = prior_dist.mean\n    sigma_0 = prior_dist.scale                             ①\n\n    mu_n = mu_mle / (1 + sigma_known**2 / (n * sigma_0**2)) +\n             mu_0 / (1 + n * sigma_0**2 / sigma_known**2)  ②\n\n    sigma_n = math.sqrt(\n        (sigma_0**2 * sigma_known**2) /\n        (n*sigma_0**2+sigma_known**2))                     ③\n\n    posterior_dist = torch.Normal(mu_n, sigma_n)\n    return posterior_dist\n```", "```py\nimport torch\n\ndef inference_unknown_variance(X, prior_dist):\n    sigma_mle = torch.std(X)\n    n = X.shape[0]\n\n    alpha_0 = prior_dist.concentration\n    beta_0 = prior_dist.rate                 ①\n\n    alpha_n = n / 2 + alpha_0\n    beta_n = n / 2 * sigma_mle ** 2 + beta_0 ②\n\n    posterior_dist = torch.Gamma(alpha_n, beta_n)\n    return posterior_dist\n```", "```py\nimport torch\n\nclass NormalGamma():                            ①\n\n    def __init__(self, mu_, lambda_, alpha_, beta_):\n        self.mu_ = mu_\n        self.lambda_ = lambda_\n        self.alpha_ = alpha_\n        self.beta_ = beta_\n\n    @property\n    def mean(self):\n        return self.mu_, self.alpha_/ self.beta_\n\n    @property\n    def mode(self):\n        return self.mu_, (self.alpha_-0.5)/ self.beta_\n```", "```py\nimport torch\n\ndef inference_unknown_mean_variance(X, prior_dist):\n    mu_mle = X.mean()\n    sigma_mle = X.std()\n    n = X.shape[0]\n\n    mu_0 = prior_dist.mu_\n    lambda_0 = prior_dist.lambda_\n    alpha_0 = prior_dist.alpha_\n    beta_0 = prior_dist.beta_                   ①\n\n    mu_n = (n * mu_mle + mu_0 * lambda_0) / (lambda_0 + n)\n    lambda_n = n + lambda_0\n    alpha_n = n / 2 + alpha_0\n    beta_n = n / 2 * sigma_mle ** 2 + beta_0 +\n             0.5* n * lambda_0/ (n + lambda_0) *\n             (mu_mle - mu_0) ** 2               ②\n\n    posterior_dist = NormalGamma(mu_n, lambda_n, alpha_n, beta_n)\n\n    return posterior_dist\n```", "```py\nprior_dist = NormalGamma(150, 100, 10.5, 810)                   ①\n\nposterior_dist = inference_unknown_mean_variance(X, prior_dist) ②\n\nmap_mu, map_precision =  posterior_dist.mode                    ③\n\nmap_std = math.sqrt(1 / map_precision)                          ④\n\nmap_dist = Normal(map_mu, map_std)                              ⑤\n```", "```py\ndef inference_known_precision(X, prior_dist, precision_known):\n    mu_mle = X.mean(dim=0)\n    n = X.shape[0]\n\n    mu_0 = prior_dist.mean\n    precision_0 = prior_dist.precision_matrix       ①\n\n    precision_n = n * precision_known + precision_0 ②\n    mu_n = torch.matmul(\n        n * torch.matmul(\n            mu_mle.unsqueeze(0), precision_known) + torch.matmul(\n                mu_0.unsqueeze(0), precision_0),\n        torch.inverse(precision_n)\n     )\n\n    posterior_dist = MultivariateNormal(\n        mu_n, precision_matrix=precision_n)\n    return posterior_dist\n```"]