["```py\n.../portfolio-project (main) $ cd chapter7\n.../chapter7 (main) $ mkdir sdk\n.../chapter7 (main) $ cd sdk\n.../sdk (main) $ touch pyproject.toml\n```", "```py\n[build-system] ![1](assets/1.png)\nrequires = [\"setuptools>=61.0\"]\nbuild-backend = \"setuptools.build_meta\"\n\n[project] ![2](assets/2.png)\nname = \"swcpy\"\nversion = \"0.0.1\" ![3](assets/3.png)\nauthors = [\n  { name=\"[enter your name]\" },\n]\ndescription = \"Example SDK from Hands-On API Book for AI and Data Science\"\nrequires-python = \">=3.10\" ![4](assets/4.png)\nclassifiers = [\n    \"Development Status :: 3 - Alpha\", ![5](assets/5.png)\n    \"Programming Language :: Python :: 3\",\n    \"License :: OSI Approved :: MIT License\",\n    \"Operating System :: OS Independent\",\n]\ndependencies = [ ![6](assets/6.png)\n       'pytest>=8.1',\n       'httpx>=0.27.0',\n]\n```", "```py\n.../sdk (main) $ mkdir src\n.../sdk (main) $ mkdir src/swcpy\n.../sdk (main) $ touch src/swcpy/__init__.py ![1](assets/1.png)\n.../sdk (main) $ touch src/swcpy/swc_client.py\n```", "```py\nimport httpx ![1](assets/1.png)\n\nclass SWCClient:\n\n    def __init__(self, swc_base_url: str): ![2](assets/2.png)\n        self.swc_base_url = swc_base_url ![3](assets/3.png)\n\n    def get_health_check(self): ![4](assets/4.png)\n        # make the API call\n        with httpx.Client(base_url=self.swc_base_url) as client: ![5](assets/5.png)\n            return client.get(\"/\") \n```", "```py\n.../sdk (main) $ pip3 install -e .\nProcessing /workspaces/portfolio-project/chapter7/sdk\n  Installing build dependencies ... done\n  Getting requirements to build wheel ... done\n  Preparing metadata (pyproject.toml) ... done\n...\nSuccessfully built swcpy\nInstalling collected packages: pluggy, iniconfig, pytest, swcpy\nSuccessfully installed iniconfig-2.0.0 pluggy-1.5.0 pytest-8.2.2 swcpy-0.0.1\n```", "```py\n.../sdk (main) $ tree --prune -I 'build|*.egg-info|__pycache__'\n.\n├── pyproject.toml\n├── src\n    └── swcpy\n        ├── __init__.py\n        └── swc_client.py\n\n2 directories, 3 files\n```", "```py\n.../sdk (main) $ touch src/swcpy/swc_config.py\n```", "```py\nimport os\nfrom dotenv import load_dotenv ![1](assets/1.png)\n\nload_dotenv() ![2](assets/2.png)\n\nclass SWCConfig: \n    \"\"\"Configuration class containing arguments for the SDK client.\n\n    Contains configuration for the base URL and progressive backoff.\n    \"\"\"\n\n    swc_base_url: str ![3](assets/3.png)\n    swc_backoff: bool ![4](assets/4.png)\n    swc_backoff_max_time: int ![5](assets/5.png)\n    swc_bulk_file_format: str ![6](assets/6.png)\n\n    def __init__( ![7](assets/7.png)\n        self,\n        swc_base_url: str = None,\n        backoff: bool = True,\n        backoff_max_time: int = 30,\n        bulk_file_format: str = \"csv\",\n    ):\n        \"\"\"Constructor for configuration class.\n\n        Contains initialization values to overwrite defaults.\n\n        Args:\n        swc_base_url (optional):\n            The base URL to use for all the API calls. Pass this in or set \n            in environment variable.\n        swc_backoff:\n            A boolean that determines if the SDK should\n            retry the call using backoff when errors occur.\n        swc_backoff_max_time:\n            The max number of seconds the SDK should keep\n            trying an API call before stopping.\n        swc_bulk_file_format:\n            If bulk files should be in csv or parquet format.\n        \"\"\"\n\n        self.swc_base_url = swc_base_url or os.getenv(\"SWC_API_BASE_URL\") ![8](assets/8.png)\n        print(f\"SWC_API_BASE_URL in SWCConfig init: {self.swc_base_url}\")  \n\n        if not self.swc_base_url: ![9](assets/9.png)\n            raise ValueError(\"Base URL is required. Set SWC_API_BASE_URL \n                              environment variable.\")\n\n        self.swc_backoff = backoff\n        self.swc_backoff_max_time = backoff_max_time\n        self.swc_bulk_file_format = bulk_file_format\n\n    def __str__(self): ![10](assets/10.png)\n        \"\"\"Stringify function to return contents of config object for logging\"\"\"\n        return f\"{self.swc_base_url} {self.swc_backoff} \n        {self.swc_backoff_max_time}  {self.swc_bulk_file_format}\"\n```", "```py\nfrom .swc_client import SWCClient\nfrom .swc_config import SWCConfig\n```", "```py\n.../sdk (main) $ mkdir src/swcpy/schemas\n.../sdk (main) $ echo \"from .schemas import *\" > src/swcpy/schemas/__init__.py\n```", "```py\n.../sdk (main) $ cp ../../chapter6/complete/schemas.py src/swcpy/schemas\n```", "```py\nimport httpx\nimport swcpy.swc_config as config ![1](assets/1.png)\nfrom .schemas import League, Team, Player, Performance ![2](assets/2.png)\nfrom typing import List ![3](assets/3.png)\nimport backoff ![4](assets/4.png)\nimport logging ![5](assets/5.png)\nlogger = logging.getLogger(__name__)\n\nclass SWCClient:\n    \"\"\"Interacts with the SportsWorldCentral API.\n\n        This SDK class simplifies the process of using the SWC Fantasy\n        Football API. It supports all the functions of the SWC API and returns\n        validated data types.\n\n    Typical usage example:\n\n        client = SWCClient()\n        response = client.get_health_check()\n\n    \"\"\"\n\n    HEALTH_CHECK_ENDPOINT = \"/\" ![6](assets/6.png)\n    LIST_LEAGUES_ENDPOINT = \"/v0/leagues/\"\n    LIST_PLAYERS_ENDPOINT = \"/v0/players/\"\n    LIST_PERFORMANCES_ENDPOINT = \"/v0/performances/\"\n    LIST_TEAMS_ENDPOINT = \"/v0/teams/\"\n    GET_COUNTS_ENDPOINT = \"/v0/counts/\"\n\n    BULK_FILE_BASE_URL = (\n        \"https://raw.githubusercontent.com/*[github ID]*\" ![7](assets/7.png)\n        + \"/portfolio-project/main/bulk/\"\n    )\n\n    def __init__(self, input_config: config.SWCConfig): ![8](assets/8.png)\n        \"\"\"Class constructor that sets variables from configuration object.\"\"\"\n\n        logger.debug(f\"Bulk file base URL: {self.BULK_FILE_BASE_URL}\")\n\n        logger.debug(f\"Input config: {input_config}\")\n\n        self.swc_base_url = input_config.swc_base_url\n        self.backoff = input_config.swc_backoff\n        self.backoff_max_time = input_config.swc_backoff_max_time\n        self.bulk_file_format = input_config.swc_bulk_file_format\n\n        self.BULK_FILE_NAMES = { ![9](assets/9.png)\n            \"players\": \"player_data\",\n            \"leagues\": \"league_data\",\n            \"performances\": \"performance_data\",\n            \"teams\": \"team_data\",\n            \"team_players\": \"team_player_data\",\n        }\n\n        if self.backoff: ![10](assets/10.png)\n            self.call_api = backoff.on_exception(\n                wait_gen=backoff.expo,\n                exception=(httpx.RequestError, httpx.HTTPStatusError),\n                max_time=self.backoff_max_time,\n                jitter=backoff.random_jitter,\n            )(self.call_api)\n\n        if self.bulk_file_format.lower() == \"parquet\": ![11](assets/11.png)\n            self.BULK_FILE_NAMES = {\n                key: value + \".parquet\" for key, value in \n                self.BULK_FILE_NAMES.items()\n            }\n        else:\n            self.BULK_FILE_NAMES = {\n                key: value + \".csv\" for key, value in \n                self.BULK_FILE_NAMES.items()\n            }\n\n        logger.debug(f\"Bulk file dictionary: {self.BULK_FILE_NAMES}\")\n```", "```py\n        if self.backoff:\n            self.get_url = backoff.on_exception(\n                wait_gen=backoff.expo, ![1](assets/1.png)\n                exception=(httpx.RequestError, httpx.HTTPStatusError), ![2](assets/2.png)\n                max_time=self.backoff_max_time, ![3](assets/3.png)\n                jitter=backoff.random_jitter, ![4](assets/4.png)\n            )(self.call_api)\n```", "```py\n    def call_api(self, ![1](assets/1.png)\n            api_endpoint: str, ![2](assets/2.png)\n            api_params: dict = None ![3](assets/3.png)\n        ) -> httpx.Response: ![4](assets/4.png)\n        \"\"\"Makes API call and logs errors.\"\"\"\n\n        if api_params: ![5](assets/5.png)\n            api_params = {key: val for key, val in api_params.items() if val \n            is not None}\n\n        try:\n            with httpx.Client(base_url=self.swc_base_url) as client:  ![6](assets/6.png)\n                logger.debug(f\"base_url: {self.swc_base_url}, api_endpoint:\n                 {api_endpoint}, api_params: {api_params}\") ![7](assets/7.png)\n                response = client.get(api_endpoint, params=api_params)\n                logger.debug(f\"Response JSON: {response.json()}\")\n                return response\n        except httpx.HTTPStatusError as e:\n            logger.error(\n                f\"HTTP status error occurred: {e.response.status_code} \n                {e.response.text}\"\n            )\n            raise\n        except httpx.RequestError as e:\n            logger.error(f\"Request error occurred: {str(e)}\")\n            raise\n```", "```py\n    with httpx.Client(base_url=self.swc_base_url) as client:\n```", "```py\n    def get_health_check(self) -> httpx.Response:\n        \"\"\"Checks if API is running and healthy.\n\n        Calls the API health check endpoint and returns a standard\n        message if the API is running normally. Can be used to check\n        status of API before making more complicated API calls.\n\n        Returns:\n          An httpx.Response object that contains the HTTP status,\n          JSON response and other information received from the API.\n\n        \"\"\"\n        logger.debug(\"Entered health check\")\n        endpoint_url = self.HEALTH_CHECK_ENDPOINT ![1](assets/1.png)\n        return self.call_api(endpoint_url)\n\n    def list_leagues(\n        self,\n        skip: int = 0, \n        limit: int = 100, \n        minimum_last_changed_date: str = None,\n        league_name: str = None,\n    ) -> List[League]: ![2](assets/2.png)\n        \"\"\"Returns a List of Leagues filtered by parameters.\n\n        Calls the API v0/leagues endpoint and returns a list of\n        League objects.\n\n        Returns:\n        A List of schemas.League objects. Each represents one\n        SportsWorldCentral fantasy league.\n\n        \"\"\"\n        logger.debug(\"Entered list leagues\")\n\n        params = {  ![3](assets/3.png)\n            \"skip\": skip,\n            \"limit\": limit,\n            \"minimum_last_changed_date\": minimum_last_changed_date,\n            \"league_name\": league_name,\n        }\n\n        response = self.call_api(self.LIST_LEAGUES_ENDPOINT, params) ![4](assets/4.png)\n        return [League(**league) for league in response.json()] ![5](assets/5.png)\n```", "```py\n    return [League(**league) for league in response.json()]\n```", "```py\n.../sdk (main) $ ls /workspaces/portfolio-project/bulk\ncsv_to_parquet.py     performance_data.parquet  team_data.csv\nleague_data.csv       player_data.csv           team_data.parquet\nleague_data.parquet   player_data.parquet       team_player_data.csv\nperformance_data.csv  readme.md                 team_player_data.parquet\n```", "```py\nplayer_id,gsis_id,first_name,last_name,position,last_changed_date\n1001,00-0023459,Aaron,Rodgers,QB,2024-04-18\n```", "```py\n    def get_bulk_player_file(self) -> bytes: ![1](assets/1.png)\n        \"\"\"Returns a bulk file with player data\"\"\"\n\n        logger.debug(\"Entered get bulk player file\")\n\n        player_file_path = self.BULK_FILE_BASE_URL + self.BULK_FILE_NAMES\n                           [\"players\"] ![2](assets/2.png)\n\n        response = httpx.get(player_file_path, follow_redirects=True) ![3](assets/3.png)\n\n        if response.status_code == 200:\n            logger.debug(\"File downloaded successfully\")\n            return response.content ![4](assets/4.png)\n```", "```py\n[build-system]\nrequires = [\"setuptools>=61.0\"]\nbuild-backend = \"setuptools.build_meta\"\n\n[project]\nname = \"swcpy\"\nversion = \"0.0.2\" ![1](assets/1.png)\nauthors = [\n  { name=\"[enter your name]\" },\n]\ndescription = \"Example Software Development Kit (SDK) from Hands-On API Book \nfor AI and Data Science\"\nrequires-python = \">=3.10\"\nclassifiers = [\n    \"Development Status :: 3 - Alpha\",\n    \"Programming Language :: Python :: 3\",\n    \"License :: OSI Approved :: MIT License\",\n    \"Operating System :: OS Independent\",\n]\ndependencies = [\n       'pytest>=8.1',\n       'httpx>=0.27.0',\n       'pydantic>=2.4.0', ![2](assets/2.png)\n       'backoff>=2.2.1', ![3](assets/3.png)\n       'pyarrow>=16.0', ![4](assets/4.png)\n]\n```", "```py\n.../sdk (main) $ touch README.md\n```", "```py\n# swcpy software development kit (SDK)\nThis is the Python SDK to interact with the SportsWorldCentral Football API, \nwhich was created for the book [Hands-On APIs for AI and Data Science]\n(https://handsonapibook.com).\n\n## Installing swcpy\n\nTo install this SDK in your environment, execute the following command:\n\n`pip install swcpy@git+https://github.com/{owner of repo}/\n portfolio-project#subdirectory=sdk`\n\n## Example usage\n\nThis SDK implements all the endpoints in the SWC API, in addition to providing \nbulk downloads of the SWC fantasy data in CSV format.\n\n### Setting base URL for the API\nThe SDK looks for a value of `SWC_API_BASE_URL` in the environment. The preferred \nmethod for setting the base URL for the SWC API is by creating a Python \n`.env` file in your project directory with the following value:\n\n```", "```py\n\nYou may also set this value as an environment variable in the environment you \nare using the SDK, or pass it as a parameter to the `SWCConfig()` method.\n\n### Example of normal API functions\n\nTo call the SDK functions for normal API endpoints, here is an example:\n\n```", "```py\n\n### Example of bulk data functions\n\nThe build data endpoint returns a bytes object. Here is an example of saving \na file locally from a bulk file endpoint:\n\n```", "```py\n```", "```py\n## Installing swcpy\n\nTo install this SDK in your environment, execute the following command:\n\n`pip install swcpy@git+https://github.com/{owner of repo}\n/portfolio-project#subdirectory=sdk`\n```", "```py\n.../sdk (main) $ tree --prune -I 'build|*.egg-info|__pycache__'\n.\n├── README.md\n├── pyproject.toml\n└── src\n    └── swcpy\n        ├── __init__.py\n        ├── schemas\n        │   ├── __init__.py\n        │   └── schemas.py\n        ├── swc_client.py\n        └── swc_config.py\n\n3 directories, 7 files\n```", "```py\n.../sdk (main) $ pip3 install --upgrade .\nProcessing /workspaces/portfolio-project/chapter7/sdk\n  Installing build dependencies ... done\n  Getting requirements to build wheel ... done\n  Preparing metadata (pyproject.toml) ... done\n...\nSuccessfully built swcpy\nInstalling collected packages: pydantic-core, backoff, annotated-types, pydantic,\nswcpy\n  Attempting uninstall: swcpy\n    Found existing installation: swcpy 0.0.1\n    Uninstalling swcpy-0.0.1:\n      Successfully uninstalled swcpy-0.0.1\nSuccessfully installed annotated-types-0.7.0 backoff-2.2.1 pyarrow-16.1.0\npydantic-2.4.2 pydantic-core-2.10.1 swcpy-0.0.2\n```", "```py\n.../sdk (main) $ mkdir tests\n.../sdk (main) $ touch tests/test_swcpy.py\n```", "```py\nimport pytest\nfrom swcpy import SWCClient ![1](assets/1.png)\nfrom swcpy import SWCConfig\nfrom swcpy.schemas import League, Team, Player, Performance\nfrom io import BytesIO ![2](assets/2.png)\nimport pyarrow.parquet as pq ![3](assets/3.png)\nimport pandas as pd ![4](assets/4.png)\n\ndef test_health_check(): ![5](assets/5.png)\n    \"\"\"Tests health check from SDK\"\"\"\n    config = SWCConfig(swc_base_url=\"http://0.0.0.0:8000\",backoff=False)\n    client = SWCClient(config)    \n    response = client.get_health_check()\n    assert response.status_code == 200\n    assert response.json() == {\"message\": \"API health check successful\"}\n\ndef test_list_leagues(): ![6](assets/6.png)\n    \"\"\"Tests get leagues from SDK\"\"\"\n    config = SWCConfig(swc_base_url=\"http://0.0.0.0:8000\",backoff=False)\n    client = SWCClient(config)    \n    leagues_response = client.list_leagues()\n    # Assert the endpoint returned a list object\n    assert isinstance(leagues_response, list)\n    # Assert each item in the list is an instance of a Pydantic League object\n    for league in leagues_response:\n        assert isinstance(league, League)\n    # Asset that 5 League objects are returned\n    assert len(leagues_response) == 5\n\ndef test_bulk_player_file_parquet(): ![7](assets/7.png)\n    \"\"\"Tests bulk player download through SDK - Parquet\"\"\"\n\n    config = SWCConfig(bulk_file_format = \"parquet\") ![8](assets/8.png)\n    client = SWCClient(config)    \n\n    player_file_parquet = client.get_bulk_player_file()\n\n    # Assert the file has the correct number of records (including header)\n    player_table = pq.read_table(BytesIO(player_file_parquet)) ![9](assets/9.png)\n    player_df = player_table.to_pandas()\n    assert len(player_df) == 1018\n```", "```py\n.../sdk (main) $ cd ../../chapter6/complete\n.../chapter6 (main) $ fastapi run main.py\n...\nINFO:     Started server process [9999]\nINFO:     Waiting for application startup.\nINFO:     Application startup complete.\nINFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit) ![1](assets/1.png)\n```", "```py\n.../sdk (main) $ pytest tests/test_swcpy.py\n=========== test session starts ===========\nplatform linux -- Python 3.10.13, pytest-8.1.2, pluggy-1.5.0\nrootdir: /workspaces/portfolio-project/chapter7/sdk\nconfigfile: pyproject.toml\nplugins: anyio-4.4.0\ncollected 3 items\n\ntests/test_swcpy.py ...                  [100%]\n\n============ 3 passed in 0.68s ============\n```", "```py\n.../sdk (main) $ cd ../.. ![1](assets/1.png)\n.../portfolio-project/ (main) $ git checkout -b learning-branch ![2](assets/2.png)\nSwitched to a new branch 'learning-branch'\n.../portfolio-project/ (main) $ git push -u origin learning-branch ![3](assets/3.png)\n * [new branch]      learning-branch -> learning-branch\nbranch 'learning-branch' set up to track 'origin/learning-branch'.\n```", "```py\n.../portfolio-project/ (learning-branch) $ git checkout main ![1](assets/1.png)\nSwitched to branch 'main'\nYour branch is up to date with 'origin/main'.\n.../portfolio-project/ (main) $ rm -rf chapter6/complete\n.../portfolio-project/ (main) $ rm -rf chapter7/complete\n.../portfolio-project/ (main) $ rm\n.../portfolio-project/ (main) $ mv chapter6/* . ![2](assets/2.png)\n.../portfolio-project/ (main) $ mv chapter7/sdk . ![3](assets/3.png)\n.../portfolio-project/ (main) $ rm -rf chapter3 ![4](assets/4.png)\n.../portfolio-project/ (main) $ rm -rf chapter4\n.../portfolio-project/ (main) $ rm -rf chapter5\n.../portfolio-project/ (main) $ rm -rf chapter6\n.../portfolio-project/ (main) $ rm -rf chapter7\n```", "```py\n.../portfolio-project (main) $ tree -d  --prune -I 'build|*.egg-info|__pycache__'\n.\n├── bulk\n└── sdk\n    ├── src\n    │   └── swcpy\n    │       └── schemas\n    └── tests\n6 directories\n```", "```py\n## Software Development Kit (SDK)\n\nIf you are a Python user, you can use the swcpy SDK to interact with our API. \nFull information is available [here](sdk/README.md). \n```"]