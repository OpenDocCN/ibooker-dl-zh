- en: Capitolo 2\. Come iniziare con FastAPI
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第二章：如何开始使用 FastAPI
- en: 'Questo lavoro è stato tradotto utilizzando l''AI. Siamo lieti di ricevere il
    tuo feedback e i tuoi commenti: [translation-feedback@oreilly.com](mailto:translation-feedback@oreilly.com)'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 这份工作是用 AI 翻译的。我们很高兴收到你的反馈和评论：[translation-feedback@oreilly.com](mailto:translation-feedback@oreilly.com)
- en: Alla fine di questo capitolo, dovresti sentirti a tuo agio nell'utilizzo del
    framework web FastAPI, nell'impostazione di progetti FastAPI e nell'articolare
    le tue decisioni sullo stack tecnologico per la creazione di servizi GenAI.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章结束时，你应该能够舒适地使用 FastAPI 框架，设置 FastAPI 项目，并就创建 GenAI 服务的技术栈做出决策。
- en: Introduzione a FastAPI
  id: totrans-3
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: FastAPI 简介
- en: '[FastAPI](https://oreil.ly/2xcoR) è un framework web ASGI (asynchronous gateway
    interface) che ti permette di costruire API e server web backend snelli. Essendoun
    frameworkASGI, è in grado di sfruttare la concorrenza per elaborare le richieste
    web. È [veloce, paragonabile ai framework moderni](https://oreil.ly/tgwEJ), ma
    è anchedotato di solide [integrazioni Swagger/OpenAPI per la documentazione automatica](https://oreil.ly/WlwOC),
    oltre a funzioni integrate di validazione e serializzazione dei dati tramite [Pydantic](https://oreil.ly/5-EmU).^([1](ch02.html#id507))
    In effetti, FastAPI è un wrapper del [framework Starlette](https://oreil.ly/tyKtQ),
    costruito da Encode, le stesse persone che hanno realizzato il framework REST
    Django. È leggero e ha un''esperienza di sviluppo simile.'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: '[FastAPI](https://oreil.ly/2xcoR) 是一个 ASGI（异步网关接口）Web 框架，它允许你构建轻量级的 API 和后端
    Web 服务器。作为一个 ASGI 框架，它能够利用并发来处理 Web 请求。它[快速，与现代框架相当](https://oreil.ly/tgwEJ)，同时还具备强大的[Swagger/OpenAPI
    集成，用于自动生成文档](https://oreil.ly/WlwOC)，以及通过 [Pydantic](https://oreil.ly/5-EmU) 集成的数据验证和序列化功能。[1](ch02.html#id507)
    实际上，FastAPI 是由 Encode 构建的 [Starlette 框架](https://oreil.ly/tyKtQ) 的包装器，由制作了 Django
    REST 框架的同一个人创建。它轻量且具有类似的开发生态。'
- en: Prima di parlare di FastAPI in modo più dettagliato, configuriamo il tuo ambiente
    di sviluppo con un'applicazione FastAPI in esecuzione.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 在更详细地介绍 FastAPI 之前，让我们通过一个正在运行的 FastAPI 应用程序来配置你的开发环境。
- en: Impostazione dell'ambiente di sviluppo
  id: totrans-6
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 开发环境设置
- en: Nel resto del capitolo, ti guiderò attraverso il processo di installazione di
    FastAPI e delle sue dipendenze essenziali, consentendoti di configurare un server
    web di base. Installeremo anche una selezione di formattatori, logger e linter
    che potrai impostare per migliorare il tuo flusso di lavoro di sviluppo.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章的剩余部分，我将指导你通过安装 FastAPI 和其基本依赖的过程，这将帮助你配置一个基本的 Web 服务器。我们还将安装一些格式化工具、日志记录器和代码检查工具，你可以根据需要设置它们来提高你的开发流程效率。
- en: Avvertenze
  id: totrans-8
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 注意事项
- en: Gli esempi di codice presenti in questo libro sono stati testati con Python
    3.11\. L'esecuzione di esempi di codice con altre versioni di Python potrebbe
    causare problemi. Inoltre, alcuni ambienti di distribuzione e le dipendenze dei
    pacchetti potrebbero non supportare le ultime versioni di Python.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 本书中的代码示例已在 Python 3.11 上进行测试。使用其他版本的 Python 运行代码示例可能会出现问题。此外，一些部署环境和包的依赖可能不支持
    Python 的最新版本。
- en: Ora puoi iniziare a configurare il tuo progetto FastAPI.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 现在你可以开始配置你的 FastAPI 项目了。
- en: Installazione di Python, FastAPI e dei pacchetti necessari
  id: totrans-11
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 安装 Python、FastAPI 及所需包
- en: 'Se utilizzi Windows, puoi usare `conda` per creare un ambiente virtuale Python:'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你使用 Windows，你可以使用 `conda` 创建 Python 虚拟环境：
- en: '[PRE0]'
  id: totrans-13
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'Se utilizzi un sistema macOS o Linux, puoi creare un ambiente Python virtuale
    utilizzando `venv`:'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你使用 macOS 或 Linux 系统，你可以使用 `venv` 创建一个 Python 虚拟环境：
- en: '[PRE1]'
  id: totrans-15
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: '[PRE2] $ source .venv/bin/activate [PRE3]` Una volta attivato l''ambiente,
    puoi installare i pacchetti fondamentali necessari per eseguire il server FastAPI
    e servire le richieste dell''API OpenAI:    [PRE4]   ``Il pacchetto `uvicorn`
    è il server web di base su cui gira FastAPI.`fastapi` installerà anche i suoi
    pacchetti di dipendenza come `starlette` e `pydantic`.`` [PRE5]``  [PRE6][PRE7]py[PRE8]`py
    >> server   Documentation at http://127.0.0.1:8000/docs [PRE9]`py [PRE10]py` [PRE11]py
    [PRE12] [PRE13]`` [PRE14][PRE15]py[PRE16]`` [PRE17] # main.py from pydantic import
    BaseModel, Field, EmailStr  class UserCreate(BaseModel):     username: str     password:
    str      @validator(''password'') ![1](assets/1.png)     def validate_password(cls,
    value):         if len(value) < 8:             raise ValueError(''Password must
    be at least 8 characters long'')         if not any(char.isdigit() for char in
    value):             raise ValueError(''Password must contain at least one digit'')         if
    not any(char.isupper() for char in value):             raise ValueError(''Password
    must contain at least one uppercase letter'')         return value ![2](assets/2.png)  app
    = FastAPI()  @app.post("/users") async def create_user_controller(user: UserCreate):     return
    {"name": user.name, "message": "Account successfully created"}  ... [PRE18] #
    main.py from fastapi.responses import RedirectResponse  @app.get("/", include_in_schema=False)
    ![1](assets/1.png) def docs_redirect_controller():     return RedirectResponse(url="/docs",
    status_code=status.HTTP_303_SEE_OTHER) ![2](assets/2.png) [PRE19] from fastapi
    import FastAPI, Depends  app = FastAPI()  def paginate(skip: int = 0, limit: int
    = 10):     return {"skip": skip, "limit": limit}  @app.get("/messages") def list_messages_controller(pagination:
    dict = Depends(paginate)):     return ...  # filter and paginate results using
    pagination params  @app.get("/conversations") def list_conversations_controller(pagination:
    dict = Depends(paginate)):     return ...  # filter and paginate results using
    pagination params [PRE20] from fastapi import FastAPI, Depends  def get_db():
    ![1](assets/1.png)     db = ... # create a database session     try:         yield
    db ![2](assets/2.png)     finally:         db.close() ![3](assets/3.png)  app
    = FastAPI()  @app.get("users/{email}/messages") def get_current_user_messages(email,
    db = Depends(get_db)): ![4](assets/4.png)     user = db.query(...) # db is reused     messages
    = db.query(...) # db is reused     return messages ![5](assets/5.png) [PRE21]
    flat-project ├── app │   ├── services.py │   ├── database.py │   ├── models.py
    │   ├── routers.py │   └── main.py ├── requirements.txt ├── .env ├── .gitignore
    [PRE22] nested-project ├── app │    ├── main.py │    ├── dependencies.py │    └──
    services │    │   ├── users.py │    │   └── profiles.py │    └── models │    │   ├──
    users.py │    │   └── profiles.py │    └── routers │        ├── users.py │        └──
    profiles.py ├── requirements.txt ├── .env ├── .gitignore [PRE23] modular-project
    ├── app │   └── modules │   │   ├── auth │   │   │   ├── routers.py │   │   │   ├──
    models.py │   │   │   ├── dependencies.py │   │   │   ├── guards.py │   │   │   ├──
    services.py │   │   └── users │   │   │   ├── router.py │   │   │   ├── models.py
    │   │   │   ├── dependencies.py │   │   │   ├── services.py │   │   │   ├── mappers.py
    │   │   │   ├── pipes.py │   │   └── profiles │   └── routers │   │   └── users.py
    │   └── providers │   │   └── email.py │   │   └── stripe.py ............ │   ├──
    settings.py  # global configs │   ├── middlewares.py  # global middleware │   ├──
    models.py  # global models │   ├── exceptions.py  # global exceptions │   └──
    main.py ├── requirements.txt ├── .env ├── .gitignore [PRE24]` [PRE25]```'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
