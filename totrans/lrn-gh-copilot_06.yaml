- en: Chapter 5\. Testing with Copilot
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第 5 章\. 使用 Copilot 进行测试
- en: Now that you understand how Copilot works and how to interact with it through
    the editor and chat interfaces, we can move on to other ways it increases productivity.
    Copilot simplifies routine tasks that can consume a lot of time and resources.
    Automating such work allows you to devote your cycles, thinking, and focus to
    the more complex tasks needed to create software.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 现在你已经了解了 Copilot 的工作原理以及如何通过编辑器和聊天界面与之交互，我们可以继续探讨其他它能提高生产力的方式。Copilot 简化了那些可能消耗大量时间和资源的常规任务。自动化这些工作可以使你将精力、思考和关注点投入到创建软件所需的更复杂任务中。
- en: 'This chapter focuses on one particular capability: using Copilot to generate
    tests. In the following sections, you’ll see how Copilot can do the following:'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 本章重点介绍一个特定的功能：使用 Copilot 生成测试。在接下来的章节中，你将看到 Copilot 可以做到以下事情：
- en: Provide guidance on testing
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 提供测试指导
- en: Create standard test cases for unit testing and integration testing
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 为单元测试和集成测试创建标准测试用例
- en: Build out edge cases
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 构建边缘情况
- en: Utilize custom testing instructions
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 利用自定义测试指令
- en: Write tests using the framework of your choice
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用你选择的框架编写测试
- en: Help implement best practices, like [test-driven development](https://oreil.ly/-nm1N)
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 帮助实施最佳实践，如 [测试驱动开发](https://oreil.ly/-nm1N)
- en: Use Copilot’s Agent mode to help drive test creation
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 Copilot 的代理模式来帮助驱动测试创建
- en: Generative AI and Testing
  id: totrans-10
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 生成式 AI 和测试
- en: When generating tests, Copilot’s results may vary significantly in content,
    suitability, and even accuracy. This usually depends on the amount of context
    provided, the interface, and the prompt.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 当生成测试时，Copilot 的结果在内容、适用性和准确性方面可能会有很大差异。这通常取决于提供上下文的数量、接口和提示。
- en: Per the nature of generative AI, nothing is guaranteed to be exactly as you
    want. So, it is important to review the suggested tests to ensure that they are
    valid and a good fit. If they’re not what you expected, you may need to edit them
    or refactor your prompt and try again.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 根据生成式 AI 的性质，没有任何东西是保证完全符合你期望的。因此，重要的是要审查建议的测试，以确保它们是有效的并且是合适的。如果它们不是你预期的，你可能需要编辑它们或重构你的提示并再次尝试。
- en: After reading this chapter, you’ll have a solid framework for harnessing this
    capability. Using that, you’ll be able to leverage Copilot in multiple ways to
    help ensure that you have the testing coverage you need.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 在阅读完本章后，你将拥有一个利用这一能力的坚实基础。利用这一点，你将能够以多种方式利用 Copilot，以确保你拥有所需的测试覆盖率。
- en: 'Let’s start by asking Copilot the broadest question about testing: “How do
    I test my code?”'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们先从向 Copilot 提出关于测试的最广泛的问题开始：“我该如何测试我的代码？”
- en: How Do I Test?
  id: totrans-15
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 我该如何进行测试？
- en: Being able to quickly pivot and learn new programming languages and frameworks
    is a standard expectation for most software professionals. You’re likely already
    comfortable with how to write tests for any language you’ve been using regularly.
    But having to switch or migrate code to a different environment can pose a substantial
    learning curve. As discussed previously, one of the Copilot features that is helpful
    here is the ability to ask how to write or translate code in the new language.
    The same can be done for testing.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 能够快速转换并学习新的编程语言和框架，对于大多数软件专业人士来说是一个标准期望。你很可能已经熟悉了如何为任何你经常使用的语言编写测试。但是，需要切换或迁移代码到不同的环境可能会带来相当大的学习曲线。如前所述，Copilot
    在这里的一个有帮助的特性是询问如何在新语言中编写或翻译代码。测试也是如此。
- en: Have Code Active Before Prompt
  id: totrans-17
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在提示之前让代码处于活动状态
- en: For the prompts and queries we’re covering in this chapter, the best results
    will usually occur when you have one or more files that are part of your project
    open and active in the editor. If you don’t have any files active, Copilot may
    fall back to telling you how to do things in more general terms for your project’s
    type, rather than giving you specifics for your project’s content.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 对于本章中我们将要讨论的提示和查询，最佳结果通常发生在你有一个或多个属于你的项目且在编辑器中打开并处于活动状态文件的情况下。如果你没有任何文件处于活动状态，Copilot
    可能会退回到以更通用的方式告诉你如何针对你的项目类型进行操作，而不是针对你的项目内容提供具体信息。
- en: 'We’ll use a project for a Kubernetes Operator written in Go as our example
    here. Suppose you are new to Go and have little or no idea how to test the code
    you’ve just produced. You could do research on [Stack Overflow](https://stackoverflow.com)
    or any other number of forums or sites, or ask colleagues. But you can also ask
    Copilot:'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，我们将使用一个用 Go 编写的 Kubernetes Operator 项目作为示例。假设你对 Go 不熟悉，对如何测试你刚刚产生的代码知之甚少。你可以研究
    [Stack Overflow](https://stackoverflow.com) 或其他许多论坛或网站，或者询问同事。但你也可以询问 Copilot：
- en: '[PRE0]'
  id: totrans-20
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: More Specific Queries
  id: totrans-21
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 更具体的查询
- en: 'If you need to be more specific about the part of your project that you want
    to test, you can include the file name in the prompt, use a chat variable, or
    add items as context as discussed in [Chapter 3](ch03.html#ch03). Here’s an example:'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你需要更具体地说明你想要测试的项目部分，你可以在提示中包含文件名，使用聊天变量，或者添加项目作为上下文，如第 3 章所述。以下是一个示例：
- en: '[PRE1]'
  id: totrans-23
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: Copilot first analyzes the project. Then, since your prompt is general, Copilot
    tells you how to create an example test for the project. It uses the *chat participant*
    and *slash command* default of `@workspace /setupTests` to produce the basic info.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: Copilot 首先分析项目。然后，由于你的提示是通用的，Copilot 会告诉你如何为项目创建一个示例测试。它使用 *chat participant*
    和 *slash command* 默认的 `@workspace /setupTests` 来生成基本信息。
- en: Copilot provides a summary of its suggestions along with buttons to make changes
    and take actions. See [Figure 5-1](#initial-suggestions-f).
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: Copilot 提供了其建议的总结，以及用于更改和采取行动的按钮。见图 5-1。[图 5-1](#initial-suggestions-f)
- en: '![](assets/lghc_0501.png)'
  id: totrans-26
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/lghc_0501.png)'
- en: Figure 5-1\. Initial suggestions for adding tests
  id: totrans-27
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 5-1\. 添加测试的初始建议
- en: In the same response, Copilot also provides an explanation for the suggestions
    along with a terminal command to run the test ([Figure 5-2](#further-explanation-o)).
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 在相同的响应中，Copilot 还提供了对建议的解释以及运行测试的终端命令（[图 5-2](#further-explanation-o)）。
- en: '![](assets/lghc_0502.png)'
  id: totrans-29
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/lghc_0502.png)'
- en: Figure 5-2\. Further explanation on adding tests
  id: totrans-30
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 5-2\. 添加测试的进一步说明
- en: If you click the Apply Changes button (shown in [Figure 5-1](#initial-suggestions-f)),
    the file will be created for you, as shown in the left part of [Figure 5-3](#file-created-via-appl).
    Note that Copilot’s response also includes information on how to run your tests.
    This is pretty impressive for one general query!
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你点击“应用更改”按钮（如图 5-1 所示），文件将为你创建，如图 5-3 的左侧部分所示。[图 5-3](#file-created-via-appl)
    注意到 Copilot 的响应还包括有关如何运行测试的信息。对于一个一般查询来说，这相当令人印象深刻！
- en: '![](assets/lghc_0503.png)'
  id: totrans-32
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/lghc_0503.png)'
- en: Figure 5-3\. A file created via the Apply Changes button
  id: totrans-33
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 5-3\. 通过“应用更改”按钮创建的文件
- en: 'The intent of `/setupTests` is to do macro-level setup of testing code and
    related changes. At the time of this writing, this feature is still experimental,
    and you may find its usefulness varies depending on the situation. Likewise, having
    Copilot default to using the `@workspace` chat participant does not always yield
    the best results. You may see better results not using these defaults when initially
    generating tests. The result of using the “rerun without” option on the previous
    query provides a more comprehensive set of steps:'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: '`/setupTests` 的目的是进行测试代码和相关更改的宏观级设置。在撰写本文时，此功能仍然是实验性的，你可能发现其有用性取决于具体情况。同样，Copilot
    默认使用 `@workspace` 聊天参与者并不总是产生最佳结果。你可能会在最初生成测试时看到不使用这些默认值时更好的结果。使用“重新运行而不”选项在上一个查询中的结果提供了一个更全面的步骤集：'
- en: Decide on a testing framework.
  id: totrans-35
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 确定一个测试框架。
- en: Set up the testing framework.
  id: totrans-36
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 设置测试框架。
- en: Create a test directory.
  id: totrans-37
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建测试目录。
- en: Write test files.
  id: totrans-38
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 编写测试文件。
- en: Write test cases.
  id: totrans-39
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 编写测试用例。
- en: Run the tests.
  id: totrans-40
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 运行测试。
- en: Automate testing.
  id: totrans-41
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 自动化测试。
- en: Included with these is text that describes in more detail what to do along with
    sample code. [Figure 5-4](#example-output-from-u) shows an excerpt from the results
    of using “rerun without.”
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 其中包含的文本详细描述了要执行的操作以及示例代码。[图 5-4](#example-output-from-u) 展示了使用“重新运行而不”选项的结果摘录。
- en: '![](assets/lghc_0504.png)'
  id: totrans-43
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/lghc_0504.png)'
- en: Figure 5-4\. Example output from using the “rerun without” option
  id: totrans-44
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 5-4\. 使用“重新运行而不”选项的示例输出
- en: Options for working around `/setupTests` are discussed in the following sidebar.
    The same types of options can be utilized for working around other default commands
    being added.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 在以下侧边栏中讨论了绕过 `/setupTests` 的选项。相同的选项类型可以用于绕过其他正在添加的默认命令。
- en: 'For an additional example, let’s tackle something less familiar to most: testing
    SQL code. I have a large demo file of SQL statements that I use for some of my
    training courses, which creates tables to populate a database for a university
    curriculum, schedule, faculty, etc.'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 为了提供一个额外的例子，让我们来处理对大多数人来说不太熟悉的事情：测试 SQL 代码。我有一个包含 SQL 语句的大演示文件，我将其用于一些培训课程，这些语句创建用于大学课程、日程安排、教职员工等的数据库表。
- en: If I open that file in the editor and ask Copilot how to test its content, Copilot
    replies as shown in [Figure 5-8](#initial-sql-test-resp). It generates a step-by-step
    plan for the testing and then creates a new file that implements the plan (shown
    on the left). The proposed new file contains SQL commands that can be used for
    doing 10 tests with a test database.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我在编辑器中打开该文件并询问Copilot如何测试其内容，Copilot会像[图5-8](#initial-sql-test-resp)所示那样回复。它生成一个逐步的测试计划，然后创建一个新文件来实现该计划（如图左侧所示）。建议的新文件包含可用于在测试数据库中执行10个测试的SQL命令。
- en: This file can then be reviewed and saved as your new tests. Copilot uses `/tests`
    to quickly generate this output. However, if you don’t want to use the quick version,
    you can use any of the strategies we discussed previously for “rerun without”
    to execute the prompt again without using the shortcut.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，你可以审查并保存为你的新测试。Copilot使用 `/tests` 命令快速生成此输出。然而，如果你不想使用快速版本，你可以使用我们之前讨论的“不带rerun”策略中的任何策略来再次执行提示，而不使用快捷方式。
- en: '![](assets/lghc_0508.png)'
  id: totrans-49
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/lghc_0508.png)'
- en: Figure 5-8\. Initial SQL test response
  id: totrans-50
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图5-8\. 初始SQL测试响应
- en: Again, this is pretty impressive for a simple query against one file. And note
    that this will work for any language, not just Python.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 再次，对于一个简单查询一个文件来说，这已经很令人印象深刻了。并且请注意，这适用于任何语言，而不仅仅是Python。
- en: Trusting Generated Tests
  id: totrans-52
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 信任生成的测试
- en: Since we’re still early in the discussion about having Copilot generate tests,
    it’s important to remember to review them just as you would any other generated
    content. Tests generated by AI may include false positives, duplicate assertions,
    and incorrect logic based on misinterpreting the code. Fortunately, test code
    is generally easy to read, which can make it easier to quickly review and verify.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 由于我们还在讨论Copilot生成测试的早期阶段，因此记住要像审查其他任何生成内容一样审查它们是很重要的。由AI生成的测试可能包括误报、重复断言和基于对代码误解的错误逻辑。幸运的是，测试代码通常很容易阅读，这可以使得快速审查和验证变得更容易。
- en: This section has shown you how to utilize Copilot to create instructions and
    code for testing when you need to start from scratch. More commonly, you may be
    coding in a language you already know and just want Copilot to help create the
    *boilerplate* code for tasks like unit testing. In the next section, you’ll see
    several ways to do that.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 本节向你展示了如何利用Copilot从零开始创建测试指令和代码。更常见的情况是，你可能正在使用你已知的语言进行编码，只想让Copilot帮助你创建单元测试等任务的*模板代码*。在下一节中，你将看到几种实现方法。
- en: Creating Unit Tests
  id: totrans-55
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 创建单元测试
- en: Given the necessity of creating tests for cases like continuous integration
    and test-driven development, manually crafting tests can represent a significant
    portion of your time and workload on a project. With Copilot, you can automate
    test generation by using several approaches. And you can choose from varying degrees
    of complexity.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 考虑到创建持续集成和测试驱动开发等用例的必要性，手动编写测试可能占据你在项目中的大量时间和工作量。使用Copilot，你可以通过多种方法自动化测试生成，并且你可以选择不同复杂程度的选项。
- en: Many times, the tests you generate with Copilot will be unit tests, designed
    to perform basic testing for a single function or procedure. However, the range
    and depth of Copilot-generated tests can vary with the prompt and interface used.
    We’ll explore the various approaches in this section.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 许多时候，使用Copilot生成的测试将是单元测试，旨在对单个函数或过程进行基本测试。然而，Copilot生成的测试的范围和深度会根据提示和接口的使用而变化。在本节中，我们将探讨各种方法。
- en: Using the /tests Command
  id: totrans-58
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用 `/tests` 命令
- en: The easiest way to have Copilot generate tests for you is using the built-in
    slash command `/tests` inline (in the IDE’s editor). This command operates on
    the code you select or reference in the IDE and then attempts to create basic
    unit tests appropriate to the code. You can enter this command through any of
    the chat interfaces available in the IDE.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 让Copilot为你生成测试的最简单方法是使用IDE编辑器中内置的斜杠命令 `/tests`（内联）。此命令在IDE中选定的或引用的代码上操作，然后尝试为代码创建适当的基礎单元测试。你可以通过IDE中可用的任何聊天界面输入此命令。
- en: 'Assume you’re again working with a simple function to determine whether a number
    is prime. The implementation doesn’t matter, but here’s one version:'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 假设你再次在处理一个简单的函数，用于判断一个数字是否为素数。实现方式不重要，但这里有一个版本：
- en: '[PRE2]'
  id: totrans-61
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: '[Figure 5-9](#invoking-copilot-to-g) shows an example of using the `/tests`
    command via the inline chat. The most straightforward usage is highlighting the
    code to be tested and then entering the command in the chat interface.'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: '[图 5-9](#invoking-copilot-to-g) 展示了通过行内聊天使用 `/tests` 命令的示例。最直接的使用方法是突出显示要测试的代码，然后在聊天界面中输入命令。'
- en: '![](assets/lghc_0509.png)'
  id: totrans-63
  prefs: []
  type: TYPE_IMG
  zh: '![图片](assets/lghc_0509.png)'
- en: Figure 5-9\. Invoking Copilot to generate tests via the `/tests` command
  id: totrans-64
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 5-9\. 通过 `/tests` 命令调用 Copilot 生成测试
- en: After running that command, Copilot generates assert-based tests for primes,
    nonprimes, one, zero, large primes, and large nonprimes. As [Figure 5-10](#tests-from-inline-cha)
    shows, when going through the inline chat, Copilot proposes the changes as a new
    file in the editor with the corresponding name *test_is_prime.py*. If you like
    the suggested tests, you can click the Accept button.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 运行该命令后，Copilot 为素数、非素数、单个、零、大素数和大非素数生成基于断言的测试。如图 5-10 所示，在行内聊天过程中，Copilot 将更改作为编辑器中的新文件提出，并具有相应的名称
    *test_is_prime.py*。如果你喜欢建议的测试，可以点击接受按钮。
- en: '![](assets/lghc_0510.png)'
  id: totrans-66
  prefs: []
  type: TYPE_IMG
  zh: '![图片](assets/lghc_0510.png)'
- en: Figure 5-10\. Tests from the inline chat option
  id: totrans-67
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 5-10\. 从行内聊天选项生成的测试
- en: The same results as running `/tests` in the inline chat interface can be achieved
    by choosing Copilot > Generate Tests from the context menu; see [Figure 5-11](#generating-tests-via).
    In fact, Copilot will want to use the `/tests` shortcut in most cases.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 通过选择 Copilot > 从上下文菜单生成测试，可以像在行内聊天界面中运行 `/tests` 一样获得相同的结果；参见 [图 5-11](#generating-tests-via)。实际上，Copilot
    在大多数情况下都会想要使用 `/tests` 快捷键。
- en: '![](assets/lghc_0511.png)'
  id: totrans-69
  prefs: []
  type: TYPE_IMG
  zh: '![图片](assets/lghc_0511.png)'
- en: Figure 5-11\. Generating tests via the context menu
  id: totrans-70
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 5-11\. 通过上下文菜单生成测试
- en: If you run the `/tests` command in the separate chat interface, you’ll likely
    get similar results, but with more of an explanation in the chat area about the
    approach Copilot is going to take, the framework it has chosen, and the type of
    tests it will create.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你单独在聊天界面中运行 `/tests` 命令，你可能会得到类似的结果，但在聊天区域中会有更多关于 Copilot 将采取的方法、选择的框架以及它将创建的测试类型的解释。
- en: A new section just above the text entry area shows any files changed. Keep/Undo
    buttons are available for all files. Proposed individual files are shown by their
    first line and have their own controls to keep (the checkmark) and undo (the curved
    left arrow). The control that looks like a document icon with + and - in it is
    used to show the diff introduced by the proposed changes in the editor. [Figure 5-12](#tests-from-tests-com)
    shows a portion of the output.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 在文本输入区域上方的新部分显示了更改的任何文件。所有文件都可用保留/撤销按钮。建议的单独文件通过其第一行显示，并有自己的保留（勾选标记）和撤销（曲线左箭头）控件。看起来像文档图标并带有
    + 和 - 的控件用于显示编辑器中提出的更改引入的差分。[图 5-12](#tests-from-tests-com) 展示了输出的一部分。
- en: '![](assets/lghc_0512.png)'
  id: totrans-73
  prefs: []
  type: TYPE_IMG
  zh: '![图片](assets/lghc_0512.png)'
- en: Figure 5-12\. Tests from the `/tests` command in the main chat
  id: totrans-74
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 5-12\. 主聊天中的 `/tests` 命令生成的测试
- en: Changing Icons and Controls
  id: totrans-75
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 更改图标和控件
- en: Copilot commonly changes the controls used in their various interfaces and moves
    them around, unfortunately. By the time you are reading this, Copilot has likely
    changed things again.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 不幸的是，Copilot 经常更改它们在各种界面中使用的控件，并将它们移动到其他位置。在你阅读这段文字的时候，Copilot 很可能已经再次更改了某些东西。
- en: 'In general, the following hold true across releases for proposed edits:'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 通常，以下内容在各个版本中对于建议的编辑都是适用的：
- en: There will be controls to accept/keep and reject/undo changes.
  id: totrans-78
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将会有接受/保留和拒绝/撤销更改的控件。
- en: Checkmarks double as keep controls.
  id: totrans-79
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 勾选标记同时作为保留控件。
- en: There will be a control to see the suggested diffs as a file in the editor or
    apply suggested diffs to a file in the editor.
  id: totrans-80
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将会有一个控件来查看建议的差分作为编辑器中的文件，或将建议的差分应用到编辑器中的文件。
- en: The diff controls may or may not set up the file with a reasonable name. You
    should always make sure to save your files yourself after reviewing and choosing
    which changes to keep.
  id: totrans-81
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 差分控件可能会也可能不会设置一个合理的文件名。你应该始终确保在审查并选择要保留的更改后自己保存文件。
- en: These responses cover a basic range of use cases. But what if you want to have
    additional tests generated and/or more cases covered? You can approach that by
    supplying more explicit prompts, the topic of the next section.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 这些响应涵盖了基本的使用案例范围。但如果你想要生成额外的测试并/或覆盖更多的情况呢？你可以通过提供更明确的提示来实现，这是下一节的主题。
- en: Creating Tests from Explicit Prompts
  id: totrans-83
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 从明确提示创建测试
- en: 'Another way to create tests is by providing prompts through the chat interface.
    A simple prompt like “Create tests for the selected code” will usually result
    in Copilot running the `/tests` command again (assuming that command is available
    in your IDE). However, you can supply a more directed prompt to have Copilot suggest
    tests for other cases. For example, if you’ve incorporated the tests already generated,
    you can select the current test file and the implementation file as context and
    then prompt Copilot about any other edge cases with a prompt like this:'
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 另一种创建测试的方法是通过聊天界面提供提示。一个简单的提示，如“为选定的代码创建测试”，通常会导致Copilot再次运行`/tests`命令（假设该命令在你的IDE中可用）。然而，你可以提供一个更具体的提示，让Copilot为其他情况建议测试。例如，如果你已经包含了已生成的测试，你可以选择当前的测试文件和实现文件作为上下文，然后使用如下提示来提示Copilot关于任何其他边缘情况：
- en: '[PRE3]'
  id: totrans-85
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'Copilot responds by identifying some additional tests cases, along with explanations
    for them:'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: Copilot通过识别一些额外的测试用例及其解释来响应：
- en: '[PRE4]'
  id: totrans-87
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'Copilot further provides the code that can be added for those test cases:'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: Copilot进一步提供了可以添加到这些测试用例中的代码：
- en: '[PRE5]'
  id: totrans-89
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'This might make you wonder whether you can extend the prompt to cover more
    use cases. Indeed, you can! For example, you can be more prescriptive, telling
    Copilot to add test cases for other inputs:'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 这可能让你想知道是否可以扩展提示来覆盖更多用例。确实可以！例如，你可以更加具体地指示Copilot为其他输入添加测试用例：
- en: '[PRE6]'
  id: totrans-91
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'With this prompt, Copilot adds additional test cases for your consideration
    and review:'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 使用这个提示，Copilot为你的考虑和审查添加了额外的测试用例：
- en: '[PRE7]'
  id: totrans-93
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: A key part of getting the most value-add from Copilot is asking it additional
    questions beyond the scope of what it may generate with default prompts or commands.
    To use our analogy of Copilot as someone new to the team, you may want or need
    to prod them to think beyond the usual test cases about other scenarios. The same
    holds true for prompting Copilot to get more comprehensive results.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 从Copilot中获得最大价值的关键部分是提出超出它可能使用默认提示或命令生成的范围的问题。用我们的类比来说，你可能希望或需要推动他们跳出常规的测试用例去考虑其他场景。对于提示Copilot以获得更全面的结果也是如此。
- en: If you prefer to create some quick tests inline with your code, a variation
    on the prompt approach can easily do that. We’ll look at that option next.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你更喜欢在代码中创建一些快速测试，可以通过提示方法的变体轻松实现。我们将在下一节中查看该选项。
- en: Creating Tests from Comments
  id: totrans-96
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 从注释创建测试
- en: Sometimes you may not want (or need) to engage the chat feature to create your
    tests. You may be actively working in your editor *in the flow* and want to do
    the equivalent of telling Copilot, “Insert some simple, quick tests here.” That
    can be done by creating a comment as a directive to Copilot. Then you simply need
    to accept the suggestions for individual tests or testing functions that it returns.
    The process follows the same interactive flow for acceptance, editing, etc., as
    discussed in [Chapter 2](ch02.html#ch02).
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 有时候你可能不希望（或需要）使用聊天功能来创建测试。你可能正在编辑器中积极工作，并想告诉Copilot“在这里插入一些简单、快速的测试”。这可以通过创建一个指令注释来实现Copilot。然后你只需接受它返回的个别测试或测试函数的建议。这个过程遵循与[第2章](ch02.html#ch02)中讨论的相同的交互流程，包括接受、编辑等。
- en: The advantage of this method is that you can initiate it from a simple (or complex)
    comment line within the code. The disadvantage is that you may have to repeatedly
    step through accepting parts of suggestions or get generic suggestions that aren’t
    as useful.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 这种方法的优点是你可以从代码中的一个简单（或复杂）的注释行开始。缺点是你可能需要反复地接受建议的部分，或者得到一些不那么有用的通用建议。
- en: 'Here’s a simple example of a directive comment placed inline after the code
    for the `is_prime` function:'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 这里是一个简单的例子，将指令注释放在`is_prime`函数代码之后的内联注释：
- en: '[PRE8]'
  id: totrans-100
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: In response, Copilot suggests an inline function with a set of simple asserts,
    as shown in [Figure 5-13](#simple-set-of-assert). All the lines from 10–23 were
    automatically generated by Copilot in response to the comment on line 9.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 作为回应，Copilot建议一个内联函数，其中包含一组简单的断言，如图[图5-13](#simple-set-of-assert)所示。从第9行的注释自动生成10-23行的所有行。
- en: '![](assets/lghc_0513.png)'
  id: totrans-102
  prefs: []
  type: TYPE_IMG
  zh: '![图片](assets/lghc_0513.png)'
- en: Figure 5-13\. A simple set of assert test cases generated from the comment
  id: totrans-103
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图5-13\. 从注释生成的简单断言测试用例集
- en: 'Alternatively, you could use a more generic comment such as this one:'
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 或者，你可以使用更通用的注释，如下所示：
- en: '[PRE9]'
  id: totrans-105
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: In this case, Copilot generates similar test cases to the other methods, but
    in the same file. [Figure 5-14](#another-example-of-te) shows an excerpt of the
    generated tests. The only line that was typed in was the first comment. All the
    other lines were generated and accepted based on that one.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种情况下，Copilot生成与其他方法类似的测试用例，但位于同一文件中。[图5-14](#另一个示例)展示了生成的测试用例的摘录。唯一输入的行是第一行注释。所有其他行都是基于这一行生成的并被接受。
- en: '![](assets/lghc_0514.png)'
  id: totrans-107
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/lghc_0514.png)'
- en: Figure 5-14\. Another example of tests generated from a comment
  id: totrans-108
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图5-14\. 从注释生成的另一个测试示例
- en: 'Finally, in this section, let’s look at a different way of using Copilot to
    help us test: validating inputs to functions inline.'
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，在本节中，让我们看看另一种使用Copilot帮助我们测试的方法：验证函数的输入。
- en: Validating Inputs
  id: totrans-110
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 验证输入
- en: 'As another angle on testing, Copilot can also assist with generating code to
    check that inputs going into a function are valid. With our example function,
    we can tell Copilot to do the following:'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 从测试的另一个角度，Copilot还可以帮助生成代码来检查传入函数的输入是否有效。以我们的示例函数为例，我们可以告诉Copilot执行以下操作：
- en: '[PRE10]'
  id: totrans-112
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'From here, Copilot responds and suggests assertions, as requested, to validate
    the inputs:'
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 从这里，Copilot根据请求响应并建议断言，以验证输入：
- en: '[PRE11]'
  id: totrans-114
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'We can also be less specific about using asserts and ask Copilot to generate
    checks:'
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 我们也可以对使用断言的要求不那么具体，并要求Copilot生成检查：
- en: '[PRE12]'
  id: totrans-116
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'This allows Copilot to generate code to validate the inputs, but with a more
    standard coding mechanism to surface any issues:'
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 这允许Copilot生成代码来验证输入，但使用更标准的编码机制来暴露任何问题：
- en: '[PRE13]python'
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: '[PRE13]python'
- en: 'def is_prime(num):'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 'def is_prime(num):'
- en: 'if not isinstance(num, int):'
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 'if not isinstance(num, int):'
- en: raise TypeError("Input must be an integer")
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: raise TypeError("输入必须是一个整数")
- en: 'if num < 0:'
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 'if num < 0:'
- en: raise ValueError("Input must be a non-negative integer")
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: raise ValueError("输入必须是非负整数")
- en: 'if num < 2:'
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 'if num < 2:'
- en: return False
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: return False
- en: 'for i in range(2, int(num ** 0.5) + 1):'
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 'for i in range(2, int(num ** 0.5) + 1):'
- en: 'if num % i == 0:'
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 'if num % i == 0:'
- en: return False
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: return False
- en: return True
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: return True
- en: '[PRE14]'
  id: totrans-130
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: Each approach may be useful in different cases depending on how simple you want
    the results to be versus the need for broader coverage. Remember that since you
    are interacting with an AI, prompting and setting the context are the keys to
    getting explicit results (versus generic results or ones rendered quickly inline).
    Depending on where you are at with your overall progress on a project and experience
    with the languages and frameworks you are using, you may find that a combination
    of these approaches works well.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 根据您希望结果有多简单与需要更广泛覆盖的需求，每种方法可能在不同的案例中都有用。记住，由于您正在与AI交互，提示和设置上下文是获得明确结果（而不是通用结果或快速内联生成的结果）的关键。根据您在项目整体进度中处于什么位置以及您对所使用的语言和框架的经验，您可能会发现这些方法的组合效果很好。
- en: 'Before we leave this section on creating unit tests, here’s a generic prompt
    template for creating a set of unit tests (adapted from the [Copilot documentation](https://oreil.ly/NOS8j)):'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们离开创建单元测试这一节之前，这里有一个创建一组单元测试的通用提示模板（改编自[Copilot文档](https://oreil.ly/NOS8j))：
- en: '[PRE15]'
  id: totrans-133
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'The words enclosed by < and > are meant to be replaced with specific terms
    by you. This template has several key elements:'
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 用尖括号<和>括起来的单词意味着您需要用特定的术语替换它们。此模板有几个关键元素：
- en: Scope
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 范围
- en: It explicitly asks for a comprehensive suite of unit tests, so the AI generates
    more than just basic tests and covers a wide variety of potential use cases.
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 它明确要求一个全面的单元测试套件，因此AI生成的不仅仅是基本测试，还涵盖了广泛的潜在用例。
- en: Scenarios
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 场景
- en: 'It specifies that the tests should include:'
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 它指定测试应包括：
- en: Edge cases to test for boundary conditions
  id: totrans-139
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 测试边界条件
- en: Exception handling for errors that should be raised when invalid actions occur
  id: totrans-140
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 当发生无效操作时应抛出异常的错误处理
- en: Data validation to ensure that inputs are correctly validated and handled by
    the methods
  id: totrans-141
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 确保输入正确验证和处理的方法数据验证
- en: Now that we’ve covered the unit-test approaches, let’s look at how we can leverage
    Copilot to help us write integration tests.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经介绍了单元测试方法，让我们看看如何利用Copilot帮助我们编写集成测试。
- en: Creating Integration Tests
  id: totrans-143
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 创建集成测试
- en: You can use Copilot to create integration tests by telling it to focus on the
    way multiple components interact rather than creating tests for isolated units
    of code. To do this, you need to write your prompts with clear instructions that
    emphasize the collaboration between services, modules, and/or external systems.
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以使用Copilot创建集成测试，通过指示它关注多个组件之间的交互方式，而不是为独立的代码单元创建测试。为此，您需要编写带有清晰说明的提示，强调服务、模块和/或外部系统之间的协作。
- en: 'The keys to having Copilot create successful integration tests are as follows:'
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 使Copilot创建成功的集成测试的关键如下：
- en: Craft specific prompts
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 制定特定的提示
- en: Ask Copilot to write integration tests for interaction between components rather
    than just generating tests for code.
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 请求Copilot编写组件之间交互的集成测试，而不仅仅是生成针对代码的测试。
- en: Use mocks for external dependencies
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 使用模拟外部依赖
- en: Integration tests frequently need to simulate an external service such as a
    database or an API. You can instruct Copilot to use mocks so tests can verify
    the functionality without having to have real implementations.
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 集成测试通常需要模拟外部服务，如数据库或API。您可以指示Copilot使用模拟，以便测试可以在没有真实实现的情况下验证功能。
- en: Request coverage of interactions
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 请求交互覆盖率
- en: Ask Copilot to verify that methods are called, data flows as expected between
    components, or that expected side effects occur.
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 请求Copilot验证方法是否被调用，数据是否在组件之间按预期流动，或者是否发生了预期的副作用。
- en: 'A generic template for a prompt for integration tests could look something
    like this:'
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 集成测试提示的通用模板可能看起来像这样：
- en: '[PRE16]'
  id: totrans-153
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: '(Again, the terms in <> are meant to be replaced for your specific use case.)
    As an example, suppose that we have an Express application with two modules:'
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: （同样，<>中的术语是为了替换为您的特定用例。）例如，假设我们有一个Express应用程序，包含两个模块：
- en: '`UserService`'
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: '`UserService`'
- en: Handles user data
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 处理用户数据
- en: '`AuthController`'
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: '`AuthController`'
- en: Handles login requests and delegates to `UserService`
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 处理登录请求并委托给`UserService`
- en: 'We want to write integration tests to ensure that the `AuthController` correctly
    interacts with `UserService` and the HTTP layer. Here is a prompt to do this:'
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 我们想编写集成测试以确保`AuthController`正确地与`UserService`和HTTP层交互。以下是执行此操作的提示：
- en: '[PRE17]'
  id: totrans-160
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: 'Here’s the response that Copilot generates based on that prompt:'
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是Copilot根据该提示生成的响应：
- en: '[PRE18]'
  id: totrans-162
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: You may need to do additional tweaking on the integration test code to ensure
    everything works as intended, but this gives you a solid starting point to work
    from.
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 您可能需要进一步调整集成测试代码以确保一切按预期工作，但这为您提供了一个坚实的起点。
- en: Regardless of the kinds of tests you are creating through Copilot, you may want
    to have them tailored for your project or per testing guidelines you must adhere
    to. In the next section, we’ll look at how to set up custom testing instructions
    for Copilot.
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 无论您通过Copilot创建的是哪种类型的测试，您可能希望它们针对您的项目或您必须遵守的测试指南进行定制。在下一节中，我们将探讨如何为Copilot设置自定义测试说明。
- en: Defining Custom Testing Instructions
  id: totrans-165
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 定义自定义测试说明
- en: You can customize how Copilot generates tests for your project by providing
    custom test-generation instructions. This ensures that Copilot produces tests
    that align with your preferred frameworks, coding standards, and workflows.
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以通过提供定制的测试生成说明来自定义Copilot为您项目生成的测试方式。这确保了Copilot生成的测试与您首选的框架、编码标准和工作流程保持一致。
- en: 'Test-generation instructions can be set up at two levels: user level and workspace
    level.'
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 测试生成说明可以在两个级别上设置：用户级别和工作区级别。
- en: For a particular workspace, you can add instructions directly to your project’s
    *.vscode/settings.json* file. If these are persisted, they customize Copilot’s
    behavior for everyone working with that project.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 对于特定的工作区，您可以直接将说明添加到项目的 *.vscode/settings.json* 文件中。如果这些说明被保存，它们将定制Copilot对该项目的所有人行为。
- en: To create instructions that apply across all projects you work with, you can
    instead add instructions to your *global* VS Code settings.
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 要创建适用于您所参与的所有项目的说明，您可以将说明添加到全局VS Code设置中。
- en: At either of these levels, you can also create a separate Markdown file with
    more detailed instructions and then point your settings to the file. This is useful
    for complex or evolving standards that you want to reuse across multiple projects.
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: 在这两个级别中，您还可以创建一个包含更详细说明的单独Markdown文件，然后将设置指向该文件。这对于您希望在多个项目中重用的复杂或不断发展的标准非常有用。
- en: 'When adding custom test instructions in your settings file, they should be
    placed under the key `github.copilot.chat.testGeneration.instructions`. Here’s
    an example with both specific instructions spelled out and a referenced file:'
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 当在你的设置文件中添加自定义测试指令时，它们应该放在`github.copilot.chat.testGeneration.instructions`键下。以下是一个包含具体指令和引用文件的示例：
- en: '[PRE19]'
  id: totrans-172
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: 'The content in the file *test-guidelines.md* could be as follows:'
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 文件*test-guidelines.md*中的内容可能如下所示：
- en: '[PRE20]'
  id: totrans-174
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: You may have to iterate to get the best form for the instructions, but once
    they’re set up, Copilot should honor them for typical operations like `@workspace
    /tests`.
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 你可能需要迭代以获得最佳指令形式，但一旦设置好，Copilot应该会为典型的操作如`@workspace /tests`遵守它们。
- en: Custom Test Instructions Are Experimental
  id: totrans-176
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 自定义测试指令是实验性的
- en: As of this writing, the custom test instructions feature is still labeled as
    *experimental.*
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 到本文写作时，自定义测试指令功能仍被标记为*实验性*。
- en: For the final part of this chapter, let’s look at how Copilot can help with
    using frameworks and creating tests *before* writing implementation code. This
    is useful for techniques like test-driven development.
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章的最后部分，让我们看看Copilot如何帮助在使用框架和创建测试*之前*编写实现代码。这对于测试驱动开发等技术很有用。
- en: Testing Before the Coding and Leveraging Frameworks
  id: totrans-179
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在编码前进行测试和利用框架
- en: '*Test-driven development* (*TDD*) has already been mentioned in this chapter.
    If you’re unfamiliar with the term, it’s an approach to software development that
    emphasizes writing test cases for code before writing the actual code itself.
    TDD is considered a best practice or requirement in many coding projects and groups.'
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: '*测试驱动开发* (*TDD*)在本章中已经提到。如果你对这个术语不熟悉，它是一种软件开发方法，强调在编写实际代码之前先编写代码的测试用例。TDD在很多编码项目和团队中被认为是最佳实践或要求。'
- en: More on TDD
  id: totrans-181
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 更多关于TDD的内容
- en: If you are new to TDD or interested in learning more about the practice, the
    web has many references. A relatively quick but informative read can be found
    at the [testdriven.io](https://oreil.ly/VaMiK) website.
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你刚开始接触TDD或想了解更多关于这种实践的信息，网上有许多参考资料。一个相对快速但信息丰富的阅读可以在[testdriven.io](https://oreil.ly/VaMiK)网站上找到。
- en: You can use Copilot to create test cases for TDD and then implement the code
    to be tested. Consider a simple example of creating a test class and tests for
    code that will help manage student records at a university. We’ll use [Mockito](https://site.mockito.org)
    in our testing framework.
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以使用Copilot创建TDD的测试用例，然后实现要测试的代码。考虑一个简单的例子，创建一个测试类和测试代码，这些代码将帮助管理大学的学生记录。在我们的测试框架中，我们将使用[Mockito](https://site.mockito.org)。
- en: About Mockito
  id: totrans-184
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 关于Mockito
- en: Mockito specializes in helping Java applications manage dependencies and simulating
    external interactions from other components without requiring the implementation
    or presence of the components themselves—i.e., *mocking*. Previously in the chapter,
    we showed how Copilot can incorporate mocking for generating integration tests.
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: Mockito专注于帮助Java应用程序管理依赖关系，并模拟来自其他组件的外部交互，而无需实现或存在这些组件本身——即*模拟*。在本章的先前部分，我们展示了Copilot如何通过模拟生成集成测试。
- en: 'To start, suppose we begin with an empty project called *students*, and we
    have Copilot create a [*pom.xml*](https://oreil.ly/Qx29p) file for a Java project
    with desired versions of dependencies. Here’s a prompt for that:'
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，假设我们从一个名为*students*的空项目开始，让Copilot为具有所需依赖项版本的Java项目创建一个[*pom.xml*](https://oreil.ly/Qx29p)文件。以下是相应的提示：
- en: '[PRE21]'
  id: totrans-187
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: As shown in [Figure 5-15](#pomxml-creation), this prompt triggers Copilot to
    try to understand our intent and then run the `/new` shortcut command to set up
    a structure if needed. After that, it figures out the code for the *pom.xml* file
    we asked for and gives a link to see it and a button shortcut to create it.
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 如[图5-15](#pomxml-creation)所示，这个提示会触发Copilot尝试理解我们的意图，然后运行`/new`快捷命令以设置所需的结构。之后，它会找出我们要求的*pom.xml*文件的代码，并提供一个链接查看它以及一个创建它的按钮快捷方式。
- en: '![](assets/lghc_0515.png)'
  id: totrans-189
  prefs: []
  type: TYPE_IMG
  zh: '![图片](assets/lghc_0515.png)'
- en: Figure 5-15\. pom.xml creation
  id: totrans-190
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图5-15\. pom.xml创建
- en: To build out our testing code, let’s create an appropriate test class and initial
    set of tests. We’ll do this in the separate Chat interface since we can expect
    a significant amount of output and we may want to put it in a separate file.
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: 为了构建我们的测试代码，让我们创建一个合适的测试类和初始测试集。我们将在单独的聊天界面中这样做，因为我们预计会有大量的输出，我们可能希望将其放入一个单独的文件中。
- en: 'In the prompt, we tell Copilot to reference the content of the *pom.xml* file
    to make sure it knows to pick up the Mockito dependency:'
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE22]'
  id: totrans-193
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: 'This then makes our initial query something like the following:'
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE23]'
  id: totrans-195
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: 'Copilot returns this in response:'
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE24]'
  id: totrans-197
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: 'Explanation:'
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
- en: '1\. **Dependencies**:'
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
- en: The `mockito-core` dependency in your pom.xml
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
- en: is used for mocking the `University` class.
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
- en: '2\. **Test Setup**:'
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
- en: The `@BeforeEach` method initializes the mock
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
- en: '`University` object and a sample `Student` object.'
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
- en: '3\. **Test Cases**:'
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
- en: '- `testEnrollStudent`: Verifies that a student is enrolled in the'
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
- en: university and checks the list of enrolled students.
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
- en: '- `testGetStudentDetails`: Verifies that the correct student'
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
- en: details are returned when queried by ID.
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
- en: Make sure you have the `Student` and `University` classes
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
- en: implemented in your project for these tests to work. Let me know if
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
- en: you need help creating those classes!
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE25]'
  id: totrans-213
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: 'Referencing #file:pom.xml, create only a StudentTest class for a'
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
- en: student enrolled at a university. A student will have personal
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
- en: attributes such as a first and last name, a phone number, an
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
- en: address, and a contact email.
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE26]'
  id: totrans-218
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: Here is the `StudentTest` class for testing a student with personal
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
- en: 'attributes:'
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
- en: package com.example;
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
- en: import org.junit.jupiter.api.BeforeEach;
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
- en: import org.junit.jupiter.api.Test;
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
- en: import static org.junit.jupiter.api.Assertions.*;
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
- en: class StudentTest {
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
- en: private Student student;
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
- en: '@BeforeEach'
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
- en: void setUp() {
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
- en: student = new Student("John", "Doe", "123-456-7890",
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
- en: '"123 Main St", "john.doe@example.com");'
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
- en: '}'
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
- en: '@Test'
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
- en: void testStudentAttributes() {
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
- en: // Verify that the student's attributes are correctly set
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
- en: assertEquals("John", student.getFirstName());
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
- en: assertEquals("Doe", student.getLastName());
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
- en: assertEquals("123-456-7890", student.getPhoneNumber());
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
- en: assertEquals("123 Main St", student.getAddress());
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
- en: assertEquals("john.doe@example.com", student.getEmail());
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
- en: '}'
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
- en: '@Test'
  id: totrans-241
  prefs: []
  type: TYPE_NORMAL
- en: void testUpdatePhoneNumber() {
  id: totrans-242
  prefs: []
  type: TYPE_NORMAL
- en: // Update the phone number and verify the change
  id: totrans-243
  prefs: []
  type: TYPE_NORMAL
- en: student.setPhoneNumber("987-654-3210");
  id: totrans-244
  prefs: []
  type: TYPE_NORMAL
- en: assertEquals("987-654-3210", student.getPhoneNumber());
  id: totrans-245
  prefs: []
  type: TYPE_NORMAL
- en: '}'
  id: totrans-246
  prefs: []
  type: TYPE_NORMAL
- en: '@Test'
  id: totrans-247
  prefs: []
  type: TYPE_NORMAL
- en: void testUpdateAddress() {
  id: totrans-248
  prefs: []
  type: TYPE_NORMAL
- en: // Update the address and verify the change
  id: totrans-249
  prefs: []
  type: TYPE_NORMAL
- en: student.setAddress("456 Elm St");
  id: totrans-250
  prefs: []
  type: TYPE_NORMAL
- en: assertEquals("456 Elm St", student.getAddress());
  id: totrans-251
  prefs: []
  type: TYPE_NORMAL
- en: '}'
  id: totrans-252
  prefs: []
  type: TYPE_NORMAL
- en: '@Test'
  id: totrans-253
  prefs: []
  type: TYPE_NORMAL
- en: void testUpdateEmail() {
  id: totrans-254
  prefs: []
  type: TYPE_NORMAL
- en: // Update the email and verify the change
  id: totrans-255
  prefs: []
  type: TYPE_NORMAL
- en: student.setEmail("new.email@example.com");
  id: totrans-256
  prefs: []
  type: TYPE_NORMAL
- en: assertEquals("new.email@example.com", student.getEmail());
  id: totrans-257
  prefs: []
  type: TYPE_NORMAL
- en: '}'
  id: totrans-258
  prefs: []
  type: TYPE_NORMAL
- en: '}'
  id: totrans-259
  prefs: []
  type: TYPE_NORMAL
- en: 'Explanation:'
  id: totrans-260
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '1\. **Attributes Tested**:'
  id: totrans-261
  prefs: []
  type: TYPE_NORMAL
- en: '- First name'
  id: totrans-262
  prefs: []
  type: TYPE_NORMAL
- en: '- Last name'
  id: totrans-263
  prefs: []
  type: TYPE_NORMAL
- en: '- Phone number'
  id: totrans-264
  prefs: []
  type: TYPE_NORMAL
- en: '- Address'
  id: totrans-265
  prefs: []
  type: TYPE_NORMAL
- en: '- Email'
  id: totrans-266
  prefs: []
  type: TYPE_NORMAL
- en: '2\. **Test Cases**:'
  id: totrans-267
  prefs: []
  type: TYPE_NORMAL
- en: '- `testStudentAttributes`: Ensures the attributes are initialized'
  id: totrans-268
  prefs: []
  type: TYPE_NORMAL
- en: correctly.
  id: totrans-269
  prefs: []
  type: TYPE_NORMAL
- en: '- `testUpdatePhoneNumber`, `testUpdateAddress`, `testUpdateEmail`'
  id: totrans-270
  prefs: []
  type: TYPE_NORMAL
- en: ': Verify that updates to attributes work as expected.'
  id: totrans-271
  prefs: []
  type: TYPE_NORMAL
- en: This test assumes the existence of a `Student` class with
  id: totrans-272
  prefs: []
  type: TYPE_NORMAL
- en: appropriate getters and setters. Let me know if you need help
  id: totrans-273
  prefs: []
  type: TYPE_NORMAL
- en: creating the `Student` class!
  id: totrans-274
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE27]'
  id: totrans-275
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: Install any needed dependencies for testing with mvn and then run
  id: totrans-276
  prefs: []
  type: TYPE_NORMAL
- en: tests
  id: totrans-277
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE28]'
  id: totrans-278
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: 'Referencing #editor, create a student class.'
  id: totrans-279
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE29]'
  id: totrans-280
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: mvn test
  id: totrans-281
  prefs: []
  type: TYPE_NORMAL
- en: 'The Maven test compilation failed due to the following issues:'
  id: totrans-282
  prefs: []
  type: TYPE_NORMAL
  zh: Maven 测试编译失败，原因如下：
- en: '1\. JUnit Dependencies Missing:'
  id: totrans-283
  prefs: []
  type: TYPE_NORMAL
  zh: 1. 缺少的 JUnit 依赖项：
- en: The org.junit.jupiter.api package is not found, indicating that the
  id: totrans-284
  prefs: []
  type: TYPE_NORMAL
  zh: The org.junit.jupiter.api package is not found, indicating that the
- en: JUnit 5 (Jupiter) dependency is missing in the pom.xml.
  id: totrans-285
  prefs: []
  type: TYPE_NORMAL
  zh: pom.xml 中缺少 JUnit 5 (Jupiter) 依赖项。
- en: '2\. Student Class Not Found: The Student class is not being'
  id: totrans-286
  prefs: []
  type: TYPE_NORMAL
  zh: 2. 学生类未找到：在测试执行过程中未找到 `Student` 类，这表明 `Student`
- en: recognized, which could be due to incorrect package structure or
  id: totrans-287
  prefs: []
  type: TYPE_NORMAL
  zh: recognized, which could be due to incorrect package structure or
- en: missing compilation.
  id: totrans-288
  prefs: []
  type: TYPE_NORMAL
  zh: 缺少编译。
- en: '3\. Annotations Not Recognized: Annotations like @BeforeEach and'
  id: totrans-289
  prefs: []
  type: TYPE_NORMAL
  zh: 3. 未识别的注解：如 @BeforeEach 的注解未被识别，这可能是由于不正确的包结构导致的
- en: '@Test are not recognized, which is also related to the missing'
  id: totrans-290
  prefs: []
  type: TYPE_NORMAL
  zh: '@Test 注解未被识别，这也与缺少'
- en: JUnit dependency.
  id: totrans-291
  prefs: []
  type: TYPE_NORMAL
  zh: JUnit 依赖项。
- en: 'I will now:'
  id: totrans-292
  prefs: []
  type: TYPE_NORMAL
  zh: 我现在将：
- en: Add the required JUnit 5 dependency to the pom.xml.
  id: totrans-293
  prefs: []
  type: TYPE_NORMAL
  zh: 将所需的 JUnit 5 依赖项添加到 pom.xml 文件中。
- en: Ensure the Student class is correctly compiled and accessible.
  id: totrans-294
  prefs: []
  type: TYPE_NORMAL
  zh: 确保 Student 类正确编译且可访问。
- en: Re-run the tests after fixing these issues
  id: totrans-295
  prefs: []
  type: TYPE_NORMAL
  zh: 修复这些问题后重新运行测试
- en: '[PRE30]'
  id: totrans-296
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: <dependencies>
  id: totrans-297
  prefs: []
  type: TYPE_NORMAL
  zh: <dependencies>
- en: <!-- ...existing dependencies... -->
  id: totrans-298
  prefs: []
  type: TYPE_NORMAL
  zh: <!-- ...现有依赖项... -->
- en: <dependency>
  id: totrans-299
  prefs: []
  type: TYPE_NORMAL
  zh: <dependency>
- en: <groupId>org.junit.jupiter</groupId>
  id: totrans-300
  prefs: []
  type: TYPE_NORMAL
  zh: <groupId>org.junit.jupiter</groupId>
- en: <artifactId>junit-jupiter</artifactId>
  id: totrans-301
  prefs: []
  type: TYPE_NORMAL
  zh: <artifactId>junit-jupiter</artifactId>
- en: <version>5.10.0</version>
  id: totrans-302
  prefs: []
  type: TYPE_NORMAL
  zh: <version>5.10.0</version>
- en: <scope>test</scope>
  id: totrans-303
  prefs: []
  type: TYPE_NORMAL
  zh: <scope>test</scope>
- en: </dependency>
  id: totrans-304
  prefs: []
  type: TYPE_NORMAL
  zh: </dependency>
- en: </dependencies>
  id: totrans-305
  prefs: []
  type: TYPE_NORMAL
  zh: </dependencies>
- en: Made changes.
  id: totrans-306
  prefs: []
  type: TYPE_NORMAL
  zh: 进行了更改。
- en: The Maven test run failed because the `Student` class could not be
  id: totrans-307
  prefs: []
  type: TYPE_NORMAL
  zh: Maven 测试运行失败，因为 `Student` 类无法
- en: found during the test execution. This indicates that the `Student`
  id: totrans-308
  prefs: []
  type: TYPE_NORMAL
  zh: 在测试执行过程中找到。这表明 `Student`
- en: class might not be compiled or is not in the correct package
  id: totrans-309
  prefs: []
  type: TYPE_NORMAL
  zh: 类可能没有被编译或者不在正确的包中
- en: structure.
  id: totrans-310
  prefs: []
  type: TYPE_NORMAL
  zh: 结构。
- en: I will verify the `Student` class's location and ensure it is
  id: totrans-311
  prefs: []
  type: TYPE_NORMAL
  zh: 我将验证 `Student` 类的位置，并确保它正确。
- en: properly compiled and accessible. Then, I will re-run the tests.
  id: totrans-312
  prefs: []
  type: TYPE_NORMAL
  zh: 正确编译且可访问。然后，我将重新运行测试。
- en: '```'
  id: totrans-313
  prefs: []
  type: TYPE_NORMAL
  zh: '```'
- en: 'Once again, the agent has figured out what it needs to try next. After we review
    and tell Copilot to proceed, it generates a new *Student.java* file with the correct
    content and in the correct location, and then proceeds to run the tests again.
    This time, they succeed because the agent has completed all needed changes. [Figure 5-18](#successful-completion)
    shows the success via the following:'
  id: totrans-314
  prefs: []
  type: TYPE_NORMAL
  zh: 再次，代理已经弄清楚它需要尝试下一步。在我们审查并告诉 Copilot 继续之后，它生成一个新的 *Student.java* 文件，内容正确且位置正确，然后再次运行测试。这次，它们成功了，因为代理已经完成了所有需要的更改。[图
    5-18](#successful-completion) 通过以下方式显示了成功：
- en: The new *Student.java* file in the upper left with its new content waiting to
    be approved
  id: totrans-315
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 上左角的新的 *Student.java* 文件及其新内容等待批准
- en: The successful build/test run in the lower left
  id: totrans-316
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 下左角的“成功构建/测试运行”
- en: The agent’s assessment that the tests all passed, the `Student` class is implemented,
    and the project is working as expected, in the upper right
  id: totrans-317
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 代理在右上角的评估表明，所有测试都通过了，`Student` 类已实现，项目按预期工作
- en: The “files changed” area in the lower right showing that updates were made by
    the agent to the *pom.xml* file and the *Student.java* file to get everything
    working
  id: totrans-318
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 下右角的“文件更改”区域显示，代理对 *pom.xml* 文件和 *Student.java* 文件进行了更新，以使一切正常工作
- en: '![](assets/lghc_0518.png)'
  id: totrans-319
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/lghc_0518.png)'
- en: Figure 5-18\. Successful completion via the agent
  id: totrans-320
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 5-18. 通过代理成功完成
- en: Certainly, we could have done this without the agent via several passes and
    individual actions. But, where we can leverage Copilot’s agentic abilities, we
    can save ourselves some time and effort.
  id: totrans-321
  prefs: []
  type: TYPE_NORMAL
  zh: 当然，我们可以通过多次遍历和单独的操作来完成这项工作，而不需要代理。但是，当我们可以利用 Copilot 的代理能力时，我们可以节省一些时间和精力。
- en: From here, we can review the changes, save the updated files into the workspace,
    and add other functionality if we need it. Similar multistep processes for testing
    workflows can be done with this step-by-step approach, whether using the agent
    or not.
  id: totrans-322
  prefs: []
  type: TYPE_NORMAL
  zh: 从这里，我们可以审查更改，将更新的文件保存到工作区，并在需要时添加其他功能。使用这种逐步方法进行测试工作流程的多步骤过程可以完成，无论是否使用代理。
- en: As always, the more context and direction you can give Copilot through the prompt,
    workspace files, editor, etc., the more likely it will produce good content and
    suggestions for you to incorporate. If, however, you don’t get what you expect,
    don’t be afraid to iterate on your prompt/query until you get the results you
    want.
  id: totrans-323
  prefs: []
  type: TYPE_NORMAL
  zh: 像往常一样，你通过提示、工作区文件、编辑器等提供的上下文和方向越多，Copilot就越有可能为你生成好的内容和建议。然而，如果你没有得到你期望的结果，不要害怕迭代你的提示/查询，直到你得到你想要的结果。
- en: Conclusion
  id: totrans-324
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 结论
- en: In this chapter, we’ve focused on how to apply Copilot’s completion suggestions
    and chat capabilities in the context of creating tests for code. As shown in the
    different sections, you can use various approaches to have Copilot generate tests
    relevant to code in your workspace. Inline completion and suggestions from Copilot
    can be utilized, as well as the chat capabilities.
  id: totrans-325
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们专注于如何在创建代码测试的上下文中应用Copilot的完成建议和聊天功能。正如不同部分所示，你可以使用各种方法让Copilot生成与你的工作区中的代码相关的测试。可以使用Copilot的行内完成和建议，以及聊天功能。
- en: Most options for generating tests rely on passing the request to the chat interface
    in some form—either by using shortcut (slash) commands or entering a prompt through
    the inline or separate chat interfaces. For any substantial or complex, lengthy
    tests, working through the chat functionality will likely provide the best results.
    For quick, boilerplate unit tests or simple unit-testing functions, using specific
    inline comments as prompts can work well.
  id: totrans-326
  prefs: []
  type: TYPE_NORMAL
  zh: 大多数生成测试的选项都依赖于以某种形式将请求传递到聊天界面——要么是通过使用快捷（斜杠）命令，要么是通过行内或单独的聊天界面输入提示。对于任何实质性的或复杂的、长篇的测试，通过聊天功能工作可能会提供最佳结果。对于快速、模板化的单元测试或简单的单元测试函数，使用特定的行内注释作为提示可以很好地工作。
- en: Most basic commands for creating tests through Copilot produce unit tests. Copilot
    can be used to create integration tests by ensuring that the prompt includes sections
    targeted toward interaction of components, mocking, and verifying the expected
    outcomes.
  id: totrans-327
  prefs: []
  type: TYPE_NORMAL
  zh: 大多数通过Copilot创建测试的基本命令都会生成单元测试。Copilot可以通过确保提示包括针对组件交互、模拟和验证预期结果的章节来创建集成测试。
- en: Copilot can be used to support best practices such as TDD. With this strategy,
    Copilot can be used to generate initial testing code and then later generate the
    appropriate implementation to pass the test. As with all approaches mentioned
    in the chapter, it’s important to review the results to make sure they are usable
    and what you intended. You should always feel free to disregard suggestions or
    code from Copilot and/or reframe prompts and queries to get more accurate results.
    Also, you can define more explicit context to have Copilot consider for generating
    the results.
  id: totrans-328
  prefs: []
  type: TYPE_NORMAL
  zh: Copilot可用于支持最佳实践，如TDD。使用这种策略，Copilot可以用来生成初始测试代码，然后后来生成适当的实现来通过测试。与本章中提到的所有方法一样，重要的是要审查结果，以确保它们是可用的并且符合你的意图。你应该始终自由地忽略Copilot的建议或代码，并/或重新构思提示和查询以获得更准确的结果。此外，你可以定义更明确的上下文，让Copilot考虑生成结果。
- en: As with implementation code, testing code should ideally be verbosely commented.
    This makes the code more readable and easily understandable. However, explaining
    and documenting our test cases or our implementations is something we may put
    off until later because it takes cycles away from other work, and the algorithms
    may be changed. In [Chapter 6](ch06.html#ch06), we’ll explore how Copilot can
    help make these tasks almost effortless.
  id: totrans-329
  prefs: []
  type: TYPE_NORMAL
  zh: 就像实现代码一样，测试代码理想情况下应该有详尽的注释。这使得代码更易于阅读和理解。然而，解释和记录我们的测试用例或实现可能被推迟到以后，因为这会占用其他工作的周期，而且算法可能会改变。在[第6章](ch06.html#ch06)中，我们将探讨Copilot如何帮助使这些任务几乎变得毫不费力。
