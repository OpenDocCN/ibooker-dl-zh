<html><head></head><body>
<div id="book-content">
<div id="sbo-rt-content"><section data-type="chapter" epub:type="chapter" data-pdf-bookmark="Chapter 15. Using ChatGPT to Call Your API"><div class="chapter" id="chapter_15">
<h1><span class="label">Chapter 15. </span>Using ChatGPT to Call Your API</h1>


<p>In the previous chapter, you built a basic generative AI application that could chat with a model in natural language and retrieve data from the SportsWorldCentral API. You created quite a bit of Python code to accomplish that.</p>

<p>In this chapter, you will use custom GPTs from OpenAI to accomplish this task without creating any Python code other than the SportsWorldCentral API. You can think of a custom GPT as a low-code method for creating a generative AI application that connects to your API.</p>






<section data-type="sect1" data-pdf-bookmark="Architecture of Your Application"><div class="sect1" id="id219">
<h1>Architecture of Your Application</h1>

<p><a data-type="xref" href="#chatgpt_architecture_ch15">Figure 15-1</a> shows the high-level architecture of the project you will create in this chapter.<a data-type="indexterm" data-primary="ChatGPT calling SWC API" data-secondary="architecture of application" id="id2676"/></p>

<p>If you compare this diagram to <a data-type="xref" href="ch14.html#langgraph_architecture_ch14">Figure 14-1</a>, you will see a few similarities. In both cases, a user is using natural language chat to retrieve data from the SportsWorldCentral API. In both cases, a function-calling LLM is used to chat with the user and decide when to call the API for additional information. Although you used an Anthropic model in <a data-type="xref" href="ch14.html#chapter_14">Chapter 14</a>, you could have used the same <a data-type="indexterm" data-primary="GPT-4o (OpenAI)" data-secondary="using for Part III portfolio project" id="id2677"/>OpenAI GPT-4o model that you will use in this chapter.</p>

<p>However, there are also large differences from <a data-type="xref" href="ch14.html#chapter_14">Chapter 14</a>’s architecture. Where <a data-type="xref" href="ch14.html#chapter_14">Chapter 14</a> required many different Python components to be developed and run on GitHub Codespaces, in this chapter, only the SportsWorldCentral API will be running there. As you continue through this chapter, I will share more contrasts with <span class="keep-together"><a data-type="xref" href="ch14.html#chapter_14">Chapter 14</a>.</span></p>

<figure><div id="chatgpt_architecture_ch15" class="figure">
<img src="assets/haad_1501.png" alt="High-level architecture" width="948" height="717"/>
<h6><span class="label">Figure 15-1. </span>High-level architecture</h6>
</div></figure>
<div data-type="warning" epub:type="warning"><h6>Warning</h6>
<p>As with the model used in <a data-type="xref" href="ch14.html#chapter_14">Chapter 14</a>, you <a data-type="indexterm" data-primary="system cards for documentation" data-secondary="GPT-4o System Card online" id="id2678"/><a data-type="indexterm" data-primary="GPT-4o (OpenAI)" data-secondary="System Card online" id="id2679"/><a data-type="indexterm" data-primary="resources online" data-secondary="OpenAI" data-tertiary="GPT-4o System Card" id="id2680"/><a data-type="indexterm" data-primary="ChatGPT calling SWC API" data-secondary="GPT-4o System Card online" id="id2681"/><a data-type="indexterm" data-primary="GPT-4o (OpenAI)" data-secondary="System Card online" data-tertiary="risks of model" id="id2682"/>should be aware of the limitations and risks of the model you are using. The <a href="https://oreil.ly/v8SNX">GPT-4o System Card</a> states risks that include misinformation, violent speech, and others.</p>
</div>
</div></section>






<section data-type="sect1" data-pdf-bookmark="Getting Started with ChatGPT"><div class="sect1" id="id151">
<h1>Getting Started with ChatGPT</h1>

<p>The first step is to sign up for<a data-type="indexterm" data-primary="ChatGPT calling SWC API" data-secondary="account setup" id="id2683"/><a data-type="indexterm" data-primary="resources online" data-secondary="OpenAI" data-tertiary="home page" id="id2684"/><a data-type="indexterm" data-primary="resources online" data-secondary="OpenAI" data-tertiary="ChatGPT pricing page" id="id2685"/><a data-type="indexterm" data-primary="ChatGPT calling SWC API" data-secondary="account setup" data-tertiary="ChatGPT pricing page online" id="id2686"/><a data-type="indexterm" data-primary="costs for ChatGPT" id="id2687"/> a ChatGPT user account, from the <a href="https://chat.openai.com">OpenAI home page</a>. You need to select a plan that includes the Create GPTs capability. At the time of this writing, the <a href="https://oreil.ly/gptpri">ChatGPT pricing page</a> shows that Plus, Team, and Enterprise accounts have that option. Follow the sign-up instructions to activate your account. Once you have signed up, log in and navigate back to the <a href="https://chat.openai.com">ChatGPT home page</a>.</p>
<div data-type="tip"><h6>Tip</h6>
<p>If you would like to prevent OpenAI<a data-type="indexterm" data-primary="ChatGPT calling SWC API" data-secondary="account setup" data-tertiary="OpenAI privacy portal" id="id2688"/><a data-type="indexterm" data-primary="resources online" data-secondary="OpenAI" data-tertiary="privacy portal" id="id2689"/> from using your chats to train its models, you can request this through the <a href="https://oreil.ly/2qLwN">OpenAI privacy portal</a>. Doing so reduces the possibility that information you enter in ChatGPT or custom GPTs will be shown to other users accidentally.</p>
</div>
</div></section>






<section data-type="sect1" class="less_space pagebreak-before" data-pdf-bookmark="Creating a Custom GPT"><div class="sect1" id="id152">
<h1>Creating a Custom GPT</h1>

<p>To create your first GPT, <a data-type="indexterm" data-primary="ChatGPT calling SWC API" data-secondary="custom GPT created" id="ch15cust"/>click your profile photo and select My GPTs. You will see the My GPTs page, as shown in <a data-type="xref" href="#my_gpts_ch15">Figure 15-2</a>.</p>

<figure><div id="my_gpts_ch15" class="figure">
<img src="assets/haad_1502.png" alt="My GPTs page" width="457" height="187"/>
<h6><span class="label">Figure 15-2. </span>My GPTs page</h6>
</div></figure>

<p>Click Create a GPT. The New GPT page will be displayed with the Configure option selected, as shown in <a data-type="xref" href="#new_gpt_ch15">Figure 15-3</a>.</p>

<figure><div id="new_gpt_ch15" class="figure">
<img src="assets/haad_1503.png" alt="Creating a new GPT" width="743" height="638"/>
<h6><span class="label">Figure 15-3. </span>Creating a new GPT</h6>
</div></figure>

<p class="less_space pagebreak-before">The large button with the plus sign on it is used to select an image for your custom GPT. Download a public-domain image to your computer, then click that button. Select Upload Photo and upload the local file. You can view an example of a public domain image of a football and helmet at <a href="https://oreil.ly/dItdO" class="bare"><em class="hyperlink">https://oreil.ly/dItdO</em></a>.</p>

<p>To configure the GPT, <a data-type="indexterm" data-primary="ChatGPT calling SWC API" data-secondary="custom GPT created" data-tertiary="configuring" id="id2690"/>fill out the options on the New GPT page as shown in <a data-type="xref" href="#completed_new_gpt_part1_ch15">Figure 15-4</a>.</p>

<figure><div id="completed_new_gpt_part1_ch15" class="figure">
<img src="assets/haad_1504.png" alt="New GPT information part one" width="852" height="556"/>
<h6><span class="label">Figure 15-4. </span>New GPT information, part 1</h6>
</div></figure>

<p>Scroll down the page to see additional options. Leave the conversation starters empty at this time. Under the Capabilities section, do not select any capabilities. The display should look like <a data-type="xref" href="#completed_new_gpt_part2_ch15">Figure 15-5</a>.</p>

<figure><div id="completed_new_gpt_part2_ch15" class="figure">
<img src="assets/haad_1505.png" alt="New GPT information part two" width="524" height="635"/>
<h6><span class="label">Figure 15-5. </span>New GPT information, part 2</h6>
</div></figure>

<p>Take a minute to see what<a data-type="indexterm" data-primary="ChatGPT calling SWC API" data-secondary="custom GPT created" data-tertiary="checking SWC knowledge" id="id2691"/> your custom GPT can do with what you have given it <span class="keep-together">so far. In</span> the Preview pane, enter the following prompt: <strong><code>What are the specific <span class="keep-together">league</span> names from the SportsWorldCentral fantasy football platform?</code></strong></p>

<p>The response you get when you<a data-type="indexterm" data-primary="AI (artificial intelligence)" data-secondary="models non-deterministic" id="id2692"/> perform this task may be different from what another user would receive. That is because generative AI responses are nondeterministic. (If you make your query too broad, your GPT may hallucinate and provide information that isn’t valid.) <a data-type="xref" href="#prompt_response1_ch15">Figure 15-6</a> displays an example where the GPT states that it doesn’t have specific information about team names, because they are not publicly available. That is correct; to get the team names, it will need to call an API.</p>

<figure><div id="prompt_response1_ch15" class="figure">
<img src="assets/haad_1506.png" alt="Prompt and response from Custom GPT" width="446" height="582"/>
<h6><span class="label">Figure 15-6. </span>Prompt and response from custom GPT</h6>
</div></figure>

<p>This reflects a <em>knowledge gap</em>, which<a data-type="indexterm" data-primary="AI (artificial intelligence)" data-secondary="knowledge gap" id="id2693"/><a data-type="indexterm" data-primary="knowledge gap of AI models" id="id2694"/> means that the model has not been trained on the information it needs to answer your prompt. To overcome this knowledge gap, you will create a custom action that enables your GPT to call the SWC API.</p>

<p>First, you need to launch your API in GitHub Codespaces with a public endpoint and update it to include the server URL in the OAS file.<a data-type="indexterm" data-startref="ch15cust" id="id2695"/></p>
</div></section>






<section data-type="sect1" data-pdf-bookmark="Launching Your GitHub Codespace"><div class="sect1" id="id398">
<h1>Launching Your GitHub Codespace</h1>

<p>You will be working with the Part III GitHub Codespace that you created in <a data-type="xref" href="ch12.html#cloning_part_3_sect">“Cloning the Part III Repository”</a>. If you haven’t created your Part III Codespace yet, you can complete that section now.</p>
</div></section>






<section data-type="sect1" class="less_space pagebreak-before" data-pdf-bookmark="Running the SportsWorldCentral (SWC) API in GitHub Codespaces"><div class="sect1" id="id153">
<h1>Running the SportsWorldCentral (SWC) API in GitHub Codespaces</h1>

<p>In the Terminal of your Codespace,<a data-type="indexterm" data-primary="launching your API" data-secondary="running in Codespace" id="id2696"/><a data-type="indexterm" data-primary="Python" data-secondary="API files" data-tertiary="launching your API to run in Codespace" id="id2697"/><a data-type="indexterm" data-primary="ChatGPT calling SWC API" data-secondary="running SWC API in Codespace" id="id2698"/><a data-type="indexterm" data-primary="SportsWorldCentral (SWC)" data-secondary="website API" data-tertiary="API running in Codespace" id="id2699"/><a data-type="indexterm" data-primary="Codespaces (GitHub)" data-secondary="launching your API" data-tertiary="running in Codespace" id="id2700"/><a data-type="indexterm" data-primary="GitHub" data-secondary="Codespaces" data-tertiary="launching your API to run in Codespace" id="id2701"/><a data-type="indexterm" data-primary="Codespaces (GitHub)" data-secondary="SWC API run locally" id="id2702"/><a data-type="indexterm" data-primary="GitHub" data-secondary="Codespaces" data-tertiary="SWC API run locally" id="id2703"/><a data-type="indexterm" data-primary="GitHub" data-secondary="Codespaces" data-tertiary="terminal window SWC API run locally" id="id2704"/><a data-type="indexterm" data-primary="terminal window of GitHub Codespace" data-secondary="SWC API run locally" id="id2705"/><a data-type="indexterm" data-primary="using APIs" data-secondary="SWC API running in Codespace" id="id2706"/><a data-type="indexterm" data-primary="Codespaces (GitHub)" data-secondary="terminal window" data-tertiary="SWC API run locally" id="id2707"/> install the required libraries using the provided <em>requirements.txt</em> file as follows:</p>

<pre data-type="programlisting" data-code-language="shell">.../ai-project (main) $ cd api
.../api (main) $ pip3 install -r requirements.txt</pre>

<p>Launch the API from the command line as shown:<a data-type="indexterm" data-primary="FastAPI" data-secondary="CLI" data-tertiary="fastapi run" id="id2708"/></p>

<pre data-type="programlisting" data-code-language="shell">.../api (main) $ fastapi run main.py</pre>

<p>You will see several messages, ending with the following:</p>

<pre data-type="programlisting" data-code-language="shell">INFO:     Started server process [19192]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)</pre>

<p>You will see a dialog stating “Your application running on port 8000 is available” as shown in <a data-type="xref" href="#make_api_public_ch15">Figure 15-7</a>. Click Make Public.<a data-type="indexterm" data-primary="Codespaces (GitHub)" data-secondary="launching your API" data-tertiary="port 8000 for application" id="id2709"/><a data-type="indexterm" data-primary="Codespaces (GitHub)" data-secondary="launching your API" data-tertiary="port 8000 made public" id="id2710"/><a data-type="indexterm" data-primary="GitHub" data-secondary="Codespaces" data-tertiary="launching your API to port 8000" id="id2711"/><a data-type="indexterm" data-primary="GitHub" data-secondary="Codespaces" data-tertiary="launching your API to port 8000 made public" id="id2712"/><a data-type="indexterm" data-primary="port 8000 for application" id="id2713"/><a data-type="indexterm" data-primary="port 8000 for application" data-secondary="making public" id="id2714"/><a data-type="indexterm" data-primary="launching your API" data-secondary="port 8000 for application" id="id2715"/><a data-type="indexterm" data-primary="launching your API" data-secondary="port 8000 for application" data-tertiary="making public" id="id2716"/></p>

<figure><div id="make_api_public_ch15" class="figure">
<img src="assets/haad_1507.png" alt="Make API Public" width="557" height="148"/>
<h6><span class="label">Figure 15-7. </span>Making the API public</h6>
</div></figure>

<p>The API is now running in Codespaces with a public port. To view the API in the browser, click Ports in the terminal and hover over Port 8000 (see <a data-type="xref" href="#api_running_public_port_15">Figure 15-8</a>).</p>

<figure><div id="api_running_public_port_15" class="figure">
<img src="assets/haad_1508.png" alt="API on public address" width="568" height="91"/>
<h6><span class="label">Figure 15-8. </span>API on a public address</h6>
</div></figure>

<p>Click the globe icon to open in the browser. If you receive the message “You are about to access a development port served by someone’s codespace,” click Continue.</p>

<p>The browser will open to a URL that ends in <em>app.github.dev</em>, and you should see the following health check message in your web browser:<a data-type="indexterm" data-primary="health check" data-secondary="launching API" id="id2717"/><a data-type="indexterm" data-primary="health check" data-secondary="launching API" data-tertiary="public port" id="id2718"/><a data-type="indexterm" data-primary="health check" data-secondary="ChatGPT calling SWC API" id="id2719"/></p>

<pre data-type="programlisting">{"message":"API health check successful"}</pre>

<p class="less_space pagebreak-before">Your API is running publicly in the cloud.<a data-type="indexterm" data-primary="deploying to the cloud" data-secondary="ChatGPT calling SWC API" id="id2720"/><a data-type="indexterm" data-primary="URL of API" data-secondary="ChatGPT calling SWC API" id="id2721"/></p>

<p>Next, you need to capture the public URL of your API so that you can use it in the next section. Copy the URL in the address bar and save that value.</p>

<p>Stop the API by pressing Ctrl-C at the terminal.<a data-type="indexterm" data-primary="Codespaces (GitHub)" data-secondary="terminal window" data-tertiary="Ctrl-C to stop API" id="id2722"/><a data-type="indexterm" data-primary="GitHub" data-secondary="Codespaces" data-tertiary="terminal window Ctrl-C to stop API" id="id2723"/><a data-type="indexterm" data-primary="Ctrl-C" data-secondary="to stop API in terminal" id="id2724"/><a data-type="indexterm" data-primary="terminal window of GitHub Codespace" data-secondary="Ctrl-C to stop API" id="id2725"/></p>
</div></section>






<section data-type="sect1" data-pdf-bookmark="Adding the Servers Section to Your OAS File"><div class="sect1" id="id220">
<h1>Adding the Servers Section to Your OAS File</h1>

<p>To update your OAS file, <a data-type="indexterm" data-primary="ChatGPT calling SWC API" data-secondary="servers section of OAS file added" id="id2726"/><a data-type="indexterm" data-primary="OpenAPI Specification (OAS) file" data-secondary="servers section added" id="id2727"/><a data-type="indexterm" data-primary="main.py" data-secondary="servers section added to OAS file" id="id2728"/>you need to update your FastAPI code. Open the <em>main.py</em> file and update the constructor so that it matches the following:</p>

<pre data-type="programlisting" data-code-language="python">app = FastAPI(
    description=api_description,
    title="Sports World Central (SWC) Fantasy Football API",
    version="0.2",
    servers=[
        {"url": "[your base URL from previous step]",
        "description": "Main server"} <a class="co" id="co_using_chatgpt_to_call_your_api_CO1-1" href="#callout_using_chatgpt_to_call_your_api_CO1-1"><img src="assets/1.png" alt="1" width="12" height="12"/></a>
    ]

)</pre>
<dl class="calloutlist">
<dt><a class="co" id="callout_using_chatgpt_to_call_your_api_CO1-1" href="#co_using_chatgpt_to_call_your_api_CO1-1"><img src="assets/1.png" alt="1" width="12" height="12"/></a></dt>
<dd><p>The value inside the quote marks should be the full public URL you copied in the previous step.</p></dd>
</dl>

<p>Adding this section in the code makes two changes that you can verify:</p>

<ul>
<li>
<p>The <code>Servers</code> section will be added to the OAS file.</p>
</li>
<li>
<p>The <code>Servers</code> section will be added to the API documentation (which is auto-generated from the OAS file).</p>
</li>
</ul>

<p>To verify these, start your API again from the Terminal:</p>

<pre data-type="programlisting" data-code-language="shell">.../api (main) $ fastapi run main.py</pre>

<p>Navigate to the API documentation by adding <em>/docs</em> to the URL. Below the General section, you should see a Servers select box as shown in <a data-type="xref" href="#servers_section_ch15">Figure 15-9</a>.</p>

<figure><div id="servers_section_ch15" class="figure">
<img src="assets/haad_1509.png" alt="Servers section added to API documentation" width="548" height="131"/>
<h6><span class="label">Figure 15-9. </span>Servers section added to API documentation</h6>
</div></figure>

<p class="less_space pagebreak-before">To view the OAS file, click the <em>openapi.json</em> link at the top of the documentation page. (You may need to add a browser extension to format the JSON for readability.) Below the <code>info</code> section of the OAS file, you should see a new <code>servers</code> section that looks like the following:</p>

<pre data-type="programlisting" data-code-language="json">"servers": [
    {
      "url": "[your base URL]",
      "description": "Main server"
    }
]</pre>

<p>Copy the full path of the OAS file from the browser, including <em>openapi.json</em>. You will use it in the next step.</p>
</div></section>






<section data-type="sect1" data-pdf-bookmark="Creating a GPT Action"><div class="sect1" id="id221">
<h1>Creating a GPT Action</h1>

<p>As shown in <a data-type="xref" href="#chatgpt_architecture_ch15">Figure 15-1</a>, your <a data-type="indexterm" data-primary="ChatGPT calling SWC API" data-secondary="GPT action created" id="id2729"/>custom GPT will contain a custom action inside it. This is the component that calls your API.</p>

<p>At the bottom of the Configure tab, click the “Create new action” button. The Add Actions page will be displayed. Leave the Authentication entry as None, because your API does not require authentication.</p>

<p>Click Import URL, and then paste the full address of your OAS file from the previous step. Your display should look like <a data-type="xref" href="#oas_file_import_ch15">Figure 15-10</a> at this point.</p>

<figure><div id="oas_file_import_ch15" class="figure">
<img src="assets/haad_1510.png" alt="Importing OAS file" width="1234" height="750"/>
<h6><span class="label">Figure 15-10. </span>Importing the OAS file</h6>
</div></figure>

<p class="less_space pagebreak-before">Click Import. The Schema section will be populated with the contents of your OAS file, as shown in <a data-type="xref" href="#oas_file_populated_ch15">Figure 15-11</a>.</p>

<figure><div id="oas_file_populated_ch15" class="figure">
<img src="assets/haad_1511.png" alt="OAS file populated" width="1246" height="1118"/>
<h6><span class="label">Figure 15-11. </span>OAS file populated</h6>
</div></figure>

<p>Scroll down below the text of the OAS file and you will see a list of available actions. <a data-type="xref" href="#available_actions_ch15">Figure 15-12</a> shows the top of this list.</p>

<figure><div id="available_actions_ch15" class="figure">
<img src="assets/haad_1512.png" alt="Available actions list" width="949" height="693"/>
<h6><span class="label">Figure 15-12. </span>Available actions list</h6>
</div></figure>
</div></section>






<section data-type="sect1" data-pdf-bookmark="Testing the APIs in Your GPT"><div class="sect1" id="id154">
<h1>Testing the APIs in Your GPT</h1>

<p>You will notice that the “Available actions” section<a data-type="indexterm" data-primary="ChatGPT calling SWC API" data-secondary="testing APIs in GPT" id="ch15tstapi"/><a data-type="indexterm" data-primary="endpoints of APIs" data-secondary="GPT restricted to subset" id="id2730"/><a data-type="indexterm" data-primary="API endpoints" data-secondary="GPT restricted to subset" id="id2731"/> lists all of the endpoints in your OAS file.  If you wanted to restrict the GPT to a subset of the endpoints in your API, you could manually edit this schema to remove any endpoints you did not want it to use. All of these endpoints are public read-only, so you will leave them in the schema.</p>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="id2732">
<h1>Contrasting ChatGPT with LangGraph</h1>
<p>This is a good time to contrast the<a data-type="indexterm" data-primary="ChatGPT calling SWC API" data-secondary="LangGraph versus" id="id2733"/><a data-type="indexterm" data-primary="LangGraph" data-secondary="ChatGPT versus" id="id2734"/> process of providing APIs to a custom GPT in this chapter and <a data-type="xref" href="ch14.html#create_lang_agent">“Creating a LangGraph Agent”</a>. Using LangGraph, you provided tools to the AI application by creating a toolkit with Python Code. Then, you gave that toolkit to a function-calling model to decide which functions to call. The model decided which function to use based on the description in the Python toolkit.</p>

<p>With the custom GPT in this chapter, you provided the OAS file, and the user interface added all of the <code>path</code> entries as possible tools. You have the option of removing any of those items that you did not want the custom GPT to use. Then the custom GPT decided which item to use based on the description in the OAS <code>path</code> object.</p>
</div></aside>

<p>To verify that the connection<a data-type="indexterm" data-primary="health check" data-secondary="ChatGPT calling SWC API" id="id2735"/> to your API is set up properly, click the Test button next to <em>v0_health_check</em>. Your GPT will call the API’s health check endpoint and give a status of the API, as shown in <a data-type="xref" href="#health_check_endpoint_test_ch15">Figure 15-13</a>.</p>

<figure><div id="health_check_endpoint_test_ch15" class="figure">
<img src="assets/haad_1513.png" alt="GPT calling health check endpoint" width="1656" height="635"/>
<h6><span class="label">Figure 15-13. </span>GPT calling health check endpoint</h6>
</div></figure>

<p>You are ready to add this action to your GPT. Click the Save button. The Share GPT dialog will be displayed as shown in <a data-type="xref" href="#gpt_sharing_options_ch15">Figure 15-14</a>.</p>

<figure><div id="gpt_sharing_options_ch15" class="figure">
<img src="assets/haad_1514.png" alt="Share GPT dialog" width="859" height="368"/>
<h6><span class="label">Figure 15-14. </span>Share GPT dialog</h6>
</div></figure>

<p>Select “Only me” to keep this GPT private. Click Save.</p>

<p>The Settings Saved dialog will be displayed with a direct link to the GPT. You do not need to use the link at this time. Click View GPT.<a data-type="indexterm" data-startref="ch15tstapi" id="id2736"/></p>
</div></section>






<section data-type="sect1" data-pdf-bookmark="Chatting with Your Custom GPT"><div class="sect1" id="id155">
<h1>Chatting with Your Custom GPT</h1>

<p>Now that you have created<a data-type="indexterm" data-primary="ChatGPT calling SWC API" data-secondary="chatting with custom GPT" id="ch15chat"/><a data-type="indexterm" data-primary="chatting with custom GPT" id="ch15chat2"/> a custom GPT, you will see it displayed in the navigation sidebar beneath ChatGPT. As shown in <a data-type="xref" href="#chatgpt_architecture_ch15">Figure 15-1</a>, your GPT is a separate application from ChatGPT. Now your GPT has the ability to access the SWC Fantasy Football API to get information.</p>

<p>Select the SWC Fantasy Football Advisor in the navigation. The display should look like <a data-type="xref" href="#swc_fantasy_advisor_ch15">Figure 15-15</a>.</p>

<figure><div id="swc_fantasy_advisor_ch15" class="figure">
<img src="assets/haad_1515.png" alt="Fantasy advisor ready to chat" width="905" height="644"/>
<h6><span class="label">Figure 15-15. </span>Fantasy Football advisor ready to chat</h6>
</div></figure>
<div data-type="warning" epub:type="warning"><h6>Warning</h6>
<p>Don’t miss the note at the bottom<a data-type="indexterm" data-primary="ChatGPT calling SWC API" data-secondary="mistakes by ChatGPT" id="id2737"/> of this page: “ChatGPT can make mistakes. Check important info.” It bears repeating that conversations with GPTs are impressive and quite convincing, but OpenAI is transparent that LLMs can provide unreliable information and hallucinate in their responses.</p>

<p>Some developers have found that GPTs <a href="https://oreil.ly/Pncx5">struggle to process statistics accurately for APIs that return large amounts of data</a>. For fantasy sports, the stakes are fairly low. But if your usage expands to tasks where accuracy is more important, don’t overlook the warnings that OpenAI is clearly publishing.</p>
</div>

<p>Start your conversation by repeating the question you asked before: <strong><code>What are the specific league names from the SportsWorldCentral Fantasy Football <span class="keep-together">platform?</span></code></strong></p>

<p>The GPT will state that it wants permission to call your API. Click Always Allow.</p>

<p>The GPT will state that it talked to your API. It also will show that it found the <code>limit</code> parameter and used a value of 10 to limit the number of results.</p>

<p>Then, it will answer the questions using the information returned from your API, as shown in <a data-type="xref" href="#api_call_results_ch15">Figure 15-16</a>. It has overcome the knowledge gap by accessing data from your API.</p>

<figure><div id="api_call_results_ch15" class="figure">
<img src="assets/haad_1516.png" alt="Results from API call" width="1544" height="847"/>
<h6><span class="label">Figure 15-16. </span>Results from API call</h6>
</div></figure>

<p>To see the API calls that the GPT made, look at the Terminal output in your Codespace. You will see the API calls made:</p>

<pre data-type="programlisting" data-code-language="shell">INFO:     10.240.2.131:0 - "GET / HTTP/1.1" 200 OK <a class="co" id="co_using_chatgpt_to_call_your_api_CO2-1" href="#callout_using_chatgpt_to_call_your_api_CO2-1"><img src="assets/1.png" alt="1" width="12" height="12"/></a>
INFO:     10.240.4.161:0 - "GET /v0/leagues/?skip=0&amp;limit=100 HTTP/1.1" 200 OK <a class="co" id="co_using_chatgpt_to_call_your_api_CO2-2" href="#callout_using_chatgpt_to_call_your_api_CO2-2"><img src="assets/2.png" alt="2" width="12" height="12"/></a></pre>
<dl class="calloutlist">
<dt><a class="co" id="callout_using_chatgpt_to_call_your_api_CO2-1" href="#co_using_chatgpt_to_call_your_api_CO2-1"><img src="assets/1.png" alt="1" width="12" height="12"/></a></dt>
<dd><p>This is a call to the health check endpoint.<a data-type="indexterm" data-primary="health check" data-secondary="ChatGPT calling SWC API" id="id2738"/></p></dd>
<dt><a class="co" id="callout_using_chatgpt_to_call_your_api_CO2-2" href="#co_using_chatgpt_to_call_your_api_CO2-2"><img src="assets/2.png" alt="2" width="12" height="12"/></a></dt>
<dd><p>This is a call to the get leagues endpoint.</p></dd>
</dl>

<p>In this case, the custom GPT made the right choices: it used the health check endpoint to make sure the API was available, and it used the get leagues endpoint to see available SWC leagues.</p>

<p>Congratulations! You have created a custom GPT and provided it access to your API through a custom action.</p>

<p>Take time and experiment with questions that will encourage the agent to use more of your API endpoints. Look at the Terminal output to see the API calls that are generated. How can you influence which API it calls? How can you guide it to answer more difficult questions using the tools? How can you stump it?<a data-type="indexterm" data-startref="ch15chat" id="id2739"/><a data-type="indexterm" data-startref="ch15chat2" id="id2740"/></p>
</div></section>






<section data-type="sect1" data-pdf-bookmark="Completing Your Part III Portfolio Project"><div class="sect1" id="id222">
<h1>Completing Your Part III Portfolio Project</h1>

<p>You have reached the end of Part III,<a data-type="indexterm" data-primary="ChatGPT calling SWC API" data-secondary="Part III project completion" id="id2741"/> congratulations! As with Parts I and II, there is some housekeeping required to get the portfolio project ready to share. You’ll move the code out of the chapter folders and into functional folders, then update <em>README.md</em>.</p>

<p>Before you make these changes, you’ll save a copy of your files to a separate GitHub branch, named <em>learning-branch</em>, so that it’s still available if you want to continue working through the code.</p>

<p>Create the new branch from the command line as follows:<a data-type="indexterm" data-primary="Codespaces (GitHub)" data-secondary="Part III project ready to share" data-tertiary="creating new branch" id="id2742"/><a data-type="indexterm" data-primary="GitHub" data-secondary="Part III project ready to share" data-tertiary="creating new branch" id="id2743"/></p>

<pre data-type="programlisting" data-code-language="shell">.../ai-project/ (main) $ git checkout -b learning-branch <a class="co" id="co_using_chatgpt_to_call_your_api_CO3-1" href="#callout_using_chatgpt_to_call_your_api_CO3-1"><img src="assets/1.png" alt="1" width="12" height="12"/></a>
Switched to a new branch 'learning-branch'
.../ai-project/ (main) $ git push -u origin learning-branch <a class="co" id="co_using_chatgpt_to_call_your_api_CO3-2" href="#callout_using_chatgpt_to_call_your_api_CO3-2"><img src="assets/2.png" alt="2" width="12" height="12"/></a>
 * [new branch]      learning-branch -&gt; learning-branch
branch 'learning-branch' set up to track 'origin/learning-branch'.</pre>
<dl class="calloutlist">
<dt><a class="co" id="callout_using_chatgpt_to_call_your_api_CO3-1" href="#co_using_chatgpt_to_call_your_api_CO3-1"><img src="assets/1.png" alt="1" width="12" height="12"/></a></dt>
<dd><p>Create a new branch named <em>learning-branch</em> locally based on the <em>main</em> branch.</p></dd>
<dt><a class="co" id="callout_using_chatgpt_to_call_your_api_CO3-2" href="#co_using_chatgpt_to_call_your_api_CO3-2"><img src="assets/2.png" alt="2" width="12" height="12"/></a></dt>
<dd><p>Push this new branch to your remote repository on GitHub.com.</p></dd>
</dl>

<p>Next, you will make some changes to the directory structure. Enter the following commands:<a data-type="indexterm" data-primary="Codespaces (GitHub)" data-secondary="Part III project ready to share" data-tertiary="moving files" id="id2744"/><a data-type="indexterm" data-primary="GitHub" data-secondary="Part III project ready to share" data-tertiary="moving files" id="id2745"/></p>

<pre data-type="programlisting" data-code-language="shell">.../ai-project/ (learning-branch) $ git checkout main <a class="co" id="co_using_chatgpt_to_call_your_api_CO4-1" href="#callout_using_chatgpt_to_call_your_api_CO4-1"><img src="assets/1.png" alt="1" width="12" height="12"/></a>
Switched to branch 'main'
Your branch is up to date with 'origin/main'.
.../ai-project/ (main) $ rm -rf chapter13/complete
.../ai-project/ (main) $ rm -rf chapter14/complete
.../ai-project/ (main) $ mkdir model-training <a class="co" id="co_using_chatgpt_to_call_your_api_CO4-2" href="#callout_using_chatgpt_to_call_your_api_CO4-2"><img src="assets/2.png" alt="2" width="12" height="12"/></a>
.../ai-project/ (main) $ mv chapter13/* model-training <a class="co" id="co_using_chatgpt_to_call_your_api_CO4-3" href="#callout_using_chatgpt_to_call_your_api_CO4-3"><img src="assets/3.png" alt="3" width="12" height="12"/></a>
.../ai-project/ (main) $ mkdir langchain <a class="co" id="co_using_chatgpt_to_call_your_api_CO4-4" href="#callout_using_chatgpt_to_call_your_api_CO4-4"><img src="assets/4.png" alt="4" width="12" height="12"/></a>
.../ai-project/ (main) $ mv chapter14/* langchain <a class="co" id="co_using_chatgpt_to_call_your_api_CO4-5" href="#callout_using_chatgpt_to_call_your_api_CO4-5"><img src="assets/5.png" alt="5" width="12" height="12"/></a>
.../ai-project/ (main) $ rm -rf chapter13 <a class="co" id="co_using_chatgpt_to_call_your_api_CO4-6" href="#callout_using_chatgpt_to_call_your_api_CO4-6"><img src="assets/6.png" alt="6" width="12" height="12"/></a>
.../ai-project/ (main) $ rm -rf chapter14</pre>
<dl class="calloutlist">
<dt><a class="co" id="callout_using_chatgpt_to_call_your_api_CO4-1" href="#co_using_chatgpt_to_call_your_api_CO4-1"><img src="assets/1.png" alt="1" width="12" height="12"/></a></dt>
<dd><p>Switch your Codespace back to the <em>main</em> branch of your repository.</p></dd>
<dt><a class="co" id="callout_using_chatgpt_to_call_your_api_CO4-2" href="#co_using_chatgpt_to_call_your_api_CO4-2"><img src="assets/2.png" alt="2" width="12" height="12"/></a></dt>
<dd><p>Make a new directory for the files from Chapter 13.</p></dd>
<dt><a class="co" id="callout_using_chatgpt_to_call_your_api_CO4-3" href="#co_using_chatgpt_to_call_your_api_CO4-3"><img src="assets/3.png" alt="3" width="12" height="12"/></a></dt>
<dd><p>Move Chapter 13’s files to the new folder.</p></dd>
<dt><a class="co" id="callout_using_chatgpt_to_call_your_api_CO4-4" href="#co_using_chatgpt_to_call_your_api_CO4-4"><img src="assets/4.png" alt="4" width="12" height="12"/></a></dt>
<dd><p>Make a new directory for the files from Chapter 14.</p></dd>
<dt><a class="co" id="callout_using_chatgpt_to_call_your_api_CO4-5" href="#co_using_chatgpt_to_call_your_api_CO4-5"><img src="assets/5.png" alt="5" width="12" height="12"/></a></dt>
<dd><p>Move Chapter 14’s files to the new folder.</p></dd>
<dt><a class="co" id="callout_using_chatgpt_to_call_your_api_CO4-6" href="#co_using_chatgpt_to_call_your_api_CO4-6"><img src="assets/6.png" alt="6" width="12" height="12"/></a></dt>
<dd><p>Remove all the subdirectories and their files.</p></dd>
</dl>

<p>To see the directory structure of the completed project, run the following command:</p>

<pre data-type="programlisting" data-code-language="shell">.../ai-project (main) $ tree -d  --prune -I 'build|*.egg-info|__pycache__'
.
├── api
├── langchain
└── model-training

3 directories</pre>

<p>Now update the <em>README.md</em> file<a data-type="indexterm" data-primary="Codespaces (GitHub)" data-secondary="Part III project ready to share" data-tertiary="updating readme.md" id="id2746"/><a data-type="indexterm" data-primary="GitHub" data-secondary="Part III project ready to share" data-tertiary="updating readme.md" id="id2747"/> to showcase your work. Here is a start, and then you can add your own thoughts:<a data-type="indexterm" data-primary="readme.md file" data-secondary="updated for AI project" id="id2748"/></p>

<pre data-type="programlisting" data-code-language="markdown"># AI Portfolio Project
This repository contains program using industry-standard Python frameworks,
based on projects from the book _Hands-on APIs for AI and Data Science_
written by Ryan Day.</pre>

<p>Now commit these changes to GitHub, and your Part III portfolio project is ready to share with the world. Congratulations on completing your Part III capstone!</p>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="id2749">
<h1>Extending Your Portfolio Project</h1>
<p>Here are a few ways to continue to expand your knowledge of ChatGPT actions:<a data-type="indexterm" data-primary="ChatGPT calling SWC API" data-secondary="Part III portfolio project extended" id="id2750"/><a data-type="indexterm" data-primary="portfolio projects" data-secondary="ChatGPT project extended" id="id2751"/></p>

<ul>
<li>
<p>Use the GPT to call APIs with larger and more complicated datasets. Find instances where it fails or makes mistakes, to explore its limitations.</p>
</li>
<li>
<p>Use the GPT Builder to make updates to your custom GPT by asking it in advance and telling it to apply the recommended changes directly.</p>
</li>
<li>
<p>If you developed an alternative API in Part I of this book, you can follow the steps in this chapter to explore the data as you did for the SWC Fantasy Football API.</p>
</li>
<li>
<p>Create a model card or system card for your custom GPT and post in your project’s repository.</p>
</li>
<li>
<p>Find more ways to demonstrate your learning in this chapter and publish them on your portfolio site, such as capturing a video or writing a blog post.</p>
</li>
</ul>
</div></aside>
</div></section>






<section data-type="sect1" data-pdf-bookmark="Summary"><div class="sect1" id="id399">
<h1>Summary</h1>

<p>In this chapter, you used OpenAI’s ChatGPT to interact with your API:</p>

<ul>
<li>
<p>You created a custom GPT.</p>
</li>
<li>
<p>You created a custom action to give your GPT access to the SWC API.</p>
</li>
<li>
<p>You updated the contents of your Part III portfolio project.</p>
</li>
</ul>
</div></section>
</div></section></div>
</div>
</body></html>