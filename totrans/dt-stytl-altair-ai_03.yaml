- en: 3 Reviewing the basic concepts of Altair
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 3. 审查Altair的基本概念
- en: This chapter covers
  id: totrans-1
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 本章涵盖
- en: Vega and Vega-Lite
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Vega和Vega-Lite
- en: The basic components of an Altair chart
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Altair图表的基本组件
- en: A relevant case study
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个相关的案例研究
- en: 'It may, at first glance, seem counterintuitive for the topic of running a data
    story in Altair (chapter 2) to be covered before the basics of Altair (chapter
    3). The reason is that now that you have a general understanding of how Altair
    works, you’re ready to see all the details. If you had read this chapter right
    away, you probably would have gotten bored and skipped it. Instead, now, you are
    ready to read it calmly. In this chapter, we will review the basic concepts underlying
    Vega and Vega-Lite, the visualization grammars upon which Altair is built. Then,
    we’ll focus on the Altair main components: encodings, marks, conditions, compound
    charts, and interactivity. In the last part of the chapter, we’ll implement a
    practical example.'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 初看之下，似乎在介绍Altair（第2章）如何运行数据故事之前，先讲解Altair的基础知识（第3章）是不合常理的。原因在于，现在你对Altair的工作原理有了基本的了解，你就可以开始深入了解所有细节了。如果你一开始就读了这一章，你可能会感到无聊并跳过它。相反，现在，你已经准备好平静地阅读它了。在本章中，我们将回顾Vega和Vega-Lite的基本概念，这些是Altair所构建的可视化语法的基础。然后，我们将重点关注Altair的主要组件：编码、标记、条件、复合图表和交互性。在章节的最后部分，我们将实现一个实际案例。
- en: 3.1 Vega and Vega-Lite
  id: totrans-6
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 3.1 Vega和Vega-Lite
- en: Vega and Vega-Lite are visualization grammars used by Altair. A *visualization
    grammar* is a set of rules and principles defining how to represent data visually,
    much like how grammar functions in a spoken language. A visualization grammar
    includes a vocabulary of visual elements, such as points, lines, and bars, as
    well as rules for combining and arranging these elements to create meaningful
    visualizations. Using a visualization grammar allows you to create clear and effective
    data visualizations that convey insights and tell stories.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: Vega和Vega-Lite是Altair使用的可视化语法。*可视化语法*是一套规则和原则，用于定义如何以视觉方式表示数据，就像语法在口语中的作用一样。可视化语法包括一系列视觉元素，如点、线和条形，以及组合和排列这些元素以创建有意义的可视化规则。使用可视化语法可以使你创建清晰有效的数据可视化，传达洞察力并讲述故事。
- en: Vega and Vega-Lite provide declarative language for creating interactive visualizations.
    Learning Vega and Vega-Lite before Altair is important because Altair is built
    on top of these two visualization libraries. By first mastering these foundational
    tools, you can gain a deeper understanding of how Altair works and take advantage
    of its full potential. Additionally, learning Vega and Vega-Lite enables you to
    create custom visualizations that may not be possible with Altair alone, allowing
    for more flexibility and creativity in data exploration and communication. In
    the following section, we’ll explore the main components of a Vega and Vega-Lite
    specification.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: Vega和Vega-Lite提供了创建交互式可视化的声明性语言。在学习Altair之前先学习Vega和Vega-Lite非常重要，因为Altair是建立在这两个可视化库之上的。通过首先掌握这些基础工具，你可以更深入地理解Altair的工作原理，并充分利用其全部潜力。此外，学习Vega和Vega-Lite还使你能够创建仅使用Altair无法实现的自定义可视化，从而在数据探索和沟通中提供更多的灵活性和创造力。在下一节中，我们将探讨Vega和Vega-Lite规范的主要组件。
- en: 3.1.1 Vega
  id: totrans-9
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 3.1.1 Vega
- en: '*Vega* is a visualization grammar used to define the visual aspects and interactive
    features of a chart by writing code in JSON format. Vega is built at the top of
    D3.js ([https://d3js.org/](https://d3js.org/)), a very popular JavaScript library
    for data visualization. Using Vega, you can generate web-based views that utilize
    HTML5 Canvas or SVG to display the resulting chart. HTML5 Canvas is a bitmap-based
    drawing technology that enables you to render dynamic graphics and animations
    on the web. SVG is a vector-based graphics format for building scalable and resolution-independent
    graphics.'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: '*Vega*是一种通过在JSON格式中编写代码来定义图表的视觉方面和交互功能的可视化语法。Vega建立在D3.js（[https://d3js.org/](https://d3js.org/)）之上，这是一个非常流行的JavaScript库，用于数据可视化。使用Vega，你可以生成基于Web的视图，利用HTML5
    Canvas或SVG来显示生成的图表。HTML5 Canvas是一种基于位图的绘图技术，它使你能够在Web上渲染动态图形和动画。SVG是一种基于矢量的图形格式，用于构建可缩放和分辨率无关的图形。'
- en: A Vega JSON file contains the specifications for the visual appearance and interactive
    behavior of a chart. Listing 3.1 shows the basic structure of a JSON specification.
    For testing, you can use the Vega Editor ([https://vega.github.io/editor/#/](https://vega.github.io/editor/#/))
    to render the chart produced by Vega. We will produce a basic Vega line chart
    gradually, throughout this section.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: Vega JSON 文件包含图表视觉外观和交互行为的规范。列表 3.1 展示了 JSON 规范的基本结构。为了测试，您可以使用 Vega 编辑器（[https://vega.github.io/editor/#/](https://vega.github.io/editor/#/))
    来渲染 Vega 生成的图表。在本节中，我们将逐步生成一个基本的 Vega 线形图表。
- en: Listing 3.1 The basic structure of a Vega JSON file
  id: totrans-12
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表 3.1 Vega JSON 文件的基本结构
- en: '[PRE0]'
  id: totrans-13
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: Note  First, define the version of the schema (`$schema`), a `description`,
    the `width`, and the `height` of the chart. Then, specify the main sections (`signals`,
    `data`, and so on). Listing 3.1 shows only the structure of a Vega JSON file and
    will not produce any chart if pasted in the Vega Editor.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 注意：首先，定义模式版本（`$schema`）、`description`、图表的 `width` 和 `height`。然后，指定主要部分（`signals`、`data`
    等）。列表 3.1 仅显示 Vega JSON 文件的结构，如果粘贴到 Vega 编辑器中，则不会生成任何图表。
- en: The main sections of a Vega JSON file include `data`, `scales`, `axes`, `marks`,
    and `signals`. In the remainder of this section, we’ll describe an overview of
    the main sections of a Vega specification. For more details, please refer to the
    Vega official documentation. ([https://vega.github.io/vega/docs/](https://vega.github.io/vega/docs/)).
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: Vega JSON 文件的主要部分包括 `data`、`scales`、`axes`、`marks` 和 `signals`。在本节的剩余部分，我们将描述
    Vega 规范的主要部分的概述。有关更多详细信息，请参阅 Vega 官方文档。([https://vega.github.io/vega/docs/](https://vega.github.io/vega/docs/))。
- en: data
  id: totrans-16
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 数据
- en: This section defines the data source to use. It specifies the data format, where
    the data is located, and how it should be loaded and transformed. The following
    listing shows an example of a `data` section.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 本节定义了要使用的数据源。它指定了数据格式、数据所在位置以及如何加载和转换数据。以下列表展示了 `data` 部分的示例。
- en: Listing 3.2 An example `data` section
  id: totrans-18
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表 3.2 `data` 部分的示例
- en: '[PRE1]'
  id: totrans-19
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'Note  Specify the list of data to use in the visualization. For each element
    of data, specify the name and content. We will use `myData` to refer to the associated
    data in the specification. We can specify more than one data source. The example
    specifies data values directly. However, you can also retrieve the data from a
    CSV file, by specifying the URL and the format as follows: `"url":` `"/path/to/csv/myfile.csv",`
    `format":` `{"type":` `"csv"}.` Alternatively, you can retrieve data from other
    formats or embed them in the JSON directly.'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: '注意：指定用于可视化的数据列表。对于数据中的每个元素，指定名称和内容。我们将使用 `myData` 来引用规范中相关的数据。可以指定多个数据源。示例直接指定数据值。然而，您也可以通过指定
    URL 和格式从 CSV 文件中检索数据，如下所示：`"url": "/path/to/csv/myfile.csv", "format": {"type":
    "csv"}`。或者，您可以从其他格式检索数据或将它们直接嵌入 JSON 中。'
- en: scales
  id: totrans-21
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 刻度
- en: This section defines the scales that map the data to visual properties. Scales
    map a data domain (input range) to a visual range (output range). The following
    listing shows an example of a `scales` section.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 本节定义了将数据映射到视觉属性的刻度。刻度将数据域（输入范围）映射到视觉范围（输出范围）。以下列表展示了 `scales` 部分的示例。
- en: Listing 3.3 An example `scales` section
  id: totrans-23
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表 3.3 `scales` 部分的示例
- en: '[PRE2]'
  id: totrans-24
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Note  Specify the list of `scales` to use in the visualization. For each scale,
    specify at least the name, range, and domain. The example defines two scales,
    one for the x-axis and the other for the y-axis. Specify the data to use as the
    value of the domain attribute.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 注意：指定用于可视化的 `scales` 列表。对于每个刻度，指定至少名称、范围和域。示例定义了两个刻度，一个用于 x 轴，另一个用于 y 轴。指定作为域属性值的要使用的数据。
- en: axes
  id: totrans-26
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 轴
- en: This section defines the axes of the chart. Use `axes` to define tick marks
    and labels along an axis. The following listing shows an example of an `axes`
    section.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 本节定义了图表的轴。使用 `axes` 定义轴上的刻度和标签。以下列表展示了 `axes` 部分的示例。
- en: Listing 3.4 An example `axes` section
  id: totrans-28
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表 3.4 `axes` 部分的示例
- en: '[PRE3]'
  id: totrans-29
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: Note  Specify the list of `axes` to use in the visualization. For each axis,
    specify at least the scale and how to orient it. The example defines two axes,
    one for the x-axis and the other for the y-axis.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 注意：指定用于可视化的 `axes` 列表。对于每个轴，指定至少刻度和如何定位它。示例定义了两个轴，一个用于 x 轴，另一个用于 y 轴。
- en: marks
  id: totrans-31
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 标记
- en: This section defines the visual `marks` that represent the data. Marks include
    points, lines, rectangles, areas, and other shapes. Use visual properties, like
    size, color, opacity, and shape, to style marks. The following listing shows an
    example of a `marks` section.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 本节定义了表示数据的视觉 `marks`。标记包括点、线、矩形、区域和其他形状。使用视觉属性，如大小、颜色、不透明度和形状，来设置标记样式。以下列表显示了一个
    `marks` 部分的示例。
- en: Listing 3.5 An example `marks` section
  id: totrans-33
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表 3.5 `marks` 示例部分
- en: '[PRE4]'
  id: totrans-34
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: Note  Specify the list of `marks` to use in the visualization. For each `mark`,
    specify at least the `type` (line, symbol, rect, and so on), the source of data
    (`from`), and how to encode the data (`encode`). Use the `enter` block to define
    the initial properties of the visualization. The example defines a line chart
    representing data contained in the `myData` variable defined in the `data` section.
    It also defines two encoding channels, `x` and `y`, and the color of the line
    stroke.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 注意：指定在可视化中使用的 `marks` 列表。对于每个 `mark`，指定至少 `type`（线、符号、矩形等）、数据源（`from`）以及如何编码数据（`encode`）。使用
    `enter` 块定义可视化的初始属性。示例定义了一个表示 `data` 部分中 `myData` 变量包含的数据的折线图。它还定义了两个编码通道 `x`
    和 `y`，以及线条的颜色。
- en: signals
  id: totrans-36
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 信号
- en: 'This section defines the interactive signals you can use to modify the visualization,
    such as sliders, dropdowns, and check boxes. Every signal is composed of two parts:
    the *listener*, which is identified by the `signals` section, and the *handler*,
    which is defined by the keyword `signal` within the `marks` section. The signal
    listener responds to signal changes, and the signal handler determines how the
    visualization reacts. For example, a signal handler might change the color or
    size of data points based on a signal’s value. The following listing provides
    an example that changes the color of a selected element in a chart when the user
    hovers over the bar with the mouse (figure 3.1).'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 本节定义了可以用来修改可视化的交互式信号，例如滑块、下拉菜单和复选框。每个信号由两部分组成：*监听器*，由 `signals` 部分标识，和*处理器*，由
    `marks` 部分的 `signal` 关键字定义。信号监听器响应信号变化，而信号处理器确定可视化如何响应。例如，信号处理器可能会根据信号值更改数据点的颜色或大小。以下列表提供了一个示例，当用户将鼠标悬停在条形上时（图
    3.1），它会更改图表中选定元素的颜色。
- en: Listing 3.6 An example `signals` section
  id: totrans-38
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表 3.6 信号示例部分
- en: '[PRE5]'
  id: totrans-39
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: Note  `signals` are used to capture events or changes in the visualization.
    For each signal, specify its name (`changeColor`, in the example), the property
    to modify (`value`, in the example), and the list of events to listen (`on`, in
    the example).
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 注意：`signals` 用于捕获可视化中的事件或变化。对于每个信号，指定其名称（例如示例中的 `changeColor`），要修改的属性（例如示例中的
    `value`），以及要监听的事件列表（例如示例中的 `on`）。
- en: To use the signal, you must specify an `update` block within your `mark` section.
    Rememember that you used the `enter` block to specify the initial condition of
    the chart. Now, you can use the `update` block to specify a change. The following
    listing specifies a change in the line color.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 要使用信号，您必须在 `mark` 部分中指定一个 `update` 块。记住，您使用了 `enter` 块来指定图表的初始条件。现在，您可以使用 `update`
    块来指定一个更改。以下列表指定了线条颜色的更改。
- en: Listing 3.7 An example `update` section
  id: totrans-42
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表 3.7 更新示例部分
- en: '[PRE6]'
  id: totrans-43
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: Note  Under the `marks` section, specify a handler associated with the signal.
    This handler will be triggered when the specified event (like mouseover) associated
    with the signal occurs. Within the `update` property of the `marks` section, a
    handler is defined. This handler checks whether the signal corresponds to the
    mouseover event (e.g., `changeColor` `===` `datum`). If the condition is met (i.e.,
    if the mouse is over the line), the handler performs an action, such as changing
    the color of the line accordingly. Refer to the Vega documentation ([https://vega.github.io/vega/docs/signals/](https://vega.github.io/vega/docs/signals/))
    for more details.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 注意：在 `marks` 部分下，指定与信号关联的处理程序。当与信号关联的指定事件（如鼠标悬停）发生时，将触发此处理程序。在 `marks` 部分的 `update`
    属性中定义了一个处理程序。此处理程序检查信号是否对应于鼠标悬停事件（例如，`changeColor` `===` `datum`）。如果条件满足（即鼠标位于线上），则处理程序执行操作，例如相应地更改线条颜色。有关更多详细信息，请参阅
    Vega 文档（[https://vega.github.io/vega/docs/signals/](https://vega.github.io/vega/docs/signals/))。
- en: Figure 3.1 shows the resulting line chart. You can find the complete example
    in the book’s GitHub repository under 03/vega/json/line-chart.json.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 图 3.1 展示了生成的折线图。您可以在书籍的 GitHub 仓库 03/vega/json/line-chart.json 下找到完整的示例。
- en: '![figure](../Images/3-1.png)'
  id: totrans-46
  prefs: []
  type: TYPE_IMG
  zh: '![图](../Images/3-1.png)'
- en: Figure 3.1 The line chart written in Vega
  id: totrans-47
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图 3.1 使用 Vega 编写的折线图
- en: Exercise 1
  id: totrans-48
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 练习 1
- en: 'Draw a line chart in Vega as follows:'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 按照以下方式在 Vega 中绘制折线图：
- en: 'Load data from the following URL: [https://mng.bz/ZEyZ](https://mng.bz/ZEyZ).'
  id: totrans-50
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从以下 URL 加载数据：[https://mng.bz/ZEyZ](https://mng.bz/ZEyZ)。
- en: Add points to the line. To do this, add a new mark (in addition to the line),
    using `symbol` as a type.
  id: totrans-51
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在线上添加点。为此，添加一个新的标记（除了线之外），使用 `symbol` 作为类型。
- en: You can find the solution to this exercise in the GitHub repository for the
    book under 03/vega/json/spec.json.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以在书籍的 GitHub 仓库中找到这个练习的解决方案，位于 03/vega/json/spec.json。
- en: Exercise 2
  id: totrans-53
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 练习 2
- en: 'Draw a bar chart in Vega as follows:'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 按照以下方式在 Vega 中绘制柱状图：
- en: 'Load data from the following URL: [https://mng.bz/Ad6W](https://mng.bz/Ad6W).'
  id: totrans-55
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从以下 URL 加载数据：[https://mng.bz/Ad6W](https://mng.bz/Ad6W)。
- en: Use `band` as the type for the `X` scale.
  id: totrans-56
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将 `band` 作为 `X` 尺度的类型。
- en: Use `rect` as the `mark` type.
  id: totrans-57
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用 `rect` 作为 `mark` 类型。
- en: Optionally, set a signal that changes the bar color while hovering over it with
    the mouse.
  id: totrans-58
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 可选地，设置一个在鼠标悬停时改变条形图颜色的信号。
- en: 'You can find the solution to this exercise in the book’s GitHub repository
    under 03/vega/json/spec2.json. Now that you have learned the basic concepts behind
    Vega, let’s move to the next step: Vega-Lite.'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以在书籍的 GitHub 仓库中找到这个练习的解决方案，位于 03/vega/json/spec2.json。现在您已经了解了 Vega 的基本概念，让我们继续下一步：Vega-Lite。
- en: 3.1.2 Vega-Lite
  id: totrans-60
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 3.1.2 Vega-Lite
- en: '*Vega-Lite* is a concise JSON of a Vega visualization. Vega-Lite still maintains
    the specifications already defined in Vega, but it represents them through a more
    compact syntax. Compared to Vega, Vega-Lite offers a more streamlined and concise
    syntax, ideal for quickly generating simple visualizations with less code complexity,
    making it more accessible to users seeking rapid creation of common charts. While
    Vega-Lite provides a high-level abstraction for creating visualizations, it may
    lack the flexibility to customize every aspect of visualization. It may also perform
    worse than Vega. The basic sections of a Vega-Lite JSON specification are `data`,
    `encoding`, `mark`, and `layer`.'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: '*Vega-Lite* 是 Vega 可视化的简洁 JSON。Vega-Lite 仍然保留了 Vega 中已定义的规范，但它通过更紧凑的语法来表示。与
    Vega 相比，Vega-Lite 提供了更简洁的语法，适合快速生成简单可视化，代码复杂度更低，使得它对寻求快速创建常见图表的用户更加易于使用。虽然 Vega-Lite
    为创建可视化提供了高级抽象，但它可能缺乏定制可视化每个方面的灵活性。它可能也比 Vega 的性能差。Vega-Lite JSON 规范的基本部分是 `data`、`encoding`、`mark`
    和 `layer`。'
- en: data
  id: totrans-62
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: data
- en: This section specifies the data source for the visualization. The following
    listing provides an example of a `data` section in Vega-Lite.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 本节指定了可视化的数据源。以下列表提供了 Vega-Lite 中 `data` 部分的示例。
- en: Listing 3.8 An example `data` section
  id: totrans-64
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表 3.8 一个 `data` 部分的示例
- en: '[PRE7]'
  id: totrans-65
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: Note  This specifies the data to use in the visualization. Refer to the Vega-Lite
    documentation ([https://vega.github.io/vega-lite/docs/data.xhtml](https://vega.github.io/vega-lite/docs/data.xhtml))
    for more details.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 注意：这指定了在可视化中使用的源数据。有关更多详细信息，请参阅 Vega-Lite 文档（[https://vega.github.io/vega-lite/docs/data.xhtml](https://vega.github.io/vega-lite/docs/data.xhtml)）。
- en: encoding
  id: totrans-67
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: encoding
- en: This section maps the data fields to visual properties, such as position, color,
    and size. The following listing shows an example of an `encoding` section in Vega-Lite.
    Use the Vega Editor to test your code in Vega-Lite, ensuring you select Vega-Lite
    from the top-left drop-down menu.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 本节将数据字段映射到视觉属性，例如位置、颜色和大小。以下列表展示了 Vega-Lite 中 `encoding` 部分的示例。使用 Vega 编辑器在
    Vega-Lite 中测试您的代码，确保您从左上角的下拉菜单中选择 Vega-Lite。
- en: Listing 3.9 An example `encoding` section
  id: totrans-69
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表 3.9 一个 `encoding` 部分的示例
- en: '[PRE8]'
  id: totrans-70
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: Note  Specify the encodings to use in the visualization. The example defines
    two channels, `x` and `y`, and specifies the data type as `quantitative`. Vega
    and Vega-Lite also support other data types, such as `ordinal`, for sequential
    data; `nominal`, for text; and `time`, for temporal data.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 注意：指定在可视化中使用的编码。示例定义了两个通道，`x` 和 `y`，并指定数据类型为 `quantitative`。Vega 和 Vega-Lite
    还支持其他数据类型，例如 `ordinal` 用于顺序数据；`nominal` 用于文本；以及 `time` 用于时间数据。
- en: mark
  id: totrans-72
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: mark
- en: This section defines the type of visual mark, such as `bars`, `points`, or `lines`.
    The following listing shows an example of a `mark` section in Vega-Lite.
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 本节定义了视觉标记的类型，例如 `bars`、`points` 或 `lines`。以下列表展示了 Vega-Lite 中 `mark` 部分的示例。
- en: Listing 3.10 An example `mark` section
  id: totrans-74
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表 3.10 一个 `mark` 部分的示例
- en: '[PRE9]'
  id: totrans-75
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: Note  Specify the `mark` to use in the visualization. The example defines a
    line chart.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 注意：指定在可视化中使用的 `mark`。示例定义了一个折线图。
- en: layer
  id: totrans-77
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: layer
- en: This section combines multiple marks in a single chart. The next listing shows
    an example of a `layer` section in Vega-Lite.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 本节在一个图表中组合多个标记。下一个列表展示了 Vega-Lite 中 `layer` 部分的示例。
- en: Listing 3.11 An example `layer` section
  id: totrans-79
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表 3.11 一个示例 `layer` 部分
- en: '[PRE10]'
  id: totrans-80
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'Note  Specify the list of marks to combine. This combines two charts: a line
    chart and a point chart.'
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 注意：指定要组合的标记列表。这组合了两个图表：一个折线图和一个点图。
- en: Interactivity
  id: totrans-82
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 交互性
- en: Vega-Lite simplifies the way of managing signals by using `params`. Instead
    of defining a signal, you define a `param`.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: Vega-Lite 通过使用 `params` 简化了管理信号的方式。你不需要定义一个信号，而是定义一个 `param`。
- en: Listing 3.12 How to specify `params` in Vega-Lite
  id: totrans-84
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表 3.12 如何在 Vega-Lite 中指定 `params`
- en: '[PRE11]'
  id: totrans-85
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: Note  Specify the name of each signal using the `params` keyword. For each `param`,
    specify the name and how to trigger it. The type can be set to `point`, to select
    a single point in the chart or interval.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 注意：使用 `params` 关键字指定每个信号的名字。对于每个 `param`，指定名字和如何触发它。类型可以设置为 `point`，以在图表或区间中选择一个单独的点。
- en: After defining the `params`, you can use them in the marks, as specified in
    the following listing. You can find the complete example in the GitHub repository
    for the book under 03/vega-lite/json/line-chart.json.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 在定义了 `params` 之后，你可以在标记中使用它们，如以下列表中指定。你可以在本书的 GitHub 仓库 03/vega-lite/json/line-chart.json
    下找到完整的示例。
- en: Listing 3.13 How to use `params` in a `mark` in Vega-Lite
  id: totrans-88
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表 3.13 在 Vega-Lite 中如何使用 `params` 在 `mark` 中
- en: '[PRE12]'
  id: totrans-89
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: Note  The example in listing 3.13 uses the `params` defined in listing 3.12
    to set the stroke color based on a condition. If the `changeColor` `param` is
    triggered, then the color line is set to `red`; if the `default` `param` is triggered,
    then the color line is set to `blue`. The default stroke color is `blue`.
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 注意：列表 3.13 中的示例使用列表 3.12 中定义的 `params` 来根据条件设置线条颜色。如果触发 `changeColor` `param`，则线条颜色设置为
    `red`；如果触发 `default` `param`，则线条颜色设置为 `blue`。默认线条颜色是 `blue`。
- en: Exercise 3
  id: totrans-91
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 练习 3
- en: Convert the result of exercise 1 into Vega-Lite. The solution to the exercise
    is provided in the book’s GitHub repository under 03/vega-lite/json/spec.json.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 将练习 1 的结果转换为 Vega-Lite。该练习的解决方案在本书的 GitHub 仓库的 03/vega-lite/json/spec.json 下提供。
- en: Now that you have learned the basic concepts behind Vega and Vega-Lite, let’s
    see how to render a Vega/Vega-Lite visualization using HTML and JavaScript. If
    you are unfamiliar with HTML and JavaScript, you can skip the next section and
    move on to section 3.2.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 现在你已经了解了 Vega 和 Vega-Lite 的基本概念，让我们看看如何使用 HTML 和 JavaScript 渲染 Vega/Vega-Lite
    可视化。如果你不熟悉 HTML 和 JavaScript，你可以跳过下一节，直接进入 3.2 节。
- en: 3.1.3 How to render a Vega or Vega-Lite visualization
  id: totrans-94
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 3.1.3 如何渲染 Vega 或 Vega-Lite 可视化
- en: Both Vega and Vega-Lite are JSON objects that need a renderer to be shown, such
    as an external JavaScript library, to render the visualization from an HTML page.
    Vega-Lite provides a JavaScript API that automatically builds both Vega and Vega-Lite
    visualizations.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: Vega 和 Vega-Lite 都是 JSON 对象，需要渲染器才能显示，例如外部 JavaScript 库，以便从 HTML 页面渲染可视化。Vega-Lite
    提供了一个 JavaScript API，可以自动构建 Vega 和 Vega-Lite 可视化。
- en: 'To render a Vega or Vega-Lite JSON, import the following JavaScript libraries
    into your HTML file:'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 要渲染 Vega 或 Vega-Lite JSON，请将以下 JavaScript 库导入到你的 HTML 文件中：
- en: '[https://cdn.jsdelivr.net/npm/vega@5.22.1](https://cdn.jsdelivr.net/npm/vega@5.22.1)'
  id: totrans-97
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[https://cdn.jsdelivr.net/npm/vega@5.22.1](https://cdn.jsdelivr.net/npm/vega@5.22.1)'
- en: '[https://cdn.jsdelivr.net/npm/vega-lite@5.6.0](https://cdn.jsdelivr.net/npm/vega-lite@5.6.0)'
  id: totrans-98
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[https://cdn.jsdelivr.net/npm/vega-lite@5.6.0](https://cdn.jsdelivr.net/npm/vega-lite@5.6.0)'
- en: '[https://cdn.jsdelivr.net/npm/vega-embed@6.21.0](https://cdn.jsdelivr.net/npm/vega-embed@6.21.0)'
  id: totrans-99
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[https://cdn.jsdelivr.net/npm/vega-embed@6.21.0](https://cdn.jsdelivr.net/npm/vega-embed@6.21.0)'
- en: The library versions may vary. In our case, we import version 5.22.1 for Vega,
    5.6.0 for Vega-Lite, and 6.21.0 for Vega-Embed, as we usually do to import JavaScript
    libraries. Then, you can wrap the code described in listing 3.11 to render your
    Vega/Vega-Lite JSON file.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 库的版本可能不同。在我们的例子中，我们导入 Vega 的 5.22.1 版本，Vega-Lite 的 5.6.0 版本，以及 Vega-Embed 的
    6.21.0 版本，就像我们通常导入 JavaScript 库一样。然后，你可以将列表 3.11 中描述的代码包装起来，以渲染你的 Vega/Vega-Lite
    JSON 文件。
- en: The JavaScript code to render a Vega or Vega-Lite JSON specification
  id: totrans-101
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 渲染 Vega 或 Vega-Lite JSON 规范的 JavaScript 代码
- en: For example, to render the chart described in listing 3.7, use the following
    HTML specification.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，要渲染列表 3.7 中描述的图表，请使用以下 HTML 规范。
- en: Listing 3.14 The complete HTML file
  id: totrans-103
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表 3.14 完整的 HTML 文件
- en: '[PRE13]'
  id: totrans-104
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: '#1 Imports Vega and Vega-Lite libraries'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: '#1 导入 Vega 和 Vega-Lite 库'
- en: '#2 Creates a div to contain the chart'
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: '#2 创建一个 div 来包含图表'
- en: '#3 Builds the chart'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: '#3 构建图表'
- en: Note  First, import the Vega and Vega-Lite libraries in the header section.
    Then, create a `div` that will contain the chart. Finally, build the chart. Use
    an external JSON file to define the chart specifications. In the `script` body,
    specify the JavaScript code to import your Vega JSON file. Open a new `XMLHttpRequest()`
    to load the JSON file, and then use the `vegaEmbed()` function to render the JSON.
    Note that you must provide a valid external URL to the request object. You can’t
    use a local JSON file.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 注意：首先，在头部部分导入 Vega 和 Vega-Lite 库。然后，创建一个将包含图表的 `div`。最后，构建图表。使用外部 JSON 文件来定义图表规范。在
    `script` 主体中，指定导入您的 Vega JSON 文件的 JavaScript 代码。打开一个新的 `XMLHttpRequest()` 来加载
    JSON 文件，然后使用 `vegaEmbed()` 函数来渲染 JSON。请注意，您必须向请求对象提供一个有效的外部 URL。您不能使用本地 JSON 文件。
- en: 'You can find the complete example and other examples in the book’s GitHub repository,
    section 03/vega ([https://mng.bz/x2NB](https://mng.bz/x2NB)) and 03/vega-lite
    ([https://mng.bz/Vxj5](https://mng.bz/Vxj5)). Now that you have learned the basic
    concepts underlying Vega and Vega-Lite, let’s move to the next topic: the basic
    components of an Altair chart.'
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以在本书 GitHub 仓库的 03/vega ([https://mng.bz/x2NB](https://mng.bz/x2NB)) 和 03/vega-lite
    ([https://mng.bz/Vxj5](https://mng.bz/Vxj5)) 部分找到完整的示例和其他示例。现在您已经了解了 Vega 和 Vega-Lite
    的基本概念，让我们转向下一个主题：Altair 图表的基本组件。
- en: 3.2 The basic components of an Altair chart
  id: totrans-110
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 3.2 Altair 图表的基本组件
- en: In this book, we mostly use the *just-in-time teaching* methodology, which combines
    theory and practice to teach concepts at the exact moment you need them. However,
    in this chapter, we will not use this methodology. This is because we want to
    establish a strong foundation of fundamental concepts about Altair before diving
    into the more advanced topics covered later in the book. By deviating from the
    just-in-time teaching methodology for this chapter, we can provide a comprehensive
    overview and in-depth understanding of the underlying principles that will serve
    as building blocks for the subsequent material. Altair is built on top of Vega-Lite
    and offers a user-friendly API to build charts. You learned how to build a basic
    chart in Altair in chapter 2, and in this chapter, we’ll dive deep into the basic
    components of an Altair chart.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 在本书中，我们主要使用 *即时教学* 方法论，该方法将理论与实际相结合，在您需要时立即教授概念。然而，在本章中，我们将不使用这种方法。这是因为我们希望在深入探讨书中后面章节的更高级主题之前，先建立一个关于
    Altair 的基本概念坚实基础。通过偏离本章的即时教学方法，我们可以提供一个全面的概述和深入理解基础原理，这些原理将作为后续材料的构建块。Altair 建立在
    Vega-Lite 之上，并提供一个用户友好的 API 来构建图表。您在第二章中学习了如何在 Altair 中构建基本图表，在本章中，我们将深入探讨 Altair
    图表的基本组件。
- en: 'The basic Altair components include the following:'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 基本的 Altair 组件包括以下内容：
- en: '*Encodings* —These define how data is mapped to visual properties, such as
    color, shape, and size.'
  id: totrans-113
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*编码* — 这些定义了数据如何映射到视觉属性，例如颜色、形状和大小。'
- en: '*Marks* —These refer to the visual elements representing the data, such as
    bars, points, and lines.'
  id: totrans-114
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*标记* — 这些指的是代表数据的视觉元素，例如条形、点和线条。'
- en: '*Conditions* —These enable us to create more complex visualizations by specifying
    rules for when we should use certain encodings or marks.'
  id: totrans-115
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*条件* — 这些使我们能够通过指定何时使用某些编码或标记的规则来创建更复杂的可视化。'
- en: '*Compound charts* —These combine multiple visual elements to create more complex
    and informative visualizations.'
  id: totrans-116
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*复合图表* — 这些将多个视觉元素组合起来，创建更复杂且信息丰富的可视化。'
- en: '*Interactivity* —This enables us to interact with the visualization and explore
    the data.'
  id: totrans-117
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*交互性* — 这使我们能够与可视化交互并探索数据。'
- en: '*Configurations* —These define general properties for compound charts.'
  id: totrans-118
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*配置* — 这些定义了复合图表的一般属性。'
- en: 'Let’s analyze each component separately, starting with the first one: encodings.
    You can find some sample code in the 03/altair directory ([https://mng.bz/rVXX](https://mng.bz/rVXX))
    of the book’s GitHub repository.'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们分别分析每个组件，从第一个开始：编码。您可以在本书 GitHub 仓库的 03/altair 目录中找到一些示例代码（[https://mng.bz/rVXX](https://mng.bz/rVXX)）。
- en: 3.2.1 Encodings
  id: totrans-120
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 3.2.1 编码
- en: 'Altair utilizes *encodings* to indicate where to show data. An encoding defines
    a mapping between a column in the dataset and an encoding channel. Each encoding
    channel corresponds to a specific column of the DataFrame that can be mapped to
    a visual feature of the plot. The encoding process determines where to display
    the data in the chart, according to the chosen channel type. Altair identifies
    several key types of channels, including the following:'
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: Altair 使用 *编码* 来指示数据在哪里显示。编码定义了数据集中某一列与编码通道之间的映射。每个编码通道对应于 DataFrame 的一个特定列，可以映射到图表的视觉特征。编码过程确定根据所选通道类型在哪里显示数据。Altair
    识别了以下几种关键类型的通道，包括以下内容：
- en: '*Position* —This specifies the location of data in the chart.'
  id: totrans-122
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*位置* — 这指定了图表中数据的位置。'
- en: '*Mark property* —This determines the chart’s appearance such as color, size,
    and shape.'
  id: totrans-123
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*标记属性* — 这决定了图表的外观，如颜色、大小和形状。'
- en: '*Text and tooltip* —These offer supplementary annotations for the graph.'
  id: totrans-124
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*文本和工具提示* — 这些为图形提供补充注释。'
- en: Table 3.1 provides a brief description of the main encodings. For more details,
    please refer to the Altair documentation ([https://mng.bz/d6RQ](https://mng.bz/d6RQ)).
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 表 3.1 提供了主要编码的简要描述。更多详细信息，请参阅 Altair 文档 ([https://mng.bz/d6RQ](https://mng.bz/d6RQ)).
- en: Refer to chapter 2 to build a chart using encodings.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 请参阅第 2 章使用编码构建图表。
- en: Table 3.1 The main encodings in Altair
  id: totrans-127
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 表 3.1 Altair 中的主要编码
- en: '| Type | Channel | Description |'
  id: totrans-128
  prefs: []
  type: TYPE_TB
  zh: '| 类型 | 通道 | 描述 |'
- en: '| --- | --- | --- |'
  id: totrans-129
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- |'
- en: '| Position  | `x, y`  | Horizontal and vertical positions  |'
  id: totrans-130
  prefs: []
  type: TYPE_TB
  zh: '| 位置  | `x, y`  | 水平和垂直位置  |'
- en: '|  | `longitude, latitude`  | Geographical coordinates  |'
  id: totrans-131
  prefs: []
  type: TYPE_TB
  zh: '|  | `longitude, latitude`  | 地理坐标  |'
- en: '|  | `xError, xError`  | Error values for `x` and `y`  |'
  id: totrans-132
  prefs: []
  type: TYPE_TB
  zh: '|  | `xError, xError`  | `x` 和 `y` 的误差值  |'
- en: '|  | `x2,y2, longitude2, latitude2`  | Second positions for ranges  |'
  id: totrans-133
  prefs: []
  type: TYPE_TB
  zh: '|  | `x2,y2, longitude2, latitude2`  | 范围的第二个位置  |'
- en: '|  | `theta, theta2`  | Start and end arc angles  |'
  id: totrans-134
  prefs: []
  type: TYPE_TB
  zh: '|  | `theta, theta2`  | 起始和结束弧角度  |'
- en: '| Mark property  | `angle, radius`  | The angle and the radius of the mark  |'
  id: totrans-135
  prefs: []
  type: TYPE_TB
  zh: '| 标记属性  | `angle, radius`  | 标记的角度和半径  |'
- en: '|  | `color, fill`  | The color and the fill of the mark  |'
  id: totrans-136
  prefs: []
  type: TYPE_TB
  zh: '|  | `color, fill`  | 标记的颜色和填充  |'
- en: '|  | `opacity, fillOpacity`  | The opacity and the fill opacity of the mark  |'
  id: totrans-137
  prefs: []
  type: TYPE_TB
  zh: '|  | `opacity, fillOpacity`  | 标记的不透明度和填充不透明度  |'
- en: '|  | `shape, size`  | The shape and the size of the mark  |'
  id: totrans-138
  prefs: []
  type: TYPE_TB
  zh: '|  | `shape, size`  | 标记的形状和大小  |'
- en: '|  | `stroke, strokeDash, strokeOpacity, strokeWidth`  | Stroke properties
    of the mark  |'
  id: totrans-139
  prefs: []
  type: TYPE_TB
  zh: '|  | `stroke, strokeDash, strokeOpacity, strokeWidth`  | 标记的描边属性  |'
- en: '| Text and tooltip  | `text`  | The text of the mark  |'
  id: totrans-140
  prefs: []
  type: TYPE_TB
  zh: '| 文本和工具提示  | `text`  | 标记的文本  |'
- en: '|  | `tooltip`  | The tooltip of the mark  |'
  id: totrans-141
  prefs: []
  type: TYPE_TB
  zh: '|  | `tooltip`  | 标记的工具提示  |'
- en: 'Each column in the dataset is associated with a data type, which defines the
    kind of values a variable can store. A data type includes primitive types, like
    integers and characters, and complex types, like arrays and objects. Altair supports
    the following data types:'
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 数据集中的每一列都与一个数据类型相关联，这定义了变量可以存储的数据类型。数据类型包括原始类型，如整数和字符，以及复杂类型，如数组和对象。Altair 支持以下数据类型：
- en: '*Nominal* —Data that can be divided into distinct categories, without any specific
    order, such as the names of different fruits in a dataset'
  id: totrans-143
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*名义* — 可以分为不同类别，但没有特定顺序的数据，例如数据集中不同水果的名称'
- en: '*Ordinal* —Data that can be divided into distinct categories with an inherent
    order, such as the days of the week, where the order of the days is essential'
  id: totrans-144
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*有序* — 可以分为具有内在顺序的不同类别，例如一周中的日子，其中日子的顺序至关重要'
- en: '*Quantitative* —Numerical and continuous data, such as the number of product
    sales'
  id: totrans-145
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*定量* — 数值和连续数据，例如产品销售数量'
- en: '*Temporal* —Data with a temporal (i.e., date or time) component, such as the
    date on which a sale occurred'
  id: totrans-146
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*时间* — 带有时间（即日期或时间）成分的数据，例如销售发生的日期'
- en: '*Geojson* —Data with a geographic component, such as latitude and longitude
    coordinates'
  id: totrans-147
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Geojson* — 带有地理成分的数据，例如经纬度坐标'
- en: 'When we build a chart in Altair, we must associate each column involved in
    the chart with a data type. Altair defines two ways to specify a data type:'
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们在 Altair 中创建图表时，必须将图表中涉及的每一列与数据类型关联起来。Altair 定义了两种指定数据类型的方式：
- en: The type property of the channel, such as `x=alt.X('category',` `type= 'quantitative')`,
    where `category` is the column name
  id: totrans-149
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通道的类型属性，例如 `x=alt.X('category', `type= 'quantitative')`，其中 `category` 是列名
- en: A shorthand code following the `:` symbol, after the column name, `x=alt.X ('category:Q')`
  id: totrans-150
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在列名之后，冒号 `:` 符号后面的缩写代码，`x=alt.X ('category:Q')`
- en: Now that you have learned the concept of encodings, let’s move on to the next
    concept, marks.
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 现在您已经学习了编码的概念，让我们继续学习下一个概念，标记。
- en: 3.2.2 Marks
  id: totrans-152
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 3.2.2 标记
- en: '*Marks* enable you to represent data in visualizations. Examples of marks include
    bar charts, line charts, heat maps, and box plots, among others. To specify the
    type of mark, use the `mark_<type>()` function, where `<type>` represents the
    specific type of mark. For instance, to create a bar chart, use `mark_bar()`.
    Additionally, you can provide a list of attributes as input parameters for each
    mark property defined in table 3.1\. When using a mark property within the `mark_<type>()`
    function, the value of that property is fixed to a constant value. For example,
    `mark_circle(size=5)` will draw circles with a constant size of 5\. However, if
    you want to vary the size of the circles depending on a specific column of your
    DataFrame, use the `size` channel within the encoding function. Table 3.2 shows
    the main mark types provided by Altair.'
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: '*标记* 使您能够在可视化中表示数据。标记的例子包括条形图、折线图、热图和箱线图等。要指定标记类型，请使用 `mark_<type>()` 函数，其中
    `<type>` 代表特定的标记类型。例如，要创建一个条形图，请使用 `mark_bar()`。此外，您还可以为表 3.1 中定义的每个标记属性提供属性列表作为输入参数。当在
    `mark_<type>()` 函数中使用标记属性时，该属性的值固定为常量值。例如，`mark_circle(size=5)` 将绘制大小为 5 的圆形。然而，如果您想根据
    DataFrame 的特定列来改变圆形的大小，请使用编码函数中的 `size` 通道。表 3.2 展示了 Altair 提供的主要标记类型。'
- en: Table 3.2 The main mark types provided by Altair
  id: totrans-154
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 表 3.2 Altair 提供的主要标记类型
- en: '| Method | Description |'
  id: totrans-155
  prefs: []
  type: TYPE_TB
  zh: '| 方法 | 描述 |'
- en: '| --- | --- |'
  id: totrans-156
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| `mark_arc()`  | A pie chart  |'
  id: totrans-157
  prefs: []
  type: TYPE_TB
  zh: '| `mark_arc()`  | 饼图  |'
- en: '| `mark_area()`  | A filled-area chart  |'
  id: totrans-158
  prefs: []
  type: TYPE_TB
  zh: '| `mark_area()`  | 填充区域图  |'
- en: '| `mark_bar()`  | A bar chart  |'
  id: totrans-159
  prefs: []
  type: TYPE_TB
  zh: '| `mark_bar()`  | 条形图  |'
- en: '| `mark_circle()`  | A scatter plot with filled points  |'
  id: totrans-160
  prefs: []
  type: TYPE_TB
  zh: '| `mark_circle()`  | 填充点的散点图  |'
- en: '| `mark_geoshape()`  | A geographic shape  |'
  id: totrans-161
  prefs: []
  type: TYPE_TB
  zh: '| `mark_geoshape()`  | 地理形状  |'
- en: '| `mark_line()`  | A line chart  |'
  id: totrans-162
  prefs: []
  type: TYPE_TB
  zh: '| `mark_line()`  | 折线图  |'
- en: '| `mark_point()`  | A scatter plot with configurable points  |'
  id: totrans-163
  prefs: []
  type: TYPE_TB
  zh: '| `mark_point()`  | 可配置点的散点图  |'
- en: '| `mark_rect()`  | A filled rectangle for heatmaps  |'
  id: totrans-164
  prefs: []
  type: TYPE_TB
  zh: '| `mark_rect()`  | 热图中的填充矩形  |'
- en: '| `mark_rule()`  | A vertical or horizontal line spanning the axis  |'
  id: totrans-165
  prefs: []
  type: TYPE_TB
  zh: '| `mark_rule()`  | 横跨轴的垂直或水平线  |'
- en: '| `mark_text()`  | A text  |'
  id: totrans-166
  prefs: []
  type: TYPE_TB
  zh: '| `mark_text()`  | 文本  |'
- en: Refer to chapter 2 to build a chart using marks.
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 请参考第 2 章使用标记构建图表。
- en: 3.2.3 Conditions
  id: totrans-168
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 3.2.3 条件
- en: 'Altair provides several ways to create *conditions* in visualizations, which
    enable you to customize and control the appearance of your charts based on specific
    criteria. One common way to create conditions in Altair is to use the *if-else*
    *statements* in the encoding channels of a chart. To define a condition in Altair,
    use the `alt.condition()` method, which takes three arguments:'
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: Altair 提供了多种在可视化中创建 *条件* 的方式，这使您可以根据特定标准自定义和控制图表的外观。在 Altair 中创建条件的一种常见方法是在图表的编码通道中使用
    *if-else* *语句*。要在 Altair 中定义一个条件，请使用 `alt.condition()` 方法，该方法接受三个参数：
- en: A condition
  id: totrans-170
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 条件
- en: A value to use when the condition is true
  id: totrans-171
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 当条件为真时使用的值
- en: A value to use when the condition is false
  id: totrans-172
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 当条件为假时使用的值
- en: For instance, if we want to change the color of the bars in a bar chart based
    on a specific condition, write the code shown in the following listing and the
    GitHub repository for the book under 03/altair/condition.py. The final chart is
    rendered in 03/altair/condition.xhtml.
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，如果我们想根据特定条件改变条形图的颜色，请编写以下列表中的代码和书中 03/altair/condition.py 的 GitHub 仓库。最终的图表在
    03/altair/condition.xhtml 中渲染。
- en: Listing 3.15 Using the `alt.condition()` method
  id: totrans-174
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表 3.15 使用 `alt.condition()` 方法
- en: '[PRE14]'
  id: totrans-175
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: '#1 Color to use when condition is true'
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: '#1 条件为真时使用的颜色'
- en: '#2 Color to use when condition is false'
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: '#2 条件为假时使用的颜色'
- en: Note  The condition in the example checks if the Region is Europe. If the condition
    is true, the bars will be colored red, and if the condition is false, the bars
    will be colored blue. Use the datum variable to directly access the DataFrame
    column name within a condition.
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 注意：示例中的条件检查区域是否为欧洲。如果条件为真，条形图将变为红色，如果条件为假，条形图将变为蓝色。使用 datum 变量可以直接在条件中访问 DataFrame
    列名。
- en: 'In addition to using if-else statements with the `alt.condition()` method and
    the type-checking functions, Altair provides two other ways to create conditions
    in visualizations: *transformations* and *selections*. You will see transformations
    in chapter 5 and selections in chapter 6\. You can use transformations and selections
    to build interconnected charts that update synchronously.'
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 除了使用 `alt.condition()` 方法中的 if-else 语句和类型检查函数外，Altair 还提供了两种在可视化中创建条件的方法：*转换*
    和 *选择*。您将在第 5 章中看到转换，在第 6 章中看到选择。您可以使用转换和选择来构建相互关联的图表，这些图表可以同步更新。
- en: 3.2.4 Compound charts
  id: totrans-180
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 3.2.4 复合图表
- en: '*Compound charts* enable you to combine visualizations in a single chart. Altair
    supports the following types of compound charts: layering, horizontal concatenation,
    vertical concatenation, and repeated charts. To explain how each type of compound
    chart works, consider the two charts described in the following listing and 03/altair/
    layering.py.'
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: '*复合图表* 允许您在单个图表中组合可视化。Altair 支持以下类型的复合图表：分层、水平连接、垂直连接和重复图表。为了解释每种类型的复合图表如何工作，请考虑以下列表和
    03/altair/layering.py 中描述的两个图表。'
- en: Listing 3.16 Building two charts in Altair
  id: totrans-182
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表 3.16 在 Altair 中构建两个图表
- en: '[PRE15]'
  id: totrans-183
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: Note  Build a base chart, with the encodings and properties shared among all
    the charts, and then use it to build the other charts, a bar chart (`chart1`),
    and a line chart (`chart2`). Use `properties()` to set the chart properties, such
    as the width and the title.
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 注意：构建一个基础图表，其中包含所有图表共享的编码和属性，然后使用它来构建其他图表，一个条形图（`chart1`）和一个折线图（`chart2`）。使用
    `properties()` 设置图表属性，例如宽度和标题。
- en: Layering
  id: totrans-185
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 分层
- en: '*Layering* lets you combine charts on top of each other, as shown in figure
    3.2\. In Altair, use the `alt.layer(chart1,chart2)` function to layer two charts,
    or the `+` operator (`chart1` `+` `chart2`). If each chart has a title and you
    don’t specify any general title for the compound chart, layering will set the
    title of the layered chart as that of the first chart.'
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: '*分层* 允许您将图表堆叠在一起，如图 3.2 所示。在 Altair 中，使用 `alt.layer(chart1,chart2)` 函数分层两个图表，或者使用
    `+` 操作符（`chart1` `+` `chart2`）。如果每个图表都有一个标题，并且您没有为复合图表指定任何通用标题，则分层将设置分层图表的标题为第一个图表的标题。'
- en: '![figure](../Images/3-2.png)'
  id: totrans-187
  prefs: []
  type: TYPE_IMG
  zh: '![figure](../Images/3-2.png)'
- en: Figure 3.2 A bar chart layered with a line chart
  id: totrans-188
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图 3.2 堆叠条形图和折线图
- en: Horizontal concatenation
  id: totrans-189
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 水平连接
- en: '*Horizontal concatenation* enables you to concatenate charts horizontally,
    as shown in figure 3.3\. In Altair, use the `alt.hconcat(chart1,chart2)` function
    to layer two charts or, alternatively, the `|` operator. Refer to 03/altair/hconcat.py
    for the complete example.'
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: '*水平连接* 允许您水平连接图表，如图 3.3 所示。在 Altair 中，使用 `alt.hconcat(chart1,chart2)` 函数分层两个图表，或者使用
    `|` 操作符。请参阅 03/altair/hconcat.py 以获取完整示例。'
- en: '![figure](../Images/3-3.png)'
  id: totrans-191
  prefs: []
  type: TYPE_IMG
  zh: '![figure](../Images/3-3.png)'
- en: Figure 3.3 A bar chart concatenated horizontally with a line chart
  id: totrans-192
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图 3.3 水平连接的条形图和折线图
- en: Vertical concatenation
  id: totrans-193
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 垂直连接
- en: '*Vertical concatenation* enables you to concatenate charts vertically, as shown
    in figure 3.4\. In Altair, use the `alt.vconcat(chart1,chart2)` function to layer
    two charts or the `&` operator. Refer to 03/altair/vconcat.py for the complete
    example.'
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: '*垂直连接* 允许您垂直连接图表，如图 3.4 所示。在 Altair 中，使用 `alt.vconcat(chart1,chart2)` 函数分层两个图表，或者使用
    `&` 操作符。请参阅 03/altair/vconcat.py 以获取完整示例。'
- en: '![figure](../Images/3-4.png)'
  id: totrans-195
  prefs: []
  type: TYPE_IMG
  zh: '![figure](../Images/3-4.png)'
- en: Figure 3.4 A bar chart concatenated vertically with a line chart
  id: totrans-196
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图 3.4 垂直连接条形图和折线图
- en: Repeated charts
  id: totrans-197
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 重复图表
- en: A *repeated chart* displays similar data views in a single visualization. With
    a repeated chart, you can create a set of charts, each displaying a subset of
    the data, by repeating a base chart using different data subsets or by changing
    a visual encoding.
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: '*重复图表* 在单个可视化中显示类似的数据视图。使用重复图表，您可以通过重复使用不同的数据子集或更改视觉编码来创建一组图表，每个图表显示数据的一个子集。'
- en: Use the `repeat()` function to create a repeated chart in Altair. This function
    takes the list of fields for the repeat, as shown in the following listing and
    under 03/altair/ repeat.py.
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 `repeat()` 函数在 Altair 中创建重复的图表。此函数接受重复的字段列表，如以下列表和 03/altair/repeat.py 中所示。
- en: Listing 3.17 Building a repeated chart in Altair
  id: totrans-200
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表 3.17 在 Altair 中构建重复图表
- en: '[PRE16]'
  id: totrans-201
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: Note  First, create the pandas DataFrame. Then, extract the list of fields to
    repeat and store them in the `fields` variable. Next, define the `repeat()` method
    with the rows and columns to repeat. Finally, use the `row` and `column` variables
    just defined as a variable of the chart encodings.
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 注意：首先，创建 pandas DataFrame。然后，提取要重复的字段列表并将它们存储在 `fields` 变量中。接下来，定义 `repeat()`
    方法，指定要重复的行和列。最后，使用刚刚定义的 `row` 和 `column` 变量作为图表编码的变量。
- en: Figure 3.5 shows the output of listing 3.17\. Altair has built 25 charts, one
    for each combination of the columns of the DataFrame specified in the `fields`
    variable.
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: 图 3.5 显示了列表 3.17 的输出。Altair 已构建了 25 个图表，每个图表对应于 `fields` 变量中指定的 DataFrame 列的每个组合。
- en: '![figure](../Images/3-5.png)'
  id: totrans-204
  prefs: []
  type: TYPE_IMG
  zh: '![图](../Images/3-5.png)'
- en: Figure 3.5 A repeated chart varying the encodings
  id: totrans-205
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图 3.5 通过编码变化的重复图表
- en: 3.2.5 Interactivity
  id: totrans-206
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 3.2.5 交互性
- en: '*Interactivity* refers to the ability to manipulate visualizations through
    user input, such as hovering over data points, clicking legends, or dragging sliders.
    In Altair, use the `interactive()` method to enable features like zooming, panning,
    and hovering over data points to display tooltips. Listing 3.18 shows an example
    of how to make a chart interactive, and figure 3.6 shows the resulting chart.
    You can also find the complete example under 03/altair/interactive.py.'
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: '*交互性* 指的是通过用户输入（如悬停在数据点上、点击图例或拖动滑块）来操作可视化的能力。在 Altair 中，使用 `interactive()`
    方法来启用缩放、平移和数据点悬停以显示工具提示的功能。列表 3.18 展示了如何使图表交互的示例，图 3.6 显示了生成的图表。您也可以在 03/altair/interactive.py
    下找到完整的示例。'
- en: Listing 3.18 Building an interactive chart in Altair
  id: totrans-208
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表 3.18 在 Altair 中构建交互式图表
- en: '[PRE17]'
  id: totrans-209
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: Note  First, create the pandas DataFrame. Then, build the Altair chart, appending
    the `interactive()` method at the end. Also, add a tooltip, which receives the
    list of DataFrame columns to show.
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: 注意：首先，创建 pandas DataFrame。然后，构建 Altair 图表，在末尾附加 `interactive()` 方法。另外，添加一个工具提示，它接收要显示的
    DataFrame 列的列表。
- en: '![figure](../Images/3-6.png)'
  id: totrans-211
  prefs: []
  type: TYPE_IMG
  zh: '![图](../Images/3-6.png)'
- en: Figure 3.6 A bar chart with interactivity enabled
  id: totrans-212
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图 3.6 启用交互性的条形图
- en: 3.2.6 Configurations
  id: totrans-213
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 3.2.6 配置
- en: To configure the basic properties of a single chart, use the `properties()`
    method. For more complex properties and to configure a compound chart, instead,
    you must use *global configurations*. Altair supports many global configurations.
    In this section, we will describe axes, title, and view. We will wait to describe
    the other configurations until later in the book, when we will require them.
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: 要配置单个图表的基本属性，请使用 `properties()` 方法。对于更复杂的属性和配置复合图表，您必须使用 *全局配置*。Altair 支持许多全局配置。在本节中，我们将描述轴、标题和视图。我们将等到书中稍后需要它们时再描述其他配置。
- en: To show how configurations work, we will start with the chart described in figure
    3.7 and generated through the code in the following listing.
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: 为了展示配置如何工作，我们将从图 3.7 中描述的图表开始，并通过以下列表中的代码生成。
- en: Listing 3.19 Defining the basic chart
  id: totrans-216
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表 3.19 定义基本图表
- en: '[PRE18]'
  id: totrans-217
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: '![figure](../Images/3-7.png)'
  id: totrans-218
  prefs: []
  type: TYPE_IMG
  zh: '![图](../Images/3-7.png)'
- en: Figure 3.7 The basic bar chart built by the default configuration
  id: totrans-219
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图 3.7 默认配置构建的基本条形图
- en: Now, let’s start modifying the basic chart by configuring axes.
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们通过配置轴来开始修改基本图表。
- en: Configuring axes
  id: totrans-221
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 配置轴
- en: 'To configure axes at a global level, Altair supports three methods:'
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: 要在全局级别配置轴，Altair 支持三种方法：
- en: '`configure_axis()`—Configures both axes.'
  id: totrans-223
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`configure_axis()`—配置两个轴。'
- en: '`configure_axisX()`—Configures the x-axis.'
  id: totrans-224
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`configure_axisX()`—配置x轴。'
- en: '`configure_axisY()`—Configures the y-axis.'
  id: totrans-225
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`configure_axisY()`—配置y轴。'
- en: Configuring axes enables you to customize several properties, such as labels,
    tick marks, and scales. The following listing shows an example, which you can
    also find under 03/altair/configure-axis.py.
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: 配置轴允许您自定义多个属性，例如标签、刻度和比例。以下列表显示了一个示例，您也可以在 03/altair/configure-axis.py 下找到。
- en: Listing 3.20 Configuring axes
  id: totrans-227
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表 3.20 配置轴
- en: '[PRE19]'
  id: totrans-228
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: '#1 Sets the label angle'
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: '#1 设置标签角度'
- en: '#2 Sets the font size of the axis title'
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: '#2 设置轴标题的字体大小'
- en: '#3 Sets the font size of the axis labels'
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: '#3 设置轴标签的字体大小'
- en: Note  Use `configure_axis()` to configure labels and titles in axes. As an alternative,
    use `configure_axisX()` to configure the x-axis and `configure_` `axisY()` configure
    the y-axis.
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: 注意：使用 `configure_axis()` 来配置轴的标签和标题。作为替代，使用 `configure_axisX()` 来配置x轴，而 `configure_axisY()`
    来配置y轴。
- en: Figure 3.8 shows the difference between the layouts when using `configure_axis()`
    (on the left) and not using `configure_axis()` (on the right).
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
  zh: 图 3.8 显示了使用 `configure_axis()`（在左侧）和不使用 `configure_axis()`（在右侧）时的布局差异。
- en: '![figure](../Images/3-8.png)'
  id: totrans-234
  prefs: []
  type: TYPE_IMG
  zh: '![figure](../Images/3-8.png)'
- en: Figure 3.8 The difference between the layouts with `configure_axis()` and without
    `configure_axis()`
  id: totrans-235
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图 3.8 使用 `configure_axis()` 和不使用 `configure_axis()` 的布局之间的差异
- en: Configuring title
  id: totrans-236
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 配置标题
- en: Use the `configure_title()` method to customize the title properties of your
    chart, such as color, font size, and font family. The following listing shows
    an example of how to use the `configure_title()` method, which you can also find
    under 03/altair/ configure-title.py.
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 `configure_title()` 方法自定义图表的标题属性，如颜色、字体大小和字体族。以下列表显示了如何使用 `configure_title()`
    方法的示例，你还可以在 03/altair/configure-title.py 下找到。
- en: Listing 3.21 Configuring `title`
  id: totrans-238
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表 3.21 配置 `title`
- en: '[PRE20]'
  id: totrans-239
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: '#1 Sets the title font size'
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
  zh: '#1 设置标题字体大小'
- en: '#2 Sets the title color'
  id: totrans-241
  prefs: []
  type: TYPE_NORMAL
  zh: '#2 设置标题颜色'
- en: '#3 Sets the distance between the title and the chart'
  id: totrans-242
  prefs: []
  type: TYPE_NORMAL
  zh: '#3 设置标题与图表之间的距离'
- en: '#4 Sets where to anchor the title'
  id: totrans-243
  prefs: []
  type: TYPE_NORMAL
  zh: '#4 设置标题锚点位置'
- en: Note  Use `configure_title()` to configure the title properties. The anchor
    must be either `None`, `start`, `middle`, or `end`.
  id: totrans-244
  prefs: []
  type: TYPE_NORMAL
  zh: 注意：使用 `configure_title()` 配置标题属性。锚点必须是 `None`、`start`、`middle` 或 `end`。
- en: Figure 3.9 shows the difference between the layouts when using `configure_title()`
    (on the left) and not using `configure_title()` (on the right).
  id: totrans-245
  prefs: []
  type: TYPE_NORMAL
  zh: 图 3.9 显示了使用 `configure_title()`（左侧）和不使用 `configure_title()`（右侧）的布局之间的差异。
- en: '![figure](../Images/3-9.png)'
  id: totrans-246
  prefs: []
  type: TYPE_IMG
  zh: '![figure](../Images/3-9.png)'
- en: Figure 3.9 The difference between the layouts with `configure_title()` and without
    `configure_title()`
  id: totrans-247
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图 3.9 使用 `configure_title()` 和不使用 `configure_title()` 的布局之间的差异
- en: Configuring view
  id: totrans-248
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 配置视图
- en: Use the `configure_view()` method to customize the general view of the chart.
    The following listing shows an example of usage of the `configure_view()` method,
    which you can also find under 03/altair/configure-view.py.
  id: totrans-249
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 `configure_view()` 方法自定义图表的一般视图。以下列表显示了 `configure_view()` 方法的使用示例，你还可以在
    03/altair/configure-view.py 下找到。
- en: Listing 3.22 Configuring `view`
  id: totrans-250
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表 3.22 配置 `view`
- en: '[PRE21]'
  id: totrans-251
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: '#1 Sets the border stroke width'
  id: totrans-252
  prefs: []
  type: TYPE_NORMAL
  zh: '#1 设置边框描边宽度'
- en: '#2 Sets the border stroke color'
  id: totrans-253
  prefs: []
  type: TYPE_NORMAL
  zh: '#2 设置边框描边颜色'
- en: '#3 Sets the background color'
  id: totrans-254
  prefs: []
  type: TYPE_NORMAL
  zh: '#3 设置背景颜色'
- en: Note  Use `configure_view()` to configure the general view of the chart.
  id: totrans-255
  prefs: []
  type: TYPE_NORMAL
  zh: 注意：使用 `configure_view()` 配置图表的一般视图。
- en: Figure 3.10 shows the difference between the layouts when using `configure_view()`
    (on the left) and not using `configure_view()` (on the right).
  id: totrans-256
  prefs: []
  type: TYPE_NORMAL
  zh: 图 3.10 显示了使用 `configure_view()`（左侧）和不使用 `configure_view()`（右侧）的布局之间的差异。
- en: '![figure](../Images/3-10.png)'
  id: totrans-257
  prefs: []
  type: TYPE_IMG
  zh: '![figure](../Images/3-10.png)'
- en: Figure 3.10 The difference between the layouts with `configure_view()` and without
    `configure_view()`
  id: totrans-258
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图 3.10 使用 `configure_view()` 和不使用 `configure_view()` 的布局之间的差异
- en: 'Now that you have learned the basic components of an Altair chart, let’s move
    to the next step: implementing a case study.'
  id: totrans-259
  prefs: []
  type: TYPE_NORMAL
  zh: 现在你已经学习了 Altair 图表的基本组件，让我们继续下一步：实现一个案例研究。
- en: 3.3 Case study
  id: totrans-260
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 3.3 案例研究
- en: Let us imagine you work as a researcher at the Global Demographic Analysis Center
    (GDAC), who wants to study population growth in North America. For this study,
    you will be using the World Bank’s population dataset (released under the CC BY-4.0
    license, [https://data.worldbank.org/indicator/SP.POP.TOTL](https://data.worldbank.org/indicator/SP.POP.TOTL));
    you can find a cleaned version of the dataset in the GitHub repository for the
    book under CaseStudies/population/source/population.csv. The dataset contains
    the population from 1960 to 2021 for all the countries of the world, as shown
    in table 3.3\. The Country Name column also contains continents. You can find
    this case study’s complete code provided as a Jupyter Notebook in the book’s GitHub
    repository under CaseStudies/population/ population.ipynb. In this case, simply
    execute a cell with the chart variable to visualize an Altair chart.
  id: totrans-261
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们假设你在全球人口分析中心（GDAC）工作，该中心希望研究北美的人口增长。为此研究，你将使用世界银行的_population_数据集（在 CC BY-4.0
    许可下发布，[https://data.worldbank.org/indicator/SP.POP.TOTL](https://data.worldbank.org/indicator/SP.POP.TOTL)）；你可以在本书的
    GitHub 仓库的 CaseStudies/population/source/population.csv 中找到数据集的清洗版本。该数据集包含从 1960
    年到 2021 年所有国家的数据，如表 3.3 所示。国家名称列还包含大洲。你可以在本书的 GitHub 仓库的 CaseStudies/population/population.ipynb
    下找到此案例研究的完整代码。在这种情况下，只需执行包含图表变量的单元格即可可视化 Altair 图表。
- en: Table 3.3 The population dataset
  id: totrans-262
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 表 3.3 人口数据集
- en: '| Country Name | 1960 | … | 2021 |'
  id: totrans-263
  prefs: []
  type: TYPE_TB
  zh: '| 国家名称 | 1960 | … | 2021 |'
- en: '| --- | --- | --- | --- |'
  id: totrans-264
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- | --- |'
- en: '| Aruba  | 54,608  |  | 106,537  |'
  id: totrans-265
  prefs: []
  type: TYPE_TB
  zh: '| 阿鲁巴 | 54,608 |  | 106,537 |'
- en: '| …  |  |  |  |'
  id: totrans-266
  prefs: []
  type: TYPE_TB
  zh: '| … |  |  |  |'
- en: '| Zimbabwe  | 3,806,310  |  | 15,993,524  |'
  id: totrans-267
  prefs: []
  type: TYPE_TB
  zh: '| 津巴布韦 | 3,806,310 |  | 15,993,524 |'
- en: You start by drawing a raw chart in the following listing, showing all the trend
    lines from 1960 to 2021 for all the countries and continents. The Country Name
    column is dirty, so the resulting chart is very confusing, as shown in figure
    3.11.
  id: totrans-268
  prefs: []
  type: TYPE_NORMAL
  zh: 你首先在以下列表中绘制一个原始图表，显示从 1960 年到 2021 年所有国家和大陆的趋势线。国家名称列很脏，所以生成的图表非常混乱，如图 3.11
    所示。
- en: Listing 3.23 Drawing the raw chart
  id: totrans-269
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表 3.23 绘制原始图表
- en: '[PRE22]'
  id: totrans-270
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: '#1 Uses this Altair function for datasets with more than 5,000 rows'
  id: totrans-271
  prefs: []
  type: TYPE_NORMAL
  zh: '#1 使用此 Altair 函数处理超过 5,000 行的数据集'
- en: '#2 Unpivots the dataset'
  id: totrans-272
  prefs: []
  type: TYPE_NORMAL
  zh: '#2 将数据集展开成非透视表形式'
- en: '#3 Draws the chart'
  id: totrans-273
  prefs: []
  type: TYPE_NORMAL
  zh: '#3 绘制图表'
- en: Note  Use `mark_line()` to draw the chart. To plot the different countries,
    use the `color` channel.
  id: totrans-274
  prefs: []
  type: TYPE_NORMAL
  zh: 注意：使用 `mark_line()` 绘制图表。要绘制不同的国家，使用 `color` 通道。
- en: '![figure](../Images/3-11.png)'
  id: totrans-275
  prefs: []
  type: TYPE_IMG
  zh: '![图表](../Images/3-11.png)'
- en: Figure 3.11 The chart with raw data
  id: totrans-276
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图 3.11 原始数据的图表
- en: 'The chart is very confusing because it presents the following problems: there
    are too many countries, there are too many colors, and it does not focus on North
    America. To solve these issues, let us use the DIKW pyramid, starting from the
    first step: turning data into information.'
  id: totrans-277
  prefs: []
  type: TYPE_NORMAL
  zh: 该图表非常混乱，因为它提出了以下问题：国家太多，颜色太多，且没有专注于北美。为了解决这些问题，让我们使用 DIKW 金字塔，从第一步开始：将数据转化为信息。
- en: 3.3.1 From data to information
  id: totrans-278
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 3.3.1 从数据到信息
- en: Turning data into information involves extracting insights from data. From the
    point of view of a chart, it means making the chart readable and understandable.
    Start by grouping countries by continent. The dataset already contains values
    for continents. List the countries using the `unique()` method provided by the
    pandas DataFrame applied to the Country Name column. For more details on the `unique()`
    method, please refer to appendix B. Note that the list of countries also contains
    the continents, so we can build a list of the continents and filter the DataFrame
    based on that list. Then, plot the resulting chart.
  id: totrans-279
  prefs: []
  type: TYPE_NORMAL
  zh: 将数据转化为信息涉及从数据中提取洞察力。从图表的角度来看，这意味着使图表可读且易于理解。首先按大陆分组国家。数据集已经包含大陆的值。使用 pandas
    DataFrame 提供的 `unique()` 方法列出国家。有关 `unique()` 方法的更多详细信息，请参阅附录 B。请注意，国家列表中也包含大陆，因此我们可以构建一个大陆列表并基于该列表过滤
    DataFrame。然后，绘制生成的图表。
- en: Listing 3.24 Decluttering the chart
  id: totrans-280
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表 3.24 清理图表
- en: '[PRE23]'
  id: totrans-281
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: '#1 Defines the list of continents'
  id: totrans-282
  prefs: []
  type: TYPE_NORMAL
  zh: '#1 定义大陆列表'
- en: '#2 Filters the DataFrame on the basis of the list'
  id: totrans-283
  prefs: []
  type: TYPE_NORMAL
  zh: '#2 根据列表过滤 DataFrame'
- en: '#3 Draws the chart'
  id: totrans-284
  prefs: []
  type: TYPE_NORMAL
  zh: '#3 绘制图表'
- en: Note  Group data by continents to reduce the number of lines.
  id: totrans-285
  prefs: []
  type: TYPE_NORMAL
  zh: 注意：按大陆分组数据以减少线条数量。
- en: 'Figure 3.12 shows the resulting chart, which is more readable. However, it
    still presents some problems: there too many colors and it does not focus on North
    America. In practice, it is difficult to compare North America with the other
    continents.'
  id: totrans-286
  prefs: []
  type: TYPE_NORMAL
  zh: 图 3.12 显示了生成的图表，它更易于阅读。然而，它仍然存在一些问题：颜色太多，且没有专注于北美。在实践中，很难将北美与其他大陆进行比较。
- en: '![figure](../Images/3-12.png)'
  id: totrans-287
  prefs: []
  type: TYPE_IMG
  zh: '![图表](../Images/3-12.png)'
- en: Figure 3.12 The chart with a focus on continents
  id: totrans-288
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图 3.12 专注于大陆的图表
- en: Change the chart by focusing on North America and grouping the other continents
    by calculating their average value, as shown in the following listing.
  id: totrans-289
  prefs: []
  type: TYPE_NORMAL
  zh: 通过专注于北美并将其他大陆按其平均值分组来更改图表，如下列表所示。
- en: Listing 3.25 Focusing on North America
  id: totrans-290
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表 3.25 专注于北美
- en: '[PRE24]'
  id: totrans-291
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: '#1 Defines a mask that selects only North America'
  id: totrans-292
  prefs: []
  type: TYPE_NORMAL
  zh: '#1 定义一个仅选择北美的掩码'
- en: '#2 Calculates the average value for the continents not in the mask'
  id: totrans-293
  prefs: []
  type: TYPE_NORMAL
  zh: '#2 计算掩码外大陆的平均值'
- en: '#3 Builds a new DataFrame with North America and the average value of the other
    continents'
  id: totrans-294
  prefs: []
  type: TYPE_NORMAL
  zh: '#3 创建一个新的包含北美和其他大陆平均值的 DataFrame'
- en: Note  Focus on North America, and calculate the average value of the other continents.
  id: totrans-295
  prefs: []
  type: TYPE_NORMAL
  zh: 注意：专注于北美，并计算其他大陆的平均值。
- en: Then, draw the chart.
  id: totrans-296
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，绘制图表。
- en: Listing 3.26 Drawing the chart
  id: totrans-297
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表 3.26 绘制图表
- en: '[PRE25]'
  id: totrans-298
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: '#1 Formats x labels'
  id: totrans-299
  prefs: []
  type: TYPE_NORMAL
  zh: '#1 格式化 x 标签'
- en: '#2 Formats y labels'
  id: totrans-300
  prefs: []
  type: TYPE_NORMAL
  zh: '#2 格式化 y 标签'
- en: '#3 Sets the range of colors'
  id: totrans-301
  prefs: []
  type: TYPE_NORMAL
  zh: '#3 设置颜色范围'
- en: '#4 Does not show the legend'
  id: totrans-302
  prefs: []
  type: TYPE_NORMAL
  zh: '#4 不显示图例'
- en: '#5 Disables grid'
  id: totrans-303
  prefs: []
  type: TYPE_NORMAL
  zh: '#5 禁用网格'
- en: Note  To format the x-axis labels, use the `format` parameter. Use `.0f` to
    show only the integer part. Also, use the `tickMinStep` parameter to set the distance
    between two labels. The example sets the value to `10`, thus labeling the decades.
    To format the y-axis labels, set the format parameter to `.2s`, using scientific
    notation with two significant figures.
  id: totrans-304
  prefs: []
  type: TYPE_NORMAL
  zh: 注意：为了格式化x轴标签，使用 `format` 参数。使用 `.0f` 来仅显示整数部分。同时，使用 `tickMinStep` 参数来设置两个标签之间的距离。示例中将值设置为
    `10`，因此标记了十年。为了格式化y轴标签，将格式参数设置为 `.2s`，使用两位有效数字的科学记数法。
- en: Figure 3.13 shows the resulting chart. We have omitted the legend for now and
    will add it later. The chart is clearer; however, the audience needs to do some
    calculations to understand the difference between the two lines.
  id: totrans-305
  prefs: []
  type: TYPE_NORMAL
  zh: 图3.13显示了结果图表。我们目前省略了图例，稍后会添加。图表更清晰；然而，观众需要做一些计算才能理解两条线之间的差异。
- en: '![figure](../Images/3-13.png)'
  id: totrans-306
  prefs: []
  type: TYPE_IMG
  zh: '![图表](../Images/3-13.png)'
- en: Figure 3.13 The chart focuses on North America.
  id: totrans-307
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图3.13 突出显示北美的图表
- en: When drawing a chart, do the calculations for the audience to serve them the
    ready-made dish. Let us calculate the difference from the starting year (1960)
    for both lines, thus making them comparable. The following listing shows how to
    calculate the difference.
  id: totrans-308
  prefs: []
  type: TYPE_NORMAL
  zh: 当绘制图表时，为观众进行计算，为他们提供现成的菜肴。让我们计算两条线从起始年份（1960年）的差异，从而使它们具有可比性。以下列表显示了如何计算差异。
- en: Listing 3.27 Calculating the difference
  id: totrans-309
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表3.27 计算差异
- en: '[PRE26]'
  id: totrans-310
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: Note  Calculate the baseline value for 1960, and then for each continent, calculate
    the difference between each year and the baseline.
  id: totrans-311
  prefs: []
  type: TYPE_NORMAL
  zh: 注意：计算1960年的基线值，然后对每个大陆，计算每年与基线之间的差异。
- en: Having calculated the difference, draw the chart. The code is similar to that
    in listing 3.23\. Change only the y-axis column to `Diff`. Figure 3.14 shows the
    resulting chart.
  id: totrans-312
  prefs: []
  type: TYPE_NORMAL
  zh: 计算完差异后，绘制图表。代码与列表3.23中的类似。只需更改y轴列到 `Diff`。图3.14显示了结果图表。
- en: '![figure](../Images/3-14.png)'
  id: totrans-313
  prefs: []
  type: TYPE_IMG
  zh: '![图表](../Images/3-14.png)'
- en: Figure 3.14 The chart with a focus on the difference in population from 1960
  id: totrans-314
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图3.14 突出显示1960年人口差异的图表
- en: The chart clearly shows the difference between the two lines, although it is
    not explicit. To complete the chart, add a label for each line as an additional
    textual mark.
  id: totrans-315
  prefs: []
  type: TYPE_NORMAL
  zh: 图表清楚地显示了两条线之间的差异，尽管这不是很明确。为了完成图表，为每条线添加一个标签作为额外的文本标记。
- en: Listing 3.28 Adding labels
  id: totrans-316
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表3.28 添加标签
- en: '[PRE27]'
  id: totrans-317
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: '#1 Sets the x position'
  id: totrans-318
  prefs: []
  type: TYPE_NORMAL
  zh: '#1 设置x位置'
- en: '#2 Sets the y position'
  id: totrans-319
  prefs: []
  type: TYPE_NORMAL
  zh: '#2 设置y位置'
- en: 'Note  Use `mark_text()` to set the line labels. We label the lines by placing
    a text annotation next to each line. We could have used the legend to label the
    lines, but as Cole Nussbaumer Knaflic says in her book, *Storytelling with Data:
    A Data Visualization Guide for Business Professionals* (John Wiley & Sons, 2015),
    it’s clearer to use text annotations for better clarity. To set the y text position,
    use the coordinates of the last point in each line. For the x, instead, slightly
    increase the coordinates of the last point in each line (e.g., 2023 in the example,
    while the last point is 2021).'
  id: totrans-320
  prefs: []
  type: TYPE_NORMAL
  zh: 注意：使用 `mark_text()` 来设置线条标签。我们通过在每个线条旁边放置文本注释来标记线条。我们本来可以使用图例来标记线条，但正如Cole Nussbaumer
    Knaflic在她的书《用数据讲故事：商业专业人士的数据可视化指南》（John Wiley & Sons, 2015）中所说，使用文本注释可以使内容更清晰。要设置y文本位置，使用每条线条最后一个点的坐标。对于x轴，相反，稍微增加每条线条最后一个点的坐标（例如，示例中的2023，而最后一个点是2021）。
- en: Now, combine the textual mark and the original chart.
  id: totrans-321
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，将文本标记和原始图表结合起来。
- en: Listing 3.29 Combining the chart and the text labels
  id: totrans-322
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表3.29 合并图表和文本标签
- en: '[PRE28]'
  id: totrans-323
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: Note  Use `+` to combine the two layers. Then, use `configure_axis()`, `configure_title()`,
    and `configure_view()` to set the global chart configurations.
  id: totrans-324
  prefs: []
  type: TYPE_NORMAL
  zh: 注意：使用 `+` 来合并两层。然后，使用 `configure_axis()`、`configure_title()` 和 `configure_view()`
    来设置全局图表配置。
- en: Figure 3.15 illustrates the resulting chart at the end of the information step.
  id: totrans-325
  prefs: []
  type: TYPE_NORMAL
  zh: 图3.15展示了信息步骤结束时的结果图表。
- en: '![figure](../Images/3-15.png)'
  id: totrans-326
  prefs: []
  type: TYPE_IMG
  zh: '![图表](../Images/3-15.png)'
- en: Figure 3.15 The chart at the end of the information step
  id: totrans-327
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图3.15 信息步骤结束时的图表
- en: The next step of the DIKW pyramid is turning information into knowledge. So
    let us proceed.
  id: totrans-328
  prefs: []
  type: TYPE_NORMAL
  zh: DIKW金字塔的下一步是将信息转化为知识。让我们继续。
- en: 3.3.2 From information to knowledge
  id: totrans-329
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 3.3.2 从信息到知识
- en: 'Turning information into knowledge involves adding context to the chart. We
    add three types of context: an annotation showing the gap between the two lines,
    an annotation containing the data source, and a text explaining the causes of
    this gap.'
  id: totrans-330
  prefs: []
  type: TYPE_NORMAL
  zh: 将信息转化为知识涉及向图表添加上下文。我们添加了三种类型的上下文：显示两条线之间差距的注释、包含数据源的注释以及解释此差距原因的文本。
- en: Chart annotation
  id: totrans-331
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 图表注释
- en: '*Chart annotation* aims to ease the audience’s life by making explicit the
    gap between the two lines. Figure 3.16 shows the annotation we are going to add
    to the chart. The annotation comprises two elements: a vertical line showing the
    gap between the two lines and a “big number” (BAN), a large number containing
    the gap value.'
  id: totrans-332
  prefs: []
  type: TYPE_NORMAL
  zh: '*图表注释*旨在通过明确两条线之间的差距来简化观众的生活。图3.16显示了我们将添加到图表中的注释。该注释包含两个元素：一条显示两条线之间差距的垂直线和“大数字”（BAN），它包含差距值。'
- en: '![figure](../Images/3-16.png)'
  id: totrans-333
  prefs: []
  type: TYPE_IMG
  zh: '![figure](../Images/3-16.png)'
- en: Figure 3.16 The chart with an explicit annotation on the gap between North America
    and the rest of the world
  id: totrans-334
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图3.16 在北美与世界其他地区之间的差距上具有明确注释的图表
- en: To draw the chart annotation, use `mark_line()` to draw the vertical line and
    `mark_ text()` to draw the text. The following listing describes how to render
    the previous annotations.
  id: totrans-335
  prefs: []
  type: TYPE_NORMAL
  zh: 要绘制图表注释，使用`mark_line()`绘制垂直线，使用`mark_text()`绘制文本。以下列表描述了如何渲染前面的注释。
- en: Listing 3.30 Adding the annotation
  id: totrans-336
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表3.30 添加注释
- en: '[PRE29]'
  id: totrans-337
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: '#1 Defines the distance between the vertical line and the last point in the
    country line'
  id: totrans-338
  prefs: []
  type: TYPE_NORMAL
  zh: '#1 定义了垂直线与国家线最后一个点之间的距离'
- en: '#2 Calculates the last value for North America line'
  id: totrans-339
  prefs: []
  type: TYPE_NORMAL
  zh: '#2 计算北美线的最后一个值'
- en: '#3 Calculates the last value for the other line'
  id: totrans-340
  prefs: []
  type: TYPE_NORMAL
  zh: '#3 计算其他线的最后一个值'
- en: '#4 Draws the vertical line'
  id: totrans-341
  prefs: []
  type: TYPE_NORMAL
  zh: '#4 绘制垂直线'
- en: '#5 Places the BAN at the middle of the vertical line'
  id: totrans-342
  prefs: []
  type: TYPE_NORMAL
  zh: '#5 将BAN放置在垂直线的中间'
- en: '#6 Draws the BAN'
  id: totrans-343
  prefs: []
  type: TYPE_NORMAL
  zh: '#6 绘制BAN'
- en: '#7 Combines the charts'
  id: totrans-344
  prefs: []
  type: TYPE_NORMAL
  zh: '#7 合并图表'
- en: Note  Use the last data points of the lines of the continents as y-coordinates
    for the vertical line and the BAN. We have hardcoded the BAN value for simplicity.
    However, you can dynamically calculate it in a complex scenario.
  id: totrans-345
  prefs: []
  type: TYPE_NORMAL
  zh: 注意：使用大陆线的最后数据点的y坐标作为垂直线和BAN的y坐标。为了简单起见，我们硬编码了BAN值。然而，在复杂场景中，您可以动态计算它。
- en: Data source
  id: totrans-346
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 数据源
- en: Place the data source as a textual annotation immediately under the title.
  id: totrans-347
  prefs: []
  type: TYPE_NORMAL
  zh: 将数据源作为文本注释立即放置在标题下方。
- en: Listing 3.31 Adding the data source
  id: totrans-348
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表3.31 添加数据源
- en: '[PRE30]'
  id: totrans-349
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: Note  Use the `mark_text()` mark to add a text to the chart. Also, set the `href`
    channel to the link to the data source.
  id: totrans-350
  prefs: []
  type: TYPE_NORMAL
  zh: 注意：使用`mark_text()`标记向图表添加文本。同时，将`href`通道设置为数据源的链接。
- en: Text annotation
  id: totrans-351
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 文本注释
- en: Place the text annotation to the left of the graph to prepare your audience
    for the chart. The text explains the possible causes of the gap between North
    America and the other continents. The following listing describes how to add a
    text annotation to the chart.
  id: totrans-352
  prefs: []
  type: TYPE_NORMAL
  zh: 将文本注释放置在图表左侧，为观众准备图表。文本解释了北美与其他大陆之间差距的可能原因。以下列表描述了如何向图表添加文本注释。
- en: Listing 3.32 Adding a text annotation
  id: totrans-353
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表3.32 添加文本注释
- en: '[PRE31]'
  id: totrans-354
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: Note  Use `mark_text()` to draw the text. Then, combine the text annotation
    with the chart.
  id: totrans-355
  prefs: []
  type: TYPE_NORMAL
  zh: 注意：使用`mark_text()`绘制文本。然后，将文本注释与图表结合。
- en: Figure 3.17 shows the resulting chart at the end of the knowledge step.
  id: totrans-356
  prefs: []
  type: TYPE_NORMAL
  zh: 图3.17显示了知识步骤结束时的结果图表。
- en: '![figure](../Images/3-17.png)'
  id: totrans-357
  prefs: []
  type: TYPE_IMG
  zh: '![figure](../Images/3-17.png)'
- en: Figure 3.17 The chart at the end of the knowledge step
  id: totrans-358
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图3.17 知识步骤结束时的图表
- en: 'The chart is almost ready. Let us proceed to the last step: turning knowledge
    into wisdom.'
  id: totrans-359
  prefs: []
  type: TYPE_NORMAL
  zh: 图表几乎准备好了。让我们进行最后一步：将知识转化为智慧。
- en: 3.3.3 From knowledge to wisdom
  id: totrans-360
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 3.3.3 从知识到智慧
- en: Turning knowledge into wisdom involves adding a call to action. In the previous
    chapters, we added a simple call to action in the title, inviting the audience
    to do something. However, in a real scenario, the call to action must include
    a proposal of possible next steps, justified with appropriate resources. The next
    step invites the audience to do something concrete; thus, the situation depicted
    in the chart changes. For example, you can add the call to action as an additional
    chart, which describes the percentage of success of each possible alternative.
    In our example, we can add a bar chart with possible strategies to improve population
    growth in North America. The percentages in the example are imaginary and do not
    reflect reality—we’ve added them just to show how a call to action works. The
    following listing shows how to build the call to action as a bar chart and add
    it to the main chart.
  id: totrans-361
  prefs: []
  type: TYPE_NORMAL
  zh: 将知识转化为智慧涉及添加行动号召。在前面的章节中，我们在标题中添加了一个简单的行动号召，邀请观众做某事。然而，在实际场景中，行动号召必须包括对可能下一步的提议，并辅以适当的资源进行论证。下一步邀请观众做具体的事情；因此，图表所描述的情况发生了变化。例如，你可以添加行动号召作为额外的图表，描述每个可能替代方案的成功率。在我们的例子中，我们可以添加一个条形图，描述提高北美人口增长的可能策略。示例中的百分比是虚构的，并不反映现实——我们只是添加它们来展示行动号召是如何工作的。以下列表展示了如何构建行动号召作为条形图并将其添加到主图表中。
- en: Listing 3.33 Adding a call to action
  id: totrans-362
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表3.33 添加行动号召
- en: '[PRE32]'
  id: totrans-363
  prefs: []
  type: TYPE_PRE
  zh: '[PRE32]'
- en: Note  Draw a chart specifying the possible alternatives and their percentage
    of success.
  id: totrans-364
  prefs: []
  type: TYPE_NORMAL
  zh: 备注：绘制一个图表，指定可能的替代方案及其成功率。
- en: Figure 3.18 shows the final chart. Following the steps specified by the DIKW,
    we have transformed the raw chart of figure 3.11 into a data story.
  id: totrans-365
  prefs: []
  type: TYPE_NORMAL
  zh: 图3.18展示了最终图表。按照DIKW的步骤，我们将图3.11的原始图表转换成了数据故事。
- en: '![figure](../Images/3-18.png)'
  id: totrans-366
  prefs: []
  type: TYPE_IMG
  zh: '![图表](../Images/3-18.png)'
- en: Figure 3.18 The final chart at the end of the wisdom step
  id: totrans-367
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图3.18 智慧步骤结束时的最终图表
- en: In this chapter, you have learned the basic concepts of Altair. In the next
    chapter, you’ll review the basic concepts of generative AI.
  id: totrans-368
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，你学习了Altair的基本概念。在下一章，你将复习生成式AI的基本概念。
- en: Summary
  id: totrans-369
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 摘要
- en: Vega and Vega-Lite are visualization grammars to define the visual aspects and
    interactive features of a chart by writing code in JSON format.
  id: totrans-370
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Vega和Vega-Lite是可视化语法，通过在JSON格式中编写代码来定义图表的视觉方面和交互功能。
- en: Altair is built at the top of Vega-Lite and offers a user-friendly API to build
    charts. The basic components of an Altair chart are encodings, marks, conditions,
    compound charts, interactivity, and configurations.
  id: totrans-371
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Altair建立在Vega-Lite之上，提供了一个用户友好的API来构建图表。Altair图表的基本组件包括编码、标记、条件、复合图表、交互性和配置。
- en: Encodings define how data attributes (like x-coordinates, y-coordinates, color,
    and size) are visually represented in the chart.
  id: totrans-372
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 编码定义了数据属性（如x坐标、y坐标、颜色和大小）如何在图表中视觉表示。
- en: Marks are the visual elements in the chart, such as bars, points, lines, or
    areas.
  id: totrans-373
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 标记是图表中的视觉元素，如条形、点、线或区域。
- en: Conditions specify how data attributes are mapped to visual properties based
    on different criteria.
  id: totrans-374
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 条件指定了根据不同标准如何将数据属性映射到视觉属性。
- en: Compound charts involve combining multiple charts into a single view.
  id: totrans-375
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 复合图表涉及将多个图表组合成一个单一视图。
- en: Interactivity refers to the ability of the chart to respond or change based
    on user input or interactions.
  id: totrans-376
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 交互性指的是图表根据用户输入或交互做出响应或改变的能力。
- en: Configurations encompass various settings to alter the appearance of the chart,
    such as adjusting axes, scales, or layout, to better convey the intended information
    or aesthetics.
  id: totrans-377
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 配置包括各种设置，用于改变图表的外观，例如调整坐标轴、刻度或布局，以更好地传达预期的信息或美学。
- en: References
  id: totrans-378
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 参考文献
- en: Data visualization
  id: totrans-379
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 数据可视化
- en: Belorkar, A., Guntuku, S. C., Hora, S., and Kumar, A. (2020). *Interactive Data
    Visualization with Python*. Packt Publishing.
  id: totrans-380
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Belorkar, A., Guntuku, S. C., Hora, S., 和 Kumar, A. (2020). *使用Python进行交互式数据可视化*.
    Packt Publishing.
- en: Abbott, D. (2024). *Everyday Data Visualization*. Manning Publications.
  id: totrans-381
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Abbott, D. (2024). *日常数据可视化*. Manning Publications.
- en: Vega, Vega-Lite, and D3.js
  id: totrans-382
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: Vega, Vega-Lite, 和 D3.js
- en: Kats, P. and Katz, D. (2019). *Learn Python by Building Data Science Applications*.
    Packt Publications.
  id: totrans-383
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Kats, P. 和 Katz, D. (2019). *通过构建数据科学应用学习Python*. Packt Publications.
- en: Meeks, E. and Dufour, A.M. (2024). *D3.js in Action*. Manning Publications.
  id: totrans-384
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Meeks, E. 和 Dufour, A.M. (2024). *D3.js实战*. Manning Publications.
- en: '*Vega: A Visualization Grammar*. (n.d.). [https://vega.github.io/vega/](https://vega.github.io/vega/).'
  id: totrans-385
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Vega：可视化语法*. (n.d.). [https://vega.github.io/vega/](https://vega.github.io/vega/).'
- en: '*Vega-Lite: A Grammar of Interactive Graphics*. (n.d.). [https://vega.github.io/vega-lite/](https://vega.github.io/vega-lite/).'
  id: totrans-386
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Vega-Lite：交互式图形语法*. (n.d.). [https://vega.github.io/vega-lite/](https://vega.github.io/vega-lite/).'
- en: Other
  id: totrans-387
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 其他
- en: 'Knaflic, C. N. (2015). Storytelling with Data: A Data Visualization Guide for
    Business Professionals. John Wiley & Sons.'
  id: totrans-388
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Knaflic, C. N. (2015). 数据讲故事：商业专业人士的数据可视化指南. 约翰·威利与儿子公司。
