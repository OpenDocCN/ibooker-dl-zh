- en: Chapter 3\. Bug Detection and Code Review
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第3章\. 错误检测和代码审查
- en: Imagine paying the highest salaries in a company to software engineers to develop
    a product that will be responsible for the company’s revenue, only to lose that
    revenue due to costly bugs in production. This is any business owner’s worst nightmare,
    and sadly it happens every day. Software has automated whole industries, replacing
    lengthy manual processes and creating new ways to do previously impossible things.
    However, automation can’t be effective when bugs detract from the underlying products’
    key functionalities.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 想象一下，为了开发一个将负责公司收入的产品，支付公司最高薪酬给软件工程师，结果却因为生产中的昂贵错误而损失了这笔收入。这是任何企业主最可怕的噩梦，而且遗憾的是，这种情况每天都在发生。软件已经自动化了整个行业，取代了耗时的手动流程，并创造了以前不可能完成的事情的新方法。然而，当错误影响了底层产品的关键功能时，自动化就变得无效。
- en: 'To mitigate this fundamental concern, several job titles have been created
    over the years to guarantee proper quality assurance (QA), such as QA engineer,
    QA analyst, and test engineer. Processes, too, have been developed to detect bugs
    before they get deployed to production. Those processes boil down to two main
    categories:'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 为了缓解这种基本担忧，多年来已经创建了几个职位来确保适当的质量保证（QA），例如QA工程师、QA分析师和测试工程师。同时，也开发了在部署到生产之前检测错误的过程。这些过程归结为两大类：
- en: Code reviews
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 代码审查
- en: This process is done during development, and it consists of team members reviewing
    each other’s code before it is deemed ready to go live. Some teams mandate a minimum
    number of team members who must review and approve a pull request (PR) before
    it can be merged.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 这个过程是在开发期间进行的，它包括在代码被认为可以上线之前，团队成员相互审查代码。一些团队要求必须有一定数量的团队成员审查和批准拉取请求（PR），然后才能合并。
- en: Quality assurance
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 质量保证
- en: This process is done after development as the last “gatekeeper” before code
    gets pushed to production. It consists of manual or automated tests done in an
    environment that closely matches production. These tests aim to mimic users’ behavior
    to catch any bug that could have escaped a code review.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 这个过程是在开发之后进行的，是代码推向生产前的最后一个“守门人”。它包括在接近生产环境的测试环境中进行的手动或自动化测试。这些测试旨在模拟用户行为，以捕捉任何可能逃过代码审查的错误。
- en: When either process finds any bugs, performance issues, security vulnerabilities,
    or other malfunctions, the code can be *regressed;* that is, it goes back to the
    software engineer who developed it, along with a comment containing the specific
    deficiencies that must be corrected.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 当任一过程发现任何错误、性能问题、安全漏洞或其他故障时，代码可以被*回滚；*也就是说，它将返回给开发它的软件工程师，并附有包含必须纠正的具体缺陷的注释。
- en: These processes are critical to any software development team, yet they are
    often very lengthy and nondeterministic, introducing bottlenecks while not fully
    delivering on the vision of preventing bugs from showing up in production. As
    such, as AI tools have come into existence, the industry has seen a big focus
    on automating code reviews and making the process of detecting bugs much faster
    and more deterministic. Thousands of software engineering teams are already using
    AI-based automated code-review tools.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 这些过程对于任何软件开发团队来说都至关重要，但它们通常非常耗时且非确定性，在防止生产中出现错误方面并未完全实现预期效果，反而引入了瓶颈。因此，随着人工智能工具的出现，该行业对自动化代码审查和使检测错误的过程更快、更确定性的关注大大增加。成千上万的软件工程团队已经使用基于人工智能的自动化代码审查工具。
- en: Types of AI Code-Review Tools
  id: totrans-9
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 人工智能代码审查工具的类型
- en: The AI tools reviewed for this chapter fall into three main categories, with
    slightly different usage in software development. Some of the tools reviewed offer
    more than one type of functionality.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 本章审查的人工智能工具主要分为三个主要类别，在软件开发中的使用略有不同。一些审查的工具提供不止一种功能。
- en: IDE-based tools
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 基于IDE的工具
- en: 'IDE-based tools integrate directly into the software development environment
    that engineers use to write code, such as Visual Studio Code, IntelliJ IDEA, or
    Eclipse. These tools provide real-time feedback as developers write code: highlighting
    errors, suggesting improvements, and providing documentation links directly in
    the IDE. Of the three types of tools described here, this is the only type that
    provides feedback when the code is saved locally. This immediate feedback loop
    helps developers identify and fix issues on the spot, improving code quality and
    reducing the need for extensive reviews later.'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 基于IDE的工具直接集成到工程师编写代码时使用的软件开发环境中，例如Visual Studio Code、IntelliJ IDEA或Eclipse。这些工具在开发者编写代码时提供实时反馈：突出显示错误、建议改进，并在IDE中直接提供文档链接。在这三种描述的工具中，这是唯一一种在代码本地保存时提供反馈的工具。这种即时的反馈循环有助于开发者立即识别和修复问题，提高代码质量并减少后期进行广泛审查的需求。
- en: Git-based tools
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 基于Git的工具
- en: Git-based tools integrate with version-control systems, such as GitHub, GitLab,
    or Bitbucket, and operate within the Git workflow. Unlike IDE-based tools, Git-based
    tools can’t be triggered by local saves of a file, only by actions in the Git
    workflow. You can set them up to review code automatically whenever you push changes
    to a repository or create or merge a PR. These tools check the code against predefined
    rules and guidelines and can enforce coding standards across all branches of the
    codebase. They typically provide feedback in the form of comments in PRs or reports
    in a continuous integration pipeline, helping ensure code quality before merging
    changes into the main branch.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 基于Git的工具与版本控制系统（如GitHub、GitLab或Bitbucket）集成，并在Git工作流程中运行。与基于IDE的工具不同，基于Git的工具不能由文件的本地保存触发，只能由Git工作流程中的操作触发。您可以设置它们在您将更改推送到存储库或创建或合并PR时自动审查代码。这些工具将代码与预定义的规则和指南进行比较，并可以在代码库的所有分支上强制执行编码标准。它们通常以PR中的注释或持续集成管道中的报告的形式提供反馈，有助于在将更改合并到主分支之前确保代码质量。
- en: Browser-based tools
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 基于浏览器的工具
- en: These tools are accessible through web browsers and typically integrate with
    online version-control platforms like GitHub, GitLab, and Bitbucket. Like Git-based
    tools, they can only be triggered by changes in the Git workflow, not local changes.
    You can use these browser-based tools to get automatic reviews of your PRs or
    code merges online. When you submit a PR, the tool reviews the code for errors,
    style violations, and security vulnerabilities, then provides feedback on that
    PR via the web interface in the browser. I find this the least convenient of the
    three types of tools presented here, since it requires you to use another platform
    besides the IDE and version-control tools you are already familiar with.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 这些工具可以通过网络浏览器访问，通常与在线版本控制平台如GitHub、GitLab和Bitbucket集成。与基于Git的工具类似，它们只能由Git工作流程中的更改触发，而不是本地更改。您可以使用这些基于浏览器的工具在线自动审查您的PR或代码合并。当您提交PR时，该工具会审查代码中的错误、样式违规和安全漏洞，然后通过浏览器中的Web界面提供对该PR的反馈。我发现这是这里介绍的这三种工具中最不方便的，因为它要求您使用除您已经熟悉的IDE和版本控制工具之外的另一个平台。
- en: 'It’s also important to differentiate between linters, static analysis tools,
    and AI-powered code-analysis tools:'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 还很重要的一点是要区分linters、静态分析工具和AI驱动的代码分析工具：
- en: Linters
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: Linters
- en: These are the simplest of these tools, focusing primarily on enforcing coding
    standards and styles. They scan code to identify syntax errors, stylistic inconsistencies,
    and basic programming errors. Linters like [ESLint for JavaScript](https://eslint.org)
    and [Pylint for Python](https://oreil.ly/-wu0d) are integrated into development
    environments, providing real-time feedback to correct issues like indentation,
    bracket placement, and line length.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 这些是最简单的工具，主要专注于强制执行编码标准和样式。它们扫描代码以识别语法错误、样式不一致和基本的编程错误。像[ESLint for JavaScript](https://eslint.org)和[Pylint
    for Python](https://oreil.ly/-wu0d)这样的linters被集成到开发环境中，提供实时反馈以纠正诸如缩进、括号放置和行长度等问题。
- en: Static analysis tools
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 静态分析工具
- en: These tools delve deeper, analyzing code without executing it in order to detect
    potential bugs, security vulnerabilities, and performance issues. Static analysis
    tools, such as [SonarQube](https://oreil.ly/wrZII), understand control flow, data
    flow, and variable scopes, making them capable of identifying complex issues like
    memory leaks and concurrency problems. They are commonly integrated into CI/CD
    pipelines, helping to maintain code health across projects.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 这些工具深入分析代码，而不执行它，以检测潜在的错误、安全漏洞和性能问题。静态分析工具，如[SonarQube](https://oreil.ly/wrZII)，理解控制流、数据流和变量作用域，能够识别复杂的错误，如内存泄漏和并发问题。它们通常集成到CI/CD管道中，帮助维护项目间的代码健康。
- en: AI-powered code analysis
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: AI驱动的代码分析
- en: These tools use machine learning to analyze coding patterns across many projects,
    identifying complex issues and suggesting improvements. AI analysis tools, like
    DeepCode and Codacy, provide context-aware suggestions and can predict the impact
    of code changes, offering optimization tips learned from vast datasets.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 这些工具使用机器学习分析多个项目中的编码模式，识别复杂问题并提出改进建议。AI分析工具，如DeepCode和Codacy，提供上下文感知的建议，并可以预测代码更改的影响，提供从大量数据集中学习到的优化技巧。
- en: Due to the scope of this book, I’ll only cover this last type of tool, AI-powered
    code analysis.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 由于本书的范围，我将只介绍最后一种工具，即AI驱动的代码分析。
- en: Use Cases
  id: totrans-25
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 用例
- en: 'The millions of software engineers who are already using AI tools for automated
    code reviews and bug detection find that they bring obvious benefits across a
    range of daily use cases. These include:'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 已经使用AI工具进行自动化代码审查和错误检测的数百万软件工程师发现，它们在一系列日常用例中带来了明显的益处。这包括：
- en: Educating software engineers
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 培训软件工程师
- en: Automated code-review tools provide software engineers, especially more junior
    ones, with a 24/7 pair programmer that points out bugs, offers suggestions, and
    above all gives context and reasoning for its suggestions. This is a great tool
    to hone your skills. Feedback loops are much more frequent with an automated tool
    than with normal code reviews by team members, increasing exposure to learning
    opportunities about the language, framework, or algorithm in question. This is
    extra beneficial for junior developers and for engineers switching to new tech
    stacks or working with a framework for the first time, since lack of experience
    makes mistakes more common. In code reviews, errors can be regressed with a message
    that helps the developer understand the mistake and avoid it next time.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 自动化代码审查工具为软件工程师，尤其是更年轻的工程师，提供了一个全天候的配对程序员，它能指出错误、提供建议，最重要的是为其建议提供上下文和推理。这是一个磨练技能的绝佳工具。与团队成员的正常代码审查相比，自动化工具的反馈循环更加频繁，增加了关于所讨论的语言、框架或算法的学习机会。这对初级开发人员和转向新技术栈或首次使用框架的工程师特别有益，因为缺乏经验使得错误更加常见。在代码审查中，错误可以通过帮助开发者理解错误并避免下次再犯的消息进行回归。
- en: Increasing software development velocity
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 提高软件开发速度
- en: Automating code review reduces the number of PR regressions. It also tremendously
    reduces the amount of time between the code being written and the review identifying
    issues to be fixed. Automatic code reviews at every change can point out vulnerabilities
    and improvements so that developers can fix them immediately. This eliminates
    the cycle of pushing faulty code only for other team members to find and regress
    it—a cycle of multiple regression loops that cost individual developers time and
    delay shipping features to production.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 自动化代码审查减少了PR回归的数量。它还极大地减少了代码编写和审查识别需要修复的问题之间的时间。每次更改时的自动代码审查都可以指出漏洞和改进，以便开发者可以立即修复它们。这消除了仅推送有缺陷的代码，而其他团队成员发现并回归它的循环——这是一个多回归循环的周期，浪费了个人开发者的时间，并延迟了将功能部署到生产中。
- en: Reducing tech debt
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 减少技术债务
- en: Many times, code reviews overlook security vulnerabilities and performance issues
    because they don’t usually impact functionality, which is objectively the biggest
    focus of any code review. Even when they are detected, they aren’t often treated
    as cause for regression. Instead, they often go into a “nice to have” note, effectively
    adding the vulnerability or issue to the pile of tech debt. That pile usually
    accumulates for a long time, until it becomes unsustainable and requires extensive
    refactoring of the codebase.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 很多次，代码审查忽略了安全漏洞和性能问题，因为它们通常不会影响功能，而功能是任何代码审查客观上最大的关注点。即使它们被检测到，也通常不会被视为回归的原因。相反，它们通常会被归入“最好有”的备注中，实际上是将漏洞或问题添加到技术债务的堆中。这个堆通常积累很长时间，直到它变得不可持续，需要大量重构代码库。
- en: Adding depth to code reviews
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 为代码审查增加深度
- en: Most of the code-review tools mentioned in this chapter focus on security vulnerabilities
    and often point out occurrences of OWASP Top 10 vulnerabilities in code, along
    with suggestions for resolving them. Team code reviews rarely reach this level
    of depth; such vulnerabilities are often only detected much later (if ever), during
    professional security audits or penetration-testing reports. Using these tools
    allows teams to detect security vulnerabilities much earlier.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 本章提到的大多数代码审查工具都专注于安全漏洞，并且经常指出代码中OWASP Top 10漏洞的发生，并提供了解决建议。团队代码审查很少达到这种深度；这种漏洞通常只有在专业安全审计或渗透测试报告中（如果有的话）才被检测到。使用这些工具可以让团队更早地发现安全漏洞。
- en: Keeping the Human Review
  id: totrans-35
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 保持人工审查
- en: A common criticism of automated code-review tools is that they discourage (human)
    team members from performing code reviews in a timely manner. To be fair, code
    reviews were a dreaded activity in many teams long before AI tools came into existence.
    Software engineers frequently forget to review their peers’ pull requests or leave
    a positive review message of “lgtm” (short for “looks good to me”) just to unblock
    a feature deployment.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 自动化代码审查工具的一个常见批评是它们会阻碍（人工）团队成员及时进行代码审查。公平地说，在AI工具出现之前，代码审查在很多团队中就已经是一个令人讨厌的活动。软件工程师经常忘记审查他们的同事的拉取请求，或者只留下一个积极的审查信息“lgtm”（即“看起来不错”）来解除功能部署的阻塞。
- en: AI tools add tremendous immediacy to the code-review process. This reassures
    software engineers that their code has a high quality standard, but it also leaves
    them feeling less urgency to review their peers’ code, believing the AI tool has
    already done that job for them.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: AI工具为代码审查过程增添了极大的即时性。这使软件工程师确信他们的代码达到了高标准，但它也让他们感到不那么迫切地审查同事的代码，认为AI工具已经为他们完成了这项工作。
- en: This is a very fair criticism, in my opinion. *AI code reviews don’t replace
    human code reviews*, especially those performed by senior engineers who know both
    a feature’s technology and the business and use cases for it. This is the angle
    that is manifestly missing in AI code reviews. The AI tool misses the *context*
    behind the code being reviewed and the intent behind certain code segments. This
    can lead it to make irrelevant suggestions or fail to identify context-specific
    issues that might be obvious to a human reviewer. This is a key reason why you
    should *never skip human code reviews*, even if you’re also using automated code
    reviews.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 我认为这是一个非常公正的批评。*AI代码审查不能取代人工代码审查*，尤其是那些由既了解技术又了解业务和用例的高级工程师进行的审查。这是AI代码审查明显缺乏的角度。AI工具错过了正在审查的代码背后的*上下文*和某些代码段背后的意图。这可能导致它提出不相关的建议或未能识别出对人类审查员来说可能显而易见的具体上下文问题。这是你应该*永远不要跳过人工代码审查*的关键原因，即使你也在使用自动代码审查。
- en: It’s also worth noting that the language used to market these automated code-review
    tools is quite different from that used for the code-generation tools reviewed
    in the previous chapter. Few of the tools discussed in this chapter mention AI
    in their marketing copy much (or at all), despite the fact that the products do
    use AI algorithms (e.g., Codacy).
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 值得注意的是，用于宣传这些自动代码审查工具的语言与上一章中审查的代码生成工具所使用的语言相当不同。本章讨论的工具中很少有在营销文案中提及AI（或根本不提），尽管这些产品确实使用了AI算法（例如，Codacy）。
- en: 'There are two reasons for this. Several of these tools existed in the market
    for years before the recent popularity of AI. However, many position themselves
    as a backstop to issues found in AI-generated code. [Sonar](https://oreil.ly/ODAHw),
    for example, promises to minimize risk, ensure code quality, and derive more value
    from code created by both AI and humans. As the website copy states: “To maximize
    the advantages of generative AI in coding, developer teams need robust DevOps
    processes, reporting, and metrics that focus on code quality, security, and reliability.”'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 有两个原因。这些工具中的许多在 AI 近期流行之前已经在市场上存在多年。然而，许多将自己定位为 AI 生成代码中问题的后备方案。[Sonar](https://oreil.ly/ODAHw)
    例如，承诺最小化风险，确保代码质量，并从 AI 和人类创建的代码中获得更多价值。正如网站文案所述：“为了最大化编码中生成 AI 的优势，开发团队需要强大的
    DevOps 流程、报告和指标，这些流程、报告和指标专注于代码质量、安全性和可靠性。”
- en: Evaluation Process
  id: totrans-41
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 评估过程
- en: 'I evaluated more than 20 automated code-review tools in order to shortlist
    the ones I highlight in this chapter. Every tool covered here meets the following
    criteria:'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 为了缩小范围，我评估了超过 20 个自动代码审查工具，以便突出本章中提到的工具。这里涵盖的每个工具都符合以下标准：
- en: It is a professional project with a competent team behind it.
  id: totrans-43
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 它是一个由有能力的团队支持的专业项目。
- en: The code it generates has a high quality threshold.
  id: totrans-44
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 它生成的代码具有高质量标准。
- en: It offers some level of functionality for free or on a trial basis.
  id: totrans-45
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 它提供了一定程度的免费或试用版功能。
- en: It has a high level of adoption at the time of writing (mid-2025).
  id: totrans-46
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在撰写本文时（2025 年中），它具有很高的采用率。
- en: In order to select and compare AI tools for this chapter, I created a simple
    JavaScript program and introduced four issues into the code. You can review the
    full code in the book’s [GitHub repository](https://github.com/sergiopereira-io/oreilly_book),
    inside the folder named “[Chapter 3](#ch03_bug_detection_and_code_review_1749441076008122).”
    [Example 3-1](#ch03_example_1_1749441076005830) provides the most relevant snippet,
    with each of the four issues commented for clarity. I ran the exact same code
    through each of the tools reviewed in this chapter, which discusses the results
    each tool provided.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 为了选择和比较本章的 AI 工具，我创建了一个简单的 JavaScript 程序，并在代码中引入了四个问题。您可以在书的 [GitHub 仓库](https://github.com/sergiopereira-io/oreilly_book)
    中查看完整的代码，在名为 “[第 3 章](#ch03_bug_detection_and_code_review_1749441076008122)” 的文件夹内。[示例
    3-1](#ch03_example_1_1749441076005830) 提供了最相关的代码片段，每个问题都有注释以供清晰理解。我使用本章讨论的每个工具运行了完全相同的代码，讨论了每个工具提供的结果。
- en: Example 3-1\. Code snippet for the tests of code-review tools
  id: totrans-48
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 示例 3-1\. 代码审查工具测试代码片段
- en: '[PRE0]'
  id: totrans-49
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'Before we dive in, here is a brief explanation of each of the errors I introduced
    and why it would be important to catch them in a code review:'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们深入探讨之前，这里是对我引入的每个错误及其为何在代码审查中捕捉到它们很重要的简要说明：
- en: SQL injection vulnerability
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: SQL 注入漏洞
- en: This vulnerability arises from incorporating user input directly into a SQL
    query without any form of validation or sanitization. In the provided code, the
    variable `requestData.username` is directly concatenated into the SQL query string.
    This approach lets attackers craft user inputs that manipulate the SQL query to
    perform unauthorized actions, like accessing, modifying, or deleting data. For
    instance, an attacker could provide a username input like `' OR '1'='1`, which
    could alter the query logic to return all users in the system, thereby breaching
    data privacy.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 这种漏洞源于在没有任何形式的验证或清理的情况下，直接将用户输入合并到 SQL 查询中。在提供的代码中，变量 `requestData.username`
    直接连接到 SQL 查询字符串。这种方法允许攻击者构建用户输入，以操纵 SQL 查询执行未经授权的操作，如访问、修改或删除数据。例如，攻击者可以提供一个用户名输入如
    `' OR '1'='1`，这可能会改变查询逻辑以返回系统中的所有用户，从而侵犯数据隐私。
- en: Cross-site scripting
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 跨站脚本
- en: '*Cross-site scripting* (XSS) occurs when an application includes untrusted
    data, typically from user inputs, within the content of its web pages without
    proper validation or escaping. In the script, `requestData.userInput` is directly
    included in an HTML response structure sent back to the client. If this user input
    includes malicious JavaScript code, the browser could execute that unauthorized
    script, leading to session hijacking, personal data theft, or malicious redirection.'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: '*跨站脚本* (XSS) 发生在应用程序在其网页内容中包含未经信任的数据时，通常来自用户输入，而没有进行适当的验证或转义。在脚本中，`requestData.userInput`
    直接包含在发送回客户端的 HTML 响应结构中。如果这个用户输入包含恶意 JavaScript 代码，浏览器可能会执行这个未经授权的脚本，导致会话劫持、个人数据盗窃或恶意重定向。'
- en: Memory leak
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 内存泄漏
- en: '*Memory leaks* in web applications can occur when memory that is no longer
    needed is not released back to the system. In the example, a large number of event
    listeners are created within a loop but are never removed. Each listener retains
    a closure scope that may consume more memory. Over time, especially in long-running
    applications like servers, these listeners accumulate, occupying an increasing
    amount of memory. This can potentially exhaust available resources and lead to
    performance degradation or crashes.'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 在网络应用程序中，当不再需要的内存未释放回系统时，可能会发生*内存泄漏*。在示例中，在循环内创建了大量的事件监听器，但从未被移除。每个监听器保留了一个闭包作用域，可能会消耗更多内存。随着时间的推移，尤其是在像服务器这样的长时间运行的应用程序中，这些监听器会积累，占用越来越多的内存。这可能会耗尽可用资源，导致性能下降或崩溃。
- en: Inefficient loop
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 不高效的循环
- en: The loop in the example code inefficiently performs a large number of iterations
    to compute the sum of all integers from 0 to 99,999\. Each iteration involves
    performing arithmetic operations and updating a local variable. Although these
    actions are relatively simple, they are unnecessarily repeated many times. This
    not only consumes CPU cycles, but it could also block the event loop in a Node.js
    environment, leading to delays in processing other incoming requests or operations.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 示例代码中的循环以低效的方式执行了大量的迭代，以计算从 0 到 99,999 的所有整数的总和。每次迭代都涉及执行算术运算和更新局部变量。尽管这些操作相对简单，但它们被不必要地重复多次。这不仅消耗了
    CPU 周期，还可能在 Node.js 环境中阻塞事件循环，导致处理其他传入请求或操作的延迟。
- en: Now let’s dive into the top-performing AI code-review tools I tried.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们深入了解我尝试过的表现最佳的 AI 代码审查工具。
- en: Codacy
  id: totrans-60
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Codacy
- en: '[Codacy](https://www.codacy.com) is a startup based in Portugal that launched
    an automated code-review tool in 2012\. The product has evolved significantly
    over the years and is now a market-leading solution that leverages AI to “help
    developers identify and fix issues within their code, improving code quality and
    reducing technical debt, with support for more than 40 programming languages and
    seamless integrations with GitHub, Bitbucket, and GitLab,” as per the copy on
    its website.'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: '[Codacy](https://www.codacy.com) 是一家位于葡萄牙的初创公司，于 2012 年推出了一款自动代码审查工具。该产品在多年中经历了显著的发展，现在已成为市场上领先的解决方案，它利用人工智能来“帮助开发者识别和修复代码中的问题，提高代码质量并减少技术债务，支持超过
    40 种编程语言，并与 GitHub、Bitbucket 和 GitLab 无缝集成，”正如其网站上的说明。'
- en: Codacy’s AI tool analyzes code for potential errors, style violations, security
    vulnerabilities, and performance issues, and it provides software engineers with
    suggestions for improvement. The tool is designed to learn from past reviews,
    adapting to the specific standards and practices of each development team.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: Codacy 的 AI 工具分析代码以查找潜在的错误、样式违规、安全漏洞和性能问题，并为软件工程师提供改进建议。该工具旨在从过去的审查中学习，适应每个开发团队的特定标准和实践。
- en: By automating the code-review process, Codacy helps developers focus more on
    building features rather than fixing issues, ultimately speeding up the development
    cycle and enhancing code maintainability.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 通过自动化代码审查流程，Codacy 帮助开发者更多地专注于构建功能，而不是修复问题，从而加快开发周期并提高代码的可维护性。
- en: Practical example
  id: totrans-64
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 实际示例
- en: I created an account with Codacy using my GitHub account and ran the tool on
    the code shown earlier in this chapter (which you can review in full in the book’s
    [GitHub repository](https://github.com/sergiopereira-io/oreilly_book)).
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 我使用我的 GitHub 账户在 Codacy 上创建了一个账户，并在本章前面显示的代码上运行了该工具（您可以在本书的 [GitHub 仓库](https://github.com/sergiopereira-io/oreilly_book)
    中完整查看）。
- en: Codacy correctly identified issue number 1, the SQL Injection vulnerability,
    and labeled its severity as “Critical,” the highest level in its ranking, as seen
    in [Figure 3-1](#ch03_figure_1_1749441076000331).
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: Codacy 正确识别了问题编号 1，即 SQL 注入漏洞，并将其严重性标记为“关键”，这是其排名中的最高级别，如 [图 3-1](#ch03_figure_1_1749441076000331)
    所示。
- en: '![](assets/gasd_0301.png)'
  id: totrans-67
  prefs: []
  type: TYPE_IMG
  zh: '![图片](assets/gasd_0301.png)'
- en: Figure 3-1\. Codacy identified the SQL injection vulnerability
  id: totrans-68
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 3-1\. Codacy 识别了 SQL 注入漏洞
- en: Codacy provides an expandable section with an explanation of what the error
    is, why it’s dangerous, and how to solve it ([Figure 3-2](#ch03_figure_2_1749441076000361)).
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: Codacy 提供了一个可展开的部分，其中解释了错误是什么，为什么它危险，以及如何解决它（[图 3-2](#ch03_figure_2_1749441076000361)）。
- en: '![](assets/gasd_0302.png)'
  id: totrans-70
  prefs: []
  type: TYPE_IMG
  zh: '![图片](assets/gasd_0302.png)'
- en: Figure 3-2\. Codacy explained the SQL injection vulnerability
  id: totrans-71
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 3-2\. Codacy 解释了 SQL 注入漏洞
- en: Codacy also correctly identified issue 2, the XSS vulnerability, and labeled
    it as “Medium” severity (Figures [3-3](#ch03_figure_3_1749441076000379) and [3-4](#ch03_figure_4_1749441076000395)).
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: Codacy还正确地识别了2号问题，即跨站脚本（XSS）漏洞，并将其标记为“中等”严重性（见图[3-3](#ch03_figure_3_1749441076000379)和[3-4](#ch03_figure_4_1749441076000395))）。
- en: '![](assets/gasd_0303.png)'
  id: totrans-73
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/gasd_0303.png)'
- en: Figure 3-3\. Codacy identified the XSS vulnerability
  id: totrans-74
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图3-3\. Codacy识别了XSS漏洞
- en: As seen in [Figure 3-4](#ch03_figure_4_1749441076000395), Codacy clearly explained
    this XSS vulnerability.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 如[图3-4](#ch03_figure_4_1749441076000395)所示，Codacy清楚地解释了这种XSS漏洞。
- en: '![](assets/gasd_0304.png)'
  id: totrans-76
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/gasd_0304.png)'
- en: Figure 3-4\. Codacy explained the XSS vulnerability
  id: totrans-77
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图3-4\. Codacy解释了XSS漏洞
- en: Codacy’s analysis didn’t identify issues 3 and 4, which are more related to
    performance than to security.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: Codacy的分析没有识别出3和4号问题，这些问题更多地与性能相关，而不是与安全相关。
- en: All of this feedback was provided on Codacy’s website immediately after I connected
    my GitHub account and selected the repository I wanted to have analyzed. However,
    after I opened a PR on that same repository, Codacy performed a second level of
    analysis directly in the repository.
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 所有这些反馈都是在我将GitHub账户连接并选择要分析的仓库后立即在Codacy网站上提供的。然而，在我为该仓库打开一个PR之后，Codacy直接在仓库中进行了第二次级别的分析。
- en: Most of the errors it identified reiterate those it found in the previous analysis,
    which I expected, since the code is the same. However, on GitHub, Codacy also
    offers a “commit suggestion” to fix each issue along with a brief explanation.
    This makes it very convenient for software engineers to simply accept the suggestion
    and merge the PR with one click ([Figure 3-5](#ch03_figure_5_1749441076000410)).
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 它识别的大多数错误重复了之前分析中发现的错误，这是预期的，因为代码是相同的。然而，在GitHub上，Codacy还为每个问题提供了一个“提交建议”，包括简短的说明，这使得软件工程师可以简单地接受建议，并一键合并PR（见图[3-5](#ch03_figure_5_1749441076000410))）。
- en: '![](assets/gasd_0305.png)'
  id: totrans-81
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/gasd_0305.png)'
- en: Figure 3-5\. Codacy suggested a fix for the issue it found
  id: totrans-82
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图3-5\. Codacy为其发现的问题提出了修复方案
- en: For all these reasons, I rate Codacy’s tool an 8/10\. It found two of two security
    issues, but it didn’t find either of the two performance issues. For the issues
    it did find, it offered very comprehensive explanations and proposed fixes that
    could be accepted in the actual repository with one click.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 由于所有这些原因，我给Codacy的工具打8/10分。它找到了两个安全漏洞中的两个，但没有找到两个性能问题中的任何一个。对于它找到的问题，它提供了非常全面的解释，并提出了可以在实际仓库中一键接受的修复方案。
- en: DeepCode (by Snyk)
  id: totrans-84
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: DeepCode（由Snyk提供）
- en: '[DeepCode](https://oreil.ly/VBZWA) began as an independent startup based in
    Zurich, Switzerland, as a spinoff from ETH Zurich University.^([1](ch03.html#id367))
    It was acquired by the cybersecurity behemoth Snyk in September 2020.^([2](ch03.html#id368))
    Since then, the product was marketed first as “DeepCode by Snyk” and more recently
    as “DeepCode AI,” and has been integrated into Snyk’s broader suite of products
    and services.'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: '[DeepCode](https://oreil.ly/VBZWA)最初是一家位于瑞士苏黎世的独立初创公司，作为苏黎世联邦理工学院（ETH Zurich
    University）的衍生公司。[1](ch03.html#id367) 它于2020年9月被网络安全巨头Snyk收购。[2](ch03.html#id368)
    从那时起，该产品最初被市场推广为“Snyk的DeepCode”，后来更改为“DeepCode AI”，并已集成到Snyk更广泛的产品和服务套件中。'
- en: As Snyk [described it](https://oreil.ly/jdWJl) in 2020, DeepCode includes “sophisticated
    interpretable machine learning semantic code analysis. The technology scans code
    10–50x faster than alternatives, enabling real-time workflows within the development
    process, and dramatically reduces both false negatives and false positives using
    a custom machine learning platform that is able to quickly learn from huge volumes
    of code.”
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 如Snyk在2020年[描述的](https://oreil.ly/jdWJl)那样，DeepCode包括“复杂的可解释机器学习语义代码分析。该技术扫描代码的速度比替代方案快10-50倍，使开发过程中的实时工作流程成为可能，并使用能够快速从大量代码中学习的自定义机器学习平台，大大减少了误报和漏报。”
- en: DeepCode uses machine learning algorithms to learn from millions of publicly
    available open source software-development repositories. This large dataset allows
    DeepCode to provide highly accurate suggestions and find potential issues that
    human reviewers might overlook.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: DeepCode使用机器学习算法从数百万个公开可用的开源软件开发仓库中学习。这个庞大的数据集使得DeepCode能够提供高度准确的建议，并找到人类审阅者可能忽略的潜在问题。
- en: 'DeepCode can be used on an IDE or directly in a Git repository. It points out
    security vulnerabilities on the spot, as alerts in the IDE tool tip or as comments
    to the pull request in the repository. As the company’s [website](https://oreil.ly/VBZWA)
    puts it:'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: DeepCode可以在IDE中使用，也可以直接在Git仓库中使用。它会在IDE工具提示中或作为仓库中拉取请求的注释指出安全漏洞。正如公司的[网站](https://oreil.ly/VBZWA)所说：
- en: It combines symbolic and generative AI, multiple machine learning methods, and
    the expertise of top security researchers to offer accurate vulnerability detection
    and tech debt management. DeepCode AI is purpose-built for security, supporting
    11 languages and over 25 million data flow cases to find and fix vulnerabilities
    efficiently. This AI technology enhances developer productivity by offering one-click
    security fixes and comprehensive app coverage while ensuring the trustworthiness
    of the AI through training data from millions of open-source projects. DeepCode
    AI stands out for its hybrid approach using multiple models and security-specific
    training sets to secure applications effectively.
  id: totrans-89
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 它结合了符号和生成式AI、多种机器学习方法和顶级安全研究人员的专业知识，以提供准确的安全漏洞检测和技术债务管理。DeepCode AI专为安全而设计，支持11种语言和超过2500万个数据流案例，以高效地查找和修复漏洞。这项AI技术通过提供一键安全修复和全面的APP覆盖，同时确保AI的可靠性，通过来自数百万开源项目的训练数据来提高开发者的生产力。DeepCode
    AI因其使用多个模型和安全特定训练集的混合方法而脱颖而出，有效地保护应用程序。
- en: Practical example
  id: totrans-90
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 实践示例
- en: Just like I did for Codacy, I created an account with Snyk/DeepCode using my
    GitHub account and ran it on the code in [Example 3-1](#ch03_example_1_1749441076005830)
    within the book’s repository.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 就像我为Codacy创建账户一样，我使用GitHub账户为Snyk/DeepCode创建了一个账户，并在本书的仓库中的[示例3-1](#ch03_example_1_1749441076005830)代码上运行了它。
- en: DeepCode correctly identified issue 1, the SQL injection vulnerability, and
    labeled it with “H” (High), the highest level in its ranking system. It even provides
    a score ([Figure 3-6](#ch03_figure_6_1749441076000425)), though I could not find
    specific information about what this score means. This issue’s score of 830 is
    the highest score received by my code.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: DeepCode正确识别了问题1，即SQL注入漏洞，并用“H”（高）标记，这是其评级系统中的最高级别。它甚至提供了一个分数（[图3-6](#ch03_figure_6_1749441076000425)），尽管我找不到关于这个分数具体含义的具体信息。这个问题得分为830，是我代码收到的最高分。
- en: '![](assets/gasd_0306.png)'
  id: totrans-93
  prefs: []
  type: TYPE_IMG
  zh: '![图片](assets/gasd_0306.png)'
- en: Figure 3-6\. DeepCode identified the SQL injection vulnerability
  id: totrans-94
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图3-6\. DeepCode识别了SQL注入漏洞
- en: Snyk/DeepCode provides two expandable sections for each error. One provides
    a deeper explanation of the issue, resembling a stack trace rendered in the browser
    UI ([Figure 3-7](#ch03_figure_7_1749441076000440)).
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: Snyk/DeepCode为每个错误提供两个可展开的部分。一个提供了对问题的更深入解释，类似于在浏览器UI中渲染的堆栈跟踪（[图3-7](#ch03_figure_7_1749441076000440)）。
- en: '![](assets/gasd_0307.png)'
  id: totrans-96
  prefs: []
  type: TYPE_IMG
  zh: '![图片](assets/gasd_0307.png)'
- en: Figure 3-7\. DeepCode explained the SQL injection vulnerability
  id: totrans-97
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图3-7\. DeepCode解释了SQL注入漏洞
- en: The second expandable section suggests a fix for the issue ([Figure 3-8](#ch03_figure_8_1749441076000457))
    and gives pointers to avoid using concatenated SQL statements as strings stored
    directly from user-entered parameters. This is a best practice in defensive programming.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 第二个可展开部分建议对问题进行修复（[图3-8](#ch03_figure_8_1749441076000457)），并提供了避免使用直接从用户输入参数存储的连接SQL语句作为字符串的指导。这是防御性编程中的最佳实践。
- en: '![](assets/gasd_0308.png)'
  id: totrans-99
  prefs: []
  type: TYPE_IMG
  zh: '![图片](assets/gasd_0308.png)'
- en: Figure 3-8\. DeepCode suggested a fix for the SQL injection vulnerability
  id: totrans-100
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图3-8\. DeepCode建议修复SQL注入漏洞
- en: These suggestions are provided “as is” from an open source repository in the
    training dataset. This is very nice in terms of transparency, as a software engineer
    should always want to know where the code comes from. However, it adds some extra
    cognitive load in terms of actually solving the problem, since this is just a
    proposed solution to help the software developer fix the issue, not an actual
    proposed solution to be adopted with the click of a button.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 这些建议是从训练数据集中的开源仓库“原样”提供的。这在透明度方面非常好，因为软件工程师总是想知道代码的来源。然而，在解决问题方面，它增加了一些额外的认知负担，因为这只是帮助软件开发者修复问题的建议方案，而不是一个实际的建议方案，可以一键采用。
- en: Despite this deep level of detail for issue 1, DeepCode didn’t find issues 2,
    3, or 4\. It did find some lower-severity issues in some libraries I used (inside
    `node_modules`), which were irrelevant to this book’s exercise.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管对问题1有如此深入的细节，但DeepCode没有发现问题2、3或4。它在我的某些库中（在`node_modules`内部）发现了一些低严重性的问题，这些问题与本书的练习无关。
- en: I rate DeepCode a 6/10\. It found one of two security issues and didn’t find
    either of the performance issues. For those issues it found, it provided very
    comprehensive explanations; however, the help it offers for each issue is lacking
    in comparison to that offered by Codacy and CodeRabbit. DeepCode provides information
    about the issue, but it doesn’t offer proposed solutions that are easy to adopt
    with one click.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 我给DeepCode打6/10分。它发现了一个安全问题的两个中之一，但没有发现任何性能问题。对于它发现的问题，它提供了非常全面的解释；然而，与Codacy和CodeRabbit提供的帮助相比，它提供的帮助还不足。DeepCode提供了关于问题的信息，但它不提供易于一键采用的解决方案。
- en: CodeRabbit
  id: totrans-104
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: CodeRabbit
- en: '[CodeRabbit](https://coderabbit.ai) is an automated code-review platform launched
    in September 2023, amid the generative AI buzz. It gained significant popularity
    very fast, especially on Twitter/X as some tech influencers did thorough reviews
    of the product and promoted it in their networks (here’s one [example](https://oreil.ly/m9rjn)).
    The official number of CodeRabbit users had not been publicly disclosed at the
    time of writing (mid-2025).'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: '[CodeRabbit](https://coderabbit.ai) 是一个在2023年9月推出的自动化代码审查平台，正值生成式AI的热潮。它迅速获得了巨大的知名度，尤其是在Twitter/X上，一些技术影响者对该产品进行了彻底的审查，并在他们的网络中推广了它（这里有一个[例子](https://oreil.ly/m9rjn)）。截至写作时（2025年中），CodeRabbit的用户数量尚未公开披露。'
- en: CodeRabbit leverages AI capabilities to enhance the quality, performance, and
    efficiency of code reviews. It delivers its code recommendations through comments
    in the repository.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: CodeRabbit利用AI能力来提高代码审查的质量、性能和效率。它通过存储库中的注释提供代码建议。
- en: Practical example
  id: totrans-107
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 实际例子
- en: Like I did for the other tools, I created an account with CodeRabbit, allowed
    it access to my GitHub account, and selected the repository I wanted to give it
    access to. Unlike Codacy and DeepCode, CodeRabbit won’t statically analyze code
    that’s already in a repository. Instead, I needed to open a pull request; CodeRabbit
    then posted comments to that PR with its code-review items and suggestions. CodeRabbit
    promotes this as a much more interactive tool that aims to mimic a team member
    commenting on a PR seconds after it’s opened on GitHub. However, my experience
    on CodeRabbit’s website was greatly inferior to my experiences with the competitors
    analyzed here.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 就像我对其他工具所做的那样，我为CodeRabbit创建了一个账户，允许它访问我的GitHub账户，并选择了我想让它访问的存储库。与Codacy和DeepCode不同，CodeRabbit不会静态分析存储库中已有的代码。相反，我需要打开一个拉取请求；CodeRabbit随后在该PR上发布评论，包括其代码审查项目和建议。CodeRabbit将其宣传为一个更具互动性的工具，旨在模仿GitHub上PR刚打开后团队成员立即评论的情况。然而，我在CodeRabbit网站上的体验远不如分析中提到的竞争对手。
- en: 'CodeRabbit correctly identified issue 1, the SQL Injection vulnerability ([Figure 3-9](#ch03_figure_9_1749441076000472)).
    It doesn’t provide any indication of severity level: all issues it reports look
    alike in that regard. It did a good job pointing out the faulty code snippet and
    offered a brief explanation about why it contains a vulnerability. I believe most
    software engineers will enjoy this simple UI, since it’s exactly the type of interaction
    they get from human colleagues who review their PR.'
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: CodeRabbit正确地识别了问题1，即SQL注入漏洞（[图3-9](#ch03_figure_9_1749441076000472)）。它没有提供任何严重程度的指示：它报告的所有问题在这方面看起来都一样。它很好地指出了有问题的代码片段，并简要解释了为什么它包含漏洞。我相信大多数软件工程师都会喜欢这种简单的UI，因为它正是他们从审查他们PR的人类同事那里获得的交互类型。
- en: '![](assets/gasd_0309.png)'
  id: totrans-110
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/gasd_0309.png)'
- en: Figure 3-9\. CodeRabbit identified the SQL injection vulnerability
  id: totrans-111
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图3-9\. CodeRabbit识别的SQL注入漏洞
- en: Along with the explanation, CodeRabbit offers an expandable section called “Committable
    suggestion” that contains a suggested fix for the issue ([Figure 3-10](#ch03_figure_10_1749441076000488)).
    While CodeRabbit displays a noticeable warning to review the offered solution
    thoroughly, committing it is only one convenient click away.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 除了解释之外，CodeRabbit还提供了一个可扩展的部分，称为“可提交的建议”部分，其中包含对问题的建议修复（[图3-10](#ch03_figure_10_1749441076000488)）。虽然CodeRabbit会显示一个明显的警告，提醒用户仔细审查提供的解决方案，但提交它只需点击一下即可。
- en: '![](assets/gasd_0310.png)'
  id: totrans-113
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/gasd_0310.png)'
- en: Figure 3-10\. CodeRabbit suggested a fix
  id: totrans-114
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图3-10\. CodeRabbit建议的修复
- en: CodeRabbit also detected issue 2, the XSS vulnerability ([Figure 3-11](#ch03_figure_11_1749441076000502)),
    but just like the other tools analyzed, CodeRabbit didn’t find performance issues
    3 and 4.
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: CodeRabbit还检测到问题2，即XSS漏洞（[图3-11](#ch03_figure_11_1749441076000502)），但与其他分析的工具一样，CodeRabbit没有发现性能问题3和4。
- en: '![](assets/gasd_0311.png)'
  id: totrans-116
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/gasd_0311.png)'
- en: Figure 3-11\. CodeRabbit identified the XSS vulnerability
  id: totrans-117
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图3-11\. CodeRabbit识别了XSS漏洞
- en: Thus, I rate CodeRabbit a 7/10\. It found both security issues but neither of
    the performance issues. It also proposed a solution for one of the issues it found,
    but not the other one. However, its explanation for the issues was very superficial
    compared to the other two tools. Finally, it lacks a website interface that would
    let users research issues in more depth and provide some historical perspective
    of changes and improvements made on the codebase, which the other tools have.
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，我给CodeRabbit评分为7/10。它发现了安全问题，但没有发现性能问题。它还为其发现的问题之一提出了解决方案，但没有为另一个问题提出解决方案。然而，与其他两个工具相比，它对问题的解释非常肤浅。最后，它缺乏一个网站界面，用户可以更深入地研究问题，并提供代码库上所做的更改和改进的历史视角，而其他工具都有这些功能。
- en: Tool Comparison
  id: totrans-119
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 工具比较
- en: 'All three of these AI code-review tools take different approaches to blocking
    my pull request from being merged, as shown in [Figure 3-12](#ch03_figure_12_1749441076000520):'
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 这三个AI代码审查工具在阻止我的拉取请求合并方面采取了不同的方法，如图[图3-12](#ch03_figure_12_1749441076000520)所示：
- en: Codacy blocks the PR merge until I fix the issues it identified (which, to be
    fair, I can do using its suggested fixes).
  id: totrans-121
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Codacy会阻止PR合并，直到我修复它识别出的问题（公平地说，我可以使用它建议的修复方法来完成）。
- en: Snyk/DeepCode doesn’t block the PR merge, despite the issues found.
  id: totrans-122
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Snyk/DeepCode尽管发现了问题，但不会阻止PR合并。
- en: CodeRabbit only posts comments; it doesn’t run actual checks, and thus it would
    never block a PR merge regardless of any issues it finds.
  id: totrans-123
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: CodeRabbit只发布评论；它不会运行实际的检查，因此无论它发现什么问题，都不会阻止PR合并。
- en: '![](assets/gasd_0312.png)'
  id: totrans-124
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/gasd_0312.png)'
- en: Figure 3-12\. Codacy and Snyk/DeepCode show up in the checks section for the
    PR merge
  id: totrans-125
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图3-12\. Codacy和Snyk/DeepCode出现在PR合并的检查部分
- en: If I were to select a single tool, Codacy would be my go-to tool. As [Table 3-1](#ch03_table_1_1749441076002736)
    indicates, it had the highest score.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我必须选择一个工具，Codacy将是我首选的工具。正如[表3-1](#ch03_table_1_1749441076002736)所示，它得分最高。
- en: Table 3-1\. AI code-review tools overview
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 表3-1\. AI代码审查工具概述
- en: '| Tool | UX | Test performance |'
  id: totrans-128
  prefs: []
  type: TYPE_TB
  zh: '| 工具 | UX | 测试性能 |'
- en: '| --- | --- | --- |'
  id: totrans-129
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- |'
- en: '| Codacy | Browser + Repository | 8/10 |'
  id: totrans-130
  prefs: []
  type: TYPE_TB
  zh: '| Codacy | 浏览器 + 仓库 | 8/10 |'
- en: '| Snyk/DeepCode | Browser + Repository | 6/10 |'
  id: totrans-131
  prefs: []
  type: TYPE_TB
  zh: '| Snyk/DeepCode | 浏览器 + 仓库 | 6/10 |'
- en: '| CodeRabbit | Repository | 7/10 |'
  id: totrans-132
  prefs: []
  type: TYPE_TB
  zh: '| CodeRabbit | 仓库 | 7/10 |'
- en: Conclusion
  id: totrans-133
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 结论
- en: Code reviews have been one of the biggest frustrations in my software development
    teams over the years. People are naturally more inclined to pick up new tasks
    assigned to them than to stop their own thread of work to review a colleague’s
    PR. This default behavior has delayed features from being moved to QA and ultimately
    going live. It has also created situations where we fast-track some urgent features
    even with a less-than-ideal level of code review, resulting in bugs showing up
    in production. In general, the biggest casualty of these common code-review frustrations
    is team morale, with team members feeling like they’re constantly switching context
    and losing focus.
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 在过去的几年中，代码审查一直是我软件开发团队最大的挫折之一。人们自然更倾向于接受分配给他们的新任务，而不是停止自己的工作流程去审查同事的PR。这种默认行为导致了功能无法及时转移到质量保证(QA)并最终上线。这也导致了我们在代码审查水平不尽如人意的情况下，快速推进一些紧急功能，结果在生产中出现了错误。总的来说，这些常见的代码审查挫折的最大受害者是团队士气，团队成员感觉他们总是在不断切换上下文，失去焦点。
- en: I began using several forms of automated code review in my teams, like linters,
    static code analysis, and test coverage dashboards, long before the recent generative
    AI hype. Any team with robust engineering standards has probably done likewise.
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 在最近的生成式AI热潮之前，我就开始在团队中使用多种形式的自动代码审查，如linters、静态代码分析和测试覆盖率仪表板。任何拥有稳健工程标准的团队可能都做了类似的事情。
- en: However, after 15 years in the industry, I can tell that the recent wave of
    evolution adds more depth to these tools—especially the seamless way they integrate
    with your software development workflow, and the option to accept suggested fixes
    with one click. Having a very capable code reviewer who’s available 24/7 to provide
    thoughtful feedback on issues in your code is a massive help to anyone. It’s something
    I could only have dreamed of when I started out as a software engineer myself.
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，在行业里15年的经验告诉我，最近的一波进化给这些工具增加了更多的深度——特别是它们无缝集成到你的软件开发工作流程中的方式，以及一键接受建议修复的选项。拥有一个能够全天候提供对代码问题深思熟虑的反馈的非常能干的代码审查员，对任何人来说都是极大的帮助。这是我作为软件工程师开始时只能梦想的事情。
- en: However, I believe that software engineers should leverage these tools as learning
    opportunities before anything else. They can and do make mistakes, as the tools
    themselves note in very visible warnings, and I can only underline that. *Always*
    have a human being review and test the suggested fixes. As with code-generation
    tools, I recommend a high level of diligence when reviewing any code or fixes
    suggested by these tools. Make it yours before you open a PR or merge to master.
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，我相信软件工程师应该首先将这些工具视为学习的机会。他们可能会犯错，正如工具本身在非常明显的警告中提到的，我只想强调这一点。*始终*让人类审查和测试建议的修复。与代码生成工具一样，我建议在审查这些工具建议的任何代码或修复时保持高度谨慎。在提交PR或合并到主分支之前，请确保将其变为自己的代码。
- en: ^([1](ch03.html#id367-marker)) This book’s author was part of the DeepCode team
    prior to the company’s acquisition by Snyk, but has no contractual relationship,
    equity, or any other vested interest in DeepCode at the time of writing.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: ^([1](ch03.html#id367-marker)) 本书作者在Snyk收购公司之前曾是DeepCode团队的一员，但在撰写本书时，与DeepCode没有任何合同关系、股权或其他利益。
- en: ^([2](ch03.html#id368-marker)) McKay, Peter. September 23, 2020\. [“Accelerating
    Our Developer-First Vision with DeepCode”](https://oreil.ly/jdWJl). *Snyk* (blog).
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: ^([2](ch03.html#id368-marker)) 麦克雷，彼得。2020年9月23日。[“通过DeepCode加速我们的开发者优先愿景”](https://oreil.ly/jdWJl)。*Snyk*（博客）。
