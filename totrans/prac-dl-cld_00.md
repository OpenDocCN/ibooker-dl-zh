# 前言

我们正在经历人工智能的复兴，每个人和他们的邻居都希望成为这一运动的一部分。这很可能是您正在浏览这本书的原因。关于深度学习的书籍有很多。因此，您可能会问我们，非常合理地问，为什么这本书存在？我们马上就会解释。

自 2013 年以来，我们在微软、英伟达、亚马逊和 Square 等公司构建产品的深度学习之旅中，我们目睹了这一领域的巨大变化。不断发展的研究是一个事实，而成熟工具的缺乏是生活的现实。

在与社区的交流和学习过程中，我们注意到缺乏明确的指导，说明如何将研究转化为面向日常用户的最终产品。毕竟，最终用户可能在网络浏览器、智能手机或边缘设备的前面。这通常涉及无数小时的黑客和实验，通过博客、GitHub 问题线程和 Stack Overflow 答案进行广泛搜索，给包的作者发送电子邮件以获取深奥的知识，以及偶尔的“恍然大悟”时刻。即使市场上的书籍往往更注重理论或如何使用特定工具。我们能希望从现有的书籍中学到的最好的东西就是构建一个玩具示例。

为了填补理论和实践之间的鸿沟，我们最初开始进行关于将人工智能从研究转化为最终用户的演讲，特别关注实际应用。这些演讲旨在展示激励性的例子，以及根据技能水平（从业余爱好者到 Google 规模的工程师）和在生产中部署深度学习所涉及的努力不同的复杂性水平。我们发现，无论是初学者还是专家，都会从这些演讲中获益。

随着时间的推移，这个领域幸运地变得更加容易接近初学者，并且有更多的工具可用。像 Fast.ai 和 DeepLearning.ai 这样的优秀在线材料使得理解如何训练 AI 模型变得比以往任何时候都更容易。书籍也占据了使用深度学习框架（如 TensorFlow 和 PyTorch）教授基础知识的市场。但即使有了这一切，理论和实践之间的巨大鸿沟仍然大多未被解决。我们希望弥合这一鸿沟。因此，您现在正在阅读的就是这本书。

本书使用平易近人的语言以及计算机视觉中的即时趣味项目，从简单的分类器开始，假设没有机器学习和人工智能的知识，逐渐增加复杂性，提高准确性和速度，扩展到数百万用户，部署在各种硬件和软件上，并最终通过强化学习构建微型自动驾驶汽车。

几乎每一章都以一个激励性的例子开始，提前确定在构建解决方案的过程中可能会问到的问题，并讨论解决问题的多种方法，每种方法都涉及不同的复杂性水平和努力。如果您正在寻找一个快速解决方案，您可能只需要阅读一章的几页就可以了。想要更深入了解主题的人应该阅读整章。当然，每个人都应该浏览这些章节中包含的案例研究，有两个原因——它们很有趣，展示了行业中的人们如何使用章节中讨论的概念来构建真实产品。

我们还讨论了深度学习从业者和行业专业人士在使用云端、浏览器、移动设备和边缘设备构建真实应用程序时面临的许多实际问题。我们在这本书中编制了许多实用的“技巧和窍门”，以及生活经验，鼓励我们的读者构建可以让某人的一天变得更好一点的应用程序。

# 给后端/前端/移动软件开发人员

您很可能已经是一位熟练的程序员。即使 Python 对您来说是一种陌生的语言，我们相信您将能够轻松掌握并立即开始。最重要的是，我们不指望您具有机器学习和人工智能方面的任何背景；这就是我们在这里的原因！我们相信您将从本书关注以下领域中获益：

+   如何构建面向用户的 AI 产品

+   如何快速训练模型

+   如何最小化原型设计中所需的代码和工作量

+   如何使模型更具性能和能源效率

+   如何操作和扩展，并估算涉及的成本

+   发现 AI 如何在行业中应用，包括 40 多个案例研究和实际示例

+   深度学习的广泛知识发展

+   开发一套通用的技能，可应用于新的框架（例如 PyTorch）、领域（例如医疗保健、机器人学）、输入模态（例如视频、音频、文本）和任务（例如图像分割、一次性学习）

# 对于数据科学家

您可能已经精通机器学习，可能知道如何训练深度学习模型。好消息！您可以进一步丰富您的技能，并加深您在该领域的知识，以便构建真实产品。本书将通过以下内容帮助您的日常工作和更多内容：

+   加快您的训练速度，包括在多节点集群上

+   建立对开发和调试模型的直觉，包括超参数调整，从而显著提高模型准确性

+   了解您的模型如何工作，发现数据中的偏见，并自动确定最佳的超参数以及模型架构，使用 AutoML

+   学习其他数据科学家使用的技巧，包括快速收集数据、以有组织的方式跟踪您的实验、与世界分享您的模型，并了解您任务的最佳可用模型

+   使用工具将您最佳的模型部署和扩展到真实用户，甚至自动化（无需涉及 DevOps 团队）

# 对于学生

现在是考虑从事人工智能职业的绝佳时机——它正在成为继互联网和智能手机之后的下一个技术革命。已经取得了很多进展，还有很多待发现的地方。我们希望本书可以作为您迈向人工智能职业的第一步，并且更好地发展更深入的理论知识。最好的部分是您不必花费大量资金购买昂贵的硬件。事实上，您可以完全免费在网络浏览器上使用强大的硬件进行训练（感谢 Google Colab！）。通过本书，我们希望您能够：

+   通过开发一系列有趣的项目，立志从事人工智能职业

+   从行业实践中学习，以帮助准备实习和工作机会

+   通过构建像自动驾驶汽车这样有趣的应用来释放您的创造力

+   通过利用您的创造力解决人类面临的最紧迫问题，成为 AI 的倡导者

# 对于教师

我们相信本书可以很好地补充您的课程内容，提供有趣的、实际的项目。我们详细介绍了深度学习流程的每一步，以及如何有效和高效地执行每一步的技术。我们在书中提出的每个项目都可以成为学期中课堂上的优秀合作或个人作品。最终，我们将在[*http://PracticalDeepLearning.ai*](http://PracticalDeepLearning.ai)上发布 PowerPoint 演示幻灯片，可用于课程辅助教学。

# 对于机器人爱好者

机器人技术令人兴奋。如果您是机器人爱好者，我们无需说服您向机器人添加智能是正确的途径。像树莓派、NVIDIA Jetson Nano、Google Coral、Intel Movidius、PYNQ-Z2 等功能日益强大的硬件平台正在推动机器人领域的创新。随着我们向工业 4.0 发展，其中一些平台将变得越来越相关和普遍。通过本书，您将：

+   学习如何构建和训练人工智能，然后将其应用到边缘

+   基准测试和比较边缘设备的性能、大小、功耗、电池和成本

+   了解如何为特定场景选择最佳的人工智能算法和设备

+   了解其他制作者如何构建创意机器人和机器

+   学习如何在该领域取得进一步进展并展示您的工作

# 每章内容预期

第一章，*探索人工智能的领域*

我们从 1950 年代到今天对这个不断发展的领域进行了一次探索，分析了构成完美深度学习配方的要素，熟悉常见的人工智能术语和数据集，并窥探了负责任人工智能的世界。

第二章，*图片中有什么：使用 Keras 进行图像分类*

我们只需用五行 Keras 代码就深入探讨了图像分类的世界。然后，我们通过在视频上叠加热图来了解神经网络在进行预测时关注的内容。奖励：我们听到了 Keras 的创始人弗朗索瓦·肖莱的激励个人旅程，展示了单个个体可以产生的影响。

第三章，*猫与狗：使用 Keras 进行 30 行迁移学习*

我们使用迁移学习在新的自定义分类任务上重复使用先前训练过的网络，以在几分钟内获得接近最先进的准确性。然后，我们对结果进行分析，以了解其分类情况。在此过程中，我们构建了一个通用的机器学习流水线，本书中多次重复使用。奖励：我们听到了 fast.ai 的联合创始人 Jeremy Howard 的声音，他讲述了成千上万的学生如何利用迁移学习来启动他们的人工智能之旅。

第四章，*构建反向图像搜索引擎：理解嵌入*

像谷歌反向图像搜索一样，我们探索如何使用嵌入——图像的上下文表示来在不到十行的代码中找到相似的图像。然后，当我们探索不同的策略和算法以加速规模化时，乐趣开始了，从数千到数百万张图像，并使它们在微秒内可搜索。

第五章，*从新手到大师预测者：最大化卷积神经网络准确性*

我们探索策略，以最大化我们的分类器可以实现的准确性，借助一系列工具，包括 TensorBoard、What-If Tool、tf-explain、TensorFlow Datasets、AutoKeras 和 AutoAugment。在此过程中，我们进行实验，以发展对哪些参数可能适用或不适用于您的人工智能任务的直觉。

第六章，*最大化 TensorFlow 的速度和性能：一个方便的清单*

我们通过一个包含 30 个技巧的清单，将训练和推理的速度提升到极致，以减少尽可能多的低效，并最大化当前硬件的价值。

第七章，*实用工具、技巧和窍门*

我们在各种主题和工具中拓展我们的实用技能，从安装、数据收集、实验管理、可视化，一直到探索建立深度学习理论基础的更多途径。

第八章，*云计算机视觉 API：15 分钟上手*

工作要聪明，不要辛苦。我们在不到 15 分钟内利用谷歌、微软、亚马逊、IBM 和 Clarifai 的云 AI 平台的强大功能。对于现有 API 无法解决的任务，我们使用定制分类服务来训练分类器，无需编码。然后我们将它们放在一个开放的基准测试中进行比较——你可能会惊讶于谁赢了。

第九章，*使用 TensorFlow Serving 和 KubeFlow 在云端进行可扩展推理服务*

我们将我们定制训练的模型部署到云端/本地，以便从数百万到数百万的请求中进行可扩展服务。我们探索 Flask、Google Cloud ML Engine、TensorFlow Serving 和 KubeFlow，展示了工作量、场景和成本效益分析。

第十章，*在浏览器中使用 TensorFlow.js 和 ml5.js 的 AI*

每个使用计算机或智能手机的个人都统一拥有一个软件程序——他们的浏览器。通过基于浏览器的深度学习库，包括 TensorFlow.js 和 ml5.js，可以接触到所有这些用户。客座作者 Zaid Alyafeai 向我们介绍了在浏览器中运行的技术和任务，如身体姿势估计、生成对抗网络（GANs）、图像到图像的转换与 Pix2Pix 等。额外福利：听听 TensorFlow.js 和 ml5.js 的关键贡献者关于这些项目的孵化过程。

第十一章，*iOS 上的实时物体分类：使用 Core ML*

我们探索了移动端深度学习的领域，重点关注苹果生态系统中的 Core ML。我们在不同的 iPhone 上对模型进行基准测试，研究减小应用程序大小和能源影响的策略，并探讨动态模型部署、设备上的训练以及专业应用程序的构建方式。

第十二章，*iOS 上的 Not Hotdog：使用 Core ML 和 Create ML*

*硅谷*的 Not Hotdog 应用（来自 HBO）被认为是移动 AI 的“Hello World”，因此我们通过三种不同的方式来构建实时版本，以示敬意。

第十三章，*食物识别：使用 TensorFlow Lite 和 ML Kit 开发 Android 应用*

我们通过 TensorFlow Lite 将 AI 带到 Android。然后我们使用 ML Kit（建立在 TensorFlow Lite 之上）和 Fritz 来探索构建自我改进 AI 应用的端到端开发生命周期。在这个过程中，我们关注模型版本控制、A/B 测试、成功度量、动态更新、模型优化等主题。额外福利：我们可以听到 Pete Warden（移动和嵌入式 TensorFlow 技术负责人）在将 AI 带到边缘设备方面的丰富经验。

第十四章，*使用 TensorFlow 目标检测 API 构建完美的猫定位器应用*

我们探索了四种不同的方法来定位图像中物体的位置。我们回顾了多年来物体检测的发展，并分析了速度和准确性之间的权衡。这为案例研究如人群计数、人脸检测和自动驾驶奠定了基础。

第十五章，*成为制造者：探索边缘嵌入式 AI*

特邀作者 Sam Sterckval 将深度学习带到低功耗设备，展示了一系列具有不同处理能力和成本的 AI 能力边缘设备，包括树莓派，NVIDIA Jetson Nano，Google Coral，Intel Movidius 和 PYNQ-Z2 FPGA，为机器人和创客项目打开了大门。奖励：听取 NVIDIA Jetson Nano 团队的意见，了解人们如何从他们的开源食谱书快速构建创意机器人。

第十六章，*使用 Keras 进行端到端深度学习模拟自动驾驶汽车*

通过使用微软 AirSim 的逼真模拟环境，特邀作者 Aditya Sharma 和 Mitchell Spryn 指导我们在训练虚拟汽车时，首先在环境中驾驶汽车，然后教授 AI 模型复制其行为。在这个过程中，本章涵盖了许多在自动驾驶汽车行业中适用的概念。

第十七章，*在不到一小时内构建自动驾驶汽车：使用 AWS DeepRacer 进行强化学习*

从虚拟世界到物理世界，特邀作者 Sunil Mallya 展示了如何在不到一小时内组装、训练和比赛 AWS DeepRacer，一辆微型汽车。通过强化学习的帮助，汽车学会了自动驾驶，惩罚自己的错误并最大化成功。我们学习如何将这些知识应用到从 AI 驾驶的奥林匹克到 RoboRace（使用全尺寸自动驾驶汽车）的比赛中。奖励：听取来自 Anima Anandkumar（NVIDIA）和 Chris Anderson（DIY Robocars 创始人）的意见，了解自动驾驶汽车行业的发展方向。

# 本书中使用的约定

本书中使用以下排版约定：

*斜体*

表示新术语，URL，电子邮件地址，文件名和文件扩展名。

`等宽`

用于程序清单，以及在段落中引用程序元素，如变量或函数名称，数据库，数据类型，环境变量，语句和关键字。

**`等宽粗体`**

显示用户应按照字面意义输入的命令或其他文本。

*`等宽斜体`*

显示应替换为用户提供的值或由上下文确定的值的文本。

###### 提示

这个元素表示提示或建议。

###### 注意

这个元素表示一般说明。

###### 警告

这个元素表示警告或注意。

# 使用代码示例

补充材料（代码示例，练习等）可在[*http://PracticalDeepLearning.ai*](http://PracticalDeepLearning.ai)下载。如果您有技术问题或在使用代码示例时遇到问题，请发送电子邮件至*PracticalDLBook@gmail.com*。

本书旨在帮助您完成工作。一般来说，如果本书提供了示例代码，您可以在程序和文档中使用它。除非您复制了代码的大部分，否则无需联系我们以获得许可。例如，编写一个使用本书中几个代码块的程序不需要许可。出售或分发 O’Reilly 图书中的示例需要许可。通过引用本书并引用示例代码回答问题不需要许可。将本书中大量示例代码合并到产品文档中需要许可。

我们感谢，但通常不需要署名。署名通常包括标题，作者，出版商和 ISBN。例如：“*Practical Deep Learning for Cloud, Mobile, and Edge* by Anirudh Koul, Siddha Ganju, and Meher Kasam (O’Reilly). Copyright 2020 Anirudh Koul, Siddha Ganju, Meher Kasam, 978-1-492-03486-5.”

如果您觉得您使用的代码示例超出了合理使用范围或上述给出的许可，请随时通过*permissions@oreilly.com*与我们联系。

# O’Reilly 在线学习

###### 注意

40 多年来，O'Reilly Media 一直为公司提供技术和商业培训、知识和见解，帮助公司取得成功。

我们独特的专家和创新者网络通过书籍、文章、会议和我们的在线学习平台分享他们的知识和专长。O'Reilly 的在线学习平台为您提供按需访问实时培训课程、深入学习路径、交互式编码环境以及来自 O'Reilly 和其他 200 多家出版商的大量文本和视频。欲了解更多信息，请访问 http://oreilly.com。

# 如何联系我们

请将有关此书的评论和问题发送至出版商：

+   O'Reilly Media, Inc.

+   1005 Gravenstein Highway North

+   Sebastopol, CA 95472

+   800-998-9938（美国或加拿大）

+   707-829-0515（国际或本地）

+   707-829-0104（传真）

O'Reilly 为这本书设有网页，列出勘误、示例和任何额外信息。您可以在 https://oreil.ly/practical-deep-learning 访问此页面。作者还为这本书设有网站：http://PracticalDeepLearning.ai。

发送电子邮件至 bookquestions@oreilly.com 评论或提出关于这本书的技术问题；发送电子邮件至 PracticalDLBook@gmail.com 联系作者关于这本书的问题。

有关我们的书籍、课程、会议和新闻的更多信息，请访问我们的网站 http://www.oreilly.com。

在 Facebook 上找到我们：http://facebook.com/oreilly

在 Twitter 上关注我们：http://twitter.com/oreillymedia

在 YouTube 上观看我们：http://www.youtube.com/oreillymedia

# 致谢

## 团体致谢

我们要感谢以下人员在我们写作这本书的旅程中给予的巨大帮助。没有他们，这本书将不可能完成。

这本书得以问世，要归功于我们的开发编辑 Nicole Taché的努力。她在我们的旅程中一直支持我们，并在每个步骤中提供重要的指导。她帮助我们优先考虑了正确的材料（信不信由你，这本书本来会更大！），并确保我们在正确的轨道上。她是我们写的每一份草稿的第一个读者，因此我们的首要目标是确保她能够理解内容，尽管她对 AI 还很陌生。我们对她的支持深表感激。

我们还要感谢 O'Reilly 团队的其他成员，包括我们的制作编辑 Christopher Faucher，他在紧张的时间表下辛勤工作，确保这本书按时印刷出版。我们也感谢我们的副本编辑 Bob Russell，他以其迅速的编辑和对细节的关注给我们留下了深刻印象。他让我们意识到在学校要注意英语语法的重要性（尽管有些晚了几年，我们很抱歉）。我们还要感谢 Rachel Roumeliotis（内容战略副总裁）和 Olivia MacDonald（开发编辑总监）对这个项目的信任和持续支持。

我们要特别感谢那些为我们的读者带来他们的技术专长，与我们分享他们对这一领域的热情的客座作者。来自微软的阿迪蒂亚·夏尔马和米切尔·斯普林向我们展示了，我们对玩视频赛车游戏的热爱可以被用来训练自动驾驶汽车，在模拟环境中驾驶汽车（使用 AirSim）。来自亚马逊的苏尼尔·马利亚通过演示表明，只需一个小时就可以组装并让一个微型自动驾驶汽车（AWS DeepRacer）在赛道上使用强化学习找到自己的路。来自 Edgise 的山姆·斯特克瓦尔总结了市场上可用的各种嵌入式人工智能硬件，这样我们就可以在下一个机器人项目上占得先机。最后，来自法赫德国王大学的扎伊德·阿利亚菲向我们展示了，浏览器同样能够运行严肃的交互式人工智能模型（借助 TensorFlow.js 和 ml5js）。

这本书之所以能够达到现在的形式，要归功于我们出色的技术审阅人员及时的反馈，他们不知疲倦地在我们的草稿上工作，指出他们发现的任何技术错误，并给出了更好传达我们想法的建议。由于他们的反馈（以及 TensorFlow 不断变化的 API），我们最终对原始预发布的大部分内容进行了重写。我们感谢玛格丽特·梅纳德-雷德（机器学习谷歌开发专家，您可能在阅读 TensorFlow 文档时读过她的作品），帕科·内森（Derwin Inc. 35 年行业资深人士，向 Anirudh 介绍了公开演讲的世界），安迪·佩特雷拉（Kensu 首席执行官和创始人，SparkNotebook 的创造者，他的技术见解符合他的声誉），尼基塔·库尔（Adobe 高级数据科学家，每次迭代后阅读并提出改进建议，有效地阅读了几千页内容，从而使内容更易接近）对每一章的详细审阅。此外，我们还得到了许多在特定主题方面具有专业知识的审阅人员的帮助，无论是浏览器中的人工智能，移动开发还是自动驾驶汽车。按章节排序的审阅人员名单如下：

+   第一章：达林尼·钱德拉塞卡兰，谢林·托马斯

+   第二章：阿努杰·夏尔马，查尔斯·科兹罗克，马诺杰·帕里哈尔，潘克什·巴莫特拉，普拉纳夫·坎特

+   第三章：阿努杰·夏尔马，查尔斯·科兹罗克，马诺杰·帕里哈尔，潘克什·巴莫特拉，普拉纳夫·坎特

+   第四章：阿努杰·夏尔马，马诺杰·帕里哈尔，潘克什·巴莫特拉，普拉纳夫·坎特

+   第六章：加布里埃尔·伊巴贡，吉里·西姆萨，马克斯·卡茨，潘克什·巴莫特拉

+   第七章：潘克什·巴莫特拉

+   第八章：迪佩什·阿加瓜尔

+   第九章：潘克什·巴莫特拉

+   第十章：布雷特·伯利，洛朗·德努，曼拉吉·辛格

+   第十一章：大卫·阿普加，詹姆斯·韦伯

+   第十二章：大卫·阿普加

+   第十三章：杰西·威尔逊，萨尔曼·加迪特

+   第十四章：阿克希特·阿罗拉，普拉纳夫·坎特，罗希特·塔内贾，罗纳伊·阿克

+   第十五章：格尔特鲁伊·范洛梅尔，乔克·德库伯，乔利恩·德科克，玛丽安娜·范洛梅尔，山姆·亨德里克斯

+   第十六章：达里奥·萨利斯奇克，库尔特·尼布尔，马修·陈，普拉维恩·帕拉尼萨米

+   第十七章：基尔特什·加格，拉里·皮泽特，皮埃尔·迪马斯，里卡多·苏埃拉斯，塞戈莱恩·德塞尔丁-潘哈德，斯里·埃拉普罗卢，新井辰也

我们在整本书中引用了一些创作者的摘录，他们让我们一窥他们的世界，以及他们建立最为著名的项目的如何以及为什么。我们感谢弗朗索瓦·肖莱，杰里米·霍华德，皮特·沃登，阿尼玛·阿南德库马尔，克里斯·安德森，蔡善庆，丹尼尔·斯米尔科夫，克里斯托瓦尔·瓦伦兹埃拉，丹尼尔·希夫曼，哈特·伍勒里，丹·阿布迪诺尔，千德德·雅斗，约翰·威尔士和丹尼·阿特斯莫。

## 个人致谢

> 我要感谢我的家人 Arbind、Saroj 和 Nikhita，他们给予我支持、资源、时间和自由去追求我的激情。感谢微软、Aira 和雅虎的所有黑客和研究人员，他们与我一起将想法变成原型产品，我们的旅程中不是成功，而是教会我们很多的挫折。我们的尝试和困难为这本书提供了丰富的素材，超出了我们最初的估计，多出了 250 页！感谢卡内基梅隆大学、达豪斯大学和塔帕大学的学术家庭，你们教会了我不仅仅是学术（不像我的 GPA 可能暗示的那样）。还要感谢盲人和低视力社区，你们每天都激励我在人工智能领域工作，向我们展示了只要拥有正确的工具，人们是无限的。
> 
> Anirudh
> 
> 我的祖父是一位作家，他曾告诉我：“写一本书比我想象的更难，也比我能想象的更有回报。”我永远感激我的祖父母、家人、妈妈、爸爸和 Shriya，他们倡导追求知识，帮助我成为今天的自己。感谢卡内基梅隆大学、欧洲核子研究中心、NASA FDL、Deep Vision、NITH 和 NVIDIA 的合作伙伴和导师们，他们在我整个旅程中与我同行，我感激他们教导我，帮助我培养了科学素养。感谢我的朋友们，希望他们还记得我，因为我最近一直很低调，非常感谢他们的耐心。希望能再见到你们。感谢那些无私地审阅书籍章节并充当听众的朋友们，非常感谢——没有你们，这本书就不会成形。
> 
> Siddha
> 
> 我感激我的父母 Rajagopal 和 Lakshmi，他们从一开始就给予我无尽的爱和支持，以及提供我良好生活和教育的坚定意愿。感谢 UF 和 VNIT 的教授们，他们教导我，让我庆幸自己主修计算机科学。感谢我的极具支持性的伴侣 Julia Tanner，近两年来，她不得不忍受与我的合著者无休止的 Skype 通话，以及我那些糟糕的笑话（其中一些不幸地出现在这本书中）的夜晚和周末。我还要感谢我的出色经理 Joel Kustka，在我写作这本书的过程中支持我。向那些在我不能像他们希望的那样经常和他们一起玩的朋友们致以问候。
> 
> Meher

最后，感谢 Grammarly 的制作者，他们让那些英语成绩平平的人成为了出版作者！
