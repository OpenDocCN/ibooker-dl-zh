["```py\nCREATE TABLE company (\n    company_id UUID PRIMARY KEY \n                     DEFAULT uuid_generate_v4(),\n    name VARCHAR(255) NOT NULL,\n    tax_id_type TIN_TYPE NOT NULL DEFAULT 'EIN',  #1\n    tax_id_number VARCHAR(9) NOT NULL,\n    ach_company_id NUMERIC(10) NOT NULL, #2\n    duns NUMERIC(9) DEFAULT NULL,  #3\n    logo BYTEA DEFAULT NULL,   #4\n    website VARCHAR(255) DEFAULT NULL,\n    industry INDUSTRY_TYPE DEFAULT NULL,\n    created_at TIMESTAMP NOT NULL DEFAULT NOW(),\n    updated_at TIMESTAMP NOT NULL DEFAULT NOW()\n);\n```", "```py\nCREATE TYPE industry_type AS ENUM ('basic materials', …, 'utilities');\n\nCREATE TYPE tin_type AS ENUM ('SSN', 'EIN', 'ITIN', 'ATIN', 'PTIN');\n```", "```py\nSELECT e.enumlabel AS label  #1\n  FROM pg_type AS t #2\n  JOIN pg_enum AS e   #2\n    ON t.oid = e.enumtypid #2\n WHERE t.typname = 'tin_type'; #3\n```", "```py\nCREATE TYPE address_type AS ENUM ('mailing', 'street'); #1\n\nCREATE TABLE company_address (\n    company_address_id UUID DEFAULT uuid_generate_v4(),\n    company_id UUID NOT NULL REFERENCES company(company_id)    #2\n                           ON DELETE CASCADE ON UPDATE CASCADE, \n    address_type ADDRESS_TYPE NOT NULL DEFAULT 'mailing',  #3\n    address_line_1 VARCHAR(255) NOT NULL,     #4\n    address_line_2 VARCHAR(255) DEFAULT NULL,  #4\n    address_line_3 VARCHAR(255) DEFAULT NULL,  #4\n    address_line_4 VARCHAR(255) DEFAULT NULL, \n    city VARCHAR(255) NOT NULL,   #5\n    state VARCHAR(2) NOT NULL,     #5\n    zip_code NUMERIC(5) NOT NULL,   #5\n    zip_code_4 NUMERIC(4) DEFAULT NULL, \n    created_at TIMESTAMP NOT NULL DEFAULT NOW(), #6\n    updated_at TIMESTAMP NOT NULL DEFAULT NOW(), \n    PRIMARY KEY (company_id, address_type)  #7\n);\n```", "```py\nCREATE TYPE phone_type AS ENUM ( 'main', 'direct', 'department', #1\n'fax', 'toll-free', 'mobile', 'home', 'other');   \n\nCREATE TABLE company_phone (\n    company_phone_id UUID DEFAULT uuid_generate_v4(),\n    company_id UUID NOT NULL REFERENCES company(company_id) #2\n                             ON DELETE CASCADE ON UPDATE CASCADE, \n    phone_type VARCHAR(25) NOT NULL,  #3\n    phone_number NUMERIC(10) NOT NULL,  #3\n    extension NUMERIC(5) DEFAULT NULL,  #3\n    created_at TIMESTAMP NOT NULL DEFAULT NOW(), #4\n    updated_at TIMESTAMP NOT NULL DEFAULT NOW(), \n    PRIMARY KEY (company_id, phone_type), #5\n    UNIQUE (phone_number, extension) #6\n);\n```", "```py\ndocker/\n├─ db/\n│  ├─ sql_scripts/\n│  │  ├─ sql/\n│  │  │  ├─ create_tables.sql\n│  │  │  ├─ general_ach_data.sql\n│  │  │  ├─ elemental_resources_inc.sql\n│  │  ├─ init.sql\n```", "```py\n…\n\\i /docker-entrypoint-initdb.d/sql/create_tables.sql #1\n\\i /docker-entrypoint-initdb.d/sql/general_ach_data.sql #2\n\\i /docker-entrypoint-initdb.d/sql/ #3\n➥elemental_resources_inc.sql\n…\n```", "```py\nDO\n$$\n    DECLARE\n        saved_uuid UUID; #1\n    BEGIN\n        WITH company_insert AS (        #2\n            INSERT INTO company (name, tax_id_number, #3\n                                duns, industry, logo)  #4\n                VALUES ('Elemental Resources Inc.', 459876543,  #4\n        123456789, 'basic materials', 'data:image/webp;base64,...') \n                RETURNING company_id #4\n        ) \n        SELECT company_id INTO saved_uuid FROM company_insert; #5\n\n        INSERT INTO company_address (saved_uuid, address_line_1, #6\n                                     city, state, zip_code)   #7\n        VALUES (saved_uuid, '123 Mineral Lane',  #7\n               'Boulder', 'CO', 80301); \n\n        INSERT INTO company_phone (saved_uuid, phone_number) #7\n        VALUES (saved_uuid, '7192662837'); \n    END\n$$;\n```", "```py\n…\n@pytest.fixture(scope=\"class\") #1\ndef client():  #1\n    return TestClient(app)  #1\n\n@pytest.fixture(scope=\"module\") #2\ndef docker_compose():   #2\n    absolute_path = Path(\"../../../../docker/db\").resolve()  #2\n    with DockerCompose(absolute_path) as compose:  #2\n        compose.start()  #2\n        yield compose #2\n        compose.stop()  #2\n\nclass TestCompanyApis:\n\n    @pytest.fixture(autouse=True) #3\n    def mock_client_host(self):  #3\n        with patch(  #3\n            \"fastapi.Request.client\",  #3\n            new_callable=lambda: type(\"Client\", (),   #3\n                             {\"host\": \"127.0.0.1\"}),  #3\n        ):  #3\n            yield #3\n\n    def test_get_companies(self, client, docker_compose): #4\n        response = client.get(\"/api/v1/companies\")  #5\n        assert response.status_code == 200, response.text #5\n```", "```py\nclass IndustryType(Enum):\n    BASIC_MATERIALS = \"basic materials\"\n    CONSUMER_GOODS = \"consumer goods\"\n    CONSUMER_SERVICES = \"consumer services\"\n    FINANCIALS = \"financials\"\n    HEALTHCARE = \"healthcare\"\n    INDUSTRIALS = \"industrials\"\n    OIL_AND_GAS = \"oil & gas\"\n    TECHNOLOGY = \"technology\"\n    TELECOMMUNICATIONS = \"telecommunications\"\n    UTILITIES = \"utilities\"\n```", "```py\nclass CompanyOverviewRecord(BaseModel):\n    company_id: Optional[UUID4] = Field(\n        None,\n        title=\"Company ID\",\n        description=\"Unique identifier for the company.\",\n    )\n    name: Optional[str] = Field(\n        None,\n        title=\"Name\",\n        description=\"Name of the company.\",\n        max_length=255,\n    )\n    industry: Optional[IndustryType] = Field( #1\n        None,\n        title=\"Industry\",\n        description=\"Type of industry the company operates in.\",\n    )\n    logo: Optional[str] = Field(\n        None,\n        title=\"Logo\",\n        description=\"Base64 Image of the Logo.\", #2\n        pattern=r\"^data:image\\/[a-zA-Z]+; #3\n➥base64,[A-Za-z0-9+/=]+$\" \n  )\n```", "```py\nclass CompaniesSql:\n\n    def get_all_companies(self) -> list[CompanyOverviewRecord]:\n        with get_db_connection(row_factory= #1\n➥class_row(CompanyOverviewRecord)) as conn: \n            result = conn.execute(\n                \"\"\"\n                SELECT company_id, name, industry, logo FROM companies #2\n                \"\"\",\n                [],\n            )\n\n        records = result.fetchall() #3\n\n        return records\n```", "```py\nrouter = APIRouter(prefix=\"/api/v1/companies\") #1\n…\n@router.get(  #2\n    path=\"\",  #2\n    response_model=list[CompanyOverviewRecord],  #2\n    summary=\"Retrieve an Overview of Companies\",  #2\n    description=\"Return a list of defined companies.\",  #2\n    response_description=\"An overview of the company.\",  #2\n    tags=[\"Company\"],  #2\n)\n@log_message(\"Company Overview\") #3\nasync def get_company_overview(request: Request) ->   #4\nlist[CompanyOverviewRecord]: \n    return CompaniesSql().get_all_companies() #5\n```", "```py\nrouters = [files.router, audit.router, #1\n➥ companies.router] \nfor router in routers: #2\n    app.include_router(router) \n```", "```py\n<ListItemButton onClick={() => route.push(\"/companies\")}> #1\n   <ListItemIcon> #2\n <Store/> #2\n </ListItemIcon> \n  <ListItemText primary=\"Companies\"/> #3\n</ListItemButton>\n```", "```py\nexport default function CompaniesOverviewPage() { #1\n\n    const [companies, setCompanies] =  #2\nuseState<CompaniesListingResponse[]>([]); \n\n    useEffect(() => {\n        const apiUrl = process.env.NEXT_PUBLIC_API_URL ?? ''; #3\n        axios.get<CompaniesListingResponse[]> #4\n➥(`${apiUrl}/companies`, { \n…\n            .then(response => { #5\n                setCompanies(response.data); \n            })\n…\n                    <CompaniesListing companies={companies}/> #6\n…\n```", "```py\ninterface CompaniesListingProps {  #1\n    companies: CompaniesListingResponse[];  #1\n}  #1\n\nexport default function CompaniesListing({companies}: #2\nReadonly<CompaniesListingProps>) { \n\n    const route = useRouter(); #3\n    const columns: GridColDef[] = [ #4\n        {field: 'view', headerName: '', sortable: false,\n            width: 100, renderCell: (params) => (\n            <ImageBase64 base64={params.row.logo} #5\n                         alt={params.row.name}  #5\n                         width=\"100%\" maxWidth=\"200px\" />  #5\n            )},\n        {field: 'name', headerName: 'Name', width: 300 },\n        {field: 'industry', headerName: 'Industry', width: 150 },\n    ];\n\n    const handleRowClick = (params: { id: any; }) => { #6\n        const companyId = params.id;  #7\n        route.push(`/companies/${companyId}/dashboard`);  #7\n    };  #7\n…\n       <DataGrid\n          rowHeight={100}\n          columns={columns} \n          rows={companies} \n          getRowId={(row) => row.company_id}\n          onRowClick={handleRowClick} #7\n       />\n…\n```", "```py\nconst isBase64Image = (base64: string) => {  #1\n    const regex = /^data:image\\/[a-zA-Z]+;base64,/;  #1\n    if (!regex.test(base64)) {  #1\n        return '';  #1\n    } else {  #1\n        return base64;  #1\n    }  #1\n}  #1\n\nexport default function ImageBase64({base64, #2\n      alt = 'Image',  width = '100%',  maxWidth = '100px'}:  #3\n➥ Readonly<ImageProps>) {  #3\n\n    const imageSource = isBase64Image(base64); #3\n\n    return (\n        <Box  #4\n            component=\"img\"  #4\n            src={imageSource}  #4\n            alt={alt}  #4\n            sx={{  #4\n                width: width,  #4\n                maxWidth: maxWidth,  #4\n            }}  #4\n        />  #4\n    );\n}\n```", "```py\nsrc/\n├─ app/\n│  ├─ companies/\n│  │  ├─ [companyId]/\n│  │  │  ├─ dashboard/\n│  │  │  │  ├─ page.tsx #1\n│  │  ├─ page.tsx #2\n```", "```py\n…\nexport default function CompanyDashboard({params}: any) {\n\n    const companyId: string = params.companyId; #1\n    const [company, setCompany] \n                     = useState<Company | undefined>(undefined); #2\n…\n    useEffect(() => {   #3\n        const apiUrl = process.env.NEXT_PUBLIC_API_URL ?? ''; \naxios.get<CompanyDetailResponse>(`${apiUrl} \n➥/companies/${companyId}`, { \n… \n            .then(response => { \n        console.log(`Response data ${JSON.stringify\n➥(response.data)}`); \n… \n    }, []); \n\n    return (\n…\n                    <Typography>Empty Company Dashboard</Typography> #4\n…\n    );\n}\n```", "```py\n  Scenario: Create an ACH file for company \"Elemental Resources Inc\"\n    Given I want to create an ACH file named \"elemental_resources.ach\"\n    And I want to have an immediate destination of \"990000013\"\n    And I want to have an immediate origin of \"987654321\"\n    And I want to have 2 batch with ACH credits and debits\n➥ and a standard entry class code of \"PPD\"\n    And I want 10 entries per batch with random amounts\n➥ between 100 and 5000\n    And I want to use individual names of \"Rocky Gravel, Sandy Stone,\n Clay Earthman, Mason Bricks, Gemmy Quartz, Rusty Ironwood, \nFlint Stoney, Dusty Boulderson, Shelly Shale\"\n    And I want to have company name \"ElementalResourcesInc\"\n➥ and company id \"459876543\"\n    When my ACH is created\n    Then I should have a file of the same name\n    And there should be 2 batch in the file\n    And there should be 20 entries in the file\n```", "```py\nsetup_info[\"company_name\"] = company_name[:16].ljust(16, \" \")\n```", "```py\nclass CompanyDetailRecord(BaseModel):\n    company_id: Optional[UUID4] = Field(\n        None,\n        title=\"Company ID\",\n        description=\"Unique identifier for the company.\",\n    )\n    name: Optional[str] = Field(\n        None,\n        title=\"Name\",\n        description=\"Name of the company.\",\n        max_length=255,\n    )\n…\n    addresses: Optional[list[Address]] = Field( #1\n        None,                    #1\n        title=\"Addresses\",  #1\n        description=\"List of Addresses.\",  #1\n    )  #1\n    phones: Optional[list[Phone]] = Field( #2\n        None,  #2\n        title=\"Phones\",  #2\n        description=\"List of Phone Numbers.\",  #2\n    )  #2\n```", "```py\n   SELECT c.company_id, c.ach_company_id, c.name, c.tax_id_type,#1\nc.tax_id_number, c.duns, c.logo, c.website, c.industry, \nca.company_address_id, ca.address_type, ca.address_type, #2\nca.address_line_1, ca.address_line_2, ca.address_line_3,  #2\nca.address_line_4, ca.city, ca.state,  #2\nca.zip_code, ca.zip_code_4,  #2\ncp.company_phone_id, cp.phone_type, #3\ncp.phone_number, cp.extension\nFROM companies AS c\nLEFT JOIN company_addresses AS ca USING (company_id) #4\nLEFT JOIN company_phones AS cp USING (company_id) \nWHERE company_id = %s #5\n```", "```py\ndef get_company_by_id(self, company_id: UUID) -> CompanyDetailRecord:\n   with get_db_connection(row_factory=dict_row) as conn:\n      result = conn.execute(\n…\n      )\n\n      rows = result.fetchall() #1\n\n      if not rows: #2\n         raise KeyError(f\"Record with id {company_id} not found\") \n\n      addresses = {} #3\n      phones = {} \n        for row in rows: #4\n           if row[\"company_address_id\"] not in addresses: #5\n              addresses[row[\"company_address_id\"]] = Address(  #5\n              …  #5\n              )  #5\n           if row[\"company_phone_id\"] not in phones: #6\n               …  #6\n              )  #6\n\n        company_data = {\n            \"company_id\": rows[0][\"company_id\"], #7\n            \"name\": rows[0][\"name\"],  #7\n            \"tax_id_type\": rows[0][\"tax_id_type\"],  #7\n            \"ach_company_id\": rows[0][\"ach_company_id\"],  #7\n            \"tax_id_number\": rows[0][\"tax_id_number\"],  #7\n            \"duns\": rows[0][\"duns\"],  #7\n            \"logo\": rows[0][\"logo\"],  #7\n            \"website\": rows[0][\"website\"],  #7\n            \"industry\": rows[0][\"industry\"],  #7\n            \"addresses\": list(addresses.values()), #8\n            \"phones\": list(phones.values()), \n        }\n\n        return CompanyDetailRecord(**company_data) #9\n```", "```py\nWITH company_info AS (\n   SELECT c.company_id, c.ach_company_id, c.name, c.tax_id_type,\n          c.tax_id_number, c.duns, c.logo, c.website, c.industry\n     FROM companies AS c\n    WHERE c.company_id = %s\n),\naddresses AS (\n   SELECT ca.company_id, #1\n          JSON_AGG(   #1\n             JSON_BUILD_OBJECT(  #1\n                'company_address_id', ca.company_address_id,  #1\n                'address_type', ca.address_type,  #1\n                'address_line_1', ca.address_line_1,  #1\n                'address_line_2', ca.address_line_2,  #1\n                'address_line_3', ca.address_line_3,  #1\n                'address_line_4', ca.address_line_4,  #1\n                'city', ca.city,  #1\n                'state', ca.state,  #1\n                'zip_code', ca.zip_code,  #1\n 'zip_code_4', ca.zip_code_4 #1\n  )  #1\n          ) AS addresses #1\n     FROM company_addresses AS ca  #1#2\n     WHERE ca.company_id = %s #3\n     GROUP BY ca.company_id #4\n),\nphones AS ( #5\n   SELECT cp.company_id, \n          JSON_AGG( \n             JSON_BUILD_OBJECT( \n                'company_phone_id', cp.company_phone_id, \n                'phone_type', cp.phone_type, \n                'phone_number', cp.phone_number, \n                'extension', cp.extension\n             ) \n          ) AS phones\n     FROM company_phones AS cp #6\n     WHERE cp.company_id = %s\n     GROUP BY cp.company_id\n) \nSELECT ci.company_id, ci.ach_company_id, ci.name,\nci.tax_id_type,  ci.tax_id_number, ci.duns, \nci.logo, ci.website, ci.industry, \nCOALESCE(a.addresses, '[]'::json) AS addresses, #7\nCOALESCE(p.phones, '[]'::json) AS phones\nFROM company_info AS ci\nLEFT JOIN addresses AS a ON ci.company_id = a.company_id\nLEFT JOIN phones AS p ON ci.company_id = p.company_id;\n```", "```py\n        row = result.fetchone()\n\n        if not row:\n            raise KeyError(f\"Record with id {company_id} not found\")\n\n        addresses = [Address(**address) for #1\n➥ address in row[\"addresses\"]]  #2\n        phones = [Phone(**phone) for phone in row[\"phones\"]] \n\n        company_data = {\n            \"company_id\": row[\"company_id\"],\n             …\n            \"addresses\": addresses, #2\n            \"phones\": phones, \n        }\n\n        return CompanyDetailRecord(**company_data) #3\n```", "```py\n@router.get(\n…\n)\n@log_message(\"Retrieving ACH batches\")\nasync def search_ach_batches(\n    request: Request,\n    criteria: str = Query(..., description=\"Search criteria for batches\"),\n) -> list[BatchSearchResponse]:\n    return BatchSearchSql().get_batches(criteria)\n```", "```py\n    def get_batches(self, criteria: str) -> list[BatchSearchResponse]:\n        amount_pattern = r\"^\\d+\\.\\d{2}$\"\n        multiple_amounts_pattern = r\"(^\\d+\\.\\d{2})\\s+(\\d+\\.\\d{2})$\"\n        company_id_pattern = r\"^\\d+$\"\n        company_name_pattern = r\"^[a-zA-Z1-9\\s]+$\"\n        if re.match(amount_pattern, criteria): #1\n            return self._get_batches_using_amount(criteria)  #2\n        elif match := re.match(multiple_amounts_pattern, criteria):  #2\n            begin_amount, end_amount = match.groups()  #2\n            return self._get_batches_using_amount_range(begin_amount,  #2\n end_amount)  #2\n        elif re.match(company_id_pattern, criteria):  #2\n            return self._get_batches_using_company_id(criteria)  #2\n        elif re.match(company_name_pattern, criteria):  #2\n            return self._get_batches_using_company_name(criteria)  #2\n        else:  #2\n            return self._get_batches_using_company_uuid(criteria)  #2\n```", "```py\nSELECT art1.ach_files_id AS file_id,\n       art5.ach_records_type_5_id AS batch_header_id,\n       af.file_name AS filename,\n       COALESCE(c.name, abh.company_name, '') AS company_name, #1\n       abh.company_identification AS company_identification,\n       abcr.total_credit_entry_dollar_amount \n                          AS total_credit_entry_dollar_amount,\n       abcr.total_debit_entry_dollar_amount \n                          AS total_debit_entry_dollar_amount,\n       abcr.entry_addenda_count AS entry_addenda_count\n  FROM ach_files af\nINNER JOIN ach_records_type_1 art1 USING ( ach_files_id )\nINNER JOIN ach_records_type_5 art5 USING ( ach_records_type_1_id )\nINNER JOIN ach_records_type_8 art8 USING ( ach_records_type_5_id )\nINNER JOIN ach_batch_headers abh USING ( ach_records_type_5_id )\nINNER JOIN ach_batch_control_records abcr USING ( ach_records_type_8_id )    \n LEFT JOIN companies c ON #2\n abh.company_identification = c.ach_company_id #3\n```", "```py\ninterface RecentCompanyBatchesProps {\n    companyId?: string;\n}\n\nexport default function \n➥RecentCompanyBatches({companyId}: Readonly<RecentCompanyBatchesProps>) {\n\n    const router = useRouter(); #1\n    const [results, setResults] =  #2\n➥ useState<AchBatchSearchResponse[]>([]); \n\n    useEffect(() => {\n\n        if (!companyId) {\n            return;\n        }\n\n        const apiUrl = process.env.NEXT_PUBLIC_API_URL ?? '';\n        axios.get<AchBatchSearchResponse[]>(`${apiUrl}/files/ #3\n➥batches/search?criteria=${companyId}`, {  #3\n…  #3\n    }, [companyId]); \n\n    const columns: GridColDef[] = [\n       {field: 'file_id', headerName: 'File', \n        sortable: false, width: 50, renderCell: (params) => (\n            <Link onClick={() => #4\nrouter.push(`/fileDetails/${params.row.file_id}`)}  #5\n    sx={{ cursor: 'pointer' }}>View</Link> \n            )},\n        {field: 'batch_header_id', headerName: 'Batch',\n         sortable: false, width: 50, renderCell: (params) => (\n            <Link onClick={() => #5\nrouter.push(`/fileDetails/${params.row.file_id}/batchDetails/  #5\n   ${params.row.batch_header_id}`)}   #5\n         sx={{ cursor: 'pointer' }}>View</Link>  #5\n…\n        {field: 'total_credit_entry_dollar_amount', \n            headerName: 'Total Credit', width: 125, \n            renderCell: (params) => ( #6\n               formatCurrency(Number(  #6\n                  params.row.total_credit_entry_dollar_amount))  #6\n            )},  #6\n        {field: 'total_debit_entry_dollar_amount',\n         headerName: 'Total Debit', width: 125, \n         renderCell: (params) => (\n            formatCurrency(Number(params.row.total_debit_entry_dollar_amount))\n            )},\n    ];\n\n    return (\n…\n       <Title>Recent Company Batches</Title>\n       <DataGrid rows={results}  #7\n                 columns={columns}   #8\n                 getRowId={(row: any) => row.batch_header_id}/>  #8\n…\n```", "```py\nCREATE TYPE schedule_type AS ENUM ('daily', 'weekly', 'bi-weekly',\n       'monthly', 'quarterly', 'semi-annually', 'annually');\n\nCREATE TABLE company_expected_files (\n    company_expected_files_id UUID DEFAULT uuid_generate_v4(), #1\n    company_id UUID NOT NULL REFERENCES companies(company_id)\n    ON DELETE CASCADE ON UPDATE CASCADE,\n    file_name VARCHAR(255) NOT NULL,\n    schedule SCHEDULE_TYPE NOT NULL DEFAULT 'daily',\n    last_file_date TIMESTAMP DEFAULT NULL,\n    created_at TIMESTAMP NOT NULL DEFAULT NOW(),\n    updated_at TIMESTAMP NOT NULL DEFAULT NOW(),\n    PRIMARY KEY (company_id, file_name) #2\n);\n```", "```py\nINSERT INTO company_expected_files ( company_id, file_name,\n            schedule, last_file_date )\nVALUES (\n   (SELECT c.company_id FROM companies AS c  #1\n             WHERE tax_id_number = '345678901'), \n   'stellar_services.ach',\n   'daily',\n   NOW() - INTERVAL '1 day'\n);\n```", "```py\n@pytest.fixture(scope=\"module\")\ndef docker_compose():\n    absolute_path = Path(\"../../../../../docker/db\").resolve()\n    with DockerCompose(absolute_path, build=True, #1\n                       services=[\"postgres\"])  #2\n as compose:  #2\n        compose.start() #2\n        yield compose #2\n        compose.stop() \n…\n    def test_get_expected_files_for_company(self, docker_compose, sql):\n        company_id =  #3\nCompanySearchSql().get_companies(\"459876543\").company_id #4\n        assert company_id is not None #4\n        results = sql.get_expected_files_for_company(company_id) #5\n        assert len(results) == 2 #6\n        assert any(  #7\n            record.file_name == \"elemental_resources.ach\"  #7\n                                            for record in results #7\n        )  #7\n        assert any(  #7\n            record.file_name == \"elemental_resources_daily_billpay.ach\"  #7\n                                            for record in results #7\n        )  #7\n```", "```py\nWITH future_file_dates AS ( #1\n   SELECT ef.company_expected_file_id,  #1\n       ef.company_id,  #1\n       ef.file_name,  #1\n       CASE ef.schedule #1\n          WHEN 'daily' THEN ef.last_file_date + INTERVAL '1 day' #1\n          WHEN 'weekly' THEN ef.last_file_date + INTERVAL '1 week' #1\n          WHEN 'bi-weekly' THEN ef.last_file_date + INTERVAL '2 weeks'  #1\n          WHEN 'monthly' THEN ef.last_file_date + INTERVAL '1 month'  #1\n          WHEN 'quarterly' THEN ef.last_file_date  #1\n                                               + INTERVAL '3 months'  #1\n          WHEN 'semi-annually' THEN ef.last_file_date   #1\n                                               + INTERVAL '6 months'  #1\n          WHEN 'annually' THEN ef.last_file_date + INTERVAL '1 year'  #1\n          ELSE ef.last_file_date  #1\n       END AS next_file_date  #1\n  FROM company_expected_files AS ef  #1\n WHERE ef.company_id = %s  #1\n)  #1\nSELECT ef.company_expected_file_id, ef.file_name, ef.schedule, #1\n    ef.last_file_date, ffd.next_file_date,\n    CASE #2\n       WHEN af.file_name IS NOT NULL   #2\n            AND af.created_at::date = ef.last_file_date::date   #2\n               THEN TRUE #2\n       ELSE FALSE  #2\n    END AS file_loaded  #2\n   FROM company_expected_files AS ef\nINNER JOIN future_file_dates AS ffd USING (company_expected_file_id)\n LEFT JOIN ach_files AS af ON ef.file_name = af.file_name\n     WHERE ef.company_id = %s;\n```", "```py\n    parser = AchFileProdates\n    ach_file = AchFileSchema(file_name=file.filename, \nfile_hash=file.content_type)\n    ach_files_id = AchFileSql().insert_record(ach_file)\n    try:\n        print(f\"Processing file {temp_file.name}\")\n        seq = parser.parse(ach_files_id, temp_file.name)\n ExpectedFilesSql().update_last_file_date(file.filename) #1\n    except Exception as e:\n        print(e)\n        return {\"error\": \"Invalid file\"}\n    return {\n        \"filename\": file.filename,\n        \"content_type\": file.content_type,\n        \"last_seq\": seq,\n```", "```py\n   UPDATE company_expected_files\n                       SET last_file_date = NOW(), #1\n                           updated_at = NOW() \n                     WHERE file_name = %s\n```", "```py\nWITH adjusted_date AS (\n    SELECT\n        NOW() + INTERVAL '1 day' AS initial_date\n)\nUPDATE company_expected_files\n        SET last_file_date = (SELECT CASE #1\n                           WHEN EXTRACT(DOW FROM initial_date) = 0 THEN   #2\ninitial_date + INTERVAL '1 day' #2\n                           WHEN EXTRACT(DOW FROM initial_date) = 6 THEN  #2\ninitial_date + INTERVAL '2 day'  #2\n                           ELSE initial_date  #2\n                         END\n                            FROM adjusted_date),\n            updated_at = NOW()\n      WHERE file_name = %s\n```", "```py\n…\ninterface ExpectedFilesProps {\n    companyId?: string;\n}\nexport default function ExpectedFiles({companyId}:\n➥ Readonly<ExpectedFilesProps>) {\n\n    const [results, setResults] = useState<CompanyExpectedFilesResponse[]>([]);\n…\n  axios.get<CompanyExpectedFilesResponse[]>\n➥(`${apiUrl}/companies/${companyId}/expect…\n\n    const columns: GridColDef[] = [\n        {field: 'file_loaded', headerName: 'Loaded', width: 75,\n         renderCell: (params) => (\n                params.value ? <TaskAlt sx={{color: \"green\"}} /> : #1\n<RadioButtonUnchecked /> \n…\n        {field: 'file_name', headerName: 'File Name', width: 200},\n        {field: 'schedule', headerName: 'Schedule', width: 75},\n…\n            field: 'last_file_date', headerName: 'Last File Date',\n            width: 100,\n            renderCell: (params) => (\n                params.value ? new Date(params.value as \n➥ string).toLocaleDateString() : ''\n…\n            field: 'next_file_date', \n            headerName: 'Next Expected Date', width: 150,\n            renderCell: (params) => (\n                params.value ? new Date(params.value as\n➥ string).toLocaleDateString() : ''\n…\n\n    return (\n…\n                    <Title>Expected Files</Title>\n                    <DataGrid rows={results} columns={columns}\n                     getRowId={(row: any) =>\n                     row.company_expected_file_id}/>\n```", "```py\nCREATE TABLE company_limits\n(\n    company_limit_id   UUID               DEFAULT uuid_generate_v4(),\n    company_id         UUID      NOT NULL REFERENCES \n                                 companies (company_id) \n                   ON DELETE CASCADE ON UPDATE CASCADE,\n    daily_debit_limit  NUMERIC(12, 2)     DEFAULT NULL,\n    daily_credit_limit NUMERIC(12, 2)     DEFAULT NULL,\n    created_at         TIMESTAMP NOT NULL DEFAULT NOW(), #1\n    updated_at         TIMESTAMP NOT NULL DEFAULT NOW() \n);\n```", "```py\nINSERT INTO ach_exception_codes (exception_code, #1\n    exception_severity, exception_description)  #1\nVALUES ('006', 'warning',   #1\n 'Company Limits  Exceeded');  #1\n…\nINSERT INTO ach_recovery_options #2\n       (exception_code, recovery_option)   #3\nVALUES ('006', 'Alert company their limit has been exceeded'); \n```", "```py\nINSERT INTO company_limits \n   ( company_id, daily_debit_limit, daily_credit_limit)\nVALUES (\n        (SELECT c.company_id FROM companies AS c \n              WHERE tax_id_number = '459876543'),\n        400.00,\n        750.00\n       );\n```", "```py\ncase \"8\":\n    ach_record = AchRecordType8Schema(\n        ach_records_type_5_id=current_batch_header_id,\n            unparsed_record=line,\n            sequence_number=sequence_number,\n         )\n    ach_record_id = AchRecordsSqlType8().insert_record(ach_record)\n    self.last_trace_number = None\n    self._parse_batch_control(ach_record_id, line)\n    if CompanyLimitsSql(). #1\n➥file_exceeds_company_limits(ach_file_id): \n        AchExceptionsSql().insert_record( #2\n            AchExceptionSchema( #3\n                ach_files_id=ach_file_id,  #4\n                ach_batch_id=current_batch_header_id,  #4\n                record_number=sequence_number,  #4\n                exception_code=  #4\n                   AchExceptions.COMPANY_LIMITS_EXCEEDED.value,  #4\n            )  #4\n        ) \n```", "```py\nwith get_db_connection(row_factory=class_row(CompanyLimitsRecord)) as conn:\n   result = conn.execute(\n   \"\"\"\n      WITH ach_batch_totals AS ( #1\n         SELECT\n                c.company_id,\n                SUM(abcr.total_credit_entry_dollar_amount) #2\n                                     AS current_credit_total,  #2\n                SUM(abcr.total_debit_entry_dollar_amount)   #2\n                                     AS current_debit_total \n           FROM ach_files AS af\n     INNER JOIN ach_records_type_1 AS art1 USING (ach_files_id)\n     INNER JOIN ach_records_type_5 AS art5 USING (ach_records_type_1_id)\n     INNER JOIN ach_records_type_8 AS art8 USING (ach_records_type_5_id)\n     INNER JOIN ach_batch_headers AS abh USING (ach_records_type_5_id)\n     INNER JOIN ach_batch_control_records AS abcr \n        USING (ach_records_type_8_id)\n     INNER JOIN companies AS c \n        ON c.ach_company_id = abh.company_identification\n          WHERE af.ach_files_id = %s\n       GROUP BY c.company_id\n   )\n   SELECT 1 #3\n   FROM ach_files AS af\n   INNER JOIN ach_records_type_1 AS art1 USING (ach_files_id)\n   INNER JOIN ach_records_type_5 AS art5 USING (ach_records_type_1_id)\n   INNER JOIN ach_records_type_8 AS art8 USING (ach_records_type_5_id)\n   INNER JOIN ach_batch_headers AS abh USING (ach_records_type_5_id)\n   INNER JOIN companies AS c ON c.ach_company_id = abh.company_identification\n   INNER JOIN company_limits AS cl USING (company_id)\n    LEFT JOIN ach_batch_totals AS abt USING (company_id)\n        WHERE af.ach_files_id = %s  #4\n          AND ( abt.current_credit_total > cl.daily_credit_limit #5\n                OR abt.current_debit_total > cl.daily_debit_limit ) \n        LIMIT 1\n   \"\"\",\n   [file_id, file_id],\n   )\nreturn result.fetchone() is not None #5\n```", "```py\nWITH ach_batch_totals AS (\n    SELECT\n        c.company_id,\n        SUM(abcr.total_credit_entry_dollar_amount) \n                                AS current_credit_total,\n        SUM(abcr.total_debit_entry_dollar_amount) \n                                AS current_debit_total\n    FROM ach_records_type_5 AS art5\n    INNER JOIN ach_records_type_8 \n                         AS art8 USING (ach_records_type_5_id)\n    INNER JOIN ach_batch_headers \n                         AS abh USING (ach_records_type_5_id)\n    INNER JOIN ach_batch_control_records \n                         AS abcr USING (ach_records_type_8_id)\n    INNER JOIN companies AS c \n              ON c.ach_company_id = abh.company_identification \n             AND c.company_id = %s\n    GROUP BY c.company_id\n)\nSELECT cl.company_limit_id,\n       cl.daily_debit_limit,\n       cl.daily_credit_limit,\n       COALESCE(abt.current_credit_total, 0) AS current_credit_total, #1\n       COALESCE(abt.current_debit_total, 0) AS current_debit_total, \n       CASE #2\n           WHEN abt.current_credit_total > cl.daily_credit_limit   #2\n           THEN TRUE #2\n           ELSE FALSE #2\n       END AS daily_credit_exceeded,  #2\n       CASE  #2\n           WHEN abt.current_debit_total > cl.daily_debit_limit   #2\n           THEN TRUE  #2\n           ELSE FALSE  #2\n       END AS daily_debit_exceeded  #2\nFROM company_limits AS cl\nLEFT JOIN ach_batch_totals AS abt USING (company_id)\nWHERE cl.company_id = %s\n```", "```py\n…\n        axios.get<CompanyLimitsResponse>(`${apiUrl}/companies\n➥/${companyId}/limits`, …\n   return (\n…\n      <Title>Company Limits</Title>\n      <Typography component=\"p\" variant=\"h4\">\n         Company Credits:\n      </Typography>\n      <Typography component=\"p\" variant=\"h6\">\n      <Typography component=\"span\" \n                  variant=\"h6\" \n                  style={{color: response.daily_credit_exceeded ? #1\n                                                'red' : 'green'}}> \n         {formatCurrency(response.current_credit_total)}\n      </Typography>\n         {\" of \"}\n         {formatCurrency(response.daily_credit_limit)}\n      </Typography>\n      <Typography component=\"p\" variant=\"h4\">\n         Company Debits:\n      </Typography>\n      <Typography component=\"p\" variant=\"h6\">\n      <Typography component=\"span\" \n                  variant=\"h6\" \n                  style={{color: response.daily_debit_exceeded ? #2\n                                              'red' : 'green'}}> \n      {formatCurrency(response.current_debit_total)}\n   </Typography>\n      {\" of \"}\n      {formatCurrency(response.daily_debit_limit)}\n…\n```", "```py\nSELECT\n       ae.ach_exceptions_id AS id,\n       af.created_at AS created_at,\n       ae.exception_code AS exception_code,\n aec.exception_description AS description,\n  acr.unparsed_record AS unparsed_record,\n COALESCE(c.name, abh.company_name, '') AS company_name, #1\n aro.recovery_option AS recovery_option\nFROM ach_exceptions AS ae\nINNER JOIN ach_exception_codes AS aec USING (exception_code)\nINNER JOIN ach_files AS af USING (ach_files_id)\nINNER JOIN ach_combined_records AS acr \n             ON ae.ach_files_id = acr.ach_files_id\n             AND ae.record_number = acr.sequence_number\nLEFT JOIN ach_recovery_options AS aro #2\n USING (exception_code) #3\nLEFT JOIN ach_batch_headers AS abh  #3\n USING(ach_records_type_5_id) #3\nLEFT JOIN companies AS c   #3\n ON abh.company_identification = c.ach_company_id #3\nWHERE ae.ach_files_id = %s \nAND ae.ach_exceptions_id = %s   \n```", "```py\nconst [exceptionData, setExceptionData] = \n        useState<AchExceptionDetailsResponse | null>(null);\n…\n            setExceptionData(response.data);\n\n            <ExceptionsModal open={isOpen} #1\n                             onClose={() => setIsOpen(false)}   #2\n                             exceptionData={exceptionData} /> \n…\n```", "```py\n…\ninterface ExceptionModalProps {\n  open: boolean;\n  onClose: () => void;\n  exceptionData: AchExceptionDetailsResponse | null;\n}\n…\nconst ExceptionsModal: FC<ExceptionModalProps> = \n      ({ open, onClose, exceptionData }:\n➥ Readonly<ExceptionModalProps>) => {\n  return (\n …\n        { exceptionData?.company_name !== '' && #1\n            <Box>  #1\n        <Typography id=\"audit-modal-description\"   #1\n           sx={{ mt: 2 }}  fontWeight={'fontWeightBold'}>  #1\n          Company Name:  #1\n        </Typography>  #1\n        <Typography>{exceptionData?.company_name}</Typography>  #1\n        </Box>  #1\n        }  #1\n  …\n        <Typography> #2\n          {exceptionData?.recovery_option ?? 'None Provided'}  #3\n        </Typography> \n     <Button onClick={onClose} sx={{ mt: 2 }}>\n          Close\n        </Button>\n…\n```", "```py\n…    \nconst [isOpen, setIsOpen] = useState(false);\n    const [exceptionData, setExceptionData] = \n              useState<AchExceptionDetailsResponse | null>(null);\n        {field: 'file_name', headerName: 'Filename', width: 150},\n        {field: 'created_at', headerName: 'Date', width: 150, \n           valueGetter: (params) => convertDateFormat(params.value)},\n        {field: 'record_number', headerName: 'Record Number', width: 150},\n {field: 'exception_code', headerName: 'Code', width: 10}, #1\n        {field: 'description', headerName: 'Description', width: 300},\n…\n            <ExceptionsModal open={isOpen}  #2\nonClose={() => setIsOpen(false)}  #3\n exceptionData={exceptionData} />  #3\n…\n```"]