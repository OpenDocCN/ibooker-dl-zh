<html><head></head><body>
<div id="sbo-rt-content"><div class="readable-text" id="p1">
<h1 class="readable-text-h1"><span class="chapter-title-numbering"><span class="num-string">5</span></span> <span class="chapter-title-text">Crafting a data story using the DIKW pyramid</span></h1>
</div>
<div class="introduction-summary">
<h3 class="introduction-header">This chapter covers</h3>
<ul>
<li class="readable-text" id="p2">A homelessness tale, our scenario for this chapter</li>
<li class="readable-text" id="p3">What a data story is and how it relates to the DIKW pyramid</li>
<li class="readable-text" id="p4">How to incorporate generative AI into the DIKW pyramid</li>
</ul>
</div>
<div class="readable-text" id="p5">
<p>Creating stories is the most exciting part of data storytelling. It’s really about following a plot with a beginning, a main point, and a conclusion—just like in the stories at the cinema or theater. Here, however, there are constraints imposed by the data. In this chapter, we will focus on using the DIKW pyramid by describing two examples. The first example will analyze the problem of homelessness in Italy, and the second will examine the problem of fake news on a hypothetical website. We will also describe the concept of a data story and how it relates to the DIKW pyramid already discussed in the previous chapters. Finally, we will describe some strategies to incorporate generative AI in the DIKW pyramid, based on how to write specific prompts for ChatGPT to generate the context of a chart and for DALL-E to generate contextual images to incorporate into the chart.</p>
</div>
<div class="readable-text" id="p6">
<h2 class="readable-text-h2"><span class="num-string">5.1</span> Breaking the ice: The homelessness tale</h2>
</div>
<div class="readable-text" id="p7">
<p>Imagine that Angelica works for a humanitarian organization that wants to apply for funding from a foundation to help reduce the population of homeless people in Italy. Humanitarian interventions can be applied to up to four Italian regions. The call for funds involves preparing a data visualization chart motivating the selected regions and detailing reasons to fund the proposal.</p>
</div>
<div class="readable-text intended-text" id="p8">
<p>Angelica’s boss asks her to complete a study on which regions to invest in and to motivate her choice. Angelica starts a web search for possible datasets on homelessness in Italy. After several searches, she comes across the ISTAT dataset on homelessness in 2021 (<a href="https://mng.bz/Bd6J">https://mng.bz/Bd6J</a>). She downloads the dataset and starts analyzing it. Table 5.1 shows a simplified version of an extract of the homelessness dataset. The original dataset column names are in Italian. They are translated into English to improve readability.</p>
</div>
<div class="browsable-container browsable-table-container framemaker-table-container" id="p9">
<h5 class="browsable-container-h5"><span class="num-string">Table 5.1</span> An extract of the ISTAT dataset on homelessness in 2021</h5>
<table>
<thead>
<tr>
<th>
<div>
         ITTER107 
       </div></th>
<th>
<div>
         Territory 
       </div></th>
<th>
<div>
         Sex 
       </div></th>
<th>
<div>
         Age 
       </div></th>
<th>
<div>
         Citizenship 
       </div></th>
<th>
<div>
         Value 
       </div></th>
</tr>
</thead>
<tbody>
<tr>
<td>  ITC1 <br/></td>
<td>  Piemonte <br/></td>
<td>  M <br/></td>
<td>  TOTAL <br/></td>
<td>  ITL <br/></td>
<td>  4,218 <br/></td>
</tr>
<tr>
<td>  ITC1 <br/></td>
<td>  Piemonte <br/></td>
<td>  F <br/></td>
<td>  TOTAL <br/></td>
<td>  ITL <br/></td>
<td>  1,496 <br/></td>
</tr>
<tr>
<td>  ITC2 <br/></td>
<td>  Valle d'Aosta <br/></td>
<td>  M <br/></td>
<td>  TOTAL <br/></td>
<td>  ITL <br/></td>
<td>  41 <br/></td>
</tr>
<tr>
<td>  ITC2 <br/></td>
<td>  Valle d'Aosta <br/></td>
<td>  F <br/></td>
<td>  TOTAL <br/></td>
<td>  ITL <br/></td>
<td>  17 <br/></td>
</tr>
</tbody>
</table>
</div>
<div class="callout-container sidebar-container">
<div class="readable-text" id="p10">
<h5 class="callout-container-h5 readable-text-h5">The ISTAT dataset on homelessness </h5>
</div>
<div class="readable-text" id="p11">
<p>The dataset has the following columns: </p>
</div>
<ul>
<li class="readable-text" id="p12"> <em>ITTER107</em>—The region ID </li>
<li class="readable-text" id="p13"> <em>Territory</em>—The region name </li>
<li class="readable-text" id="p14"> <em>Sex</em>—One of Male (M), Female (F), or Total (T) </li>
<li class="readable-text" id="p15"> <em>Age</em>—One of Sum of All Ages (TOTAL), Under 17 (Y_UN17), Between 18 and 34 (Y18-34), Between 35 and 54 (Y35-54), and Greater Than 55 ('Y_GE55) </li>
<li class="readable-text" id="p16"> <em>Citizenship</em>—One of Italian (ITL), Foreign (FRGAPO), or Total (TOTAL) </li>
<li class="readable-text" id="p17"> <em>Value</em>—The actual number of homeless people </li>
</ul>
</div>
<div class="readable-text" id="p18">
<p>At the end of her analysis, Angelica produces the chart shown in figure 5.1 by writing the code in the following listing, using Altair. You can find the full code in the GitHub repository for the book under CaseStudies/homeless-people/raw-chart.py.</p>
</div>
<div class="browsable-container listing-container" id="p19">
<h5 class="listing-container-h5 browsable-container-h5"><span class="num-string">Listing 5.1</span> The map in Altair</h5>
<div class="code-area-container">
<pre class="code-area">import pandas as pd
import altair as alt

df = pd.read_csv('source/homeless.csv')

df['Territory'] = df['Territory'].str.replace('Trentino Alto Adige', 'Trentino-Alto Adige/Südtirol')    <span class="aframe-location"/> #1

df = df[(df['Age'] == 'TOTAL') &amp; (df['Sex'] == 'T') &amp;  (df['Citizenship'] == 'TOTAL')]           <span class="aframe-location"/> #2

url = "https://raw.githubusercontent.com/openpolis/geojson-italy/master/topojson/limits_IT_regions.topo.json"
map = alt.topo_feature(url, "regions")   <span class="aframe-location"/> #3

chart = alt.Chart(map).mark_geoshape().encode(
    tooltip='properties.reg_name:N',
    color=alt.Color('Value:Q')
).project('mercator').properties(
    width=500,
    height=500
).transform_lookup(
    lookup='properties.reg_name',
    from_=alt.LookupData(df, 'Territory', ['Territory', 'Value'])
).properties(title='Homeless in Italy in 2021')

chart.save('raw-chart.xhtml')<span class="aframe-location"/></pre>
<div class="code-annotations-overlay-container">
     #1 Data cleaning
     <br/>#2 Focus on total age, total sex, and total citizenship.
     <br/>#3 Load the TopoJSON file by URL.
     <br/>
</div>
</div>
</div>
<div class="browsable-container figure-container" id="p20">
<img alt="figure" height="1004" src="../Images/5-1.png" width="1100"/>
<h5 class="figure-container-h5"><span class="num-string">Figure 5.1</span> A map showing the homeless people in Italy in 2021</h5>
</div>
<div class="readable-text print-book-callout" id="p21">
<p><span class="print-book-callout-head">Note</span>  The chart builds a map using an underlying <code>topoJSON</code> object containing the map of Italy. To build the map, use the <code>mark_geoshape()</code> marker, and specify the projection through the <code>project(</code>) method. In addition, combine the homeless dataset (<code>df</code>) and the map through the <code>transform_lookup()</code> method. Map the <code>properties.reg_name</code> variable of the <code>topoJSON</code> file with the <code>Territory</code> variable of the <code>df</code> DataFrame. We’ll discuss how to build a geographical map more deeply in the next chapter.</p>
</div>
<div class="readable-text" id="p22">
<p>Angelica shows the chart to her boss, who asks her to answer their question: <em>Which are the four regions for which we must apply for funding?</em> Angelica looks at the chart and gives this answer: <em>those with the darker color</em>. Her answer is very ambiguous because from the chart she produced, it is not immediately clear which exactly are the four regions with the darkest color. In addition, it is not clear why to select the four regions. Angelica has to admit that her chart has failed in its mission.</p>
</div>
<div class="readable-text" id="p23">
<h3 class="readable-text-h3"><span class="num-string">5.1.1</span> What was wrong with the chart?</h3>
</div>
<div class="readable-text" id="p24">
<p>The main problem with the chart is there is a large discrepancy between what Angelica’s boss (audience) expected to see in the chart and what the chart actually shows. In practice, Angelica’s chart does not answer the question for which it was requested (figure 5.2).<span class="aframe-location"/></p>
</div>
<div class="browsable-container figure-container" id="p25">
<img alt="figure" height="497" src="../Images/5-2.png" width="1100"/>
<h5 class="figure-container-h5"><span class="num-string">Figure 5.2</span> Angelica’s boss (audience) requested an answer to a specific question (on the left). The chart actually answered generic questions (on the right).</h5>
</div>
<div class="readable-text" id="p26">
<p>Here comes the first rule when building a chart: a chart must answer exactly the question the intended audience asks. Try not to leave it up to your audience to decipher the answer. Do the work for them!</p>
</div>
<div class="readable-text intended-text" id="p27">
<p>Angelica’s boss asks her to redo the chart. She returns to her office with her head down and analyzes her dataset again. Angelica understands that the problem is not so much data analysis but rather how to represent data effectively. She tries this reasoning: <em>at a glance, the audience must understand the four regions to apply for funding. What could these four regions be? Probably the ones that have the highest value of homeless people</em>. What is missing in her previous chart is the <em>probably </em>part. She considers making a bar chart that shows the regions in descending order based on the number of homeless people present. After a small effort, she produces the chart in figure 5.3, writing the code in listing 5.2. You can also find the code in the GitHub repository for the book under CaseStudies/homeless-people/bar-chart.py.<span class="aframe-location"/></p>
</div>
<div class="browsable-container figure-container" id="p28">
<img alt="figure" height="806" src="../Images/5-3.png" width="1100"/>
<h5 class="figure-container-h5"><span class="num-string">Figure 5.3</span> A bar chart showing the number of homeless people in Italy by region in 2021</h5>
</div>
<div class="browsable-container listing-container" id="p29">
<h5 class="listing-container-h5 browsable-container-h5"><span class="num-string">Listing 5.2</span> The bar chart in Altair</h5>
<div class="code-area-container">
<pre class="code-area">chart = alt.Chart(df).mark_bar(
    color='#80C11E'
).encode(
    y = alt.Y('Territory', 
              sort='-x', 
              axis=alt.Axis(title='')),
    x = alt.X('Value', 
              axis=alt.Axis(tickCount=4,title='Number of homeless people'))
).properties(
    width=500,
    title='Homelessness in Italy in 2021'
)

).properties(title='Homeless in Italy in 2021')

chart = chart.configure_title(
    fontSize=20,
    offset=25
).configure_axis(
    grid=False
).configure_view(
    strokeWidth=0
)

chart.save('bar-chart.xhtml')</pre>
</div>
</div>
<div class="readable-text print-book-callout" id="p30">
<p><span class="print-book-callout-head">Note</span>  The code builds a bar chart using the <code>mark_bar()</code> method. It also sets the bars’ color using the <code>color</code> parameter. To order the bars in descending order, use the <code>sort</code> parameter within the <code>y</code> channel, and specify to sort in descending order of the <code>x</code> encoding channel. Use <code>configure_title()</code> to configure the title parameters, such as the font size (<code>fontSize</code>) and the <code>offset</code> between the title and the chart.</p>
</div>
<div class="readable-text" id="p31">
<p>The chart answers the boss’s question: the four regions are Lazio, Lombardia, Piemonte, and Campania. Angelica notes that three of the four regions also correspond to the most populous regions of Italy. As Angelica reflects on this, she notices that her chart contains an underlying error. The most populous regions also have the highest number of homeless people precisely because their population is greater.</p>
</div>
<div class="readable-text intended-text" id="p32">
<p>Therefore, the chart does not show the situation in a relevant way. She needs to normalize the data based on the population—or scale the numbers based on population size. Without any normalization, data could be biased. Consider, for example, the case of a region with a population of 100 people, of which 30 are homeless. Also, consider region with a population of 10 people, of which 8 are homeless. If you represent absolute values, you conclude that in the first case, there are more homeless people than in the second one. But if you pay more attention to the scenario, in the second case, 80% of the population are homeless, while in the first case, only 30% are homeless. </p>
</div>
<div class="readable-text intended-text" id="p33">
<p>Figure 5.4 shows the resulting chart after the normalization process, focusing on the regions with the four largest homeless populations. Listing 5.3 describes the code written to draw the chart (script CaseStudies/homeless-people/story-chart.py).<span class="aframe-location"/></p>
</div>
<div class="browsable-container figure-container" id="p34">
<img alt="figure" height="892" src="../Images/5-4.png" width="1029"/>
<h5 class="figure-container-h5"><span class="num-string">Figure 5.4</span> A bar chart showing the number of homeless people in a region with a population of 1,000 in 2021</h5>
</div>
<div class="browsable-container listing-container" id="p35">
<h5 class="listing-container-h5 browsable-container-h5"><span class="num-string">Listing 5.3</span> Listing 5.3 The improved bar chart in Altair</h5>
<div class="code-area-container code-area-with-html">
<pre class="code-area">import pandas as pd
import altair as alt

df = pd.read_csv('source/homeless.csv')

df['Territory'] = df['Territory'].str.replace('Trentino Alto Adige', 
<span class="">↪</span> 'Trentino-Alto Adige/Südtirol')        <span class="aframe-location"/> #1

df = df[(df['Age'] == 'TOTAL') &amp; (df['Sex'] == 'T') &amp;  (df['Citizenship'] 
<span class="">↪</span> == 'TOTAL')]                  <span class="aframe-location"/> #2
df = df[['Value', 'ITTER107']] 

df_pop = pd.read_csv('source/population.csv')
df_pop = df_pop[(df_pop['Age'] == 'TOTAL') &amp; (df_pop['Sex'] == 'T')]   <span class="aframe-location"/> #3


df_pop = df_pop[['Value', 'ITTER107','Territory']]

df_tot = df_pop.set_index('ITTER107').join(df.set_index('ITTER107'),
<span class="">↪</span> lsuffix='_pop', rsuffix='_hom').reset_index()
df_tot['Ratio'] = df_tot['Value_hom']/df_tot['Value_pop']*1000


chart = alt.Chart(df_tot).mark_bar().encode(
    y = alt.Y('Territory', 
              sort='-x', 
              axis=alt.Axis(title='')),
    x = alt.X('Ratio', 
              axis=alt.Axis(tickCount=4,title='')),
    color=alt.condition(alt.datum.Ratio &gt; 2, 
                        alt.value('#80C11E'), 
                        alt.value('lightgray'))

).properties(
    width=500,
    title='Number of homeless people in a population of 1,000'
)</pre>
<div class="code-annotations-overlay-container">
     #1 Data cleaning
     <br/>#2 Focus on total age, total sex, and total citizenship.
     <br/>#3 Normalize the values by popultation.
     <br/>
</div>
</div>
</div>
<div class="readable-text print-book-callout" id="p36">
<p><span class="print-book-callout-head">Note</span>  The code loads the population dataset, which contains the same fields as the homeless dataset, except for the Value column, which indicates the actual population. The code merges the two datasets, population (<code>df_pop</code>) and homeless (<code>df</code>), and calculates the ratio between the number of homeless and the population. Then, the chart builds a bar chart using the ratio as the <code>x</code> encoding channel.</p>
</div>
<div class="readable-text" id="p37">
<p>Angelica’s chart eventually answers her boss’s question: the four regions are Lazio, Liguria, Piemonte, and Sardegna. Finally, Angelica shows her chart to her boss, who is very satisfied with her result. </p>
</div>
<div class="readable-text intended-text" id="p38">
<p>To apply for funds, Angelica must send her chart to a commission, which will decide whether or not to finance her organization’s proposal. However, after a careful evaluation, the foundation commission decides not to finance her project because the chart lacks motivation. </p>
</div>
<div class="readable-text" id="p39">
<h3 class="readable-text-h3"><span class="num-string">5.1.2</span> What was wrong with the presentation?</h3>
</div>
<div class="readable-text" id="p40">
<p>To understand why the foundation commission refused to fund Angelica’s proposal, let’s trace back the path she followed. She started with raw data, analyzed it, extracted an insight, and represented it through a chart before she sent it to the foundation commission (figure 5.5). <span class="aframe-location"/></p>
</div>
<div class="browsable-container figure-container" id="p41">
<img alt="figure" height="406" src="../Images/5-5.png" width="1100"/>
<h5 class="figure-container-h5"><span class="num-string">Figure 5.5</span> Angelica’s journey to chart generation. Angelica presented the results of data exploration directly to her audience.</h5>
</div>
<div class="readable-text intended-text" id="p42">
<p>What is lacking about her chart is that it contains no context and no motivation to push the foundation commission to accept her proposal. Angelica should have added an explanatory phase to the exploratory phase of the data, where she could have engaged the audience with her data and motivated them to accept her proposal. Angelica could have used the DIKW model to move from the exploratory phase of her data to the explanatory phase (figure 5.6).<span class="aframe-location"/></p>
</div>
<div class="browsable-container figure-container" id="p43">
<img alt="figure" height="417" src="../Images/5-6.png" width="1100"/>
<h5 class="figure-container-h5"><span class="num-string">Figure 5.6</span> Angelica should have transformed her data exploration into a data explanation phase.</h5>
</div>
<div class="readable-text" id="p44">
<p>In other words, Angelica hasn’t turned data into a story. In his book, <em>Effective Data Storytelling</em>, Brent Dykes says, “The formation of a data story begins with using exploratory data visualizations to discover insights. Once a meaningful insight is uncovered, explanatory data visualizations are used to tell a story.” (Dykes, 2019) The chart built by Angelica constitutes only the main point of the data story. However, to have a complete story, Angelica should have also included a background and next steps (figure 5.7). <span class="aframe-location"/>The foundation commission expected Angelica’s chart to answer this question: <em>Why should we fund your project?</em> Organizing the chart as a story would have increased her chances of receiving funding.</p>
</div>
<div class="browsable-container figure-container" id="p45">
<img alt="figure" height="467" src="../Images/5-7.png" width="1100"/>
<h5 class="figure-container-h5"><span class="num-string">Figure 5.7</span> The foundation commission expected to see a story with a background, a main point, and next steps, inviting them to fund Angelica’s proposal.</h5>
</div>
<div class="readable-text intended-text" id="p46">
<p>Now, you understand the urgency behind turning data into a story to communicate a message to an audience effectively. Next, let’s move to the next step: what a data story is and its main components.</p>
</div>
<div class="readable-text" id="p47">
<h2 class="readable-text-h2"><span class="num-string">5.2</span> Uncovering the narrative: What a data story is</h2>
</div>
<div class="readable-text" id="p48">
<p>According to the <em>Cambridge Dictionary</em>, a story is “a description, either true or imagined, of a connected series of events.” A story is a way to share information or entertainment through a structured, cohesive narrative that engages the audience. The goal of a story is always to engage its audience to communicate a message.</p>
</div>
<div class="readable-text intended-text" id="p49">
<p>In his book <em>Poetics</em>, the Greek philosopher Aristotle proposed a framework to structure a tragedy, also known as the <em>three-act structure</em>. The structure consists of three main parts: the setup, the confrontation, and the resolution (figure 5.8). <span class="aframe-location"/></p>
</div>
<div class="browsable-container figure-container" id="p50">
<img alt="figure" height="591" src="../Images/5-8.png" width="941"/>
<h5 class="figure-container-h5"><span class="num-string">Figure 5.8</span> The three-act structure proposed by Aristotle to structure a tragedy</h5>
</div>
<div class="readable-text" id="p51">
<p>The setup introduces the audience to the characters, setting, and basic conflict of the story. In the confrontation, the main character faces obstacles and struggles to overcome them. Finally, in the resolution, the story reaches the point at which conflicts are resolved. Aristotle’s tragedy structure is still widely used today in literature, film, and other forms of storytelling. Its effectiveness lies in its ability to build tension and suspense, leading to a satisfying resolution for the audience.</p>
</div>
<div class="readable-text intended-text" id="p52">
<p>In <em>Effective Data Storytelling</em>, Dykes proposes an updated version of the three-act tragedy, adapted to the data storytelling scenario (figure 5.9). Dykes calls it the <em>data storytelling arc</em>.<span class="aframe-location"/></p>
</div>
<div class="browsable-container figure-container" id="p53">
<img alt="figure" height="527" src="../Images/5-9.png" width="1100"/>
<h5 class="figure-container-h5"><span class="num-string">Figure 5.9</span> The data storytelling arc proposed by Dykes to structure a data story</h5>
</div>
<div class="readable-text intended-text" id="p54">
<p>A data story starts by (a) defining the background behind data and (b) raising the audience’s interest. Dykes also proposes including a hook during this initial phase. A hook is “a notable observation that acts as a turning <span class="aframe-location"/>point in the story and begins to reveal a problem or opportunity” (Dykes, 2019). Then, the data story culminates with the main point behind the data by (c) revealing the insight, (d) leaving the audience some time to think, and (e) terminating by proposing the next steps. </p>
</div>
<div class="readable-text intended-text" id="p55">
<p>The structure proposed in figure 4.9 might seem abstract and difficult to apply when constructing a chart. Using the DIKW pyramid covered in chapter 1, you can turn a simple chart into a story. </p>
</div>
<div class="readable-text" id="p56">
<h3 class="readable-text-h3"><span class="num-string">5.2.1</span> Using the DIKW pyramid to streamline a data story</h3>
</div>
<div class="readable-text" id="p57">
<p>In chapter 1, we introduced the data, information, knowledge, wisdom (DIKW) pyramid and used it to transform data into wisdom in the practical example of an event dedicated to pets. We can generalize the example described in chapter 2 and use the DIKW to build any data story. Figure 5.10 shows how to map the data storytelling arc to the DIKW pyramid:</p>
</div>
<ul>
<li class="readable-text" id="p58"> Extracting insights from data corresponds to the main point of a data story. </li>
<li class="readable-text" id="p59"> Adding context to the extracted information corresponds to defining the background and raising the audience interest. </li>
<li class="readable-text" id="p60"> Adding a call to action corresponds to inviting the audience to think and follow the next steps.<span class="aframe-location"/> </li>
</ul>
<div class="browsable-container figure-container" id="p61">
<img alt="figure" height="662" src="../Images/5-10.png" width="1100"/>
<h5 class="figure-container-h5"><span class="num-string">Figure 5.10</span> A mapping of the data storytelling arc and the DIKW pyramid</h5>
</div>
<div class="readable-text" id="p62">
<p>It might seem strange to have knowledge before the data. However, here, by <em>knowledge</em>, we mean of all the elements needed to understand the story and place it in a specific context. The described mapping suggests the natural flow when you build a data story (figure 5.11). First, identify the main point of your story; then set the background; and, finally, set the next steps.<span class="aframe-location"/></p>
</div>
<div class="browsable-container figure-container" id="p63">
<img alt="figure" height="259" src="../Images/5-11.png" width="1100"/>
<h5 class="figure-container-h5"><span class="num-string">Figure 5.11</span> The flow to build a data story</h5>
</div>
<div class="readable-text" id="p64">
<h3 class="readable-text-h3"><span class="num-string">5.2.2</span> DIKW in action: Completing the homelessness tale</h3>
</div>
<div class="readable-text" id="p65">
<p>The homelessness example described at the beginning of the chapter stopped at the information level of the DIKW pyramid that, in terms of a data story, consisted only of the main point. Adding background to the chart involves grabbing your audience’s attention and making them interested in the problem you’re describing. In chapter 2, you learned that in Altair, you can add textual annotations to a chart to transform information into knowledge. In addition, there are other ways to add context to a chart, including labels, titles, sources, images, descriptions, and comparisons. We’ll describe these in more detail in chapter 6.</p>
</div>
<div class="readable-text intended-text" id="p66">
<p>In the case of the homeless problem, you can add text describing the situation of these people and possibly a photo that gives a face to the people involved. We will see how to add a hero to the story in chapter 6. For now, it’s enough to give a face to the people behind the data.</p>
</div>
<div class="readable-text intended-text" id="p67">
<p>In listing 5.4, we add text describing the context as the chart subtitle. Use the <code>TitleParams()</code> function to specify the title properties, including the subtitle. Set the subtitle to </p>
</div>
<div class="browsable-container listing-container" id="p68">
<div class="code-area-container">
<pre class="code-area">Homelessness is a heartbreaking reality that leaves individuals and families without a stable home, leading to devastating consequences such as poor health and social isolation.</pre>
</div>
</div>
<div class="readable-text" id="p69">
<p>Also, add a short description, helping the reader to focus on the data: </p>
</div>
<div class="browsable-container listing-container" id="p70">
<div class="code-area-container">
<pre class="code-area">The chart describes the number of homeless people in Italy per 1,000 inhabitants, organized by region. The data is from 2021, the most recent year available (Source: ISTAT).</pre>
</div>
</div>
<div class="browsable-container listing-container" id="p71">
<h5 class="listing-container-h5 browsable-container-h5"><span class="num-string">Listing 5.4</span> Adding the context as the subtitle</h5>
<div class="code-area-container">
<pre class="code-area"># Add context
chart = chart.properties(width=500,title=alt.TitleParams(
    text=["Together, Let's Make a Difference:","Support Our Project to Help the Homeless!"],
    subtitle=['Homelessness is a heartbreaking reality that leaves individuals and families without a stable home,','leading to devastating consequences such as poor health and social isolation.', 'The chart describes the number of homeless people in Italy per 1,000 inhabitants, organized by region. ', 'The data is from 2021, the most recent year available (Source: ISTAT).']],
    subtitleFontSize=18,
))</pre>
</div>
</div>
<div class="readable-text print-book-callout" id="p72">
<p><span class="print-book-callout-head">Note</span>  Within the <code>properties()</code> method, use the <code>title</code> parameter to set the chart title. Define the title using the <code>TitleParams()</code> function, which can receive many parameters as an input. The example passes the following parameters: title (<code>text</code>), subtitle (<code>subtitle</code>), subtitle font size (<code>subTitleFontSize</code>), title font size (<code>titleFontSize</code>).</p>
</div>
<div class="readable-text" id="p73">
<p>Listing 5.5 shows how to add two photos to the chart and combine them with the original chart to build a dashboard. You must run the code on a web server to make it work. If you don’t have a web server, you can run a local and temporary web server from the command line, running the following command in the directory containing the produced HTML file: <code>python</code> <code>-m</code> <code>http.server.</code> The server should listen at port 8000 and serve all the files in the directory from which it is started. Point your browser to http:<span class="link-like">//</span>localhost:8000/chart.xhtml to access the file chart.xhtml.</p>
</div>
<div class="browsable-container listing-container" id="p74">
<h5 class="listing-container-h5 browsable-container-h5"><span class="num-string">Listing 5.5</span> Adding the context as images</h5>
<div class="code-area-container">
<pre class="code-area">image1 = alt.Chart(pd.DataFrame({'image_url': ['source/homeless1.png']})).mark_image(
    width=200,
    height=200,
).encode(
    url='image_url',
    x=alt.value(0),  # pixels from left
    y=alt.value(50)  # pixels from the top
)          <span class="aframe-location"/> #1

image2 = alt.Chart(pd.DataFrame({'image_url': ['source/homeless2.png']})).mark_image(
    width=200,
    height=200,
).encode(
    url='image_url',
    x=alt.value(0),  # pixels from left
    y=alt.value(300)
)                    <span class="aframe-location"/> #2

image1 + image2 | chart</pre>
<div class="code-annotations-overlay-container">
     #1 Build the first image.
     <br/>#2 Build the second image
     <br/>
</div>
</div>
</div>
<div class="readable-text print-book-callout" id="p75">
<p><span class="print-book-callout-head">Note</span>  Use <code>mark_image()</code> to add an image to a chart. Set the path to the image file in the DataFrame passed to the chart. Use the <code>x</code> and <code>y</code> channels to set the image position in the chart. Use the same chart to draw <code>image1</code> and <code>image2</code> (<code>+</code> operator), and draw the main chart on the right with respect to <code>image1</code> <code>+</code> <code>image2</code>.</p>
</div>
<div class="readable-text" id="p76">
<p>To complete the homelessness story, add a call to action, which includes the next steps. In this example, we first modify the title: <em>Together, Let’s Make a Difference: Support Our Project to Help the Homeless!</em> We’ll see different strategies to add a call to action to a chart in chapter 9. Figure 5.12 shows the resulting chart.<span class="aframe-location"/></p>
</div>
<div class="browsable-container figure-container" id="p77">
<img alt="figure" height="608" src="../Images/5-12.png" width="1100"/>
<h5 class="figure-container-h5"><span class="num-string">Figure 5.12</span> The homelessness chart is enriched with a context (images and subtitle).</h5>
</div>
<div class="readable-text" id="p78">
<p>Then, we add a new part to the chart, describing how we will use funds (figure 5.13). For example, we will use 35% of the funds for shelter and housing, 25% for job training, and so on.<span class="aframe-location"/></p>
</div>
<div class="browsable-container figure-container" id="p79">
<img alt="figure" height="255" src="../Images/5-13.png" width="1100"/>
<h5 class="figure-container-h5"><span class="num-string">Figure 5.13</span> A possible next step explaining how we will use funds</h5>
</div>
<div class="readable-text" id="p80">
<p>The following listing shows how we implemented the charts in figure 5.13. We assume we have a DataFrame storing the percentage of funds (allocation) for each category.</p>
</div>
<div class="browsable-container listing-container" id="p81">
<h5 class="listing-container-h5 browsable-container-h5"><span class="num-string">Listing 5.6</span> Adding a next step</h5>
<div class="code-area-container">
<pre class="code-area">import pandas as pd
import altair as alt

donuts = None

for index, row in ns.iterrows():
    curr_ns = pd.DataFrame(
        {'Category': ['A', 'B'],
         'Value': [row['Allocation'], 100-row['Allocation']]
        }                            <span class="aframe-location"/> #1
    )

    donut = alt.Chart(curr_ns).mark_arc(outerRadius=30, innerRadius=20).encode(
        theta=alt.Theta("Value:Q", stack=True),
        color=alt.Color("Category:N", scale=alt.Scale(range=['green', 'lightgray']), legend=None)        <span class="aframe-location"/> #2
    )

    title = alt.Chart(curr_ns).mark_text(text=row['Category'], y=0, size=16)<span class="aframe-location"/> #3

    text = alt.Chart(curr_ns).mark_text(text=f"{row['Allocation']}%", color=iColor, size=16)         <span class="aframe-location"/> #4

    donut = donut.properties(
        height=100,
        width=100
    )         <span class="aframe-location"/> #5

 #6
    if index == 0:
 #7
        donuts = title + donut + text
    else:
 #8
        donuts = alt.hconcat(donuts, title + donut + text)

 #9
donuts = donuts.properties(title='Our visionary plan to harness the funds')</pre>
<div class="code-annotations-overlay-container">
     #1 Creates a DataFrame for the current row to use as data for the chart
     <br/>#2 Generates the donut chart using Altair
     <br/>#3 Creates a title for the donut chart
     <br/>#4 Creates a text annotation for the donut chart
     <br/>#5 Sets the size of the donut chart
     <br/>#6 Combines the title, donut chart, and text annotation
     <br/>#7 If it’s the first iteration, assigns the combined chart to donuts
     <br/>#8 If it’s not the first iteration, horizontally concatenates the combined chart with the existing donuts
     <br/>#9 Sets the title for the final donuts chart
     <br/>
</div>
</div>
</div>
<div class="readable-text print-book-callout" id="p82">
<p><span class="print-book-callout-head">Note</span>  Implement each donut chart as a separate chart using <code>mark_arc()</code>. For each donut, build an ad-hoc DataFrame (<code>current_ns</code>) that contains the actual allocation value and its complementary value (100 – Actual Allocation Value). Then, use different colors to plot the current allocation value and its complementary value.</p>
</div>
<div class="readable-text" id="p83">
<p>Figure 5.14 shows the resulting chart. If Angelica had submitted the chart in figure 5.14 to the commission foundation, she probably would have had more opportunities to get funded. Now that you have completed the homelessness tale, let’s describe how you can incorporate the power of generative AI in the DIKW pyramid.<span class="aframe-location"/></p>
</div>
<div class="browsable-container figure-container" id="p84">
<img alt="figure" height="863" src="../Images/5-14.png" width="1100"/>
<h5 class="figure-container-h5"><span class="num-string">Figure 5.14</span> The final chart for the homeless tale</h5>
</div>
<div class="readable-text" id="p85">
<h2 class="readable-text-h2"><span class="num-string">5.3</span> Incorporating generative AI into the DIKW pyramid</h2>
</div>
<div class="readable-text" id="p86">
<p>Generative AI, as we covered in chapter 4, can help us take things one step further by enabling the creation of sophisticated and realistic computer-generated content that can revolutionize various industries and domains. Now, armed with this knowledge, we can leverage generative AI’s capabilities to augment human creativity and automate content generation processes.</p>
</div>
<div class="readable-text intended-text" id="p87">
<p>Figure 5.15 shows where we can incorporate generative AI tools into each step of the DIKW pyramid: </p>
</div>
<ul>
<li class="readable-text" id="p88"> <em>Insight extraction</em> —Use generative algorithms to automate the creation code that builds the chart.  </li>
<li class="readable-text" id="p89"> <em>Context adding</em> —Use text generation to transform basic texts into more engaging ones for the audience. Add images, voice, and videos generated by AI to give the audience additional context. </li>
<li class="readable-text" id="p90"> <em>Call to action</em> —Use text generation to suggest new ideas and engaging text.<span class="aframe-location"/> </li>
</ul>
<div class="browsable-container figure-container" id="p91">
<img alt="figure" height="661" src="../Images/5-15.png" width="1100"/>
<h5 class="figure-container-h5"><span class="num-string">Figure 5.15</span> Where we can incorporate generative AI tools into the DIKW pyramid</h5>
</div>
<div class="readable-text" id="p92">
<p>It’s important to note that the examples listed are just a few of the ways that you can incorporate generative AI into the DIKW pyramid. There are countless other ways in which you can take advantage of these tools, such as synthesizing large amounts of data, developing personalized, predictive models, and constructing personalized recommendations based on data. However, in this book, we will focus specifically on the techniques for integrating generative AI into the DIKW pyramid, as it can assist in building a data story. Anyway, I encourage you to think outside the box and explore new and innovative ways to apply generative AI in your work. With so much potential waiting to be unlocked, the possibilities are truly endless! Now that you have learned how to incorporate generative AI tools into the DIKW pyramid, let’s apply this strategy to our case study: the homelessness tale.</p>
</div>
<div class="readable-text" id="p93">
<h2 class="readable-text-h2"><span class="num-string">5.4</span> Behind the scenes: The homelessness tale</h2>
</div>
<div class="readable-text" id="p94">
<p>In the previous chapters, you saw how to use GitHub Copilot to generate the code to build the chart. Now, it’s time to go a step further.</p>
</div>
<div class="readable-text intended-text" id="p95">
<p>Consider the homelessness tale again, specifically figure 5.12. The figure contains a title, defining the call to action; a subtitle, setting the context; and two photos, adding to the context. While you may have thought that we came up with the title and created or downloaded the images, in reality, it was ChatGPT and DALL-E that worked together to generate the content! Let’s see how we used ChatGPT to generate the subtitle and DALL-E to generate the photos. In the next chapters, we will see how to use more deeply generative AI tools for data storytelling.</p>
</div>
<div class="readable-text" id="p96">
<h3 class="readable-text-h3"><span class="num-string">5.4.1</span> Creating a compelling subtitle</h3>
</div>
<div class="readable-text" id="p97">
<p>We started a conversation with ChatGPT to extract a possible context that describes the situation where homeless individuals live. The context should be a short and engaging sentence. Figure 5.16 shows the steps involved in the conversation. <em>Q</em> refers to user questions (which will form the basis of our prompts), and <em>A</em> refers to ChatGPT’s answers. You can read the complete conversation in 05/genAI/SubtitleConversation.txt.<span class="aframe-location"/></p>
</div>
<div class="browsable-container figure-container" id="p98">
<img alt="figure" height="401" src="../Images/5-16.png" width="1100"/>
<h5 class="figure-container-h5"><span class="num-string">Figure 5.16</span> The steps to generate the text used for context</h5>
</div>
<div class="readable-text" id="p99">
<p>ChatGPT generated the text after four steps. We used the following strategy to make ChatGPT generate the desired text:</p>
</div>
<ol>
<li class="readable-text" id="p100"> <em>Describe</em> —Ask ChatGPT to describe your problem in general. In this case, ask ChatGPT to describe the homelessness condition in general. As an answer, ChatGPT generates a long passage of text. </li>
<li class="readable-text" id="p101"> <em>Shorten</em> —Ask ChatGPT to write a summary of the generated text. </li>
<li class="readable-text" id="p102"> <em>Transform</em> —Ask ChatGPT to make the summary more engaging for the audience. </li>
<li class="readable-text" id="p103"> <em>Shorten</em> —If the text is still long, ask ChatGPT to reduce it. </li>
</ol>
<div class="readable-text" id="p104">
<p>Without realizing it, we applied the DIKW model to the use of ChatGPT. Starting from a long passage of text (data), we extracted the information (summary), and then converted it into knowledge and wisdom (engaging text). In other words, when you talk to ChatGPT to generate context, organize the conversation as a story (figure 5.17).<span class="aframe-location"/></p>
</div>
<div class="browsable-container figure-container" id="p105">
<img alt="figure" height="711" src="../Images/5-17.png" width="1100"/>
<h5 class="figure-container-h5"><span class="num-string">Figure 5.17</span> The mapping between the data story structure and the ChatGPT conversation to generate context</h5>
</div>
<div class="readable-text" id="p106">
<p>You can generalize the described procedure to generate a variety of possible subtitles and then choose the one that fits your needs. Additionally, you can add specific keywords that can help appeal to your target audience and increase the visibility of your text. We’ll see how to add keywords to the ChatGPT conversation in chapter 6. </p>
</div>
<div class="readable-text" id="p107">
<h3 class="readable-text-h3"><span class="num-string">5.4.2</span> Generating images</h3>
</div>
<div class="readable-text" id="p108">
<p>Adding one or more images or photos to your chart helps give a face to the topic of your chart. However, images are often subjected to copyright, which means using them without permission from the owner can lead to legal consequences. We can use DALL-E and other AI tools for images to create unique and original images that are free from copyright restrictions. </p>
</div>
<div class="readable-text intended-text" id="p109">
<p>In the chart about homelessness, we have added two photos representing homeless individuals. We have generated them using the following simple prompt to DALL-E: <em>a photo of a homeless individual</em>. DALL-E has generated four images, and we have chosen two (figure 5.18). In chapter 6, we will see more advanced techniques to generate images.<span class="aframe-location"/></p>
</div>
<div class="browsable-container figure-container" id="p110">
<img alt="figure" height="445" src="../Images/5-18.png" width="1100"/>
<h5 class="figure-container-h5"><span class="num-string">Figure 5.18</span> The photos generated by DALL-E when prompted with a photo of a homeless individual</h5>
</div>
<div class="readable-text" id="p111">
<p>Now that you have learned how to use generative AI tools to transform your raw data visualization chart into a data story, let’s look at another example, to consolidate the concepts. </p>
</div>
<div class="readable-text" id="p112">
<h2 class="readable-text-h2"><span class="num-string">5.5</span> Another example: Fake news</h2>
</div>
<div class="readable-text" id="p113">
<p>Imagine that LatestNews is an important website that publishes news from different contributors. At a given point, the editor-in-chief receives some complaints from different readers because they read a high percentage of fake news. The editor-in-chief contacts you to analyze the amount of fake news on the LatestNews website and advises the website editors to pay attention to the categories of news that have the highest probability of being fake. You already have collected data, and you have the dataset shown in table 5.2.</p>
</div>
<div class="browsable-container browsable-table-container framemaker-table-container" id="p114">
<h5 class="browsable-container-h5"><span class="num-string">Table 5.2</span> An extract of the dataset of the example</h5>
<table>
<thead>
<tr>
<th>
<div>
         Category 
       </div></th>
<th>
<div>
         Number of Fake Articles 
       </div></th>
<th>
<div>
         Number of Articles 
       </div></th>
</tr>
</thead>
<tbody>
<tr>
<td>  Politics <br/></td>
<td>  1,235 <br/></td>
<td>  1,300 <br/></td>
</tr>
<tr>
<td>  Economy <br/></td>
<td>  1,456 <br/></td>
<td>  1,678 <br/></td>
</tr>
<tr>
<td>  Justice <br/></td>
<td>  300 <br/></td>
<td>  570 <br/></td>
</tr>
<tr>
<td>  Religion <br/></td>
<td>  30 <br/></td>
<td>  100 <br/></td>
</tr>
</tbody>
</table>
</div>
<div class="readable-text" id="p115">
<p>The dataset shows the number of fake news stories and the total number of articles for each news category. You start by drawing a preliminary chart, paying attention to the percentage of fake articles for each category. Figure 5.19 shows the preliminary chart, and listing 5.7 shows the associated code. You can also find the code in the GitHub repository for the book under CaseStudies/fake-news/raw-chart.py.<span class="aframe-location"/></p>
</div>
<div class="browsable-container figure-container" id="p116">
<img alt="figure" height="983" src="../Images/5-19.png" width="958"/>
<h5 class="figure-container-h5"><span class="num-string">Figure 5.19</span> The raw chart showing the number of fake articles by category </h5>
</div>
<div class="browsable-container listing-container" id="p117">
<h5 class="listing-container-h5 browsable-container-h5"><span class="num-string">Listing 5.7</span> Building the raw chart</h5>
<div class="code-area-container">
<pre class="code-area">import pandas as pd
import altair as alt

# Load the dataset data/fakenews.csv.
df = pd.read_csv('data/fakenews.csv')

# Create a column chart of the number of articles per category:  <span class="aframe-location"/> #1
# - Use the `Category` column for x channel.
# - Use the `Number of Articles` for y channel.

chart = alt.Chart(df).mark_bar(
    color='#81c01e'
).encode(
    x=alt.X('Category:N', 
            sort='-y',
            title=None,
            axis=alt.Axis(labelFontSize=14)
            ),
    y=alt.Y('Percentage of Fake Articles:Q',
            axis=alt.Axis(labelFontSize=14, titleFontSize=14)
            )
).properties(
    width=400,
    height=300
).configure_axis(   <span class="aframe-location"/> #2
    grid=False       <span class="aframe-location"/> #3
).configure_view(
    strokeWidth=0
).transform_calculate(
    'Percentage of Fake Articles', alt.datum['Number of Fake Articles']/alt.datum['Number of Articles']*100
)

chart.save('raw-chart.xhtml')</pre>
<div class="code-annotations-overlay-container">
     #1 Uses Copilot comments to speed up the chart generation process
     <br/>#2 Uses configure_axis() to configure the axes’ general properties
     <br/>#3 Removes the grid completely
     <br/>
</div>
</div>
</div>
<div class="readable-text print-book-callout" id="p118">
<p><span class="print-book-callout-head">Note</span>  Use <code>transform_calculate()</code> to dynamically add a new column to the DataFrame. This method receives the new column name as the first parameter (Percentage of Fake Articles, in the example) and the expression to calculate the new column as the second parameter.</p>
</div>
<div class="readable-text" id="p119">
<p>In the remainder of the section, we will apply the DIKW pyramid to transform the chart into a data story. Let’s start with the first step: turning data into information.</p>
</div>
<div class="readable-text" id="p120">
<h3 class="readable-text-h3"><span class="num-string">5.5.1</span> From data to information</h3>
</div>
<div class="readable-text" id="p121">
<p>Turning data into information means extracting some insights from data, an insight that is significant and helps your audience of editors understand which kind of news has the highest probability of being fake. Let’s try the rotation strategy. This strategy, originally described by Berengueres in his previously quoted book, involves rotating the chart to obtain a pyramid and searching for some pyramid framework, such as moral, economic, and other similar frameworks. Figure 5.20 shows the rotation process.<span class="aframe-location"/></p>
</div>
<div class="browsable-container figure-container" id="p122">
<img alt="figure" height="711" src="../Images/5-20.png" width="1100"/>
<h5 class="figure-container-h5"><span class="num-string">Figure 5.20</span> The rotation process of the chart in figure 5.19</h5>
</div>
<div class="readable-text intended-text" id="p123">
<p>Next, we can flip the chart horizontally and obtain the chart in figure 5.21, with corrected labels. You can also rewrite the Altair code directly to draw a column chart instead of a bar chart (the code is in the GitHub repository under CaseStudies/fake-news/bar-chart.py). We have preferred to show the rotation process instead of drawing the chart directly, to show how the rotation strategy works. <span class="aframe-location"/></p>
</div>
<div class="browsable-container figure-container" id="p124">
<img alt="figure" height="877" src="../Images/5-21.png" width="1100"/>
<h5 class="figure-container-h5"><span class="num-string">Figure 5.21</span> The rotation process, flipping the chart in figure 5.19 horizontally</h5>
</div>
<div class="readable-text intended-text" id="p125">
<p>If you look at labels carefully, you may notice that at the bottom of the pyramid, there are categories related to material life (from Education to Business). In the middle of the pyramid, there are categories related to moral life (from Human Rights to Ethics). At the top of the pyramid, there are categories related to spiritual life (from Mysticism to Philosophy). This means that most fake news relates to material life (more than 70%) and moral life (more than 30% of fake news but less than 60%). You can highlight the model material–moral–spiritual life using different colors in the chart based on the different macro categories the news belongs to. </p>
</div>
<div class="readable-text intended-text" id="p126">
<p>First, use Copilot to generate the list of macro categories, as shown in listing 5.8 and in the GitHub repository for the book under CaseStudies/fake-news/story-chart.py. The listing shows only how to generate the material life macro category, but you can apply the same strategy also for the other macro categories.</p>
</div>
<div class="browsable-container listing-container" id="p127">
<h5 class="listing-container-h5 browsable-container-h5"><span class="num-string">Listing 5.8</span> Using Copilot to generate a list</h5>
<div class="code-area-container">
<pre class="code-area"># Build a Python list with the following categories and name it material_life:
# Technology
# Environment
# Health
# Science
# Education
# Business
# Lifestyle
# Travel
# Politics
# Economy
# Sport

material_life = ['Technology', 'Environment', 'Health', 'Science', 'Education', 'Business', 'Lifestyle', 'Travel', 'Politics', 'Economy', 'Sport']   <span class="aframe-location"/> #1</pre>
<div class="code-annotations-overlay-container">
     #1 The output produced by Copilot
     <br/>
</div>
</div>
</div>
<div class="readable-text print-book-callout" id="p128">
<p><span class="print-book-callout-head">Note</span>  Describe the elements to include in the list.</p>
</div>
<div class="readable-text" id="p129">
<p>Now, ask Copilot to generate the code to add a new column to the DataFrame, containing the macro category. The following listing shows the instructions for Copilot.</p>
</div>
<div class="browsable-container listing-container" id="p130">
<h5 class="listing-container-h5 browsable-container-h5"><span class="num-string">Listing 5.9</span> Using Copilot to add a new column to a DataFrame</h5>
<div class="code-area-container">
<pre class="code-area"># Add a new column to the dataframe df called Macro Category that contains the following values:
# - If the Category is in material_life, then the value is Material Life.
# - If the Category is in moral_life, then the value is Moral Life.
# - If the Category is in spiritual_life, then the value is Spiritual Life.

df['Macro Category'] = df['Category'].apply(lambda x: 'Material Life' if x in material_life else ('Moral Life' if x in moral_life else 'Spiritual Life'))<span class="aframe-location"/> #1</pre>
<div class="code-annotations-overlay-container">
     #1 The output produced by Copilot
     <br/>
</div>
</div>
</div>
<div class="readable-text print-book-callout" id="p131">
<p><span class="print-book-callout-head">Note</span>  Describe how to build the new category of the DataFrame.</p>
</div>
<div class="readable-text" id="p132">
<p>Next, use the new column Macro Category to set the color of the bars in the chart.</p>
</div>
<div class="browsable-container listing-container" id="p133">
<h5 class="listing-container-h5 browsable-container-h5"><span class="num-string">Listing 5.10</span> Using the new column for the bars’ colors</h5>
<div class="code-area-container">
<pre class="code-area">chart = alt.Chart(df).mark_bar(
).encode(
    y=alt.Y('Category:N', 
            sort='x',
            title=None,
            axis=alt.Axis(labelFontSize=14)
            ),
    x=alt.X('Percentage of Fake Articles:Q',
            axis=alt.Axis(labelFontSize=14, 
                          titleFontSize=14),
    ),
    color=alt.Color('Macro Category:N',
                    scale=alt.Scale(
                        range=['#991111', '#f38f8f','lightgray'],
                        domain=['Material Life', 'Moral Life', 'Spiritual Life']
                    ),
                    legend=None
            )
).properties(
    width=400,
    height=400
).transform_calculate(
    'Percentage of Fake Articles', alt.datum['Number of Fake Articles']/alt.datum['Number of Articles']*100
)</pre>
</div>
</div>
<div class="readable-text print-book-callout" id="p134">
<p><span class="print-book-callout-head">Note</span>  Add the color channel to set the color of the bars.</p>
</div>
<div class="readable-text" id="p135">
<p>Figure 5.22 shows the resulting chart. We have used two tonalities of red to highlight the urgency of paying attention to material and moral life.<span class="aframe-location"/></p>
</div>
<div class="browsable-container figure-container" id="p136">
<img alt="figure" height="877" src="../Images/5-22.png" width="1100"/>
<h5 class="figure-container-h5"><span class="num-string">Figure 5.22</span> The chart of figure 5.21 with macro categories highlighted</h5>
</div>
<div class="readable-text" id="p137">
<p>We could improve the chart by simplifying it, for example, by grouping categories. However, our audience comprises experts (editors), who need very detailed information because they must know precisely which categories they must analyze more deeply. For this reason, we keep the chart very detailed. We have removed the legend from the chart because we want to replace it with some images, which also act as the context for our story. Let’s see how to add these images in the next step: turning information into knowledge.</p>
</div>
<div class="readable-text" id="p138">
<h3 class="readable-text-h3"><span class="num-string">5.5.2</span> From information to knowledge</h3>
</div>
<div class="readable-text" id="p139">
<p>The idea is to add an image for each macro category, more specifically, an icon. We can use DALL-E to generate the three images. Use the following prompt to generate the spiritual life icon: a black-and-white icon with praying hands. DALL-E will generate four images, such as those shown in figure 5.23.<span class="aframe-location"/></p>
</div>
<div class="browsable-container figure-container" id="p140">
<img alt="figure" height="267" src="../Images/5-23.png" width="1100"/>
<h5 class="figure-container-h5"><span class="num-string">Figure 5.23</span> The images generated by DALL-E related to the spiritual life</h5>
</div>
<div class="readable-text" id="p141">
<p>Similarly, you can generate icons related to the other categories. We have used the following prompts: </p>
</div>
<ul>
<li class="readable-text" id="p142"> <em>A black and white icon with a balance symbol of moral life </em> </li>
<li class="readable-text" id="p143"> <em>A black and white icon with a circle representing the world</em> </li>
</ul>
<div class="readable-text" id="p144">
<p>If you don’t have any ideas on how to generate an image, you can use ChatGPT to get some ideas. For example, you can write the following prompt in ChatGPT: <em>How would you represent material life through an icon?</em> Among the other suggestions, ChatGPT suggests the following:<em> A circle to represent the world or universe, with various smaller icons or symbols placed within it to represent different facets of material life.</em></p>
</div>
<div class="readable-text intended-text" id="p145">
<p>Once you have generated the images, you can incorporate them into the chart. The following listing describes how to add the spiritual life image. You can adopt the same strategy also for the other images. Also, remember to load the generated HTML chart in a web server.</p>
</div>
<div class="browsable-container listing-container" id="p146">
<h5 class="listing-container-h5 browsable-container-h5"><span class="num-string">Listing 5.11</span> Adding an icon to the chart</h5>
<div class="code-area-container">
<pre class="code-area">spiritual_image = alt.Chart(
    pd.DataFrame({'image_url': ['media/spiritual-life.png']})
).mark_image(
    width=80,
    height=80,
).encode(
    url='image_url',
    x=alt.value(270),  # pixels from left
    y=alt.value(50)
)          <span class="aframe-location"/> #1</pre>
<div class="code-annotations-overlay-container">
     #1 Add an image to the chart.
     <br/>
</div>
</div>
</div>
<div class="readable-text print-book-callout" id="p147">
<p><span class="print-book-callout-head">Note</span>  Calibrate the x and y positions manually, based on how the chart appears.</p>
</div>
<div class="readable-text" id="p148">
<p>Near the icon, add a text describing the macro category.</p>
</div>
<div class="browsable-container listing-container" id="p149">
<h5 class="listing-container-h5 browsable-container-h5"><span class="num-string">Listing 5.12</span> Adding text to the chart</h5>
<div class="code-area-container">
<pre class="code-area">spiritual_text = alt.Chart(
    pd.DataFrame({'text': ['Spiritual Life']})
).mark_text(
    fontSize=30,
    color='black',
    align='center',
    baseline='middle',
    font='Monotype',
    fontStyle='italic'
).encode(
    x=alt.value(420),  # pixels from left
    y=alt.value(50),
    text='text'
)</pre>
</div>
</div>
<div class="readable-text print-book-callout" id="p150">
<p><span class="print-book-callout-head">Note</span>  Calibrate the x and y positions manually, based on how the chart appears.</p>
</div>
<div class="readable-text" id="p151">
<p>Finally, combine all the charts.</p>
</div>
<div class="browsable-container listing-container" id="p152">
<h5 class="listing-container-h5 browsable-container-h5"><span class="num-string">Listing 5.13</span> Combining the images, texts, and chart</h5>
<div class="code-area-container">
<pre class="code-area">chart = chart + spiritual_image  + spiritual_text + moral_image + moral_text + material_image + material_text

chart = chart.configure_axis(
    grid=False
).configure_view(
    strokeWidth=0
)
chart.save('story-chart.xhtml')</pre>
</div>
</div>
<div class="readable-text print-book-callout" id="p153">
<p><span class="print-book-callout-head">Note</span>  Use the + operator to combine all the elements of the chart</p>
</div>
<div class="readable-text" id="p154">
<p>Figure 5.24 shows the resulting chart. The icons and the text act as the legend. In addition, they are the characters of our story.<span class="aframe-location"/></p>
</div>
<div class="browsable-container figure-container" id="p155">
<img alt="figure" height="602" src="../Images/5-24.png" width="1100"/>
<h5 class="figure-container-h5"><span class="num-string">Figure 5.24</span> Adding the images related to spiritual life, moral life, and material life to the chart</h5>
</div>
<div class="readable-text intended-text" id="p156">
<p>The next step involves adding a textual background to our chart and setting the context. We can add it as the subtitle of our chart. Let’s use ChatGPT to generate some ideas. Write the following prompt:</p>
</div>
<div class="readable-text" id="p157">
<p><em>Act as a storyteller. Describe the context of a visual chart showing that the highest number of fake news on the LatestNews website is related to material life, followed by moral life and finally by spiritual life. Use max 150 characters.</em></p>
</div>
<div class="readable-text intended-text" id="p158">
<p>We have specified three main elements:</p>
</div>
<ul>
<li class="readable-text" id="p159"> The ChatGPT role (we’ll see this in the next chapter in more detail) </li>
<li class="readable-text" id="p160"> The scenario </li>
<li class="readable-text" id="p161"> The maximum number of characters to use </li>
</ul>
<div class="readable-text" id="p162">
<p>ChatGPT may produce the following output: <em>In the intriguing chart, depicting fake news trends on the LatestNews website, material life claims the most prominent slice, trailed by moral life, and lastly, spiritual life.</em> We can use it as it is, we can modify it, or we can even ask for a new subtitle. In our case, we’ll use this output as the context of our chart.</p>
</div>
<div class="readable-text intended-text" id="p163">
<p>Let’s add this to our chart, by simply setting the subtitle in the chart properties.</p>
</div>
<div class="browsable-container listing-container" id="p164">
<h5 class="listing-container-h5 browsable-container-h5"><span class="num-string">Listing 5.14</span> Adding a subtitle to the chart</h5>
<div class="code-area-container">
<pre class="code-area">chart = chart.properties(width=500,title=alt.TitleParams(
    subtitle=['The LatestNews website is a popular source of news and information, but it is also a source of fake news.'],
    subtitleFontSize=18,
    fontSize=30,
    offset=40
))</pre>
</div>
</div>
<div class="readable-text print-book-callout" id="p165">
<p><span class="print-book-callout-head">Note</span>  Use <code>TitleParams()</code> to specify the title and subtitle parameters.</p>
</div>
<div class="readable-text" id="p166">
<p>Now that we have turned information into knowledge, let’s proceed with the last step: turning knowledge into wisdom.</p>
</div>
<div class="readable-text" id="p167">
<h3 class="readable-text-h3"><span class="num-string">5.5.3</span> From knowledge to wisdom</h3>
</div>
<div class="readable-text" id="p168">
<p>Wisdom involves adding a call to action to the story. In our case, we can simply say to the audience to pay attention to material and moral news because they have a high percentage of fake news. Let’s use ChatGPT to generate an engaging title. Use the following prompt: <em>Transform the following text into an engaging title: pay attention to material and moral news because they have a high percentage of fake news. Generate 5 titles.</em> Figure 5.25 shows a possible output generated by ChatGPT.<span class="aframe-location"/></p>
</div>
<div class="browsable-container figure-container" id="p169">
<img alt="figure" height="371" src="../Images/5-25.png" width="1100"/>
<h5 class="figure-container-h5"><span class="num-string">Figure 5.25</span> A possible output generated by ChatGPT</h5>
</div>
<div class="readable-text" id="p170">
<p>The generated titles do not contain a call to action. To add it, let’s improve the title by writing the following new prompt for ChatGPT in the same chat: <em>Transform the titles into a call to action that invites the audience to pay attention to news related to material and moral life</em>. Figure 5.26 shows a possible output produced by ChatGPT.<span class="aframe-location"/></p>
</div>
<div class="browsable-container figure-container" id="p171">
<img alt="figure" height="289" src="../Images/5-26.png" width="1100"/>
<h5 class="figure-container-h5"><span class="num-string">Figure 5.26</span> A possible output generated by ChatGPT when asked to add a call to action</h5>
</div>
<div class="readable-text" id="p172">
<p>As an example, select the third title, <em>Your Truth Guardian: Take a Stand Against Fake News in Material and Moral Narratives</em>, and add it to the chart, simply setting the text parameter, as shown in the following listing. Figure 5.27 shows the final chart.</p>
</div>
<div class="browsable-container listing-container" id="p173">
<h5 class="listing-container-h5 browsable-container-h5"><span class="num-string">Listing 5.15</span> Adding a title to the chart</h5>
<div class="code-area-container code-area-with-html">
<pre class="code-area">chart = chart.properties(width=500,title=alt.TitleParams(
    text=['Your Truth Guardian:', 'Take a Stand Against Fake News in Material and 
<span class="">↪</span> Moral Narratives'],
    subtitle=['The LatestNews website is a popular source of news and information, but it 
<span class="">↪</span> is also a source of fake news.'],
    subtitleFontSize=18,
    fontSize=30,
    offset=40)
)<span class="aframe-location"/></pre>
</div>
</div>
<div class="browsable-container figure-container" id="p174">
<img alt="figure" height="760" src="../Images/5-27.png" width="1100"/>
<h5 class="figure-container-h5"><span class="num-string">Figure 5.27</span> The final chart</h5>
</div>
<div class="readable-text print-book-callout" id="p175">
<p><span class="print-book-callout-head">Note</span>  Use the <code>text</code> parameter to add a title to the chart.</p>
</div>
<div class="readable-text" id="p176">
<p>In this chapter, you have learned the main concepts of building a data story using the DIKW pyramid and how to incorporate generative AI tools in the flow. We’ve had a high-level overview of implementing the DIKW pyramid as part of our data story as well as incorporating generative AI tools to enhance things further. In the next few chapters, we will look at traversing the DIKW pyramid in greater detail, starting by moving from <em>data</em> to <em>information</em>. </p>
</div>
<div class="readable-text" id="p177">
<h2 class="readable-text-h2">Summary</h2>
</div>
<ul>
<li class="readable-text" id="p178"> A <em>story</em> is a narrative that engages its audience to communicate a message and move them to action. </li>
<li class="readable-text" id="p179"> The <em>data storytelling arc</em> identifies five moments in a story: background, raising interest, main point, audience thinking, and next steps. </li>
<li class="readable-text" id="p180"> Use the DIKW pyramid to implement the data storytelling arc practically. </li>
<li class="readable-text" id="p181"> Use generative AI to assist you when scaling the DIKW pyramid, using prompts to produce what you want (text or images). </li>
</ul>
<div class="readable-text" id="p182">
<h2 class="readable-text-h2">References</h2>
</div>
<ul>
<li class="readable-text" id="p183"> Dykes, B. (2019). <em>Effective Data Storytelling: How to Drive Change with Data, Narrative and Visuals</em>. John Wiley &amp; Sons. </li>
<li class="readable-text" id="p184"> Cambridge Dictionary. (n.d.). <em>Story</em>. <a href="https://dictionary.cambridge.org/dictionary/english/story">https://dictionary.cambridge.org/dictionary/english/story</a>. </li>
</ul>
</div></body></html>