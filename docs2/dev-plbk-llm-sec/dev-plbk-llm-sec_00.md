# 前言

世界上到处都在追逐大型语言模型（LLM）的浪潮，这令人兴奋！当 ChatGPT 突然出现在舞台上时，它不仅仅进入了记录簿；它打破了记录，成为历史上最快被采用的应用。现在，仿佛地球上的每个软件供应商都在竞相将生成式 AI 和 LLM 技术嵌入到他们的产品堆栈中，将我们推向未知的领域。这种喧嚣是真实的，炒作是有理由的，可能性似乎是无限的。

但等等，还有转折。当我们惊叹于这些技术奇迹时，它们的安保结构，用最温和的话说，还在建设中。残酷的事实是？许多开发者正在没有地图的情况下步入这个新时代，对表面下的安全和安全沙坑几乎一无所知。现在这几乎成了常规：每周我们都会被另一个头条新闻击中，关于 LLM 的小故障。这些个别事件的影响到目前为止还算是温和的，但不要误会——我们正在玩火自焚。

风险并非仅仅是假设性的；它们是真实存在的，时间正在流逝。如果没有深入探索 LLM 安全风险及其应对策略的浑浊水域，我们不仅是在冒着小故障的风险；我们是在招致重大灾难。是时候开发者们做好准备，获取信息，并走在曲线之前了。快！

# 谁应该读这本书

本书的主要受众是构建嵌入 LLM 技术的定制应用的开发团队。通过我在这个领域的近期工作，我了解到这些团队通常规模很大，其成员背景极其多样化。这些包括擅长“Web 应用”技术的软件开发者，他们正在 AI 领域迈出第一步。这些团队也可能包括将他们的技艺从后台办公室带到聚光灯下的人工智能专家，那里的安全风险大不相同。他们还包括应用安全专家和数据科学专家。

除了核心受众之外，我还了解到其他人也觉得这些信息非常有用。这包括参与这些项目的扩展团队，他们希望了解这些技术的底层原理，以帮助减轻采用这些新技术所带来的关键风险。这些人包括软件开发高管、首席信息安全官（CISO）、质量工程师和安全运营团队。

# 我为什么写这本书

我一直对人工智能着迷。作为一个青少年，我深情地回忆起在我 Atari 400 家用电脑上编写视频游戏的日子。大约在 1980 年，这台小机器只有 8 千字节 RAM。但即便如此，我还是设法在这台机器上装上了完整的《Tron 光子自行车》游戏克隆版，其中包括一个简单但有效的 AI，可以在单人模式下驾驶一辆自行车。

在我的职业生涯中，我参与了几个人工智能相关项目。大学毕业后，我和我的好朋友汤姆·桑托斯一起成立了一家基于几千行手工编写的 C++代码的人工智能软件公司，这些代码用遗传算法解决了看似无法解决的问题。后来，我和我的朋友凯达尔·波德里和伊本尼泽·舒伯特一起在 Citrix 帮助构建了一个大规模的机器学习系统。但当我第一次看到 ChatGPT 时，我知道一切都已经改变了。

当我第一次接触到 LLMs 时，我在一家构建网络安全软件的公司工作。我的工作是帮助大型公司发现和追踪他们软件中的漏洞。很快，我就明显地意识到 LLMs 带来了独特且严重的安全漏洞。在接下来的几个月里，我调整了我的职业生涯，以应对这种颠覆。我开始了一个关于 LLM 安全的热门开源项目，你稍后会听到更多关于它的内容。我甚至换了一份工作，加入了 Exabeam 公司，这是一家在人工智能和网络安全交叉领域工作的公司。当 O’Reilly 出版社的编辑向我提出写一本关于这个主题的书时，我知道我必须抓住这个机会。

# 导航本书

这本书共有 12 章，分为三个逻辑部分。在这里，我将概述每个部分和章节，以便给你一个关于方法和内容的想法，这样你就可以在阅读时知道接下来会发生什么。

## 第一部分：奠定基础（第 1-3 章）

本书的前几章为理解基于 LLM 的应用程序的安全态势奠定了基础。它们应该为你提供坚实的基础，让你能够自信地解开使用 LLM 开发应用程序所面临的问题：

+   第一章，“聊天机器人破坏者”，通过一个真实案例研究，展示了业余黑客如何破坏了世界上最大软件公司之一的昂贵且具有潜力的聊天机器人项目。这将为你在这个领域的未来战斗奠定基础。

+   第二章，“LLM 应用的 OWASP Top 10”，介绍了我于 2023 年发起的一个项目，旨在识别和解决 LLM 带来的独特安全挑战。在处理那个项目的过程中获得的知识直接导致了我写这本书。

+   第三章，“架构和信任边界”，探讨了使用 LLM 的应用程序的结构，强调了控制应用程序内部各种数据流的重要性。

## 第二部分：风险、漏洞和补救措施（第 4-9 章）

在这些章节中，我们将分析你在开发 LLM 应用时面临的重大风险区域。这些风险包括任何应用安全从业者都熟悉的口味问题，例如注入攻击、敏感信息泄露和软件供应链风险。你还将了解到机器学习爱好者非常熟悉但在 Web 开发中不太熟悉的漏洞类别，例如训练数据中毒。

在此过程中，你还将了解困扰这些新型生成式 AI 系统的全新安全和安全担忧，例如幻觉、过度依赖和过度代理。我将通过实际案例研究带你了解风险和影响，并就如何根据具体情况预防或减轻这些风险提供建议：

+   第四章，“提示注入”，探讨了攻击者如何通过构建特定的输入来操纵 LLM，使其执行未预期的操作。

+   第五章，“你的 LLM 知道得太多吗？”，深入探讨了敏感信息泄露的风险，展示了 LLM 如何无意中暴露其训练过的数据，以及如何防范这种漏洞。

+   第六章，“语言模型会梦见电子羊吗？”，考察了 LLM 中独特的“幻觉”现象——模型生成虚假或误导性信息的实例。

+   第七章，“不相信任何人”，侧重于零信任原则，解释了不要轻信任何输出的重要性，并确保有严格的验证流程来处理 LLM 的输出。

+   第八章，“别让你的钱包丢失”，探讨了部署 LLM 技术的经济风险，重点关注拒绝服务（DoS）、拒绝钱包（DoW）和模型克隆攻击。这些威胁利用类似的漏洞来施加财务负担、破坏服务或窃取知识产权。

+   第九章，“找到最薄弱的环节”，突出了软件供应链中的漏洞以及确保其免受可能损害整个应用程序的潜在漏洞的关键步骤。

通过理解和解决这些风险，开发者可以更好地保护他们的应用程序免受不断发展的威胁环境的影响。

## 第三部分：构建安全流程和为未来做准备（第 10-12 章）

第二部分中的章节将为你提供理解和解决这个空间中各种个别威胁所需的工具。本节的最后部分是关于将所有内容整合在一起：

+   在 第十章，“从未来历史中学习” 中，我将使用一些著名的科幻轶事来说明多个弱点和设计问题如何结合在一起引发灾难。通过解释这些未来案例研究，我希望帮助您防止类似这种情况在未来发生。

+   在 第十一章，“信任过程” 中，我们将深入探讨将 LLM 精通的安全实践构建到您的软件工厂中的严肃业务——没有这一点，我不相信您能够成功地在规模上保护此类软件。

+   最后，在 第十二章，“负责任的人工智能安全实用框架” 中，我们将探讨 LLM 和人工智能技术的轨迹，看看它们将带我们去哪里，以及它们对安全和安全要求可能产生的潜在影响。我还会向您介绍负责任的人工智能软件工程（RAISE）框架，该框架将为您提供一种简单、基于清单的方法，以确保您正在实施最重要的工具和课程，以保持您的软件安全。

# 本书使用的约定

以下是在本书中使用的排版约定：

*斜体*

表示新术语、URL、电子邮件地址、文件名和文件扩展名。

`常宽`

用于程序列表，以及段落中引用程序元素，如变量或函数名称、数据库、数据类型、环境变量、语句和关键字。

**`常宽粗体`**

显示用户应逐字输入的命令或其他文本。

*`常宽斜体`*

显示应替换为用户提供的值或由上下文确定的值的文本。

###### 提示

此元素表示提示或建议。

###### 注意

此元素表示一般性说明。

###### 警告

此元素表示警告或注意事项。

# O’Reilly 在线学习

###### 注意

超过 40 年来，[*O’Reilly Media*](https://oreilly.com) 为公司提供技术培训和业务培训、知识和洞察力，以帮助公司成功。

我们独特的专家和创新者网络通过书籍、文章和我们的在线学习平台分享他们的知识和专业知识。O’Reilly 的在线学习平台为您提供按需访问实时培训课程、深入的学习路径、交互式编码环境以及来自 O’Reilly 和 200 多家其他出版商的大量文本和视频。有关更多信息，请访问 [*https://oreilly.com*](https://oreilly.com)。

# 如何联系我们

请将有关此书的评论和问题寄给出版社：

+   O’Reilly 媒体公司

+   1005 Gravenstein Highway North

+   Sebastopol, CA 95472

+   800-889-8969（美国或加拿大）

+   707-827-7019（国际或本地）

+   707-829-0104（传真）

+   *support@oreilly.com*

+   [*https://www.oreilly.com/about/contact.html*](https://www.oreilly.com/about/contact.html)

我们为这本书有一个网页，其中列出了勘误表、示例和任何其他附加信息。您可以通过[*https://oreil.ly/the-developers-playbook*](https://oreil.ly/the-developers-playbook)访问此页面。

想了解我们书籍和课程的相关新闻和信息，请访问[*https://oreilly.com*](https://oreilly.com)。

在 LinkedIn 上找到我们：[*https://linkedin.com/company/oreilly-media*](https://linkedin.com/company/oreilly-media)。

在 YouTube 上关注我们：[*https://youtube.com/oreillymedia*](https://youtube.com/oreillymedia)。

# 致谢

我要感谢所有鼓励我或对项目各个方面提供反馈的朋友、家人和同事：Will Chilcutt, Fabrizio Cilli, Ads Dawson, Ron Del Rosario, Sherri Douville, Sandy Dunn, Ken Huang, Gavin Klondike, Marko Lihter, Marten Mickos, Eugene Neelou, Chase Peterson, Karla Roland, Jason Ross, Tom Santos, Robert Simonoff, Yuvraj Singh, Rachit Sood, Seth Summersett, Darcie Tuuri, Ashish Verma, Jeff Williams, Alexa Wilson, Dave Wilson, 和 Zoe Wilson。

我要感谢 O’Reilly 团队在这个项目上的支持和指导。我还对 Nicole Butterfield 表示深深的感激，是她向我提出了这本书的想法，并引导我通过了提案阶段。我还要感谢我的编辑 Jeff Bleiel，他的耐心、技能和专业知识对这本书产生了重大影响。特别感谢我们的技术审稿人：Pamela Isom, Chenta Lee, Thomas Nield 和 Matteo Dora。
