# 前言

这本书向您介绍了生物学与深度学习之间迷人的交汇点。它面向那些渴望获得计算技能的生物学家和那些对将他们的专业知识应用于生物学问题感兴趣的计算实践者。这种学科融合正在改变生物技术和医学，并有望成为整个生命科学的基础。

本书的内容旨在作为入门级教程，引导您从基础知识到更高级的概念。我们旨在平衡实际代码示例和清晰的解释，使新术语和概念易于理解。现实世界的 Python 代码出现得早且频繁，有助于您培养实际操作直觉。虽然深度学习是一个强大的工具，但它并非万能的解决方案——我们强调在深入建模之前理解您的数据和深思熟虑地构建您的问题的重要性。我们鼓励您从简单开始，构建模块化和可调试的代码，并在明确目的下添加复杂性。

尽管这本书是为初学者设计的，但每一章都是在前一章的基础上构建的，以开发一个将机器学习应用于生物数据的实用、端到端的工作流程。我们的目标是为您提供足够强大的工具来解决现实世界的问题，并足够灵活以适应您自己的研究问题。例如，在最后一章中，我们重现了最近一篇使用深度学习在显微镜图像中揭示空间蛋白质模式的关键结果，该结果发表在*Nature Methods*上。

这本书面向的对象

我们在整个书中使用 JAX 和 Flax 深度学习生态系统，帮助您使用在机器学习研究中越来越受欢迎的工具构建高效、灵活的模型。

# 这个领域发展极其迅速——库发生变化，数据集得到更新，模型架构时兴时衰。您将学习的核心思想——如何构建项目、准备数据、构建和评估模型以及将预测与生物学问题联系起来——将不受框架或趋势的影响而保持有用。

这本书是为任何对使用深度学习解决生物学问题感兴趣的人而写的——无论您是生物学家、数据科学家还是软件工程师。我们旨在提供学科之间的可访问桥梁和在这个新兴领域工作的实用基础。我们设计了这本书，使其用户友好且跨学科，目标是支持来自各种背景的读者。

# 我们为什么写这本书

简而言之，对于那些希望在生物学与机器学习交汇处工作的人来说，教育资源并不多。大多数材料要么高度关注一个领域，要么假设对两个领域都有深厚的先验知识。我们着手编写我们希望自己在起步时拥有的书籍——一种易于接近、动手操作且基于真实生物学问题的书籍。

尽管这本书远非完美（请随时向我们发送您的建议和扩展），但我们希望它提供一个有用的和激励人心的起点——也许甚至能激发一些读者追求这个令人兴奋、快速发展的领域的职业生涯。

# 先决条件

我们假设你对 Python 和核心科学 Python 库有基本的了解——特别是 NumPy、pandas 和 Matplotlib。你不需要是一位编程专家，但你应该感到舒适地阅读和编写基本的 Python 代码。如果你是 Python 的新手，网上有许多优秀的教程和课程可以帮助你入门。我们特别推荐[Codecademy Python 在线课程](https://oreil.ly/oLar3)，以及 Al Sweigart 的免费书籍[*用 Python 自动化无聊的事情*](https://oreil.ly/uEGbU)。

也有一些机器学习背景是有帮助的。像优化、损失函数、训练步骤、过拟合和前馈神经网络这样的概念会经常出现。如果这些概念不熟悉，不要担心——书中包含简短的解释，并且你总是可以暂停使用外部资源进行复习。

# 为什么我们关注分子生物学

本书主要关注生物学的“小”方面：分子、细胞和组织。这有两个主要原因。首先，我们的背景在分子和细胞生物学，这自然影响了我们选择的话题。其次，迄今为止，大多数生物学的深度学习应用都集中在这一领域，这主要得益于大规模数据集的可用性和该领域的量化性质。

话虽如此，本书中的技术和工作流程具有广泛的应用性，我们希望对其他生物学领域感兴趣的读者——如生态学、神经科学或动物学——也能在这里找到灵感和有用的工具。我们期待深度学习方法继续在生命科学领域传播。

# 为什么所有这些动手编程项目

当涉及到机器学习时，我们相信编程是真正理解所发生事情的最有效方法之一。仅凭理论解释往往可能感觉抽象或令人困惑——尤其是在涉及到复杂的符号和密集的专业术语时。

动手项目通过使想法具体化来克服这一点。它们提供了几个独特的优势：

主动学习

编写代码有助于通过直接经验加强概念。

深入理解

实现模型迫使你理解每个组件——没有地方可以挥挥手。

立即反馈

它可能很苛刻，但不起作用的代码很快就会凸显理解或设置中的差距，并邀请实验。

实际回报

到项目结束时，你将拥有一个可以分析、调整或应用于新数据的运行模型。

理论理解仍然是必不可少的——但对于大多数人来说，自己构建和调试东西所带来的清晰度是无法替代的。

# 笔记本可用性

每一章的执行笔记本都可在 GitHub 上找到，并可直接在 Google Colab 中启动。这些笔记本旨在帮助你以动手的方式跟随材料。

我们会在你阅读时提醒你它们的位置，但我们强烈鼓励你深入探索——没有比实验和亲自动手更好的学习方法。如果你在探索代码时发现错误或有建议，请随时提交一个 pull request 或在 GitHub 上打开一个 issue。

# O’Reilly 在线学习平台

本书也通过 O’Reilly 在线学习平台提供，在那里你可以找到所有图表的全彩版本。印刷版为黑白，尽管我们已经尽力确保清晰度，但某些可视化确实依赖于颜色才能完全可解释。

我们建议在查看使用热图、叠加或彩色编码标签的图表时参考数字版本。

# 书籍快速浏览

这是一本高度跨学科的书籍，围绕深度学习在生物学中的应用的端到端示例构建。每一章都会带你完成一个自包含的项目——从生物学背景到数据集构建、模型训练、评估和可能的扩展。虽然一些章节基于前面的章节，但大多数可以根据你的兴趣独立阅读。

为了支持学习，每一章都包含与当前任务相关的简短生物学和机器学习入门内容。我们涵盖了广泛的生物模态（例如，序列、图像和图）和深度学习架构（例如，transformer、卷积神经网络、图神经网络、自动编码器），复杂性逐渐增加。

这里是对五个主要技术章节的总结，以快速了解所探索的任务、数据类型和技术：

| 章节 | 标题 | 任务 | 模态 | 任务类型 | 架构 | 难度 |
| --- | --- | --- | --- | --- | --- |
| 2 | “学习蛋白质的语言” | 从蛋白质序列预测蛋白质功能。 | 序列 | 多标签分类 | 基于 transformer 嵌入的线性分类器 | 初级 |
| 3 | “学习 DNA 的逻辑” | 从序列预测 DNA-蛋白质结合事件。 | 序列 | 二元和多标签分类 | 卷积神经网络，transformer | 中级 |
| 4 | “使用图理解药物-药物相互作用” | 预测一对药物是否会相互作用。 | 图 | 基于图的学习，二元分类 | 图神经网络 | 中级 |
| 5 | “在医学图像中检测皮肤癌” | 从图像中分类皮肤病变。 | 图像 | 多类分类 | 卷积神经网络 | 中级 |
| 6 | “学习细胞内的空间组织模式” | 预测蛋白质的亚细胞定位。 | 图像 | 表示学习，多标签分类 | 自动编码器，卷积神经网络 | 高级 |

章节通常在范围和深度上逐步构建，从第二章中提取嵌入的简单线性分类器开始，逐步发展到从头开始构建的更复杂模型，这些模型基于越来越丰富和具有挑战性的数据。

# 章节摘要

第一章，“引言”

了解深度学习在生物学中的前景和挑战。我们将讨论在启动新项目之前需要考虑的实际问题——比如你的模型可以替代什么，深度学习是否真的必要，以及如何构建你的工作流程。

本章还包括一个简短的技术介绍，涵盖 JAX/Flax、机器学习中常见的 Python 模式、工作环境和实际设置技巧。

第二章，“学习蛋白质的语言”

使用蛋白质语言模型嵌入来预测蛋白质功能。你将从预训练的蛋白质语言模型中提取嵌入，并训练一个简单的线性分类器进行多标签分类。在这个过程中，你将学习如何准备蛋白质功能数据集、评估预测和可视化嵌入以获得生物学见解。

第三章，“学习 DNA 的逻辑”

训练轻量级的卷积和转换模型来预测某些调控蛋白绑定到 DNA 的位置。你将了解如何从 DNA 序列中揭示见解，解释模型，并评估多个结合因子上的预测。

第四章，“使用图理解药物-药物相互作用”

使用图神经网络来建模药物关系，根据网络特征预测潜在的药物相互作用——有害或有益。

第五章，“在医学图像中检测皮肤癌”

训练卷积神经网络来从图像中分类皮肤病变的类型。本章重点介绍图像预处理、迁移学习和在小型医学数据集中管理过拟合。

第六章，“学习细胞内的空间组织模式”

构建一个变分自动编码器来分析显微镜图像中的蛋白质定位。这一高级章节探讨了无监督学习、潜在空间分析和从高分辨率成像数据中提取结构。

第七章，“生物深度学习的技巧和窍门”

获取在真实生物工作流程中设计、调试和改进模型的实际建议。本章还提供了避免常见陷阱、扩展学习和探索新项目想法的指导。

# 本书使用的约定

本书使用了以下排版约定：

*斜体*

指示新术语、URL、电子邮件地址、文件名和文件扩展名。

`常宽字体`

用于程序列表，以及段落中引用程序元素，如变量或函数名称、数据库、数据类型、环境变量、语句和关键字。

###### 小贴士

此元素表示一个提示或建议。

###### 注意

此元素表示一个一般性说明。

###### 警告

此元素表示一个警告或注意。

# 使用代码示例

补充材料（代码示例、练习等）可在[*https://github.com/deep-learning-for-biology*](https://github.com/deep-learning-for-biology)下载。

如果你有一个技术问题或在使用代码示例时遇到问题，请打开一个 GitHub 问题、提交一个 pull 请求，或发送电子邮件到*support@oreilly.com*。

这本书旨在帮助你完成工作。一般来说，如果本书提供了示例代码，你可以在你的程序和文档中使用它。除非你正在复制代码的很大一部分，否则你不需要联系我们获取许可。例如，编写一个使用本书中几个代码片段的程序不需要许可。从 O’Reilly 书籍中销售或分发示例代码需要许可。通过引用本书并引用示例代码来回答问题不需要许可。将本书的大量示例代码纳入你产品的文档中需要许可。

我们感激，但通常不需要署名。署名通常包括标题、作者、出版社和 ISBN。例如：“*《生物学的深度学习》* 由查尔斯·拉瓦拉尼和娜塔莎·拉蒂谢娃（O’Reilly）著。版权所有 2025 查尔斯·拉瓦拉尼和娜塔莎·拉蒂谢娃，978-1-098-16803-2。”

如果你认为你对代码示例的使用超出了合理使用或上述许可，请随时联系我们*permissions@oreilly.com*。

# O’Reilly 在线学习

###### 注意

40 多年来，[*O’Reilly Media*](https://oreilly.com)一直为科技公司提供技术和商业培训、知识和洞察力，以帮助公司成功。

我们独特的专家和创新者网络通过书籍、文章和我们的在线学习平台分享他们的知识和专长。O’Reilly 的在线学习平台为您提供按需访问实时培训课程、深入的学习路径、交互式编码环境以及来自 O’Reilly 和 200 多家其他出版商的大量文本和视频。更多信息，请访问[*https://oreilly.com*](https://oreilly.com)。

# 如何联系我们

请将有关本书的评论和问题寄给出版社：

+   O’Reilly Media, Inc.

+   141 Stony Circle, Suite 195

+   Santa Rosa, CA 95401

+   800-889-8969 (在美国或加拿大)

+   707-827-7019 (国际或本地)

+   707-829-0104 (传真)

+   *support@oreilly.com*

+   [*https://oreilly.com/about/contact.html*](https://oreilly.com/about/contact.html)

我们为这本书有一个网页，其中列出了勘误表、示例以及任何额外的信息。您可以通过[*https://oreil.ly/deep-learning-for-biology-1e*](https://oreil.ly/deep-learning-for-biology-1e)访问此页面。

想了解我们书籍和课程的新闻和信息，请访问[*https://oreilly.com*](https://oreilly.com)。

在 LinkedIn 上找到我们：[*https://linkedin.com/company/oreilly-media*](https://linkedin.com/company/oreilly-media)。

在 YouTube 上关注我们：[*https://youtube.com/oreillymedia*](https://youtube.com/oreillymedia)。

# 致谢

这本书是一个重大的项目——我们无法独立完成——我们对在过程中支持我们的人深表感激。我们特别感谢 Melis Kayikcı 和 Tibet Fonteyne 以及我们的家人，他们给予了坚定不移的支持。没有他们，这本书是不可能完成的。

我们还感谢我们的技术审稿人——Christian Winkler 和 Lipi Deepaakshi Patnaik——他们深思熟虑的反馈帮助提高了材料的清晰度和正确性。我们还要感谢 Danny Elfanbaum 开发了 `jupyter-book-to-htmlbook` 工具，它极大地改善了内容开发。我们还要向我们的 O’Reilly 编辑 Corbin Collins 表示衷心的感谢，他指导了整个项目；生产编辑 Ashley Stussy，编辑 Audrey Doyle 和 Kim Wimpsett，以及 WordCo Indexing Services, Inc 为帮助润色手稿；以及采购编辑 Nicole Butterfield，感谢她鼓励我们最初接受这个项目。

许多朋友和同事在整个写作过程中提供了有见地的审阅、建议和急需的鼓励。我们衷心感谢 Sam Beckbessinger、Petar Veličković、Justin Dollman、Kristofer Linton-Reid、Felix Kruger、Joshua Pan、Richard Tanburn、Sebastian Bodenstein、Arnaud Aillaud、Vaibhav Bhardwaj、Fredrik Eckardt、Hannes Baukmann、Justin Cope、Levent Mengütürk、Murat Mengütürk、James Sullivan、Loïc Royer、Toby Pohlen、Žiga Avsec 和 John Jumper。

最后，第二章的灵感来源于 2023 年 Deep Learning Indaba 实践“Machine Learning for Biology: Learning the Language of Life”，由 Tom Makkink、Kevin Michael Eloff、Natasha Latysheva 和 Kyle Taylor 共同开发。
