- en: 4 Exploring multi-agent systems
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 4 探索多智能体系统
- en: This chapter covers
  id: totrans-1
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 本章涵盖
- en: Building multi-agent systems using AutoGen Studio
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用AutoGen Studio构建多智能体系统
- en: Building a simple multi-agent system
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 构建一个简单的多智能体系统
- en: Creating agents that can work collaboratively over a group chat
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 创建能够在群聊中协同工作的智能代理
- en: Building an agent crew and multi-agent systems using CrewAI
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用CrewAI构建智能代理团队和多智能体系统
- en: Extending the number of agents and exploring processing patterns with CrewAI
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用CrewAI扩展智能代理数量并探索处理模式
- en: Now let’s take a journey from AutoGen to CrewAI, two well-established multi-agent
    platforms. We’ll start with AutoGen, a Microsoft project that supports multiple
    agents and provides a studio for working with them. We’ll explore a project from
    Microsoft called AutoGen, which supports multiple agents but also provides a studio
    to ease you into working with agents. From there, we’ll get more hands-on coding
    of AutoGen agents to solve tasks using conversations and group chat collaborations.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们从AutoGen到CrewAI进行一次旅行，这两个都是成熟的智能代理平台。我们将从AutoGen开始，这是一个支持多个智能代理并为他们提供工作室的微软项目。我们将探索一个名为AutoGen的微软项目，它支持多个智能代理，同时也提供了一个工作室来简化与智能代理一起工作的过程。从那里，我们将进行更多关于AutoGen智能代理的编码实践，以使用对话和群聊协作来解决任务。
- en: Then, we’ll transition to CrewAI, a self-proposed enterprise agentic system
    that takes a different approach. CrewAI balances role-based and autonomous agents
    that can be sequentially or hierarchically flexible task management systems. We’ll
    explore how CrewAI can solve diverse and complex problems.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，我们将过渡到CrewAI，这是一个自提出的企业级智能代理系统，它采用了一种不同的方法。CrewAI平衡了基于角色的和自主的智能代理，这些代理可以具有顺序或分层灵活的任务管理系统。我们将探讨CrewAI如何解决多样化和复杂的问题。
- en: Multi-agent systems incorporate many of the same tools single-agent systems
    use but benefit from the ability to provide outside feedback and evaluation to
    other agents. This ability to support and criticize agent solutions internally
    gives multi-agent systems more power. We’ll explore an introduction to multi-agent
    systems, beginning with AutoGen Studio in the next section.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 多智能体系统结合了许多单智能体系统使用的工具，但得益于能够向其他智能代理提供外部反馈和评估的能力。这种内部支持并批评智能代理解决方案的能力赋予了多智能体系统更多的力量。我们将探讨多智能体系统的介绍，下一节将从AutoGen
    Studio开始。
- en: 4.1 Introducing multi-agent systems with AutoGen Studio
  id: totrans-10
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 4.1 使用AutoGen Studio介绍多智能体系统
- en: AutoGen Studio is a powerful tool that employs multiple agents behind the scenes
    to solve tasks and problems a user directs. This tool has been used to develop
    some of the more complex code in this book. For that reason and others, it’s an
    excellent introduction to a practical multi-agent system.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: AutoGen Studio是一个强大的工具，它背后使用多个智能代理来解决用户指定的任务和问题。这个工具已被用于开发本书中的一些更复杂的代码。因此，它是一个实践多智能体系统的优秀入门。
- en: Figure 4.1 shows a schematic diagram of the agent connection/communication patterns
    AutoGen employs. AutoGen is a conversational multi-agent platform because communication
    is done using natural language. Natural language conversation seems to be the
    most natural pattern for agents to communicate, but it’s not the only method,
    as you’ll see later.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 图4.1展示了AutoGen使用的智能体连接/通信模式的示意图。AutoGen是一个对话式多智能体平台，因为通信是通过自然语言进行的。自然语言对话似乎是智能体通信的最自然模式，但并非唯一方法，正如你稍后将会看到的。
- en: '![figure](../Images/4-1.png)'
  id: totrans-13
  prefs: []
  type: TYPE_IMG
  zh: '![figure](../Images/4-1.png)'
- en: 'Figure 4.1 How AutoGen agents communicate through conversations (Source: AutoGen)'
  id: totrans-14
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图4.1 AutoGen智能体如何通过对话进行通信（来源：AutoGen）
- en: AutoGen supports various conversational patterns, from group and hierarchical
    to the more common and simpler proxy communication. In proxy communication, one
    agent acts as a proxy and directs communication to relevant agents to complete
    tasks. A proxy is similar to a waiter taking orders and delivering them to the
    kitchen, which cooks the food. Then, the waiter serves the cooked food.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: AutoGen支持各种对话模式，从群组和分层到更常见和简单的代理通信。在代理通信中，一个智能代理充当代理，并将通信引导到相关的智能代理以完成任务。代理类似于接受订单并将其传递给厨房的侍者，厨房负责烹饪食物。然后，侍者将烹饪好的食物上桌。
- en: The basic pattern in AutoGen uses a `UserProxy` and one or more assistant agents.
    Figure 4.2 shows the user proxy taking direction from a human and then directing
    an assistant agent enabled to write code to perform the tasks. Each time the assistant
    completes a task, the proxy agent reviews, evaluates, and provides feedback to
    the assistant. This iteration loop continues until the proxy is satisfied with
    the results.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: AutoGen的基本模式使用一个`UserProxy`和一个或多个助手代理。图4.2显示了用户代理从人类那里获得指示，然后指导一个被授权编写代码以执行任务的助手代理。每次助手完成一个任务时，代理代理都会进行审查、评估并提供反馈给助手。这个迭代循环会一直持续到代理对结果满意为止。
- en: '![figure](../Images/4-2.png)'
  id: totrans-17
  prefs: []
  type: TYPE_IMG
  zh: '![图](../Images/4-2.png)'
- en: 'Figure 4.2 The user proxy agent and assistant agent communication (Source:
    AutoGen)'
  id: totrans-18
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图4.2 用户代理代理和助手代理的通信（来源：AutoGen）
- en: The benefit of the proxy is that it works to replace the required human feedback
    and evaluation, and, in most cases, it does a good job. While it doesn’t eliminate
    the need for human feedback and evaluation, it produces much more complete results
    overall. And, while the iteration loop is time consuming, it’s time you could
    be drinking a coffee or working on other tasks.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 代理的好处是它旨在替代所需的人类反馈和评估，并且在大多数情况下，它做得很好。虽然它不能消除对人类反馈和评估的需求，但它总体上产生了更完整的结果。而且，虽然迭代循环耗时，但这是您可以用来喝咖啡或处理其他任务的时间。
- en: AutoGen Studio is a tool developed by the AutoGen team that provides a helpful
    introduction to conversable agents. In the next exercise, we’ll install Studio
    and run some experiments to see how well the platform performs. These tools are
    still in a rapid development cycle, so if you encounter any problems, consult
    the documentation on the AutoGen GitHub repository.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: AutoGen Studio是由AutoGen团队开发的一个工具，它为可对话代理提供了一个有用的介绍。在下一个练习中，我们将安装Studio并运行一些实验，以查看该平台的表现如何。这些工具仍在快速开发周期中，所以如果您遇到任何问题，请查阅AutoGen
    GitHub仓库上的文档。
- en: 4.1.1 Installing and using AutoGen Studio
  id: totrans-21
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 4.1.1 安装和使用AutoGen Studio
- en: Open the `chapter_04` folder in Visual Studio Code (VS Code), create a local
    Python virtual environment, and install the `requirements.txt` file. If you need
    assistance with this, consult appendix B to install all of this chapter’s exercise
    requirements.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 在Visual Studio Code（VS Code）中打开`chapter_04`文件夹，创建一个本地Python虚拟环境，并安装`requirements.txt`文件。如果您需要帮助，请参阅附录B以安装本章的所有练习要求。
- en: Open a terminal in VS Code (Ctrl-`, Cmd-`) pointing to your virtual environment,
    and run AutoGen Studio using the command shown in listing 4.1\. You’ll first need
    to define an environment variable for your OpenAI key. Because ports 8080 and
    8081 are popular, and if you have other services running, change the port to 8082
    or something you choose.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 在VS Code中打开终端（Ctrl-`, Cmd-`），指向您的虚拟环境，并使用列表4.1中显示的命令运行AutoGen Studio。您首先需要为您的OpenAI密钥定义一个环境变量。因为8080和8081端口很受欢迎，如果您有其他服务正在运行，请将端口更改为8082或您选择的任何端口。
- en: Listing 4.1 Launching AutoGen Studio
  id: totrans-24
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表4.1 启动AutoGen Studio
- en: '[PRE0]'
  id: totrans-25
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: '#1 Use the appropriate command for your terminal type.'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: '#1 使用适合您终端类型的适当命令。'
- en: '#2 Change the port if you expect or experience a conflict on your machine.'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: '#2 如果您预计或遇到机器上的冲突，请更改端口。'
- en: 'Navigate your browser to the AutoGen Studio interface shown in figure 4.3 (as
    of this writing). While there may be differences, one thing is for sure: the primary
    interface will still be chat. Enter a complex task that requires coding. The example
    used here is `Create` `a` `plot` `showing` `the` `popularity` `of` `the` `term`
    `GPT` `Agents` `in` `Google` `search.`'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 将您的浏览器导航到图4.3中显示的AutoGen Studio界面（截至本文撰写时）。虽然可能会有所不同，但有一点可以肯定：主界面仍然将是聊天界面。输入一个需要编码的复杂任务。这里使用的示例是`创建`一个`显示`“GPT代理”在`谷歌搜索`中`流行度`的`图表`。
- en: '![figure](../Images/4-3.png)'
  id: totrans-29
  prefs: []
  type: TYPE_IMG
  zh: '![图](../Images/4-3.png)'
- en: Figure 4.3 Entering a task for the agents to work on in the AutoGen interface
  id: totrans-30
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图4.3 在AutoGen界面中为代理输入要执行的任务
- en: The agent assistant generates code snippets to perform or complete various subtasks
    as the agents work together through the task in the example. The user proxy agent
    then attempts to execute those code snippets and assesses the output. In many
    cases, proving the code runs and produces the required output is sufficient for
    the user proxy agent to approve the task’s completion.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 代理助手在代理通过示例中的任务协同工作时生成代码片段以执行或完成各种子任务。然后，用户代理尝试执行这些代码片段并评估输出。在许多情况下，证明代码运行并产生所需输出就足以让用户代理批准任务的完成。
- en: If you encounter any problems with the assistant agent requests, ask the proxy
    agent to try a different method or another problem. This highlights a bigger problem
    with agentic systems using packages or libraries that have expired and no longer
    work. For this reason, it’s generally better to get agents to execute actions
    rather than build code to perform actions as tools.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您在助手代理请求中遇到任何问题，请要求代理尝试不同的方法或另一个问题。这突显了使用已过期且不再工作的包或库的代理系统的一个更大的问题。因此，通常更好的做法是让代理执行行动，而不是构建代码作为工具来执行行动。
- en: Tip  Executing AutoGen and AutoGen Studio using Docker is recommended, especially
    when working with code that may affect the operating system. Docker can isolate
    and virtualize the agents’ environment, thus isolating potentially harmful code.
    Using Docker can help alleviate any secondary windows or websites that may block
    the agent process from running.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 提示：建议使用Docker执行AutoGen和AutoGen Studio，尤其是在处理可能影响操作系统的代码时。Docker可以隔离和虚拟化代理的环境，从而隔离可能有害的代码。使用Docker可以帮助缓解可能阻止代理进程运行的任何次要窗口或网站。
- en: Figure 4.4 shows the agent’s completion of the task. The proxy agent will collect
    any generated code snippet, images, or other documents and append them to the
    message. You can also review the agent conversation by opening the Agent Messages
    expander. In many cases, if you ask the agent to generate plots or applications,
    secondary windows will open showing those results.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 图4.4显示了代理完成任务的输出。代理将收集任何生成的代码片段、图像或其他文档，并将它们附加到消息中。您还可以通过打开“代理消息”展开器来回顾代理对话。在许多情况下，如果您要求代理生成图表或应用程序，将打开次要窗口以显示这些结果。
- en: '![figure](../Images/4-4.png)'
  id: totrans-35
  prefs: []
  type: TYPE_IMG
  zh: '![figure](../Images/4-4.png)'
- en: Figure 4.4 The output after the agents complete the task
  id: totrans-36
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图4.4 代理完成任务后的输出
- en: Amazingly, the agents will perform most tasks nicely and complete them well.
    Depending on the complexity of the task, you may need to further iterate with
    the proxy. Sometimes, an agent may only go so far to complete a task because it
    lacks the required skills. In the next section, we’ll look at how to add skills
    to agents.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 令人惊讶的是，代理将很好地执行大多数任务并完成它们。根据任务的复杂程度，您可能需要与代理进一步迭代。有时，代理可能只能完成一项任务，因为它缺乏所需的技能。在下一节中，我们将探讨如何向代理添加技能。
- en: 4.1.2 Adding skills in AutoGen Studio
  id: totrans-38
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 4.1.2 在AutoGen Studio中添加技能
- en: Skills and tools, or *actions,* as we refer to them in this book, are the primary
    means by which agents can extend themselves. Actions give agents the ability to
    execute code, call APIs, or even further evaluate and inspect generated output.
    AutoGen Studio currently begins with just a basic set of tools to fetch web content
    or generate images.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 技能和工具，或我们在这本书中称之为“行动”，是代理扩展自己的主要手段。行动赋予代理执行代码、调用API或进一步评估和检查生成输出的能力。AutoGen
    Studio目前仅开始于一组基本的工具，用于获取网页内容或生成图像。
- en: Note  Many agentic systems employ the practice of allowing agents to code to
    solve goals. However, we discovered that code can be easily broken, needs to be
    maintained, and can change quickly. Therefore, as we’ll discuss in later chapters,
    it’s better to provide agents with skills/actions/tools to solve problems.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 注意：许多代理系统采用允许代理编码以解决问题目标的做法。然而，我们发现代码容易被破解，需要维护，并且可能快速变化。因此，正如我们将在后续章节中讨论的，为代理提供技能/行动/工具以解决问题会更好。
- en: In the following exercise scenario, we’ll add a skill/action to inspect an image
    using the OpenAI vision model. This will allow the proxy agent to provide feedback
    if we ask the assistant to generate an image with particular content.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 在以下练习场景中，我们将使用OpenAI视觉模型添加一个检查图像的技能/行动。这将允许代理在请求助手生成具有特定内容的图像时提供反馈。
- en: With AutoGen Studio running, go to the Build tab and click Skills, as shown
    in figure 4.5\. Then, click the New Skill button to open a code panel where you
    can copy–paste code to. From this tab, you can also configure models, agents,
    and agent workflows.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 当AutoGen Studio运行时，转到“构建”选项卡，点击“技能”，如图4.5所示。然后，点击“新建技能”按钮打开一个代码面板，您可以将代码复制粘贴到其中。从该选项卡，您还可以配置模型、代理和代理工作流程。
- en: '![figure](../Images/4-5.png)'
  id: totrans-43
  prefs: []
  type: TYPE_IMG
  zh: '![figure](../Images/4-5.png)'
- en: Figure 4.5 Steps to creating a new skill on the Build tab
  id: totrans-44
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图4.5 在“构建”选项卡上创建新技能的步骤
- en: Enter the code shown in listing 4.2 and also provided in the book’s source code
    as `describe_image.py`. Copy and paste this code into the editor window, and then
    click the Save button at the bottom.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 输入列表4.2中所示的代码，并在本书的源代码中作为`describe_image.py`提供。将此代码复制粘贴到编辑器窗口中，然后点击底部的“保存”按钮。
- en: Listing 4.2 `describe_image.py`
  id: totrans-46
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表 4.2 `describe_image.py`
- en: '[PRE1]'
  id: totrans-47
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: '#1 Function to load and encode the image as a Base64 string'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: '#1 函数：加载和编码图像为 Base64 字符串'
- en: '#2 Including the image string along with the JSON payload'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: '#2 在 JSON 有效负载中包括图像字符串'
- en: '#3 Unpacking the response and returning the content of the reply'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: '#3 解包响应并返回回复的内容'
- en: The `describe_image` function uses the OpenAI GPT-4 vision model to describe
    what is in the image. This skill can be paired with the existing generate_image
    skill as a quality assessment. The agents can confirm that the generated image
    matches the user’s requirements.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: '`describe_image` 函数使用 OpenAI GPT-4 视觉模型来描述图像中的内容。这项技能可以作为质量评估与现有的 `generate_image`
    技能配对。代理可以确认生成的图像符合用户的要求。'
- en: After the skill is added, it must be added to the specific agent workflow and
    agent for use. Figure 4.6 demonstrates adding the new skill to the primary assistant
    agent in the general or default agent workflow.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 技能添加后，必须将其添加到特定的代理工作流程和代理中以便使用。图 4.6 展示了在通用或默认代理工作流程中将新技能添加到主要助手代理的过程。
- en: '![figure](../Images/4-6.png)'
  id: totrans-53
  prefs: []
  type: TYPE_IMG
  zh: '![图](../Images/4-6.png)'
- en: Figure 4.6 Configuring the primary_assistant agent with the new skill
  id: totrans-54
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图 4.6 配置主要助手代理的新技能
- en: Now that the skill is added to the primary assistant, we can task the agent
    with creating a specific image and validating it using the new describe_image
    skill. Because image generators notoriously struggle with correct text, we’ll
    create an exercise task to do just that.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 现在技能已经添加到主要助手，我们可以要求代理创建一个特定的图像，并使用新的 `describe_image` 技能进行验证。由于图像生成器在处理正确文本方面众所周知地存在困难，我们将创建一个练习任务来完成这项工作。
- en: Enter the text shown in listing 4.3 to prompt the agents to create a book image
    cover for this book. We’ll explicitly say that the text needs to be correct and
    insist that the agent uses the new `describe_image` function to verify the image.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 输入列表 4.3 中显示的文本，以提示代理为这本书创建一个书封面图像。我们将明确指出文本需要正确无误，并坚持要求代理使用新的 `describe_image`
    函数来验证图像。
- en: Listing 4.3 Prompting for a book cover
  id: totrans-57
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表 4.3 提示创建书封面
- en: '[PRE2]'
  id: totrans-58
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: After the prompt is entered, wait for a while, and you may get to see some dialogue
    exchanged about the image generation and verification process. In the end, though,
    if everything works correctly, the agents will return with the results shown in
    figure 4.7.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 输入提示后，等待一段时间，你可能会看到一些关于图像生成和验证过程的对话。然而，如果一切正常，代理最终将返回图 4.7 中显示的结果。
- en: '![figure](../Images/4-7.png)'
  id: totrans-60
  prefs: []
  type: TYPE_IMG
  zh: '![图](../Images/4-7.png)'
- en: Figure 4.7 The generated file outputs from the agent work on the image generation
    task
  id: totrans-61
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图 4.7 代理在图像生成任务上的生成文件输出
- en: Remarkably, the agent coordination completed the task in just a couple of iterations.
    Along with the images, you can also see the various helper code snippets generated
    to assist with task completion. AutoGen Studio is impressive in its ability to
    integrate skills that the agents can further adapt to complete some goal. The
    following section will show how these powerful agents are implemented in code.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 值得注意的是，代理协调在仅几次迭代中就完成了任务。除了图像外，你还可以看到为辅助任务完成而生成的一些各种辅助代码片段。AutoGen Studio 在其能够集成代理可以进一步适应以完成某些目标的能力方面给人留下深刻印象。下一节将展示如何用代码实现这些强大的代理。
- en: 4.2 Exploring AutoGen
  id: totrans-63
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 4.2 探索 AutoGen
- en: While AutoGen Studio is a fantastic tool for understanding multi-agent systems,
    we must look into the code. Fortunately, coding multiple agent examples with AutoGen
    is simple and easy to run. We’ll cover the basic AutoGen setup in the next section.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然 AutoGen Studio 是理解多人代理系统的一个出色工具，但我们必须查看代码。幸运的是，使用 AutoGen 编写多个代理示例既简单又容易运行。我们将在下一节中介绍基本的
    AutoGen 设置。
- en: 4.2.1 Installing and consuming AutoGen
  id: totrans-65
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 4.2.1 安装和消费 AutoGen
- en: This next exercise will look at coding a basic multi-agent system that uses
    a user proxy and conversable agent. Before we do that, though, we want to make
    sure AutoGen is installed and configured correctly.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 下一个练习将探讨编写一个基本的多人代理系统，该系统使用用户代理和可对话的代理。在我们这样做之前，我们想要确保 AutoGen 已经正确安装和配置。
- en: Open a terminal in VS Code, and run the entire chapter 4 install directions
    per appendix B, or run the `pip` command in listing 4.4\. If you’ve installed
    the `requirements.txt` file, you’ll also be ready to run AutoGen.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 在 VS Code 中打开一个终端，按照附录 B 中的说明运行整个第 4 章安装指令，或者运行列表 4.4 中的 `pip` 命令。如果你已经安装了 `requirements.txt`
    文件，你也将准备好运行 AutoGen。
- en: Listing 4.4 Installing AutoGen
  id: totrans-68
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表 4.4 安装 AutoGen
- en: '[PRE3]'
  id: totrans-69
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: Next, copy the `chapter_04/OAI_CONFIG_LIST.example` to `OAI_CONFIG_LIST`, removing
    `.example` from the file name. Then, open the new file in VS Code, and enter your
    OpenAI or Azure configuration in the `OAI_CONFIG_LIST` file in listing 4.5\. Fill
    in your API key, model, and other details per your API service requirements. AutoGen
    will work with any model that adheres to the OpenAI client. That means you can
    use local LLMs via LM Studio or other services such as Groq, Hugging Face, and
    more.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，将`chapter_04/OAI_CONFIG_LIST.example`复制到`OAI_CONFIG_LIST`，从文件名中删除`.example`。然后，在VS
    Code中打开新文件，并在列表4.5中的`OAI_CONFIG_LIST`文件中输入您的OpenAI或Azure配置。根据您的API服务要求填写API密钥、模型和其他详细信息。AutoGen将与遵循OpenAI客户端的任何模型一起工作。这意味着您可以通过LM
    Studio或其他服务（如Groq、Hugging Face等）使用本地LLM。
- en: Listing 4.5 `OAI_CONFIG_LIST`
  id: totrans-71
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表4.5 `OAI_CONFIG_LIST`
- en: '[PRE4]'
  id: totrans-72
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: '#1 Select the model; GPT-4 is recommended.'
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: '#1 选择模型；推荐使用GPT-4。'
- en: '#2 Use the service key you would typically use.'
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: '#2 使用您通常使用的服务密钥。'
- en: '#3 Select the model; GPT-4 is recommended.'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: '#3 选择模型；推荐使用GPT-4。'
- en: '#4 Use the service key you would typically use.'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: '#4 使用您通常使用的服务密钥。'
- en: '#5 Changing the base URL allows you to point to other services, not just Azure
    OpenAI.'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: '#5 更改基本URL允许您指向其他服务，而不仅仅是Azure OpenAI。'
- en: Now, we can look at the code for a basic multi-agent chat using the out-of-the-box
    `UserProxy` and `ConversableAgent` agents. Open `autogen_start.py` in VS Code,
    shown in the following listing, and review the parts before running the file.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们可以查看使用现成的`UserProxy`和`ConversableAgent`代理进行基本多代理聊天的代码。在VS Code中打开`autogen_start.py`，如下所示列表，并在运行文件之前查看相关部分。
- en: Listing 4.6 `autogen_start.py`
  id: totrans-79
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表4.6 `autogen_start.py`
- en: '[PRE5]'
  id: totrans-80
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: '#1 Loads your LLM configuration from the JSON file OAI_CONFIG_LIST'
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: '#1 从JSON文件OAI_CONFIG_LIST加载您的LLM配置。'
- en: '#2 This agent talks directly to the LLM.'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: '#2 此代理直接与LLM（大型语言模型）进行交流。'
- en: '#3 This agent proxies conversations from the user to the assistant.'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: '#3 此代理代理用户与助手之间的对话。'
- en: '#4 Setting the termination message allows the agent to iterate.'
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: '#4 设置终止消息允许代理迭代。'
- en: '#5 A chat is initiated with the assistant through the user_proxy to complete
    a task.'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: '#5 通过user_proxy与助手发起聊天以完成任务。'
- en: Run the code by running the file in VS Code in the debugger (F5). The code in
    listing 4.6 uses a simple task to demonstrate code writing. Listing 4.7 shows
    a few examples to choose from. These coding tasks are also some of the author’s
    regular baselines to assess an LLMs’ strength in coding.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 通过在VS Code的调试器中运行文件（F5）来运行代码。列表4.6中的代码使用一个简单的任务来演示代码编写。列表4.7展示了几个可供选择示例。这些编码任务也是作者评估LLM在编码能力上的常规基准之一。
- en: Listing 4.7 Simple coding task examples
  id: totrans-87
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表4.7 简单编码任务示例
- en: '[PRE6]'
  id: totrans-88
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: '#1 To enjoy iterating over these tasks, use Windows Subsystem for Linux (WSL)
    on Windows, or use Docker.'
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: '#1 要享受对这些任务进行迭代的乐趣，请在Windows上使用Windows Subsystem for Linux (WSL)，或使用Docker。'
- en: After the code starts in a few seconds, the assistant will respond to the proxy
    with a solution. At this time, the proxy will prompt you for feedback. Press Enter,
    essentially giving no feedback, and this will prompt the proxy to run the code
    to verify it operates as expected.
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 几秒钟后代码开始运行，助手将向代理提供一个解决方案。此时，代理将提示您提供反馈。按Enter键，实际上是没有提供反馈，这将提示代理运行代码以验证其是否按预期运行。
- en: Impressively, the proxy agent will even take cues to install required packages
    such as Pygame. Then it will run the code, and you’ll see the output in the terminal
    or as a new window or browser. You can play the game or use the interface if the
    code shelled a new window/browser.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 令人印象深刻的是，代理甚至可以获取提示来安装所需的包，例如Pygame。然后它会运行代码，您将在终端或新窗口或浏览器中看到输出。如果代码在新的窗口/浏览器中打开，您可以玩游戏或使用界面。
- en: Note that the spawned window/browser won’t close on Windows and will require
    exiting the entire program. To avoid this problem, run the code through Windows
    Subsystem for Linux (WSL) or Docker. AutoGen explicitly recommends using Docker
    for code execution agents, and if you’re comfortable with containers, this is
    a good option.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，在Windows上，生成的窗口/浏览器不会关闭，并且需要退出整个程序。为了避免这个问题，请通过Windows Subsystem for Linux
    (WSL)或Docker运行代码。AutoGen明确建议使用Docker作为代码执行代理，如果您熟悉容器，这是一个不错的选择。
- en: Either way, after the proxy generates and runs the code, the `working_dir` folder
    set earlier in listing 4.6 should now have a Python file with the code. This will
    allow you to run the code at your leisure, make changes, or even ask for improvements,
    as we’ll see. In the next section, we’ll look at how to improve the capabilities
    of the coding agents.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 无论哪种方式，在代理生成和运行代码后，列表 4.6 中之前设置的 `working_dir` 文件夹现在应该有一个包含代码的 Python 文件。这将允许你随意运行代码，进行更改，甚至要求改进，正如我们将看到的。在下节中，我们将探讨如何提高编码代理的能力。
- en: 4.2.2 Enhancing code output with agent critics
  id: totrans-94
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 4.2.2 使用代理评论家增强代码输出
- en: One powerful benefit of multi-agent systems is the multiple roles/personas you
    can automatically assign when completing tasks. Generating or helping to write
    code can be an excellent advantage to any developer, but what if that code was
    also reviewed and tested? In the next exercise, we’ll add another agent critic
    to our agent system to help with coding tasks. Open `autogen_coding_critic.py`,
    as shown in the following listing.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 多代理系统的一个强大优势是，在完成任务时可以自动分配多个角色/角色。生成或帮助编写代码可以是任何开发者的一个极好的优势，但如果该代码也被审查和测试呢？在下一个练习中，我们将向我们的代理系统添加另一个代理评论家来帮助编码任务。打开
    `autogen_coding_critic.py`，如下列所示。
- en: Listing 4.8 `autogen_coding_critic.py`
  id: totrans-96
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表 4.8 `autogen_coding_critic.py`
- en: '[PRE7]'
  id: totrans-97
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: '#1 This time, the assistant is given a system/persona message.'
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: '#1 这次，助手被给予一个系统/角色消息。'
- en: '#2 A second assistant critic agent is created with a background.'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: '#2 创建了一个具有背景的第二个助手评论家代理。'
- en: '#3 A custom function helps extract the code for review by the critic.'
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: '#3 一个自定义函数帮助提取评论家审查的代码。'
- en: '#4 A nested chat is created between the critic and the engineer.'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: '#4 评论家和工程师之间创建了一个嵌套聊天。'
- en: '#5 The proxy agent initiates a chat with a max delay and explicit summary method.'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: '#5 代理代理以最大延迟和明确的摘要方法启动聊天。'
- en: Run the `autogen_coding_critic.py` file in VS Code in debug mode, and watch
    the dialog between the agents. This time, after the code returns, the critic will
    also be triggered to respond. Then, the critic will add comments and suggestions
    to improve the code.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 在 VS Code 中以调试模式运行 `autogen_coding_critic.py` 文件，并观察代理之间的对话。这次，在代码返回后，评论家也会被触发进行响应。然后，评论家会添加注释和建议来改进代码。
- en: Nested chats work well for supporting and controlling agent interactions, but
    we’ll see a better approach in the following section. Before that though, we’ll
    review the importance of the AutoGen cache in the next section.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 嵌套聊天对于支持和控制代理交互效果很好，但我们在下节中会看到一个更好的方法。在此之前，我们将在下一节中回顾 AutoGen 缓存的重要性。
- en: 4.2.3 Understanding the AutoGen cache
  id: totrans-105
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 4.2.3 理解 AutoGen 缓存
- en: AutoGen can consume many tokens over chat iterations as a conversable multi-agent
    platform. If you ask AutoGen to work through complex or novel problems, you may
    even encounter token limits on your LLM; because of this, AutoGen supports several
    methods to reduce token usage.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 作为可对话的多代理平台，AutoGen 在聊天迭代中可能会消耗许多令牌。如果你要求 AutoGen 通过复杂或新颖的问题，你甚至可能会在 LLM 上遇到令牌限制；因此，AutoGen
    支持几种减少令牌使用的方法。
- en: AutoGen uses caching to store progress and reduce token usage. Caching is enabled
    by default, and you may have already encountered it. If you check your current
    working folder, you’ll notice a `.cache` folder, as shown in figure 4.8\. Caching
    allows your agents to continue conversations if they get interrupted.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: AutoGen 使用缓存来存储进度并减少令牌使用。缓存默认启用，你可能已经遇到过。如果你检查当前工作文件夹，你会注意到一个 `.cache` 文件夹，如图
    4.8 所示。缓存允许代理在被打断后继续对话。
- en: '![figure](../Images/4-8.png)'
  id: totrans-108
  prefs: []
  type: TYPE_IMG
  zh: '![figure](../Images/4-8.png)'
- en: Figure 4.8 AutoGen cache and working folders
  id: totrans-109
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图 4.8 AutoGen 缓存和工作文件夹
- en: In code, you can control the cache folder for your agent’s run, as shown in
    listing 4.9\. By wrapping the `initiate_chat` call with the `with` statement,
    you can control the location and seed for the cache. This will allow you to save
    and return to long-running AutoGen tasks in the future by just setting the `cache_seed`
    for the previous cache.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 在代码中，你可以控制代理运行的缓存文件夹，如图 4.9 所示。通过将 `initiate_chat` 调用用 `with` 语句包装，你可以控制缓存的位置和种子。这将允许你通过仅设置前一个缓存的
    `cache_seed` 来保存并返回未来的长时间运行的 AutoGen 任务。
- en: Listing 4.9 Setting the cache folder
  id: totrans-111
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表 4.9 设置缓存文件夹
- en: '[PRE8]'
  id: totrans-112
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: '#1 Setting the seed_cache denotes the individual location.'
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: '#1 设置 seed_cache 表示单个位置。'
- en: '#2 Sets the cache as a parameter'
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: '#2 将缓存作为参数设置'
- en: This caching ability allows you to continue operations from the previous cache
    location and captures previous runs. It can also be a great way to demonstrate
    and inspect how an agent conversation generated the results. In the next section,
    we’ll look at another conversational pattern in which AutoGen supports group chat.
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 这种缓存能力允许你从之前的缓存位置继续操作并捕获之前的运行。这也可以是一种展示和检查代理对话如何生成结果的好方法。在下一节中，我们将探讨另一种AutoGen支持的群聊对话模式。
- en: 4.3 Group chat with agents and AutoGen
  id: totrans-116
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 4.3 与代理和AutoGen的群聊
- en: One problem with chat delegation and nested chats or conversations is the conveyance
    of information. If you’ve ever played the telephone game, you’ve witnessed this
    firsthand and experienced how quickly information can change over iterations.
    With agents, this is certainly no different, and chatting through nested or sequential
    conversations can alter the task or even the desired result.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 聊天委托和嵌套聊天或对话的一个问题是信息的传达。如果你曾经玩过电话游戏，你亲自见证了这一点，并体验到了信息在迭代中如何迅速变化。对于代理来说，这当然也不例外，通过嵌套或顺序对话聊天可以改变任务甚至期望的结果。
- en: The telephone game
  id: totrans-118
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 电话游戏
- en: The telephone game is a fun but educational game that demonstrates information
    and coherence loss. Children form a line, and the first child receives a message
    only they can hear. Then, in turn, the children verbally pass the message on to
    the next child, and so on. At the end, the last child announces the message to
    the whole group, which often isn’t even close to the same message.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 电话游戏是一种既有趣又有教育意义的游戏，它展示了信息和连贯性的丧失。孩子们排成一排，第一个孩子只能听到一个信息。然后，孩子们轮流将信息口头传递给下一个孩子，以此类推。最后，最后一个孩子将信息宣布给整个小组，通常这个信息与最初的信息相差甚远。
- en: To counter this, AutoGen provides a group chat, a mechanism by which agents
    participate in a shared conversation. This allows agents to review all past conversations
    and better collaborate on long-running and complex tasks.
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 为了应对这一点，AutoGen提供了一个群聊机制，通过这个机制代理可以参与共享对话。这允许代理回顾所有过去的对话，并在长期和复杂任务上更好地协作。
- en: Figure 4.9 shows the difference between nested and collaborative group chats.
    We used the nested chat feature in the previous section to build a nested agent
    chat. In this section, we use the group chat to provide a more collaborative experience.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 图4.9显示了嵌套群聊和协作群聊之间的差异。我们在上一节中使用了嵌套聊天功能来构建嵌套代理聊天。在本节中，我们使用群聊来提供更协作的体验。
- en: '![figure](../Images/4-9.png)'
  id: totrans-122
  prefs: []
  type: TYPE_IMG
  zh: '![图](../Images/4-9.png)'
- en: Figure 4.9 The difference between nested and group chat for conversable agents
  id: totrans-123
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图4.9 可对话代理的嵌套群聊与群聊之间的差异
- en: Open `autogen_coding_group.py` with relevant parts, as shown in listing 4.10\.
    The code is similar to the previous exercise but now introduces `GroupChat` and
    `GroupChatManager`. The agents and messages are held with the group chat, similar
    to a messaging channel in applications such as Slack or Discord. The chat manager
    coordinates the message responses to reduce conversation overlap.
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 打开`autogen_coding_group.py`，查看列表4.10中的相关部分。代码与之前的练习类似，但现在引入了`GroupChat`和`GroupChatManager`。代理和消息都存储在群聊中，类似于Slack或Discord等应用中的消息频道。聊天管理器协调消息响应以减少对话重叠。
- en: Listing 4.10 `autoget_coding_group.py` (relevant sections)
  id: totrans-125
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表4.10 `autoget_coding_group.py`（相关部分）
- en: '[PRE9]'
  id: totrans-126
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: '#1 Human input is now set to never, so no human feedback.'
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: '#1 人类输入现在设置为永不，因此没有人类反馈。'
- en: '#2 Code omitted, but consult changes to the persona in the file'
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: '#2 代码省略，但请参考文件中角色的更改'
- en: '#3 This object holds the connection to all the agents and stores the messages.'
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: '#3 此对象持有所有代理的连接并存储消息。'
- en: '#4 The manager coordinates the conversation as a moderator would.'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: '#4 管理员作为调解者一样协调对话。'
- en: Run this exercise, and you’ll see how the agents collaborate. The engineer will
    now take feedback from the critic and undertake operations to address the critic’s
    suggestions. This also allows the proxy to engage in all of the conversation.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 运行这个练习，你会看到代理是如何协作的。工程师现在将从评论者那里获取反馈并执行操作以解决评论者的建议。这也允许代理参与所有对话。
- en: Group conversations are an excellent way to strengthen your agents’ abilities
    as they collaborate on tasks. However, they are also substantially more verbose
    and token expensive. Of course, as LLMs mature, so do the size of their context
    token windows and the price of token processing. As token windows increase, concerns
    over token consumption may eventually go away.
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 群组对话是加强代理协作能力的好方法，因为它们在完成任务时进行协作。然而，它们也更为冗长且代价高昂。当然，随着大型语言模型（LLMs）的成熟，它们的上下文标记窗口的大小和标记处理的价格也在增加。随着标记窗口的增加，对标记消耗的担忧可能会最终消失。
- en: AutoGen is a powerful multi-agent platform that can be experienced using a web
    interface or code. Whatever your preference, this agent collaboration tool is
    an excellent platform for building code or other complex tasks. Of course, it
    isn’t the only platform, as you’ll see in the next section, where we explore a
    newcomer called CrewAI.
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: AutoGen 是一个强大的多代理平台，可以通过网页界面或代码体验。无论你的偏好如何，这个代理协作工具是构建代码或其他复杂任务的优秀平台。当然，它并不是唯一的平台，正如你将在下一节中看到的，我们将探索一个新来者，即
    CrewAI。
- en: 4.4 Building an agent crew with CrewAI
  id: totrans-134
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 4.4 使用 CrewAI 构建代理团队
- en: CrewAI is relatively new to the realm of multi-agent systems. Where AutoGen
    was initially developed from research and then extended, CrewAI is built with
    enterprise systems in mind. As such, the platform is more robust, making it less
    extensible in some areas.
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: CrewAI 在多代理系统领域相对较新。AutoGen 最初是从研究中发展起来的，然后进行了扩展，而 CrewAI 是以企业系统为前提构建的。因此，该平台在某种程度上更健壮，但在某些方面不太容易扩展。
- en: With CrewAI, you build a crew of agents to focus on specific areas of a task
    goal. Unlike AutoGen, CrewAI doesn’t require the use of the user proxy agent but
    instead assumes the agents only work among themselves.
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 CrewAI，你可以构建一个专注于特定任务目标的代理团队。与 AutoGen 不同，CrewAI 不需要使用用户代理代理，而是假设代理只在自己之间工作。
- en: Figure 4.10 shows the main elements of the CrewAI platform, how they connect
    together, and their primary function. It shows a sequential-processing agent system
    with generic researcher and writer agents. Agents are assigned tasks that may
    also include tools or memory to assist them.
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.10 展示了 CrewAI 平台的主要元素，它们如何连接在一起以及它们的主要功能。它展示了一个具有通用研究人员和作家代理的顺序处理代理系统。代理被分配的任务可能包括工具或记忆来协助它们。
- en: '![figure](../Images/4-10.png)'
  id: totrans-138
  prefs: []
  type: TYPE_IMG
  zh: '![figure](../Images/4-10.png)'
- en: Figure 4.10 The composition of a CrewAI system
  id: totrans-139
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图 4.10 CrewAI 系统的组成
- en: 'CrewAI supports two primary forms of processing: sequential and hierarchical.
    Figure 4.10 shows the sequential process by iterating across the given agents
    and their associated tasks. In the next section, we dig into some code to set
    up a crew and employ it to complete a goal and create a good joke.'
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: CrewAI 支持两种主要的处理形式：顺序和分层。图 4.10 通过迭代给定的代理及其相关任务来展示顺序处理过程。在下一节中，我们将深入研究一些代码来设置团队并使用它来完成目标并创造一个有趣的笑话。
- en: 4.4.1 Creating a jokester crew of CrewAI agents
  id: totrans-141
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 4.4.1 创建一个由 CrewAI 代理组成的玩笑者团队
- en: CrewAI requires more setup than AutoGen, but this also allows for more control
    and additional guides, which provide more specific context to guide the agents
    in completing the given task. This isn’t without problems, but it does offer more
    control than AutoGen out of the box.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 与 AutoGen 相比，CrewAI 需要更多的设置，但这也允许更多的控制和额外的指南，这些指南提供了更具体的上下文来指导代理完成给定的任务。这并非没有问题，但它确实提供了比
    AutoGen 更多的控制。
- en: 'Open `crewai_introduction.py` in VS Code and look at the top section, as shown
    in listing 4.11\. Many settings are required to configure an agent, including
    the role, goal, verboseness, memory, backstory, delegation, and even tools (not
    shown). In this example, we’re using two agents: a senior joke researcher and
    a joke writer.'
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 在 VS Code 中打开 `crewai_introduction.py` 并查看列表 4.11 所示的顶部部分。配置代理需要许多设置，包括角色、目标、冗长性、记忆、前传、委派，甚至工具（未显示）。在这个例子中，我们使用了两个代理：一个高级玩笑研究人员和一个玩笑作家。
- en: Listing 4.11 `crewai_introduction.py` (agent section)
  id: totrans-144
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表 4.11 `crewai_introduction.py`（代理部分）
- en: '[PRE10]'
  id: totrans-145
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: '#1 Creates the agents and provides them a goal'
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: '#1 创建代理并为他们提供一个目标'
- en: '#2 verbose allows the agent to emit output to the terminal.'
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: '#2 verbose 允许代理向终端输出输出。'
- en: '#3 Supports the use of memory for the agents'
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: '#3 支持代理使用内存'
- en: '#4 The backstory is the agent’s background—its persona.'
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: '#4 前传是代理的背景——其角色。'
- en: '#5 The agents can either be delegated to or are allowed to delegate; True means
    they can delegate.'
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: '#5 代理可以被委派或允许委派；True 表示它们可以委派。'
- en: '#6 Creates the agents and provides them a goal'
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: '#6 创建代理并为他们提供一个目标'
- en: '#7 verbose allows the agent to emit output to the terminal.'
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: '#7 verbose 允许代理向终端输出。'
- en: '#8 Supports the use of memory for the agents'
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: '#8 支持代理使用内存'
- en: '#9 The backstory is the agent’s background—its persona.'
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: '#9 前传故事是代理的背景——其角色。'
- en: Moving down the code, we next see the tasks, as shown in listing 4.12\. Tasks
    denote an agent’s process to complete the primary system goal. They also link
    an agent to work on a specific task, define the output from that task, and may
    include how it’s executed.
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 在代码中向下移动，我们接下来看到的是任务，如列表 4.12 所示。任务表示代理完成主要系统目标的过程。它们还链接代理以执行特定任务，定义该任务的输出，并可能包括其执行方式。
- en: Listing 4.12 `crewai_introduction.py` (task section)
  id: totrans-156
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表 4.12 `crewai_introduction.py`（任务部分）
- en: '[PRE11]'
  id: totrans-157
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: '#1 The Task description defines how the agent will complete the task.'
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: '#1 任务描述定义了代理如何完成任务。'
- en: '#2 Explicitly defines the expected output from performing the task'
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: '#2 明确定义执行任务时的预期输出'
- en: '#3 The agent assigned to work on the task'
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: '#3 被分配执行任务的代理'
- en: '#4 The Task description defines how the agent will complete the task.'
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: '#4 任务描述定义了代理如何完成任务。'
- en: '#5 Explicitly defines the expected output from performing the task'
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: '#5 明确定义执行任务时的预期输出'
- en: '#6 If the agent should execute asynchronously'
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: '#6 如果代理应该异步执行'
- en: '#7 Any output the agent will generate'
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: '#7 代理将生成的任何输出'
- en: Now, we can see how everything comes together as the `Crew` at the bottom of
    the file, as shown in listing 4.13\. Again, many options can be set when building
    the `Crew`, including the agents, tasks, process type, memory, cache, maximum
    requests per minute (`max_rpm`), and whether the crew shares.
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们可以看到所有内容是如何在文件底部的 `Crew` 中汇集起来的，如列表 4.13 所示。同样，在构建 `Crew` 时可以设置许多选项，包括代理、任务、进程类型、内存、缓存、每分钟最大请求数（`max_rpm`）以及机组人员是否共享。
- en: Listing 4.13 `crewai_introduction.py` (crew section)
  id: totrans-166
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表 4.13 `crewai_introduction.py`（机组部分）
- en: '[PRE12]'
  id: totrans-167
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: '#1 The agents assembled into the crew'
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: '#1 组装进机组的人员'
- en: '#2 The tasks the agents can work on'
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: '#2 代理可以执行的任务'
- en: '#3 Defining how the agents will interact'
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: '#3 定义代理如何交互'
- en: '#4 Whether the system should use memory; needs to be set if agents/tasks have
    it on'
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: '#4 是否应该使用内存；如果代理/任务有，则需要设置'
- en: '#5 Whether the system should use a cache, similar to AutoGen'
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: '#5 系统是否应该使用缓存，类似于 AutoGen'
- en: '#6 Maximum requests per minute the system should limit itself to'
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: '#6 每分钟系统应限制的最大请求数'
- en: '#7 Whether the crew should share information, similar to group chat'
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: '#7 是否应该让机组人员共享信息，类似于群聊'
- en: 'When you’re done reviewing, run the file in VS Code (F5), and watch the terminal
    for conversations and messages from the crew. As you can probably tell by now,
    the goal of this agent system is to craft jokes related to AI engineering. Here
    are some of the funnier jokes generated over a few runs of the agent system:'
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 当你完成审查后，在 VS Code 中运行文件（F5），并观察终端中的机组人员对话和消息。正如你现在可能已经察觉到的，这个代理系统的目标是制作与人工智能工程相关的笑话。以下是几次运行代理系统生成的几个有趣的笑话：
- en: Why was the computer cold? It left Windows open.
  id: totrans-176
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 为什么电脑会冷？因为它留下了 Windows。
- en: Why don’t AI engineers play hide and seek with their algorithms? Because no
    matter where they hide, the algorithms always find them in the “overfitting” room!
  id: totrans-177
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 为什么人工智能工程师不和他们自己的算法玩捉迷藏？因为无论他们藏在哪里，算法总是在“过拟合”房间里找到他们！
- en: What is an AI engineer’s favorite song? “I just called to say I love yo… . and
    to collect more data for my voice recognition software.”
  id: totrans-178
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 人工智能工程师最喜欢的歌曲是什么？“我刚刚打电话来说我爱你……并且为了收集更多数据用于我的语音识别软件。”
- en: Why was the AI engineer broke? Because he spent all his money on cookies, but
    his browser kept eating them.
  id: totrans-179
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 为什么人工智能工程师会破产？因为他把所有的钱都花在了饼干上，但他的浏览器一直在吃它们。
- en: Before you run more iterations of the joke crew, you should read the next section.
    This section shows how to add observability to the multi-agent system.
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 在运行更多笑话机组迭代之前，你应该阅读下一节。本节展示了如何向多代理系统添加可观察性。
- en: 4.4.2 Observing agents working with AgentOps
  id: totrans-181
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 4.4.2 通过 AgentOps 观察代理的工作
- en: Observing a complex assemblage such as a multi-agent system is critical to understanding
    the myriad of problems that can happen. Observability through application tracing
    is a key element of any complex system, especially one engaged in enterprise use.
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 观察一个复杂集合，如多代理系统，对于理解可能发生的各种问题至关重要。通过应用程序跟踪进行可观察性是任何复杂系统的关键元素，尤其是那些在企业中使用的系统。
- en: CrewAI supports connecting to a specialized agent operations platform appropriately
    called AgentOps. This observability platform is generic and designed to support
    observability with any agent platform specific to LLM usage. Currently, no pricing
    or commercialization details are available.
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: CrewAI支持连接到一个专门称为AgentOps的操作平台。这个可观察性平台是通用的，旨在支持任何特定于LLM使用的代理平台的可观察性。目前，没有提供定价或商业化细节。
- en: Connecting to AgentOps is as simple as installing the package, getting an API
    key, and adding a line of code to your crew setup. This next exercise will go
    through the steps to connect and run AgentOps.
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 连接到AgentOps就像安装包、获取API密钥以及在团队设置中添加一行代码一样简单。接下来的练习将介绍连接和运行AgentOps的步骤。
- en: Listing 4.14 shows installing the `agentops` package using `pip`. You can install
    the package alone or as an additional component of the `crewai` package. Remember
    that AgentOps can also be connected to other agent platforms for observability.
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 列表4.14展示了使用`pip`安装`agentops`包的过程。你可以单独安装该包，或者将其作为`crewai`包的附加组件安装。记住，AgentOps也可以连接到其他代理平台以实现可观察性。
- en: Listing 4.14 Installing AgentOps
  id: totrans-186
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表4.14 安装AgentOps
- en: '[PRE13]'
  id: totrans-187
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'Before using AgentOps, you need to sign up for an API key. Following are the
    general steps to sign up for a key at the time of writing:'
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 在使用AgentOps之前，你需要注册一个API密钥。以下是在撰写本文时注册密钥的一般步骤：
- en: Visit [https://app.agentops.ai](https://app.agentops.ai) in your browser.
  id: totrans-189
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在你的浏览器中访问[https://app.agentops.ai](https://app.agentops.ai)。
- en: Sign up for an account.
  id: totrans-190
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 注册一个账户。
- en: Create a project, or use the default.
  id: totrans-191
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个项目，或使用默认设置。
- en: Go to Settings > Projects and API Keys.
  id: totrans-192
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 前往设置 > 项目和API密钥。
- en: Copy and/or generate a new API key; this will copy the key to your browser.
  id: totrans-193
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 复制或生成一个新的API密钥；这将把密钥复制到你的浏览器中。
- en: Paste the key to your `.env` file in your project.
  id: totrans-194
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将密钥粘贴到你的项目中的`.env`文件。
- en: After the API key is copied, it should resemble the example shown in the following
    listing.
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: 在复制API密钥后，它应该类似于以下列表中所示示例。
- en: 'Listing 4.15 `env.`: Adding an AgentOps key'
  id: totrans-196
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表4.15 `env.`：添加AgentOps密钥
- en: '[PRE14]'
  id: totrans-197
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: Now, we need to add a few lines of code to the CrewAI script. Listing 4.16 shows
    the additions as they are added to the `crewai_agentops.py` file. When creating
    your own scripts, all you need to do is add the `agentops` package and initialize
    it when using CrewAI.
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们需要在CrewAI脚本中添加几行代码。列表4.16展示了添加到`crewai_agentops.py`文件中的内容。当你创建自己的脚本时，你所需要做的就是添加`agentops`包，并在使用CrewAI时初始化它。
- en: Listing 4.16 `crewai_agentops.py` (AgentOps additions)
  id: totrans-199
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表4.16 `crewai_agentops.py`（AgentOps添加）
- en: '[PRE15]'
  id: totrans-200
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: '#1 The addition of the required package'
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: '#1 添加所需的包'
- en: '#2 Make sure to initialize the package after the environment variables are
    loaded.'
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: '#2 确保在加载环境变量后初始化包。'
- en: Run the `crewai_agentops.py` file in VS Code (F5), and watch the agents work
    as before. However, you can now go to the AgentOps dashboard and view the agent
    interactions at various levels.
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: 在VS Code中运行`crewai_agentops.py`文件（按F5），并观察代理像以前一样工作。然而，你现在可以进入AgentOps仪表板并查看不同级别的代理交互。
- en: Figure 4.11 shows the dashboard for running the joke crew to create the best
    joke. Several statistics include total duration, the run environment, prompt and
    completion tokens, LLM call timings, and estimated cost. Seeing the cost can be
    both sobering and indicative of how verbose agent conversations can become.
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 图4.11展示了运行玩笑团队以创建最佳玩笑的仪表板。包括总时长、运行环境、提示和完成令牌、LLM调用时间以及预估成本等统计数据。看到成本既可能让人清醒，也可能表明代理对话可能多么冗长。
- en: '![figure](../Images/4-11.png)'
  id: totrans-205
  prefs: []
  type: TYPE_IMG
  zh: '![图](../Images/4-11.png)'
- en: Figure 4.11 The AgentOps dashboard for running the joke crew
  id: totrans-206
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图4.11 运行玩笑团队的AgentOps仪表板
- en: The AgentOps platform is an excellent addition to any agent platform. While
    it’s built into CrewAI, it’s helpful that the observability could be added to
    AutoGen or other frameworks. Another attractive thing about AgentOps is that it’s
    dedicated to observing agent interactions and not transforming from a machine
    learning operations platform. In the future, we’ll likely see the spawn of more
    agent observability patterns.
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: AgentOps平台是任何代理平台的绝佳补充。虽然它内置在CrewAI中，但将可观察性添加到AutoGen或其他框架中也很有帮助。AgentOps的另一个吸引人的特点是它专注于观察代理交互，而不是从机器学习操作平台转换而来。未来，我们可能会看到更多代理可观察性模式的诞生。
- en: One benefit that can’t be overstated is the cost observation that an observability
    platform can provide. Did you notice in figure 4.11 that creating a single joke
    costs a little over 50 cents? Agents can be very powerful, but they can also become
    very costly, and it’s essential to observe what those costs are in terms of practicality
    and commercialization.
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 一个不容忽视的益处是，可观察性平台可以提供的成本观察。你注意到图 4.11 中创建一个笑话的成本略超过 50 美分吗？代理可以非常强大，但它们也可能变得非常昂贵，因此观察这些成本在实用性和商业化方面至关重要。
- en: In the last section of this chapter, we’ll return to CrewAI and revisit building
    agents that can code games. This will provide an excellent comparison between
    the capabilities of AutoGen and CrewAI.
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章的最后部分，我们将回到 CrewAI，重新探讨构建能够编写游戏的代理。这将提供 AutoGen 和 CrewAI 功能之间的一次优秀比较。
- en: 4.5 Revisiting coding agents with CrewAI
  id: totrans-210
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 4.5 使用 CrewAI 重新探讨编码代理
- en: A great way to compare capabilities between multi-agent platforms is to implement
    similar tasks in a bot. In this next set of exercises, we’ll employ CrewAI as
    a game programming team. Of course, this could be adapted to other coding tasks
    as well.
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: 比较多代理平台功能的一种好方法是在机器人中实现类似任务。在接下来的练习中，我们将使用 CrewAI 作为游戏编程团队。当然，这也可以适应其他编码任务。
- en: Open `crewai_coding_crew.py` in VS Code, and we’ll first review the agent section
    in listing 4.17\. Here, we’re creating a senior engineer, a QA engineer, and a
    chief QA engineer with a role, goal, and backstory.
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: 在 VS Code 中打开 `crewai_coding_crew.py`，我们首先将回顾列表 4.17 中的代理部分。在这里，我们创建了一个高级工程师、一个
    QA 工程师和一位首席 QA 工程师，并为他们分配了角色、目标和背景故事。
- en: Listing 4.17 `crewai_coding_crew.py` (agent section)
  id: totrans-213
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表 4.17 `crewai_coding_crew.py` (代理部分)
- en: '[PRE16]'
  id: totrans-214
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: '#1 Allows the user to input the instructions for their game'
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: '#1 允许用户输入他们游戏的指令'
- en: '#2 Only the chief QA engineer can delegate tasks.'
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: '#2 只有首席 QA 工程师可以委派任务。'
- en: Scrolling down in the file will display the agent tasks, as shown in listing
    4.18\. The task descriptions and expected output should be easy to follow. Again,
    each agent has a specific task to provide better context when working to complete
    the task.
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: 在文件中向下滚动将显示代理任务，如图 4.18 列表所示。任务描述和预期输出应该很容易理解。同样，每个代理都有一个特定的任务，以便在工作时提供更好的上下文。
- en: Listing 4.18 `crewai_coding_crew.py` (task section)
  id: totrans-218
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表 4.18 `crewai_coding_crew.py` (任务部分)
- en: '[PRE17]'
  id: totrans-219
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: '#1 The game instructions are substituted into the prompt using Python formatting.'
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: '#1 使用 Python 格式化将游戏指令替换到提示中。'
- en: Finally, we can see how this comes together by going to the bottom of the file,
    as shown in listing 4.19\. This crew configuration is much like what we’ve seen
    before. Each agent and task are added, as well as the verbose and process attributes.
    For this example, we’ll continue to use sequential methods.
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我们可以通过查看文件底部，如图 4.19 列表所示，来了解这一切是如何结合在一起的。这个队伍配置与我们之前看到的大致相同。每个代理和任务都被添加，以及详尽和过程属性。对于这个例子，我们将继续使用顺序方法。
- en: Listing 4.19 `crewai_coding_crew.py` (crew section)
  id: totrans-222
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表 4.19 `crewai_coding_crew.py` (队伍部分)
- en: '[PRE18]'
  id: totrans-223
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: '#1 Process is sequential.'
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: '#1 处理过程是顺序的。'
- en: '#2 No additional context is provided in the kickoff.'
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: '#2 启动阶段没有提供额外的上下文。'
- en: When you run the VS Code (F5) file, you’ll be prompted to enter the instructions
    for writing a game. Enter some instructions, perhaps the snake game or another
    game you choose. Then, let the agents work, and observe what they produce.
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: 当你运行 VS Code (F5) 文件时，系统会提示你输入编写游戏的指令。输入一些指令，比如蛇形游戏或你选择的另一个游戏。然后，让代理工作，并观察它们产生的结果。
- en: With the addition of the chief QA engineer, the results will generally look
    better than what was produced with AutoGen, at least out of the box. If you review
    the code, you’ll see that it generally follows good patterns and, in some cases,
    may even include tests and unit tests.
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: 随着首席 QA 工程师的加入，结果通常会优于使用 AutoGen 产生的结果，至少在初始阶段是这样。如果你审查代码，你会发现它通常遵循良好的模式，在某些情况下，甚至可能包括测试和单元测试。
- en: Before we finish the chapter, we’ll make one last change to the crew’s processing
    pattern. Previously, we employed sequential processing, as shown in figure 4.10\.
    Figure 4.12 shows what hierarchical processing looks like in CrewAI.
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们完成本章之前，我们将对队伍的处理模式进行最后一次修改。之前，我们采用了顺序处理，如图 4.10 所示。图 4.12 展示了在 CrewAI 中层级处理的样子。
- en: '![figure](../Images/4-12.png)'
  id: totrans-229
  prefs: []
  type: TYPE_IMG
  zh: '![图](../Images/4-12.png)'
- en: Figure 4.12 Hierarchical processing of agents coordinated through a crew manager
  id: totrans-230
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图 4.12 通过队伍管理器协调的代理的层级处理
- en: Adding this manager is a relatively simple process. Listing 4.20 shows the additional
    code changes to a new file that uses the coding crew in a hierarchical method.
    Aside from importing a class for connecting to OpenAI from LangChain, the other
    addition is adding this class as the crew manger, `manager_llm`.
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: 添加这个经理是一个相对简单的过程。列表4.20显示了将编码船员以分层方法使用的新文件中的附加代码更改。除了从LangChain导入连接到OpenAI的类之外，另一个添加是将其作为船员经理`manager_llm`。
- en: Listing 4.20 `crewai_hierarchy.py` (crew manager sections)
  id: totrans-232
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表4.20 `crewai_hierarchy.py`（船员经理部分）
- en: '[PRE19]'
  id: totrans-233
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: '#1 Imports the LLM connector from LangChain'
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: '#1 从LangChain导入LLM连接器'
- en: '#2 You must set a crew manager when selecting hierarchical processing.'
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
  zh: '#2 在选择分层处理时，您必须设置一个船员经理。'
- en: '#3 Sets the crew manager to be the LLM connector'
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
  zh: '#3 将船员经理设置为LLM连接器'
- en: '#4 You must set a crew manager when selecting hierarchical processing.'
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: '#4 在选择分层处理时，您必须设置一个船员经理。'
- en: Run this file in VS Code (F5). When prompted, enter a game you want to create.
    Try using the same game you tried with AutoGen; the snake game is also a good
    baseline example. Observe the agents work through the code and review it repeatedly
    for problems.
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: 在VS Code中运行此文件（按F5）。当提示时，输入您想要创建的游戏。尝试使用与AutoGen相同的游戏；蛇游戏也是一个很好的基线示例。观察代理如何通过代码并反复检查问题。
- en: After you run the file, you can also jump on AgentOps to review the cost of
    this run. Chances are, it will cost over double what it would have without the
    agent manager. The output will also likely not be significantly better. This is
    the trap of building agent systems without understanding how quickly things can
    spiral.
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
  zh: 运行文件后，您还可以在AgentOps中查看此次运行的成本。很可能会超过没有代理管理器时的两倍。输出效果也可能不会显著提高。这就是在不了解事情如何迅速失控的情况下构建代理系统所陷入的陷阱。
- en: An example of this spiral that often happens when agents continually iterate
    over the same actions is frequently repeating tasks. You can view this problem
    in AgentOps, as shown in figure 4.13, by viewing the Repeat Thoughts plot.
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
  zh: 当代理不断重复相同的动作时，经常发生的这种螺旋效应的一个例子是频繁重复的任务。您可以通过查看重复思考图来查看这个问题，如图4.13所示。
- en: '![figure](../Images/4-13.png)'
  id: totrans-241
  prefs: []
  type: TYPE_IMG
  zh: '![figure](../Images/4-13.png)'
- en: Figure 4.13 The repetition of thoughts as they occurred within an agent run
  id: totrans-242
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图4.13 代理运行中发生的思维重复
- en: The Repeat Thoughts plot from AgentOps is an excellent way to measure the repetition
    your agent system encounters. Overly repetitive thought patterns typically mean
    the agent isn’t being decisive enough and instead keeps trying to generate a different
    answer. If you encounter this problem, you want to change the agents’ processing
    patterns, tasks, and goals. You may even want to alter the system’s type and number
    of agents.
  id: totrans-243
  prefs: []
  type: TYPE_NORMAL
  zh: AgentOps中的重复思考图是衡量您的代理系统遇到重复情况的一个绝佳方式。过于重复的思维模式通常意味着代理不够果断，而是在不断尝试生成不同的答案。如果您遇到这个问题，您可能需要改变代理的处理模式、任务和目标。您甚至可能想要改变系统的类型和代理的数量。
- en: Multi-agent systems are an excellent way to break up work in terms of work patterns
    of jobs and tasks. Generally, the job role is allocated to an agent role/persona,
    and the tasks it needs to complete may be implicit, as in AutoGen, or more explicit,
    as in CrewAI.
  id: totrans-244
  prefs: []
  type: TYPE_NORMAL
  zh: 多代理系统是按工作模式和任务分配工作的一种极好方式。通常，工作角色分配给代理角色/人物，它需要完成的任务可能是隐性的，如AutoGen中所示，或者更明确，如CrewAI中所示。
- en: In this chapter, we covered many useful tools and platforms that you can use
    right away to improve your work, life, and more. That completes our journey through
    multi-agent platforms, but it doesn’t conclude our exploration and use of multiple
    agents, as we’ll discover in later chapters.
  id: totrans-245
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们介绍了许多您可以直接使用的有用工具和平台，以改善您的工作、生活等。这完成了我们对多代理平台的探索之旅，但我们的探索和使用多代理的工作并未结束，正如我们将在后面的章节中发现的。
- en: 4.6 Exercises
  id: totrans-246
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 4.6 练习
- en: 'Use the following exercises to improve your knowledge of the material:'
  id: totrans-247
  prefs: []
  type: TYPE_NORMAL
  zh: 使用以下练习来提高您对材料的了解：
- en: '*Exercise 1* —Basic Agent Communication with AutoGen'
  id: totrans-248
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*练习1* — 使用AutoGen进行基本代理通信'
- en: '*Objective* —Familiarize yourself with basic agent communications and setup
    in AutoGen.'
  id: totrans-249
  prefs: []
  type: TYPE_NORMAL
  zh: '*目标* — 在AutoGen中熟悉基本的代理通信和设置。'
- en: '*Tasks*:'
  id: totrans-250
  prefs: []
  type: TYPE_NORMAL
  zh: '*任务*：'
- en: Set up AutoGen Studio on your local machine, following the instructions provided
    in this chapter.
  id: totrans-251
  prefs:
  - PREF_UL
  - PREF_UL
  type: TYPE_NORMAL
  zh: 按照本章提供的说明，在您的本地机器上设置AutoGen Studio。
- en: Create a simple multi-agent system with a user proxy and two assistant agents.
  id: totrans-252
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 创建一个简单的多代理系统，包含一个用户代理和两个助手代理。
- en: Implement a basic task where the user proxy coordinates between the assistant
    agents to generate a simple text output, such as summarizing a short paragraph.
  id: totrans-253
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 实现一个基本任务，其中用户代理在助手代理之间协调以生成简单的文本输出，例如总结一段简短的段落。
- en: '*Exercise 2* —Implementing Advanced Agent Skills in AutoGen Studio'
  id: totrans-254
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*练习2* — 在AutoGen Studio中实现高级代理技能'
- en: '*Objective* —Enhance agent capabilities by adding advanced skills.'
  id: totrans-255
  prefs: []
  type: TYPE_NORMAL
  zh: '*目标* — 通过添加高级技能增强代理能力。'
- en: '*Tasks*:'
  id: totrans-256
  prefs: []
  type: TYPE_NORMAL
  zh: '*任务*:'
- en: Develop and integrate a new skill into an AutoGen agent that allows it to fetch
    and display real-time data from a public API (e.g., weather information or stock
    prices).
  id: totrans-257
  prefs:
  - PREF_UL
  - PREF_UL
  type: TYPE_NORMAL
  zh: 开发并集成一项新技能到AutoGen代理中，使其能够从公共API（例如，天气信息或股票价格）获取并显示实时数据。
- en: Ensure the agent can ask for user preferences (e.g., city for weather, type
    of stocks) and display the fetched data accordingly.
  id: totrans-258
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 确保代理可以询问用户偏好（例如，天气的城市，股票类型）并相应地显示获取的数据。
- en: '*Exercise 3* —Role-Based Task Management with CrewAI'
  id: totrans-259
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*练习3* — 使用CrewAI进行基于角色的任务管理'
- en: '*Objective* —Explore role-based task management in CrewAI.'
  id: totrans-260
  prefs: []
  type: TYPE_NORMAL
  zh: '*目标* — 探索CrewAI中的基于角色的任务管理。'
- en: '*Tasks*:'
  id: totrans-261
  prefs: []
  type: TYPE_NORMAL
  zh: '*任务*:'
- en: Design a CrewAI setup where multiple agents are assigned specific roles (e.g.,
    data fetcher, analyzer, presenter).
  id: totrans-262
  prefs:
  - PREF_UL
  - PREF_UL
  type: TYPE_NORMAL
  zh: 设计一个CrewAI设置，其中多个代理被分配特定的角色（例如，数据收集器、分析器、报告生成器）。
- en: Configure a task sequence where the data fetcher collects data, the analyzer
    processes the data, and the presenter generates a report.
  id: totrans-263
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 配置一个任务序列，其中数据收集器收集数据，分析器处理数据，报告生成器生成报告。
- en: Execute the sequence and observe the flow of information and task delegation
    among agents.
  id: totrans-264
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 执行序列并观察代理之间信息流和任务委派的流程。
- en: '*Exercise 4* —Multi-Agent Collaboration in Group Chat Using AutoGen'
  id: totrans-265
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*练习4* — 使用AutoGen在群聊中进行多代理协作'
- en: '*Objective* —Understand and implement a group chat system in AutoGen to facilitate
    agent collaboration.'
  id: totrans-266
  prefs: []
  type: TYPE_NORMAL
  zh: '*目标* — 理解和实现AutoGen中的群聊系统以促进代理协作。'
- en: '*Tasks*:'
  id: totrans-267
  prefs: []
  type: TYPE_NORMAL
  zh: '*任务*:'
- en: Set up a scenario where multiple agents need to collaborate to solve a complex
    problem (e.g., planning an itinerary for a business trip).
  id: totrans-268
  prefs:
  - PREF_UL
  - PREF_UL
  type: TYPE_NORMAL
  zh: 设置一个场景，其中多个代理需要协作解决一个复杂问题（例如，为商务旅行规划行程）。
- en: Use the group chat feature to allow agents to share information, ask questions,
    and provide updates to each other.
  id: totrans-269
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用群聊功能允许代理之间共享信息、提问和提供更新。
- en: Monitor the agents’ interactions and effectiveness in collaborative problem
    solving.
  id: totrans-270
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 监控代理在协作问题解决中的交互和有效性。
- en: '*Exercise 5* —Adding and Testing Observability with AgentOps in CrewAI'
  id: totrans-271
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*练习5* — 在CrewAI中使用AgentOps添加和测试可观察性'
- en: '*Objective* —Implement and evaluate the observability of agents using AgentOps
    in a CrewAI environment.'
  id: totrans-272
  prefs: []
  type: TYPE_NORMAL
  zh: '*目标* — 在CrewAI环境中使用AgentOps实现和评估代理的可观察性。'
- en: '*Tasks*:'
  id: totrans-273
  prefs: []
  type: TYPE_NORMAL
  zh: '*任务*:'
- en: Integrate AgentOps into a CrewAI multi-agent system.
  id: totrans-274
  prefs:
  - PREF_UL
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将AgentOps集成到CrewAI多代理系统中。
- en: Design a task for the agents that involves significant computation or data processing
    (e.g., analyzing customer reviews to determine sentiment trends).
  id: totrans-275
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 设计一个涉及大量计算或数据处理（例如，分析客户评论以确定情感趋势）的任务。
- en: Use AgentOps to monitor the performance, cost, and output accuracy of the agents.
    Identify any potential inefficiencies or errors in agent interactions.
  id: totrans-276
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用AgentOps监控代理的性能、成本和输出准确性。识别任何潜在的交互不效率或错误。
- en: Summary
  id: totrans-277
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 摘要
- en: AutoGen, developed by Microsoft, is a conversational multi-agent platform that
    employs a variety of agent types, such as user proxies and assistant agents, to
    facilitate task execution through natural language interactions.
  id: totrans-278
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 由微软开发的AutoGen是一个对话式多代理平台，它采用多种代理类型，如用户代理和助手代理，通过自然语言交互促进任务执行。
- en: AutoGen Studio acts as a development environment that allows users to create,
    test, and manage multi-agent systems, enhancing the usability of AutoGen.
  id: totrans-279
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: AutoGen Studio作为一个开发环境，允许用户创建、测试和管理多代理系统，提高了AutoGen的可用性。
- en: AutoGen supports multiple communication patterns, including group chats and
    hierarchical and proxy communications. Proxy communication involves a primary
    agent (proxy) that interfaces between the user and other agents to streamline
    task completion.
  id: totrans-280
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: AutoGen支持多种通信模式，包括群聊、层次化和代理通信。代理通信涉及一个主要代理（代理），它在用户和其他代理之间进行接口以简化任务完成。
- en: CrewAI offers a structured approach to building multi-agent systems with a focus
    on enterprise applications. It emphasizes role-based and autonomous agent functionalities,
    allowing for flexible, sequential, or hierarchical task management.
  id: totrans-281
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: CrewAI提供了一种构建多代理系统的结构化方法，重点在于企业应用。它强调基于角色和自主代理的功能，允许灵活的、顺序的或层次化的任务管理。
- en: Practical exercises in the chapter illustrate how to set up and use AutoGen
    Studio, including installing necessary components and running basic multi-agent
    systems.
  id: totrans-282
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 本章中的实际练习说明了如何设置和使用AutoGen Studio，包括安装必要的组件和运行基本的多人智能体系统。
- en: Agents in AutoGen can be equipped with specific skills to perform tasks such
    as code generation, image analysis, and data retrieval, thereby broadening their
    application scope.
  id: totrans-283
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: AutoGen中的智能体可以配备特定的技能来执行代码生成、图像分析和数据检索等任务，从而扩大其应用范围。
- en: CrewAI is distinguished by its ability to structure agent interactions more
    rigidly than AutoGen, which can be advantageous in settings that require precise
    and controlled agent behavior.
  id: totrans-284
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: CrewAI凭借其能够比AutoGen更严格地结构化智能体交互的能力而脱颖而出，这在需要精确和可控智能体行为的场景中可能具有优势。
- en: CrewAI supports integrating memory and tools for agents to consume through task
    completion.
  id: totrans-285
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: CrewAI支持将记忆和工具集成到智能体中，以便通过任务完成来消费。
- en: CrewAI supports integration with observability tools such as AgentOps, which
    provides insights into agent performance, interaction efficiency, and cost management.
  id: totrans-286
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: CrewAI支持与可观察性工具（如AgentOps）集成，这些工具可以提供关于智能体性能、交互效率和成本管理的见解。
- en: AgentOps is an agent observability platform that can help you easily monitor
    extensive agent interactions.
  id: totrans-287
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: AgentOps是一个智能体可观察性平台，可以帮助您轻松监控广泛的智能体交互。
