- en: appendix B Python pandas DataFrame
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 附录B Python pandas DataFrame
- en: This appendix describes an overview of the pandas DataFrame and the methods
    used in this book.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 本附录描述了pandas DataFrame的概述以及本书中使用的方法。
- en: B.1 An overview of pandas DataFrame
  id: totrans-2
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: B.1 pandas DataFrame概述
- en: Python pandas is a data manipulation, analysis, and visualization library. It
    provides tools to load and allow you to manipulate, analyze, and visualize data.
    In this book, we use the pandas DataFrame, a two-dimensional structure composed
    of rows and columns. The DataFrame stores data in a tabular form, enabling you
    to manipulate, analyze, filter, and aggregate data quickly and easily.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: Python pandas是一个数据操作、分析和可视化库。它提供了加载数据、允许您操作、分析和可视化数据的工具。在本书中，我们使用pandas DataFrame，它由行和列组成的二维结构。DataFrame以表格形式存储数据，使您能够快速轻松地操作、分析、过滤和汇总数据。
- en: 'There are different ways to create a pandas DataFrame. In this book, we consider
    two ways: from a Python dictionary and from a CSV file. You can download the code
    described in this appendix from the GitHub repository for the book under AppendixB/Pandas
    DataFrame.ipynb.'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 创建pandas DataFrame有不同的方法。在本书中，我们考虑两种方法：从Python字典和从CSV文件。您可以从本书的GitHub存储库中下载附录B/Pandas
    DataFrame.ipynb中描述的代码。
- en: B.1.1 Building from a dictionary
  id: totrans-5
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: B.1.1 从字典构建
- en: Consider the following listing, which creates a pandas DataFrame from a Python
    dictionary.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 考虑以下列表，它从Python字典创建一个pandas DataFrame。
- en: Listing B.1 Creating a DataFrame from a dictionary
  id: totrans-7
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表B.1 从字典创建DataFrame
- en: '[PRE0]'
  id: totrans-8
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: '#1 Defines the dictionary'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: '#1 定义字典'
- en: '#2 Creates the DataFrame'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: '#2 创建DataFrame'
- en: '#3 Parses the BirthDate field as a date'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: '#3 将BirthDate字段解析为日期'
- en: Note  Use `DataFrame()` to create a new DataFrame from a dictionary.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 注意：使用`DataFrame()`从字典创建一个新的DataFrame。
- en: B.1.2 Building from a CSV file
  id: totrans-13
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: B.1.2 从CSV文件构建
- en: Use the `read_csv()` file to load a CSV file into a pandas DataFrame.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 使用`read_csv()`文件将CSV文件加载到pandas DataFrame中。
- en: Listing B.2 Creating a DataFrame from a CSV file
  id: totrans-15
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表B.2 从CSV文件创建DataFrame
- en: '[PRE1]'
  id: totrans-16
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: Note  Use `read_csv()` to create a new DataFrame from a CSV file.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 注意：使用`read_csv()`从CSV文件创建一个新的DataFrame。
- en: Now that you have seen how to create a pandas DataFrame, we’ll discuss the main
    DataFrame functions used in this book.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 现在您已经看到了如何创建pandas DataFrame，我们将讨论本书中使用的主要DataFrame函数。
- en: B.2 dt
  id: totrans-19
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: B.2 dt
- en: The `dt` variable within a pandas Dataframe enables you to access Python’s built-in
    DateTime library. Use it to store and manipulate DateTime values, such as the
    year, month, day, hour, minute, and second. Consider the following listing, which
    extracts the year from a DateTime column.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: pandas DataFrame中的`dt`变量允许您访问Python的内置DateTime库。使用它来存储和操作DateTime值，如年、月、日、小时、分钟和秒。考虑以下列表，它从DateTime列中提取年份。
- en: Listing B.3 How to use pandas `dt`
  id: totrans-21
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表B.3 如何使用pandas `dt`
- en: '[PRE2]'
  id: totrans-22
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: '#1 Extracts the year from the BirthDate column'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: '#1 从BirthDate列提取年'
- en: '#2 Extracts the month from the BirthDate column'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: '#2 从BirthDate列提取月'
- en: '#3 Extracts the day from the BirthDate column'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: '#3 从BirthDate列提取天'
- en: '#4 Extracts the week from the BirthDate column'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: '#4 从BirthDate列提取周'
- en: Note  Use pandas `dt` to access the DateTime functions of Python’s DateTime
    library.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 注意：使用pandas `dt`访问Python DateTime库的DateTime函数。
- en: B.3 groupby()
  id: totrans-28
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: B.3 groupby()
- en: The pandas `groupby()` method splits data into groups based on the values of
    certain columns. This process often involves creating an aggregate statistic for
    each group, such as a sum or mean.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: pandas `groupby()`方法根据某些列的值将数据拆分为组。此过程通常涉及为每个组创建一个汇总统计量，例如总和或平均值。
- en: Listing B.4 How to use pandas `groupby`
  id: totrans-30
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表B.4 如何使用pandas `groupby`
- en: '[PRE3]'
  id: totrans-31
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: Note  Use pandas `groupby` to group by instrument and calculate the average
    score by grade. Use the `reset_index()` method to restore the indexer column (`Grade`
    in the example).
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 注意：使用pandas `groupby`按仪器分组，并按年级计算平均分数。使用`reset_index()`方法恢复索引列（例如示例中的`Grade`）。
- en: Table B.1 shows the result.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 表B.1显示了结果。
- en: Table B.1 The result of `groupby()` in listing B.4
  id: totrans-34
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 表B.1 列表B.4中`groupby()`的结果
- en: '| **Grade** | **MathsScore** | **PhysicsScore** | **ChemistryScore** |'
  id: totrans-35
  prefs: []
  type: TYPE_TB
  zh: '| **成绩** | **数学成绩** | **物理成绩** | **化学成绩** |'
- en: '| --- | --- | --- | --- |'
  id: totrans-36
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- | --- |'
- en: '| A  | 90.0  | 88.0  | 91.0  |'
  id: totrans-37
  prefs: []
  type: TYPE_TB
  zh: '| A  | 90.0  | 88.0  | 91.0  |'
- en: '| B  | 85.0  | 92.0  |  |'
  id: totrans-38
  prefs: []
  type: TYPE_TB
  zh: '| B  | 85.0  | 92.0  |  |'
- en: B.4 isnull()
  id: totrans-39
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: B.4 isnull()
- en: The pandas DataFrame `isnull()` method returns a new Boolean DataFrame indicating
    which values in the DataFrame are null (`NaN`). Use this method to detect missing
    values in a DataFrame.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: pandas DataFrame的`isnull()`方法返回一个新的布尔DataFrame，指示DataFrame中的哪些值是null（`NaN`）。使用此方法检测DataFrame中的缺失值。
- en: Listing B.5 How to use pandas `isnull`
  id: totrans-41
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表B.5 如何使用pandas `isnull`
- en: '[PRE4]'
  id: totrans-42
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: Note  Use pandas `isnull()` to check if a DataFrame contains missing values.
    You can apply the `isnull()` method to a single column as well (e.g., `df['ChemistryScore'].isnull()`).
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 注意  使用 pandas 的 `isnull()` 函数检查 DataFrame 是否包含缺失值。您还可以将 `isnull()` 方法应用于单个列（例如，`df['ChemistryScore'].isnull()`）。
- en: Table B.2 shows the result, a Boolean DataFrame indicating which values in the
    DataFrame are null (`NaN`).
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 表 B.2 显示了结果，一个布尔 DataFrame，指示 DataFrame 中的哪些值是 null (`NaN`)。
- en: Table B.2 The result of `isnull()` in listing B.5
  id: totrans-45
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 表 B.2 列表 B.5 中 `isnull()` 的结果
- en: '| **Name** | **BirthDate** | **MathsScore** | **PhysicsScore** | **ChemistryScore**
    | **Grade** |'
  id: totrans-46
  prefs: []
  type: TYPE_TB
  zh: '| **姓名** | **出生日期** | **MathsScore** | **PhysicsScore** | **ChemistryScore**
    | **Grade** |'
- en: '| --- | --- | --- | --- | --- | --- |'
  id: totrans-47
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- | --- | --- | --- |'
- en: '| False  | False  | False  | False  | False  | False  |'
  id: totrans-48
  prefs: []
  type: TYPE_TB
  zh: '| False | False | False | False | False | False |'
- en: '| False  | False  | False  | False  | True  | False  |'
  id: totrans-49
  prefs: []
  type: TYPE_TB
  zh: '| False | False | False | False | True | False |'
- en: '| False  | False  | True  | False  | False  | False  |'
  id: totrans-50
  prefs: []
  type: TYPE_TB
  zh: '| False | False | True | False | False | False |'
- en: B.5 melt()
  id: totrans-51
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: B.5 melt()
- en: We use the pandas `melt()` function to reshape data by turning columns into
    rows. This function unpivots a DataFrame from wide to long format, optionally
    leaving identifiers set.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 我们使用 pandas 的 `melt()` 函数通过将列转换为行来重塑数据。此函数将 DataFrame 从宽格式转换为长格式，可选地保留标识符。
- en: Listing B.6 How to use pandas `melt`
  id: totrans-53
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表 B.6 如何使用 pandas `melt`
- en: '[PRE5]'
  id: totrans-54
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: Note  Use pandas `melt()` to transform the DataFrame from wide to long format.
    Set the `id_vars` argument to specify which variables to keep as an identifier
    and the `var_name` and `value_name` arguments to set the column names for the
    new variables in the resulting melted DataFrame. Use `value_ vars` to select the
    columns to group.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 注意  使用 pandas 的 `melt()` 函数将 DataFrame 从宽格式转换为长格式。将 `id_vars` 参数设置为指定要保留作为标识符的变量，并将
    `var_name` 和 `value_name` 参数设置为结果熔化 DataFrame 中新变量的列名。使用 `value_vars` 选择要分组的列。
- en: Table B.3 shows the result of melting the data used in listing B.6.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 表 B.3 显示了列表 B.6 中使用的数据的熔化结果。
- en: Table B.3 The result of the melting operation described in listing B.6
  id: totrans-57
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 表 B.3 列表 B.6 中描述的熔化操作的结果
- en: '| **Name** | **Subject** | **Score** |'
  id: totrans-58
  prefs: []
  type: TYPE_TB
  zh: '| **姓名** | **科目** | **分数** |'
- en: '| --- | --- | --- |'
  id: totrans-59
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- |'
- en: '| Alice  | `MathsScore`  | 90.0  |'
  id: totrans-60
  prefs: []
  type: TYPE_TB
  zh: '| 爱丽丝 | `MathsScore` | 90.0 |'
- en: '| Bob  | `MathsScore`  | 85.0  |'
  id: totrans-61
  prefs: []
  type: TYPE_TB
  zh: '| 鲍勃 | `MathsScore` | 85.0 |'
- en: '| Charlie  | `MathsScore`  | Null  |'
  id: totrans-62
  prefs: []
  type: TYPE_TB
  zh: '| 查理 | `MathsScore` | Null |'
- en: '| Alice  | `PhysicsScore`  | 87.0  |'
  id: totrans-63
  prefs: []
  type: TYPE_TB
  zh: '| 爱丽丝 | `PhysicsScore` | 87.0 |'
- en: '| Bob  | `PhysicsScore`  | 92.0  |'
  id: totrans-64
  prefs: []
  type: TYPE_TB
  zh: '| 鲍勃 | `PhysicsScore` | 92.0 |'
- en: '| Charlie  | `PhysicsScore`  | 89.0  |'
  id: totrans-65
  prefs: []
  type: TYPE_TB
  zh: '| 查理 | `PhysicsScore` | 89.0 |'
- en: '| Alice  | `ChemistryScore`  | 92.0  |'
  id: totrans-66
  prefs: []
  type: TYPE_TB
  zh: '| 爱丽丝 | `ChemistryScore` | 92.0 |'
- en: '| Bob  | `ChemistryScore`  | Null  |'
  id: totrans-67
  prefs: []
  type: TYPE_TB
  zh: '| 鲍勃 | `ChemistryScore` | Null |'
- en: B.6 unique()
  id: totrans-68
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: B.6 unique()
- en: We use the pandas `unique()` method to obtain distinct values from a specific
    column in a DataFrame. This method returns an array-like object, containing the
    unique values found in the specified column.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 我们使用 pandas 的 `unique()` 方法从 DataFrame 的特定列中获取唯一值。此方法返回一个类似数组的对象，包含在指定列中找到的唯一值。
- en: Listing B.7 How to use pandas `unique`
  id: totrans-70
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表 B.7 如何使用 pandas `unique`
- en: '[PRE6]'
  id: totrans-71
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: Note  Use pandas `unique()` to get the unique values of a column.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 注意  使用 pandas 的 `unique()` 函数获取列的唯一值。
- en: The following listing shows the result of calculating the unique values for
    the column `Grade` (from listing B.7).
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 以下列表显示了计算 `Grade` 列（来自列表 B.7）的唯一值的结果。
- en: Listing B.8 The results of pandas `unique()`
  id: totrans-74
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表 B.8 pandas `unique()` 的结果
- en: '[PRE7]'
  id: totrans-75
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: Note  The method returns an array containing the unique values for a column.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 注意  此方法返回一个包含列唯一值的数组。
