- en: 9 Using PyTorch to fight cancer
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 9 使用PyTorch来对抗癌症
- en: This chapter covers
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 本章涵盖内容
- en: Breaking a large problem into smaller, easier ones
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将一个大问题分解为更小、更容易的问题
- en: Exploring the constraints of an intricate deep learning problem, and deciding
    on a structure and approach
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 探索复杂深度学习问题的约束，并决定结构和方法
- en: Downloading the training data
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 下载训练数据
- en: 'We have two main goals for this chapter. We’ll start by covering the overall
    plan for part 2 of the book so that we have a solid idea of the larger scope the
    following individual chapters will be building toward. In chapter 10, we will
    begin to build out the data-parsing and data-manipulation routines that will produce
    data to be consumed in chapter 11 while training our first model. In order to
    do what’s needed for those upcoming chapters well, we’ll also use this chapter
    to cover some of the context in which our project will be operating: we’ll go
    over data formats, data sources, and exploring the constraints that our problem
    domain places on us. Get used to performing these tasks, since you’ll have to
    do them for any serious deep learning project!'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 本章有两个主要目标。我们将首先介绍本书第二部分的整体计划，以便我们对接下来的各个章节将要构建的更大范围有一个坚实的概念。在第10章中，我们将开始构建数据解析和数据操作例程，这些例程将在第11章中训练我们的第一个模型时产生要消耗的数据。为了很好地完成即将到来的章节所需的工作，我们还将利用本章来介绍我们的项目将运行的一些背景：我们将讨论数据格式、数据来源，并探索我们问题领域对我们施加的约束。习惯执行这些任务，因为你将不得不为任何严肃的深度学习项目做这些任务！
- en: 9.1 Introduction to the use case
  id: totrans-6
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 9.1 用例简介
- en: Our goal for this part of the book is to give you the tools to deal with situations
    where things aren’t working, which is a far more common state of affairs than
    part 1 might have led you to believe. We can’t predict every failure case or cover
    every debugging technique, but hopefully we’ll give you enough to not feel stuck
    when you encounter a new roadblock. Similarly, we want to help you avoid situations
    with your own projects where you have no idea what you could do next when your
    projects are under-performing. Instead, we hope your ideas list will be so long
    that the challenge will be to prioritize!
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 本书这一部分的目标是为您提供处理事情不顺利的工具，这种情况比第1部分可能让你相信的更常见。我们无法预测每种失败情况或涵盖每种调试技术，但希望我们能给你足够的东西，让你在遇到新的障碍时不感到困惑。同样，我们希望帮助您避免您自己的项目出现情况，即当您的项目表现不佳时，您不知道接下来该做什么。相反，���们希望您的想法列表会很长，挑战将是如何优先考虑！
- en: In order to present these ideas and techniques, we need a context with some
    nuance and a fair bit of heft to it. We’ve chosen automatic detection of malignant
    tumors in the lungs using only a CT scan of a patient’s chest as input. We’ll
    be focusing on the technical challenges rather than the human impact, but make
    no mistake--even from just an engineering perspective, part 2 will require a more
    serious, structured approach than we needed in part 1 in order to have the project
    succeed.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 为了呈现这些想法和技术，我们需要一个具有一些细微差别和相当重要性的背景。我们选择使用仅通过患者胸部的CT扫描作为输入来自动检测肺部恶性肿瘤。我们将专注于技术挑战而不是人类影响，但不要误解--即使从工程角度来看，第2部分也需要比第1部分更严肃、更有结构的方法才能使项目成功。
- en: '*Note* CT scans are essentially 3D X-rays, represented as a 3D array of single-channel
    data. We’ll cover them in more detail soon.'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: '*注意* CT扫描本质上是3D X射线，表示为单通道数据的3D数组。我们很快会更详细地讨论它们。'
- en: 'As you might have guessed, the title of this chapter is more eye-catching,
    implied hyperbole than anything approaching a serious statement of intent. Let
    us be precise: our project in this part of the book will take three-dimensional
    CT scans of human torsos as input and produce as output the location of suspected
    malignant tumors, if any exist.'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 正如你可能已经猜到的，本章的标题更多是引人注目的、暗示夸张，而不是严肃的声明意图。让我们准确一点：本书的这一部分的项目将以人体躯干的三维CT扫描作为输入，并输出怀疑的恶性肿瘤的位置，如果有的话。
- en: Detecting lung cancer early has a huge impact on survival rate, but is difficult
    to do manually, especially in any comprehensive, whole-population sense. Currently,
    the work of reviewing the data must be performed by highly trained specialists,
    requires painstaking attention to detail, and it is dominated by cases where no
    cancer exists.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 早期检测肺癌对生存率有巨大影响，但手动进行这项工作很困难，特别是在任何全面、整体人口意义上。目前，审查数据的工作必须由经过高度训练的专家执行，需要极其细致的注意，而且主要是由不存在癌症的情况主导。
- en: Doing that job well is akin to being placed in front of 100 haystacks and being
    told, “Determine which of these, if any, contain a needle.” Searching this way
    results in the potential for missed warning signs, particularly in the early stages
    when the hints are more subtle. The human brain just isn’t built well for that
    kind of monotonous work. And that, of course, is where deep learning comes in.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 做好这项工作就像被放在100堆草垛前，并被告知：“确定这些中哪些，如果有的话，包含一根针。”这样搜索会导致潜在的警告信号被忽略，特别是在早期阶段，提示更加微妙。人类大脑并不适合做那种单调的工作。当然，这就是深度学习发挥作用的地方。
- en: Automating this process is going to give us experience working in an uncooperative
    environment where we have to do more work from scratch, and there are fewer easy
    answers to problems that we might run into. Together, we’ll get there, though!
    Once you’re finished reading part 2, we think you’ll be ready to start working
    on a real-world, unsolved problem of your own choosing.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 自动化这个过程将使我们在一个不合作的环境中获得经验，在那里我们必须从头开始做更多的工作，而且可能会遇到更少的问题容易解决。不过，我们一起努力，最终会成功的！一旦你读完第二部分，我们相信你就准备好开始解决你自己选择的一个真实且未解决的问题了。
- en: We chose this problem of lung tumor detection for a few reasons. The primary
    reason is that the problem itself is unsolved! This is important, because we want
    to make it clear that you can use PyTorch to tackle cutting-edge projects effectively.
    We hope that increases your confidence in PyTorch as a framework, as well as in
    yourself as a developer. Another nice aspect of this problem space is that while
    it’s unsolved, a lot of teams have been paying attention to it recently and have
    seen promising results. That means this challenge is probably right at the edge
    of our collective ability to solve; we won’t be wasting our time on a problem
    that’s actually decades away from reasonable solutions. That attention on the
    problem has also resulted in a lot of high-quality papers and open source projects,
    which are a great source of inspiration and ideas. This will be a huge help once
    we conclude part 2 of the book, if you are interested in continuing to improve
    on the solution we create. We’ll provide some links to additional information
    in chapter 14.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 我们选择了肺部肿瘤检测这个问题，有几个原因。主要原因是这个问题本身尚未解决！这很重要，因为我们想要明确表明你可以使用PyTorch有效地解决尖端项目。我们希望这能增加你对PyTorch作为框架以及作为开发者的信心。这个问题空间的另一个好处是，虽然它尚未解决，但最近许多团队一直在关注它，并且已经看到了有希望的结果。这意味着这个挑战可能正好处于我们集体解决能力的边缘；我们不会浪费时间在一个实际上离合理解决方案还有几十年的问题上。对这个问题的关注也导致了许多高质量的论文和开源项目，这些是灵感和想法的重要来源。如果你有兴趣继续改进我们创建的解决方案，这将在我们完成书的第二部分后非常有帮助。我们将在第14章提供一些额外信息的链接。
- en: This part of the book will remain focused on the problem of detecting lung tumors,
    but the skills we’ll teach are general. Learning how to investigate, preprocess,
    and present your data for training is important no matter what project you’re
    working on. While we’ll be covering preprocessing in the specific context of lung
    tumors, the general idea is that *this is what you should be prepared to do* for
    your project to succeed. Similarly, setting up a training loop, getting the right
    performance metrics, and tying the project’s models together into a final application
    are all general skills that we’ll employ as we go through chapters 9 through 14.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 本书的这一部分将继续专注于检测肺部肿瘤的问题，但我们将教授的技能是通用的。学习如何调查、预处理和呈现数据以进行训练对于你正在进行的任何项目都很重要。虽然我们将在肺部肿瘤的具体背景下涵盖预处理，但总体思路是*这是你应该为你的项目做好准备的*。同样，建立训练循环、获得正确的性能指标以及将项目的模型整合到��终应用程序中都是我们将在第9至14章中使用的通用技能。
- en: '*Note* While the end result of part 2 will work, the output will not be accurate
    enough to use clinically. We’re focusing on using this as a motivating example
    for *teaching PyTorch*, not on employing every last trick to solve the problem.'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: '*注意* 尽管第2部分的最终结果将有效，但输出不够准确以用于临床。我们专注于将其作为*教授PyTorch*的激励示例，而不是利用每一个技巧来解决问题。'
- en: 9.2 Preparing for a large-scale project
  id: totrans-17
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 9.2 准备一个大型项目
- en: This project will build off of the foundational skills learned in part 1\. In
    particular, the content covering model construction from chapter 8 will be directly
    relevant. Repeated convolutional layers followed by a resolution-reducing downsampling
    layer will still make up the majority of our model. We will use 3D data as input
    to our model, however. This is conceptually similar to the 2D image data used
    in the last few chapters of part 1, but we will not be able to rely on all of
    the 2D-specific tools available in the PyTorch ecosystem.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 这个项目将建立在第1部分学到的基础技能之上。特别是，从第8章开始的模型构建内容将直接相关。重复的卷积层后跟着一个分辨率降低的下采样层仍将构成我们模型的大部分。然而，我们将使用3D数据作为我们模型的输入。这在概念上类似于第1部分最后几章中使用的2D图像数据，但我们将无法依赖PyTorch生态系统中所有2D特定工具。
- en: The main differences between the work we did with convolutional models in chapter
    8 and what we’ll do in part 2 are related to how much effort we put into things
    outside the model itself. In chapter 8, we used a provided, off-the-shelf dataset
    and did little data manipulation before feeding the data into a model for classification.
    Almost all of our time and attention were spent building the model itself, whereas
    now we’re not even going to begin designing the first of our two model architectures
    until chapter 11\. That is a direct consequence of having nonstandard data without
    prebuilt libraries ready to hand us training samples suitable to plug into a model.
    We’ll have to learn about our data and implement quite a bit ourselves.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 我们在第8章使用卷积模型的工作与第2部分中将要做的工作之间的主要区别与我们投入到模型之外的事情有关。在第8章，我们使用一个提供的现成数据集，并且在将数据馈送到模型进行分类之前几乎没有进行数据操作。我们几乎所有的时间和注意力都花在构建模型本身上，而现在我们甚至不会在第11章开始设计我们的两个模型架构之一。这是由于有非标准数据，没有预先构建的库可以随时提供适合插入模型的训练样本。我们将不得不了解我们的数据并自己实现相当多的内容。
- en: Even when that’s done, this will not end up being a case where we convert the
    CT to a tensor, feed it into a neural network, and have the answer pop out the
    other side. As is common for real-world use cases such as this, a workable approach
    will be more complicated to account for confounding factors such as limited data
    availability, finite computational resources, and limitations on our ability to
    design effective models. Please keep that in mind as we build to a high-level
    explanation of our project architecture.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 即使完成了这些工作，这也不会成为将CT转换为张量，将其馈送到神经网络中，并在另一侧得到答案的情况。对于这样的真实用例，一个可行的方法将更加复杂，以考虑到限制数据可用性、有限的计算资源以及我们设计有效模型的能力的限制因素。请记住这一点，因为我们将逐步解释我们项目架构的高级概述。
- en: Speaking of finite computational resources, part 2 will require access to a
    GPU to achieve reasonable training speeds, preferably one with at least 8 GB of
    RAM. Trying to train the models we will build on CPU could take weeks![¹](#pgfId-1011948)
    If you don’t have a GPU handy, we provide pretrained models in chapter 14; the
    nodule analysis script there can probably be run overnight. While we don’t want
    to tie the book to proprietary services if we don’t have to, we should note that
    at the time of writing, Colaboratory ([https://colab.research.google.com](https://colab.research.google.com))
    provides free GPU instances that might be of use. PyTorch even comes preinstalled!
    You will also need to have at least 220 GB of free disk space to store the raw
    training data, cached data, and trained models.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 谈到有限的计算资源，第2部分将需要访问 GPU 才能实现合理的训练速度，最好是至少具有 8 GB 的 RAM。尝试在 CPU 上训练我们将构建的模型可能需要几周时间！[¹](#pgfId-1011948)
    如果你手头没有 GPU，我们在第14章提供了预训练模型；那里的结节分析脚本可能可以在一夜之间运行。虽然我们不想将本书与专有服务绑定，但值得注意的是，目前，Colaboratory（[https://colab.research.google.com](https://colab.research.google.com)）提供免费的
    GPU 实例，可能会有用。PyTorch 甚至已经预安装！你还需要至少 220 GB 的可用磁盘空间来存储原始训练数据、缓存数据和训练模型。
- en: '*Note* Many of the code examples presented in part 2 have complicating details
    omitted. Rather than clutter the examples with logging, error handling, and edge
    cases, the text of this book contains only code that expresses the core idea under
    discussion. Full working code samples can be found on the book’s website ([www.manning.com/books/deep-learning-with-pytorch](https://www.manning.com/books/deep-learning-with-pytorch))
    and GitHub ([https://github.com/deep-learning-with-pytorch/dlwpt-code](https://github.com/deep-learning-with-pytorch/dlwpt-code)).'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: '*注意* 第2部分中呈现的许多代码示例省略了复杂的细节。与其用日志记录、错误处理和边缘情况来混淆示例，本书的文本只包含表达讨论中核心思想的代码。完整的可运行代码示例可以在本书的网站（[www.manning.com/books/deep-learning-with-pytorch](https://www.manning.com/books/deep-learning-with-pytorch)）和
    GitHub（[https://github.com/deep-learning-with-pytorch/dlwpt-code](https://github.com/deep-learning-with-pytorch/dlwpt-code)）上找到。'
- en: OK, we’ve established that this is a hard, multifaceted problem, but what are
    we going to do about it? Instead of looking at an entire CT scan for signs of
    tumors or their potential malignancy, we’re going to solve a series of simpler
    problems that will combine to provide the end-to-end result we’re interested in.
    Like a factory assembly line, each step will take raw materials (data) and/or
    output from previous steps, perform some processing, and hand off the result to
    the next station down the line. Not every problem needs to be solved this way,
    but breaking off chunks of the problem to solve in isolation is often a great
    way to start. Even if it turns out to be the wrong approach for a given project,
    it’s likely we’ll have learned enough while working on the individual chunks that
    we’ll have a good idea how to restructure our approach into something successful.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 好的，我们已经确定了这是一个困难、多方面的问题，但我们要怎么解决呢？我们不是要查看整个 CT 扫描以寻找肿瘤或其潜在恶性，而是要解决一系列更简单的问题，这些问题将组合在一起提供我们感兴趣的端到端结果。就像工厂的装配线一样，每个步骤都会接收原材料（数据）和/或前一步骤的输出，进行一些处理，并将结果交给下一个站点。并不是每个问题都需要这样解决，但将问题分解成独立解决的部分通常是一个很好的开始。即使最终发现这种方法对于特定项目来说是错误的，但在处理各个部分时，我们可能已经学到足够多的知识，以便知道如何重新构建我们的方法以取得成功。
- en: Before we get into the details of how we’ll break down our problem, we need
    to learn some details about the medical domain. While the code listings will tell
    you *what* we’re doing, learning about radiation oncology will explain *why*.
    Learning about the problem space is crucial, no matter what domain it is. Deep
    learning is powerful, but it’s not magic, and trying to apply it blindly to nontrivial
    problems will likely fail. Instead, we have to combine insights into the space
    with intuition about neural network behavior. From there, disciplined experimentation
    and refinement should give us enough information to close in on a workable solution.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们深入了解如何分解问题的细节之前，我们需要了解一些关于医学领域的细节。虽然代码清单会告诉你我们在做什么，但了解放射肿瘤学将解释为什么我们这样做。无论是哪个领域，了解问题空间都是至关重要的。深度学习很强大，但它不是魔法，盲目地将其应用于非平凡问题可能会失败。相反，我们必须将对空间的洞察力与对神经网络行为的直觉相结合。从那里，有纪律的实验和改进应该为我们提供足够的信息，以便找到可行的解决方案。
- en: 9.3 What is a CT scan, exactly?
  id: totrans-25
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 9.3 什么是 CT 扫描，确切地说？
- en: 'Before we get too far into the project, we need to take a moment to explain
    what a CT scan is. We will be using data from CT scans extensively as the main
    data format for our project, so having a working understanding of the data format’s
    strengths, weaknesses, and fundamental nature will be crucial to utilizing it
    well. The key point we noted earlier is this: CT scans are essentially 3D X-rays,
    represented as a 3D array of single-channel data. As we might recall from chapter
    4, this is like a stacked set of grayscale PNG images.'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们深入项目之前，我们需要花点时间解释一下什么是 CT 扫描。我们将广泛使用 CT 扫描数据作为我们项目的主要数据格式，因此对数据格式的优势、劣势和基本特性有一个工作理解将对其有效利用至关重要。我们之前指出的关键点是：CT
    扫描本质上是 3D X 射线，表示为单通道数据的 3D 数组。正如我们可能从第4章中记得的那样，这就像一组堆叠的灰度 PNG 图像。
- en: Voxel
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 体素
- en: A voxel is the 3D equivalent to the familiar two-dimensional pixel. It encloses
    a volume of space (hence, “volumetric pixel”), rather than an area, and is typically
    arranged in a 3D grid to represent a field of data. Each of those dimensions will
    have a measurable distance associated with it. Often, voxels are cubic, but for
    this chapter, we will be dealing with voxels that are rectangular prisms.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 一个体素是熟悉的二维像素的三维等价物。它包围着空间的一个体积（因此，“体积像素”），而不是一个区域，并且通常排列在一个三维网格中以表示数据场。每个维度都将与之关联一个可测量的距离。通常，体素是立方体的，但在本章中，我们将处理的是长方体体素。
- en: In addition to medical data, we can see similar voxel data in fluid simulations,
    3D scene reconstructions from 2D images, light detection and ranging (LIDAR) data
    for self-driving cars, and many other problem spaces. Those spaces all have their
    individual quirks and subtleties, and while the APIs that we’re going to cover
    here apply generally, we must also be aware of the nature of the data we’re using
    with those APIs if we want to be effective.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 除了医学数据，我们还可以在流体模拟、从2D图像重建的3D场景、用于自动驾驶汽车的光探测与测距（LIDAR）数据等问题领域看到类似的体素数据。这些领域都有各自的特点和微妙之处，虽然我们将在这里介绍的API通常适用，但如果我们想要有效地使用这些API，我们也必须了解我们使用的数据的性质。
- en: Each voxel of a CT scan has a numeric value that roughly corresponds to the
    average mass density of the matter contained inside. Most visualizations of that
    data show high-density material like bones and metal implants as white, low-density
    air and lung tissue as black, and fat and tissue as various shades of gray. Again,
    this ends up looking somewhat similar to an X-ray, with some key differences.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 每个CT扫描的体素都有一个数值，大致对应于内部物质的平均质量密度。大多数数据的可视化显示高密度材料如骨骼和金属植入物为白色，低密度的空气和肺组织为黑色，脂肪和组织为各种灰色。再次，这看起来与X射线有些相似，但也有一些关键区别。
- en: 'The primary difference between CT scans and X-rays is that whereas an X-ray
    is a projection of 3D intensity (in this case, tissue and bone density) onto a
    2D plane, a CT scan retains the third dimension of the data. This allows us to
    render the data in a variety of ways: for example, as a grayscale solid, which
    we can see in figure 9.1.'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: CT扫描和X射线之间的主要区别在于，X射线是将3D强度（在本例中为组织和骨密度）投影到2D平面上，而CT扫描保留了数据的第三维。这使我们能够以各种方式呈现数据：例如，作为一个灰度实体，我们可以在图9.1中看到。
- en: '![](../Images/CH09_F01_Stevens2_GS.png)'
  id: totrans-32
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/CH09_F01_Stevens2_GS.png)'
- en: 'Figure 9.1 A CT scan of a human torso showing, from the top, skin, organs,
    spine, and patient support bed. Source: [http://mng.bz/04r6](http://mng.bz/04r6);
    Mindways CT Software / CC BY-SA 3.0 ([https:// creativecommons.org/licenses/by-sa/
    3.0/deed.en](https://creativecommons.org/licenses/by-sa/3.0/deed.en)).'
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 图9.1 人体躯干的CT扫描，从上到下依次显示皮肤、器官、脊柱和患者支撑床。来源：[http://mng.bz/04r6](http://mng.bz/04r6);
    Mindways CT Software / CC BY-SA 3.0 ([https://creativecommons.org/licenses/by-sa/3.0/deed.en](https://creativecommons.org/licenses/by-sa/3.0/deed.en))。
- en: '*Note* CT scans actually measure radiodensity, which is a function of both
    mass density and atomic number of the material under examination. For our purposes
    here, the distinction isn’t relevant, since the model will consume and learn from
    the CT data no matter what the exact units of the input happen to be.'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: '*注意* CT扫描实际上测量的是辐射密度，这是受检材料的质量密度和原子序数的函数。在这里，区分并不相关，因为无论输入的确切单位是什么，模型都会处理和学习CT数据。'
- en: This 3D representation also allows us to “see inside” the subject by hiding
    tissue types we are not interested in. For example, we can render the data in
    3D and restrict visibility to only bone and lung tissue, as in figure 9.2.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 这种3D表示还允许我们通过隐藏我们不感兴趣的组织类型来“看到”主体内部。例如，我们可以将数据呈现为3D，并将可见性限制在骨骼和肺组织，如图9.2所示。
- en: '![](../Images/CH09_F02_Stevens2_GS.png)'
  id: totrans-36
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/CH09_F02_Stevens2_GS.png)'
- en: Figure 9.2 A CT scan showing ribs, spine, and lung structures
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 图9.2 显示了肋骨、脊柱和肺结构的CT扫描
- en: CT scans are much more difficult to acquire than X-rays, because doing so requires
    a machine like the one shown in figure 9.3 that typically costs upward of a million
    dollars new and requires trained staff to operate it. Most hospitals and some
    well-equipped clinics have a CT scanner, but they aren’t nearly as ubiquitous
    as X-ray machines. This, combined with patient privacy regulations, can make it
    somewhat difficult to get CT scans unless someone has already done the work of
    gathering and organizing a collection of them.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 与X射线相比，CT扫描要难得多，因为这需要像图9.3中所示的那种机器，通常新机器的成本高达一百万美元，并且需要受过培训的工作人员来操作。大多数医院和一些设备齐全的诊所都有CT扫描仪，但它们远不及X射线机器普及。这与患者隐私规定结合在一起，可能会使得获取CT扫描有些困难，除非已经有人做好了收集和整理这些数据的工作。
- en: Figure 9.3 also shows an example bounding box for the area contained in the
    CT scan. The bed the patient is resting on moves back and forth, allowing the
    scanner to image multiple slices of the patient and hence fill the bounding box.
    The scanner’s darker, central ring is where the actual imaging equipment is located.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 图9.3还显示了CT扫描中包含区域的示例边界框。患者躺在的床来回移动，使扫描仪能够成像患者的多个切片，从而填充边界框。扫描仪较暗的中心环是实际成像设备的位置。
- en: '![](../Images/CH09_F03_Stevens2_GS.png)'
  id: totrans-40
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/CH09_F03_Stevens2_GS.png)'
- en: Figure 9.3 A patient inside a CT scanner, with the CT scan’s bounding box overlaid.
    Other than in stock photos, patients don’t typically wear street clothes while
    in the machine.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 图9.3 一个患者在CT扫描仪内，CT扫描的边界框叠加显示。除了库存照片外，患者在机器内通常不穿着便装。
- en: A final difference between a CT scan and an X-ray is that the data is a digital-only
    format. *CT* stands for *computed tomography* ([https://en.wikipedia.org/wiki/CT_scan#Process](https://en.wikipedia.org/wiki/CT_scan#Process)).
    The raw output of the scanning process doesn’t look particularly meaningful to
    the human eye and must be properly reinterpreted by a computer into something
    we can understand. The settings of the CT scanner when the scan is taken can have
    a large impact on the resulting data.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: CT扫描与X射线之间的最后一个区别是数据仅以数字格式存在。*CT*代表*计算机断层扫描*([https://en.wikipedia.org/wiki/CT_scan#Process](https://en.wikipedia.org/wiki/CT_scan#Process))。扫描过程的原始输出对人眼来说并不特别有意义，必须由计算机正确重新解释为我们可以理解的内容。扫描时CT扫描仪的设置会对结果数据产生很大影响。
- en: 'While this information might not seem particularly relevant, we have actually
    learned something that is: from figure 9.3, we can see that the way the CT scanner
    measures distance along the head-to-foot axis is different than the other two
    axes. The patient actually moves along that axis! This explains (or at least is
    a strong hint as to) why our voxels might not be cubic, and also ties into how
    we approach massaging our data in chapter 12\. This is a good example of why we
    need to understand our problem space if we’re going to make effective choices
    about how to solve our problem. When starting to work on your own projects, be
    sure you do the same investigation into the details of your data.'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管这些信息可能看起来并不特别相关，但实际上我们学到了一些东西：从图9.3中，我们可以看到CT扫描仪测量头到脚轴向距离的方式与其他两个轴不同。患者实际上沿着这个轴移动！这解释了（或至少是一个强烈的暗示）为什么我们的体素可能不是立方体，并且也与我们在第12章中如何处理数据有关。这是一个很好的例子，说明我们需要了解我们的问题领域，如果要有效地选择如何解决问题。在开始处理自己的项目时，确保您对数据的细节进行相同的调查。
- en: '9.4 The project: An end-to-end detector for lung cancer'
  id: totrans-44
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 9.4 项目：肺癌端到端检测器
- en: Now that we’ve got our heads wrapped around the basics of CT scans, let’s discuss
    the structure of our project. Most of the bytes on disk will be devoted to storing
    the CT scans’ 3D arrays containing density information, and our models will primarily
    consume various subslices of those 3D arrays. We’re going to use five main steps
    to go from examining a whole-chest CT scan to giving the patient a lung cancer
    diagnosis.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经掌握了CT扫描的基础知识，让我们讨论一下我们项目的结构。大部分磁盘上的字节将用于存储包含密度信息的CT扫描的3D数组，我们的模型将主要消耗这些3D数组的各种子切片。我们将使用五个主要步骤，从检查整个胸部CT扫描到给患者做出肺癌诊断。
- en: Our full, end-to-end solution shown in figure 9.4 will load CT data files to
    produce a `Ct` instance that contains the full 3D scan, combine that with a module
    that performs *segmentation* (flagging voxels of interest), and then group the
    interesting voxels into small lumps in the search for candidate *nodules*.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 我们在图9.4中展示的完整端到端解决方案将加载CT数据文件以生成包含完整3D扫描的`Ct`实例，将其与执行*分割*（标记感兴趣的体素）的模块结合，然后将有趣的体素分组成小块，以寻找候选*结节*。
- en: Nodules
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 结节
- en: A mass of tissue made of proliferating cells in the lung is a tumor. A tumor
    can be benign or it can be malignant, in which case it is also referred to as
    cancer. A small tumor in the lung (just a few millimeters wide) is called a nodule.
    About 40% of lung nodules turn out to be malignant--small cancers. It is very
    important to catch those as early as possible, and this depends on medical imaging
    of the kind we are looking at here.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 肺部由增殖细胞组成的组织块称为肿瘤。肿瘤可以是良性的，也可以是恶性的，此时也被称为癌症。肺部的小肿瘤（仅几毫米宽）称为结节。大约40%的肺结节最终被证实是恶性的--小癌症。尽早发现这些对于医学影像非常重要，这取决于我们正在研究的这种类型的医学影像。
- en: '![](../Images/CH09_F04_Stevens2_GS.png)'
  id: totrans-49
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/CH09_F04_Stevens2_GS.png)'
- en: Figure 9.4 The end-to-end process of taking a full-chest CT scan and determining
    whether the patent has a malignant tumor
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 图9.4 完整胸部CT扫描并确定患者是否患有恶性肿瘤的端到端过程
- en: The nodule locations are combined back with the CT voxel data to produce nodule
    candidates, which can then be examined by our nodule classification model to determine
    whether they are actually nodules in the first place and, eventually, whether
    they’re malignant. This latter task is particularly difficult because malignancy
    might not be apparent from CT imaging alone, but we’ll see how far we get. Last,
    each of those individual, per-nodule classifications can then be combined into
    a whole-patient diagnosis.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 结节位置与CT体素数据结合，产生结节候选，然后可以由我们的结节分类模型检查它们是否实际上是结节，最终是否是恶性的。后一项任务特别困难，因为恶性可能仅从CT成像中无法明显看出，但我们将看看我们能走多远。最后，每个单独的结节分类可以组合成整体患者诊断。
- en: 'In more detail, we will do the following:'
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 更详细地说，我们将执行以下操作：
- en: Load our raw CT scan data into a form that we can use with PyTorch. Putting
    raw data into a form usable by PyTorch will be the first step in any project you
    face. The process is somewhat less complicated with 2D image data and simpler
    still with non-image data.
  id: totrans-53
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将我们的原始CT扫描数据加载到一个可���与PyTorch一起使用的形式中。将原始数据放入PyTorch可用的形式将是您面临的任何项目的第一步。对于2D图像数据，这个过程稍微复杂一些，对于非图像数据则更简单。
- en: Identify the voxels of potential tumors in the lungs using PyTorch to implement
    a technique known as *segmentation*. This is roughly akin to producing a heatmap
    of areas that should be fed into our classifier in step 3\. This will allow us
    to focus on potential tumors inside the lungs and ignore huge swaths of uninteresting
    anatomy (a person can’t have lung cancer in the stomach, for example).
  id: totrans-54
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用PyTorch识别肺部潜在肿瘤的体素，实现一种称为*分割*的技术。这大致相当于生成应该输入到我们第3步分类器中的区域的热图。这将使我们能够专注于肺部内部的潜在肿瘤，并忽略大片无趣的解剖结构（例如，一个人不能在胃部患肺癌）。
- en: Generally, being able to focus on a single, small task is best while learning.
    With experience, there are some situations where more complicated model structures
    can yield superlative results (for example, the GAN game we saw in chapter 2),
    but designing those from scratch requires extensive mastery of the basic building
    blocks first. Gotta walk before you run, and all that.
  id: totrans-55
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 通常，在学习时能够专注于单一小任务是最好的。随着经验的积累，有些情况下更复杂的模型结构可以产生最优结果（例如，我们在第2章看到的GAN游戏），但是从头开始设计这些模型需要对基本构建模块有广泛的掌握。先学会走路，再跑步，等等。
- en: 'Group interesting voxels into lumps: that is, candidate nodules (see figure
    9.5 for more information on nodules). Here, we will find the rough center of each
    hotspot on our heatmap.'
  id: totrans-56
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将有趣的体素分组成块：也就是候选结节（有关结节的更多信息，请参见图9.5）。在这里，我们将找到热图上每个热点的粗略中心。
- en: Each nodule can be located by the index, row, and column of its center point.
    We do this to present a simple, constrained problem to the final classifier. Grouping
    voxels will not involve PyTorch directly, which is why we’ve pulled this out into
    a separate step. Often, when working with multistep solutions, there will be non-deep-learning
    glue steps between the larger, deep-learning-powered portions of the project.
  id: totrans-57
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 每个结节可以通过其中心点的索引、行和列来定位。我们这样做是为了向最终分类器提供一个简单、受限的问题。将体素分组不会直接涉及PyTorch，这就是为什么我们将其拆分为一个单独的步骤。通常，在处理多步解决方案时，会在项目的较大、由深度学习驱动的部分之间添加非深度学习的连接步骤。
- en: Classify candidate nodules as actual nodules or non-nodules using 3D convolution.
  id: totrans-58
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用3D卷积将候选结节分类为实际结节或非结节。
- en: This will be similar in concept to the 2D convolution we covered in chapter
    8\. The features that determine the nature of a tumor from a candidate structure
    are local to the tumor in question, so this approach should provide a good balance
    between limiting input data size and excluding relevant information. Making scope-limiting
    decisions like this can keep each individual task constrained, which can help
    limit the amount of things to examine when troubleshooting.
  id: totrans-59
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 这将类似于我们在第8章中介绍的2D卷积。确定候选结构中肿瘤性质的特征是与问题中的肿瘤局部相关的，因此这种方法应该在限制输入数据大小和排除相关信息之间提供良好的平衡。做出这种限制范围的决定可以使每个单独的任务受限，这有助于在故障排除时限制要检查的事物数量。
- en: Diagnose the patient using the combined per-nodule classifications.
  id: totrans-60
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用组合的每个结节分类来诊断患者。
- en: Similar to the nodule classifier in the previous step, we will attempt to determine
    whether the nodule is benign or malignant based on imaging data alone. We will
    take a simple maximum of the per-tumor malignancy predictions, as only one tumor
    needs to be malignant for a patient to have cancer. Other projects might want
    to use different ways of aggregating the per-instance predictions into a file
    score. Here, we are asking, “Is there anything suspicious?” so maximum is a good
    fit for aggregation. If we were looking for quantitative information like “the
    ratio of type A tissue to type B tissue,” we might take an appropriate mean instead.
  id: totrans-61
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 与上一步中的结节分类器类似，我们将尝试仅基于成像数据确定结节是良性还是恶性。我们将简单地取每个肿瘤恶性预测的最大值，因为只需要一个肿瘤是恶性，患者就会患癌症。其他项目可能希望使用不同的方式将每个实例的预测聚合成一个文件分数。在这里，我们问的是，“有什么可疑的吗？”所以最大值是一个很好的聚合方式。如果我们正在寻找定量信息，比如“A型组织与B型组织的比例”，我们可能会选择适当的平均值。
- en: On the shoulders of giants
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 肩上的巨人
- en: We are standing on the shoulders of giants when deciding on this five-step approach.
    We’ll discuss these giants and their work more in chapter 14\. There isn’t any
    particular reason why we should know in advance that this project structure will
    work well for this problem; instead, we’re relying on others who have actually
    implemented similar things and reported success when doing so. Expect to have
    to experiment to find workable approaches when transitioning to a different domain,
    but always try to learn from earlier efforts in the space and from those who have
    worked in similar areas and have discovered things that might transfer well. Go
    out there, look for what others have done, and use that as a benchmark. At the
    same time, avoid getting code and running it blindly, because you need to fully
    understand the code you’re running in order to use the results to make progress
    for yourself.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们决定采用这种五步方法时，我们站在巨人的肩膀上。我们将在第14章更详细地讨论这些巨人及其工作。我们事先并没有特别的理由认为这种项目结构对这个问题会很有效；相反，我们依赖于那些实际实施过类似事物并报告成功的人。在转向不同领域时，预计需要进行实验以找到可行的方法，但始终尝试从该领域的早期努力和那些在类似领域工作并发现可能转移的事物的人那里学习。走出去，寻找他人所做的事情，并将其作为一个基准。同时，避免盲目获取代码并运行，因为您需要完全理解您正在运行的代码，以便利用结果为自己取得进展。
- en: Figure 9.4 only depicts the final path through the system once we’ve built and
    trained all of the requisite models. The actual work required to train the relevant
    models will be detailed as we get closer to implementing each step.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 图9.4仅描述了在构建和训练所有必要模型后通过系统的最终路径。训练相关模型所需的实际工作将在我们接近实施每个步骤时详细说明。
- en: The data we’ll use for training provides human-annotated output for both steps
    3 and 4\. This allows us to treat steps 2 and 3 (identifying voxels and grouping
    them into nodule candidates) as almost a separate project from step 4 (nodule
    candidate classification). Human experts have annotated the data with nodule locations,
    so we can work on either steps 2 and 3 or step 4 in whatever order we prefer.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将用于训练的数据为步骤3和4提供了人工注释的输出。这使我们可以将步骤2和3（识别体素并将其分组为结节候选）几乎视为与步骤4（结节候选分类）分开的项目。人类专家已经用结节位置注释了数据，因此我们可以按照自己喜欢的顺序处理步骤2和3或步骤4。
- en: We will first work on step 1 (data loading), and then jump to step 4 before
    we come back and implement steps 2 and 3, since step 4 (classification) requires
    an approach similar to what we used in chapter 8, using multiple convolutional
    and pooling layers to aggregate spatial information before feeding it into a linear
    classifier. Once we’ve got a handle on our classification model, we can start
    working on step 2 (segmentation). Since segmentation is the more complicated topic,
    we want to tackle it without having to learn both segmentation and the fundamentals
    of CT scans and malignant tumors at the same time. Instead, we’ll explore the
    cancer-detection space while working on a more familiar classification problem.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将首先处理步骤1（数据加载），然后跳到步骤4，然后再回来实现步骤2和3，因为步骤4（分类）需要一种类似于我们在第8章中使用的方法，即使用多个卷积和池化层来聚合空间信息，然后将其馈送到线性分类器中。一旦我们掌握了分类模型，我们就可以开始处理步骤2（分割）。由于分割是更复杂的主题，我们希望在不必同时学习分割和CT扫描以及恶性肿瘤的基础知识的情况下解决它。相反，我们将在处理一个更熟悉的分类问题的同时���索癌症检测领域。
- en: This approach of starting in the middle of the problem and working our way out
    probably seems odd. Starting at step 1 and working our way forward would make
    more intuitive sense. Being able to carve up the problem and work on steps independently
    is useful, however, since it can encourage more modular solutions; in addition,
    it’s easier to partition the workload between members of a small team. Also, actual
    clinical users would likely prefer a system that flags suspicious nodules for
    review rather than provides a single binary diagnosis. Adapting our modular solution
    to different use cases will probably be easier than if we’d done a monolithic,
    from-the-top system.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 从问题中间开始并逐步解决问题的方法可能看起来很奇怪。从第1步开始逐步向前推进会更直观。然而，能够将问题分解并独立解决各个步骤是有用的，因为这样可以鼓励更模块化的解决方案；此外，将工作负载在小团队成员之间划分会更容易。此外，实际的临床用户可能更喜欢一个系统，可以标记可疑的结节供审查，而不是提供单一的二进制诊断。将我们的模块化解决方案适应不同的用例可能会比如果我们采用了单一的、自上而下的系统更容易。
- en: As we work our way through implementing each step, we’ll be going into a fair
    bit of detail about lung tumors, as well as presenting a lot of fine-grained detail
    about CT scans. While that might seem off-topic for a book that’s focused on PyTorch,
    we’re doing so specifically so that you begin to develop an intuition about the
    problem space. That’s crucial to have, because the space of all possible solutions
    and approaches is too large to effectively code, train, and evaluate.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们逐步实施每一步时，我们将详细介绍肺部肿瘤，以及展示大量关于CT扫描的细节。虽然这可能看起来与专注于PyTorch的书籍无关，但我们这样做是为了让你开始对问题空间产生直觉。这是至关重要的，因为所有可能的解决方案和方法的空间太大，无法有效地编码、训练和评估。
- en: If we were working on a different project (say, the one you tackle after finishing
    this book), we’d still need to do an investigation to understand the data and
    problem space. Perhaps you’re interested in satellite mapping, and your next project
    needs to consume pictures of our planet taken from orbit. You’d need to ask questions
    about the wavelengths being collected--do you get only normal RGB, or something
    more exotic? What about infrared or ultraviolet? In addition, there might be impacts
    on the images based on time of day, or if the imaged location isn’t directly under
    the satellite, skewing the image. Will the image need correction?
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们在做一个不同的项目（比如你在完成这本书后要处理的项目），我们仍然需要进行调查来了解数据和问题空间。也许你对卫星地图制作感兴趣，你的下一个项目需要处理从轨道拍摄的地球图片。你需要询问关于收集的波长的问题--你只得到正常的RGB吗，还是更奇特的东西？红外线或紫外线呢？此外，根据白天时间或者成像位置不直接在卫星正上方，可能会使图像倾斜。图像是否需要校正？
- en: Even if your hypothetical *third* project’s data type remains the same, it’s
    probable that the domain you’ll be working in will change things, possibly drastically.
    Processing camera output for self-driving cars still involves 2D images, but the
    complications and caveats are wildly different. For example, it’s much less likely
    that a mapping satellite will need to worry about the sun shining into the camera,
    or getting mud on the lens!
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 即使你假设的*第三个*项目的数据类型保持不变，你将要处理的领域可能会改变事情，可能会发生显著变化。处理自动驾驶汽车的相机输出仍然涉及2D图像，但复杂性和注意事项却大不相同。例如，映射卫星不太可能需要担心太阳照射到相机中，或者镜头上沾上泥巴！
- en: We must be able to use our intuition to guide our investigation into potential
    optimizations and improvements. That’s true of deep learning projects in general,
    and we’ll practice using our intuition as we go through part 2\. So, let’s do
    that. Take a quick step back, and do a gut check. What does your intuition say
    about this approach? Does it seem overcomplicated to you?
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 我们必须能够运用直觉来引导我们对潜在优化和改进的调查。这对于深度学习项目���说是真实的，我们将在第2部分中练习使用我们的直觉。所以，让我们这样做。快速退后一步，做一个直觉检查。你的直觉对这种方法有什么看法？对你来说是否过于复杂？
- en: 9.4.1 Why can’t we just throw data at a neural network until it works?
  id: totrans-72
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 9.4.1 为什么我们不能简单地将数据输入神经网络直到它工作？
- en: After reading the last section, we couldn’t blame you for thinking, “This is
    nothing like chapter 8!” You might be wondering why we’ve got two separate model
    architectures or why the overall data flow is so complicated. Well, our approach
    is different from that in chapter 8 for a reason. It’s a hard task to automate,
    and people haven’t fully figured it out yet. That difficulty translates to complexity;
    once we as a society have solved this problem definitively, there will probably
    be an off-the-shelf library package we can grab to have it Just Work, but we’re
    not there just yet.
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 在阅读最后一节之后，如果你认为，“这和第8章完全不同！”我们并不会责怪你。你可能会想知道为什么我们有两种不同的模型架构，或者为什么整体数据流如此复杂。嗯，我们之所以采取这种方法与第8章不同是有原因的。自动化这个任务很困难，人们还没有完全弄清楚。这种困难转化为复杂性；一旦我们作为一个社会彻底解决了这个问题，可能会有一个现成的库包，我们可以直接使用，但我们还没有达到那一步。
- en: Why so difficult, though?
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 为什么会这么困难呢？
- en: Well, for starters, the majority of a CT scan is fundamentally uninteresting
    with regard to answering the question, “Does this patient have a malignant tumor?”
    This makes intuitive sense, since the vast majority of the patient’s body will
    consist of healthy cells. In the cases where there is a malignant tumor, up to
    99.9999% of the voxels in the CT still won’t be cancer. That ratio is equivalent
    to a two-pixel blob of incorrectly tinted color somewhere on a high-definition
    television, or a single misspelled word out of a shelf of novels.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，大部分CT扫描基本上与回答“这个患者是否患有恶性肿瘤？”这个问题无关。这是很直观的，因为患者身体的绝大部分组织都是健康的细胞。在有恶性肿瘤的情况下，CT中高达99.9999%的体素仍然不是癌症。这个比例相当于高清电视上某处两个像素的颜色错误或者一本小说书架上一个拼错的单词。
- en: Can you identify the white dot in the three views of figure 9.5 that has been
    flagged as a nodule?[²](#pgfId-1014126)
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 你能够在图9.5的三个视图中识别被标记为结节的白点吗？[²](#pgfId-1014126)
- en: If you need a hint, the index, row, and column values can be used to help find
    the relevant blob of dense tissue. Do you think you could figure out the relevant
    properties of tumors given only images (and that means *only* the images--no index,
    row, and column information!) like these? What if you were given the entire 3D
    scan, not just three slices that intersect the interesting part of the scan?
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你需要提示，索引、行和列值可以帮助找到相关的密集组织块。你认为只有这些图像（这意味着*只有*图像--没有索引、行和列信息！）你能找出肿瘤的相关特性吗？如果你被给予整个3D扫描，而不仅仅是与扫描的有趣部分相交的三个切片呢？
- en: '*Note* Don’t fret if you can’t locate the tumor! We’re trying to illustrate
    just how subtle this data can be--the fact that it is hard to identify visually
    is the entire point of this example.'
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: '*注意* 如果你找不到肿瘤，不要担心！我们试图说明这些数据有多微妙--难以在视觉上识别是这个例子的全部意义。'
- en: '![](../Images/CH09_F05_Stevens2_GS.png)'
  id: totrans-79
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/CH09_F05_Stevens2_GS.png)'
- en: Figure 9.5 A CT scan with approximately 1,000 structures that look like tumors
    to the untrained eye. Exactly one has been identified as a nodule when reviewed
    by a human specialist. The rest are normal anatomical structures like blood vessels,
    lesions, and other non-problematic lumps.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 图9.5 一张CT扫描，大约有1,000个对于未经训练的眼睛看起来像肿瘤的结构。当由人类专家审查时，只有一个被确定为结节。其余的是正常的解剖结构，如血管、病变和其他无问题的肿块。
- en: You might have seen elsewhere that end-to-end approaches for detection and classi-fication
    of objects are very successful in general vision tasks. TorchVision includes end-to-end
    models like Fast R-CNN/Mask R-CNN, but these are typically trained on hundreds
    of thousands of images, and those datasets aren’t constrained by the number of
    samples from rare classes. The project architecture we will use has the benefit
    of working well with a more modest amount of data. So while it’s certainly theoretically
    possible to just throw an arbitrarily large amount of data at a neural network
    until it learns the specifics of the proverbial lost needle, as well as how to
    ignore the hay, it’s going to be practically prohibitive to collect enough data
    and wait for a long enough time to train the network properly. That won’t be the
    *best* approach since the results are poor, and most readers won’t have access
    to the compute resources to pull it off at all.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 你可能在其他地方看到端到端方法在对象检测和分类中非常成功。TorchVision包括像Fast R-CNN/Mask R-CNN这样的端到端模型，但这些模型通常在数十万张图像上进行训练，而这些数据集并不受稀有类别样本数量的限制。我们将使用的项目架构有利于在更适量的数据上表现良好。因此，虽然从理论上讲，可以向神经网络投入任意大量的数据，直到它学会寻找传说中的丢失的针，以及如何忽略干草，但实际上收集足够的数据并等待足够长的时间来正确训练网络是不现实的。这不会是*最佳*方法，因为结果很差，大多数读者根本无法获得计算资源来实现它。
- en: To come up with the best solution, we could investigate proven model designs
    that can better integrate data in an end-to-end manner.[³](#pgfId-1014227) These
    complicated designs are capable of producing high-quality results, but they’re
    not the *best* because understanding the design decisions behind them requires
    having mastered fundamental concepts first. That makes these advanced models poor
    candidates to use while teaching those same fundamentals!
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 要想得出最佳解决方案，我们可以研究已被证明能够更好地端到端集成数据的模型设计。这些复杂的设计能够产生高质量的结果，但它们并不是*最佳*，因为要理解它们背后的设计决策需要先掌握基本概念。这使得这些先进模型在教授这些基本概念时不是很好的选择！
- en: That’s not to say that our multistep design is the *best* approach, either,
    but that’s because “best” is only relative to the criteria we chose to evaluate
    approaches. There are *many* “best” approaches, just as there are many goals we
    could have in mind as we work on a project. Our self-contained, multistep approach
    has some disadvantages as well.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 这并不是说我们的多步设计是*最佳*方法，因为“最佳”只是相对于我们选择用来评估方法的标准而言。有*许多*“最佳”方法，就像我们在项目中工作时可能有许多目标一样。我们的自包含、多步方法也有一些缺点。
- en: Recall the GAN game from chapter 2\. There, we had two networks cooperating
    to produce convincing forgeries of old master artists. The artist would produce
    a candidate work, and the scholar would critique it, giving the artist feedback
    on how to improve. Put in technical terms, the structure of the model allowed
    gradients to backpropagate from the final classifier (fake or real) to the earliest
    parts of the project (the artist).
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 回想一下第2章的GAN游戏。在那里，我们有两个网络合作，制作出老大师艺术家的逼真赝品。艺术家会制作一个候选作品，学者会对其进行评论，给予艺术家如何改进的反馈。用技术术语来说，模型的结构允许梯度从最终分类器（假或真）传播到项目的最早部分（艺术家）。
- en: Our approach for solving the problem won’t use end-to-end gradient backpropagation
    to directly optimize for our end goal. Instead, we’ll optimize discrete chunks
    of the problem individually, since our segmentation model and classification model
    won’t be trained in tandem with each other. That might limit the top-end effectiveness
    of our solution, but we feel that this will make for a much better learning experience.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 我们解决问题的方法不会使用端到端梯度反向传播直接优化我们的最终目标。相反，我们将分别优化问题的离散块，因为我们的分割模型和分类模型不会同时训练。这可能会限制我们解决方案的最高效果，但我们认为这将带来更好的学习体验。
- en: We feel that being able to focus on a single step at a time allows us to zoom
    in and concentrate on the smaller number of new skills we’re learning. Each of
    our two models will be focused on performing exactly one task. Similar to a human
    radiologist as they review slice after slice of CT, the job gets much easier to
    train for if the scope is well contained. We also want to provide tools that allow
    for rich manipulation of the data. Being able to zoom in and focus on the detail
    of a particular location will have a huge impact on overall productivity while
    training the model compared to having to look at the entire image at once. Our
    segmentation model is forced to consume the entire image, but we will structure
    things so that our classification model gets a zoomed-in view of the areas of
    interest.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 我们认为，能够一次专注于一个步骤使我们能够放大并集中精力学习的新技能数量更少。我们的两个模型将专注于执行一个任务。就像人类放射科医生在逐层查看CT切片时一样，如果范围被很好地限定，训练工作就会变得更容易。我们还希望提供能够对数据进行丰富操作的工具。能够放大并专注于特定位置的细节将对训练模型的整体生产率产生巨大影响，而不是一次查看整个图像。我们的分割模型被迫消耗整个图像，但我们将构建结构，使我们的分类模型获得感兴趣区域的放大视图。
- en: Step 3 (grouping) will produce and step 4 (classification) will consume data
    similar to the image in figure 9.6 containing sequential transverse slices of
    a tumor. This image is a close-up view of a (potentially malignant, or at least
    indeterminate) tumor, and it is what we’re going to train the step 4 model to
    identify, and the step 5 model to classify as either benign or malignant. While
    this lump may seem nondescript to an untrained eye (or untrained convolutional
    network), identifying the warning signs of malignancy in this sample is at least
    a far more constrained problem than having to consume the entire CT we saw earlier.
    Our code for the next chapter will provide routines to produce zoomed-in nodule
    images like figure 9.6.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 第3步（分组）将生成数据，第4步（分类）将消耗类似于图9.6中包含肿瘤顺序横截面的图像。这幅图像是（潜在恶性，或至少不确定）肿瘤的近距离视图，我们将训练第4步模型识别，并训练第5步模型将其分类为良性或恶性。对于未经训练的眼睛（或未经训练的卷积网络）来说，这个肿块可能看起来毫无特征，但在这个样本中识别恶性的预警信号至少比消耗我们之前看到的整个CT要容易得多。我们下一章的代码将提供生成类似图9.6的放大结节图像的例程。
- en: '![](../Images/CH09_F06_Stevens2_GS.png)'
  id: totrans-88
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/CH09_F06_Stevens2_GS.png)'
- en: Figure 9.6 A close-up, multislice crop of the tumor from the CT scan in figure
    9.5
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 图9.6 CT扫描中肿瘤的近距离、多层切片裁剪
- en: We will perform the step 1 data-loading work in chapter 10, and chapters 11
    and 12 will focus on solving the problem of classifying these nodules. After that,
    we’ll back up to work on step 2 (using segmentation to find the candidate tumors)
    in chapter 13, and then we’ll close out part 2 of the book in chapter 14 by implementing
    the end-to-end project with step 3 (grouping) and step 5 (nodule analysis and
    diagnosis).
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将在第10章中进行第1步数据加载工作，第11章和第12章将专注于解决分类这些结节的问题。之后，我们将回到第13章工作于第2步（使用分割找到候选肿瘤），然后我们将在第14章中结束本书的第2部分，通过实现第3步（分组）和第5步（结节分析和诊断）的端到端项目。
- en: '*Note* Standard rendering of CTs places the superior at the top of the image
    (basically, the head goes up), but CTs order their slices such that the first
    slice is the inferior (toward the feet). So, Matplotlib renders the images upside
    down unless we take care to flip them. Since that flip doesn’t really matter to
    our model, we won’t complicate the code paths between our raw data and the model,
    but we will add a flip to our rendering code to get the images right-side up.
    For more information about CT coordinate systems, see section 10.4\.'
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: '*注意* CT的标准呈现将上部放在图像的顶部（基本上，头向上），但CT按顺序排列其切片，使第一切片是下部（向脚）。因此，Matplotlib会颠倒图像，除非我们注意翻转它们。由于这种翻转对我们的模型并不重要，我们不会在原始数据和模型之间增加代码路径的复杂性，但我们会在渲染代码中添加翻转以使图像正面朝上。有关CT坐标系统的更多信息，请参见第10.4节。'
- en: Let’s repeat our high-level overview in figure 9.7.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们在图9.7中重复我们的高层概述。
- en: '![](../Images/CH09_F07_Stevens2_GS.png)'
  id: totrans-93
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/CH09_F07_Stevens2_GS.png)'
- en: Figure 9.7 The end-to-end process of taking a full-chest CT scan and determining
    whether the patient has a malignant tumor
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 图9.7 完成全胸CT扫描并确定患者是否患有恶性肿瘤的端到端过程
- en: 9.4.2 What is a nodule?
  id: totrans-95
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 9.4.2 什么是结节？
- en: 'As we’ve said, in order to understand our data well enough to use it effectively,
    we need to learn some specifics about cancer and radiation oncology. One last
    key thing we need to understand is what a *nodule* is. Simply put, a nodule is
    any of the myriad lumps and bumps that might appear inside someone’s lungs. Some
    are problematic from a health-of-the-patient perspective; some are not. The precise
    definition[⁴](#pgfId-1014430) limits the size of a nodule to 3 cm or less, with
    a larger lump being a *lung mass* ; but we’re going to use *nodule* interchangeably
    for all such anatomical structures, since it’s a somewhat arbitrary cutoff and
    we’re going to deal with lumps on both sides of 3 cm using the same code paths.
    A nodule--a small mass in the lung--can turn out to be benign or a malignant tumor
    (also referred to as *cancer*). From a radiological perspective, a nodule is really
    similar to other lumps that have a wide variety of causes: infection, inflammation,
    blood-supply issues, malformed blood vessels, and diseases other than tumors.'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 正如我们所说的，为了充分了解我们的数据以有效使用它，我们需要学习一些关于癌症和放射肿瘤学的具体知识。我们需要了解的最后一件重要事情是什么是*结节*。简单来说，结节是可能出现在某人肺部内部的无数肿块和隆起之一。有些从患者健康角度来看是有问题的；有些则不是。精确的定义将结节的大小限制在3厘米以下，更大的肿块被称为*肺块*；但我们将使用*结节*来交替使用所有这样的解剖结构，因为这是一个相对任意的分界线，我们将使用相同的代码路径处理3厘米两侧的肿块。肺部的小肿块--结节--可能是良性或恶性肿瘤（也称为*癌症*）。从放射学的角度来看，结节与其他有各种原因的肿块非常相似：感染、炎症、血液供应问题、畸形血管以及除肿瘤外的其他疾病。
- en: 'The key part is this: the cancers that we are trying to detect will *always*
    be nodules, either suspended in the very non-dense tissue of the lung or attached
    to the lung wall. That means we can limit our classifier to only nodules, rather
    than have it examine all tissue. Being able to restrict the scope of expected
    inputs will help our classifier learn the task at hand.'
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 关键部分在于：我们试图检测的癌症将*始终*是结节，要么悬浮在肺部非密集组织中，要么附着在肺壁上。这意味着我们可以将我们的分类器限制在仅检查结节，而不是让它检查所有组织。能够限制预期输入范围将有助于我们的分类器学习手头的任务。
- en: This is another example of how the underlying deep learning techniques we’ll
    use are universal, but they can’t be applied blindly.[⁵](#pgfId-1014495) We’ll
    need to understand the field we’re working in to make choices that will serve
    us well.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 这是另一个例子，说明我们将使用的基础深度学习技术是通用的，但不能盲目应用。我们需要了解我们所从事的领域，以做出对我们有利的选择。
- en: In figure 9.8, we can see a stereotypical example of a malignant nodule. The
    smallest nodules we’ll be concerned with are only a few millimeters across, though
    the one in figure 9.8 is larger. As we discussed earlier in the chapter, this
    makes the smallest nodules approximately a million times smaller than the CT scan
    as a whole. More than half of the nodules detected in patients are not malignant.[⁶](#pgfId-1014514)
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 在图9.8中，我们可以看到一个恶性结节的典型例子。我们关注的最小结节直径仅几毫米，尽管图9.8中的结节较大。正如我们在本章前面讨论的那样，这使得最小结节大约比整个CT扫描小一百万倍。患者检测到的结节中超过一半不是恶性的。
- en: '![](../Images/CH09_F08_Stevens2_GS.png)'
  id: totrans-100
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/CH09_F08_Stevens2_GS.png)'
- en: Figure 9.8 A CT scan with a malignant nodule displaying a visual discrepancy
    from other nodules
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 图9.8 一张显示恶性结节与其他结节视觉差异的CT扫描
- en: '9.4.3 Our data source: The LUNA Grand Challenge'
  id: totrans-102
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 9.4.3 我们的数据来源：LUNA大挑战
- en: The CT scans we were just looking at come from the LUNA (LUng Nodule Analysis)
    Grand Challenge. The LUNA Grand Challenge is the combination of an open dataset
    with high-quality labels of patient CT scans (many with lung nodules) and a public
    ranking of classifiers against the data. There is something of a culture of publicly
    sharing medical datasets for research and analysis; open access to such data allows
    researchers to use, combine, and perform novel work on this data without having
    to enter into formal research agreements between institutions (obviously, some
    data is kept private as well). The goal of the LUNA Grand Challenge is to encourage
    improvements in nodule detection by making it easy for teams to compete for high
    positions on the leader board. A project team can test the efficacy of their detection
    methods against standardized criteria (the dataset provided). To be included in
    the public ranking, a team must provide a scientific paper describing the project
    architecture, training methods, and so on. This makes for a great resource to
    provide further ideas and inspiration for project improvements.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 我们刚刚查看的CT扫描来自LUNA（LUng Nodule Analysis）大挑战。LUNA大挑战是一个开放数据集与患者CT扫描（许多带有肺结节的）高质量标签的结合，以及对数据的分类器的公开排名。有一种公开分享医学数据集用于研究和分析的文化；对这些数据的开放访问使研究人员能够在不必在机构之间签订正式研究协议的情况下使用、结合和对这些数据进行新颖的工作（显然，某些数据也是保密的）。LUNA大挑战的目标是通过让团队轻松竞争排名榜上的高位来鼓励结节检测的改进。项目团队可以根据标准化标准（提供的数据集）测试其检测方法的有效性。要包含在公开排名中，团队必须提供描述项目架构、训练方法等的科学论文。这为提供进一步的想法和启发项目改进提供了很好的资源。
- en: '*Note* Many CT scans “in the wild” are incredibly messy, in terms of idiosyncrasies
    between various scanners and processing programs. For example, some scanners indicate
    areas of the CT scan that are outside of the scanner’s field of view by setting
    the density of those voxels to something negative. CT scans can also be acquired
    with a variety of settings on the CT scanner, which can change the resulting image
    in ways ranging from subtly to wildly different. Although the LUNA data is generally
    clean, be sure to check your assumptions if you incorporate other data sources.'
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: '*注意* 许多CT扫描“在野外”非常混乱，因为各种扫描仪和处理程序之间存在独特性。例如，一些扫描仪通过将那些超出扫描仪视野范围的CT扫描区域的密度设置为负值来指示这些体素。CT扫描也可以使用各种设置在CT扫描仪上获取，这可能会以微妙或截然不同的方式改变结果图像。尽管LUNA数据通常很干净，但如果您整合其他数据源，请务必检查您的假设。'
- en: 'We will be using the LUNA 2016 dataset. The LUNA site ([https://luna16.grand-challenge
    .org/Description](https://luna16.grand-challenge.org/Description)) describes two
    tracks for the challenge: the first track, “Nodule detection (NDET),” roughly
    corresponds to our step 1 (segmentation); and the second track, “False positive
    reduction (FPRED),” is similar to our step 3 (classification). When the site discusses
    “locations of possible nodules,” it is talking about a process similar to what
    we’ll cover in chapter 13\.'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将使用LUNA 2016数据集。LUNA网站（[https://luna16.grand-challenge.org/Description](https://luna16.grand-challenge.org/Description)）描述了挑战的两个轨道���第一轨道“结节检测（NDET）”大致对应于我们的第1步（分割）；第二轨道“假阳性减少（FPRED）”类似于我们的第3步（分类）。当该网站讨论“可能结节的位置”时，它正在讨论一个类似于我们将在第13章中介绍的过程。
- en: 9.4.4 Downloading the LUNA data
  id: totrans-106
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 9.4.4 下载LUNA数据
- en: Before we go any further into the nuts and bolts of our project, we’ll cover
    how to get the data we’ll be using. It’s about 60 GB of data compressed, so depending
    on your internet connection, it might take a while to download. Once uncompressed,
    it takes up about 120 GB of space; and we’ll need another 100 GB or so of cache
    space to store smaller chunks of data so that we can access it more quickly than
    reading in the whole CT.[⁷](#pgfId-1014643)
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们进一步探讨项目的细节之前，我们将介绍如何获取我们将使用的数据。压缩后的数据约为60 GB，因此根据您的互联网连接速度，可能需要一段时间才能下载。解压后，它占用约120
    GB的空间；我们还需要另外约100 GB的缓存空间来存储较小的数据块，以便我们可以比读取整个CT更快地访问它。
- en: Navigate to [https://luna16.grand-challenge.org/download](https://luna16.grand-challenge.org/download)
    and either register using email or use the Google OAuth login. Once logged in,
    you should see two download links to Zenodo data, as well as a link to Academic
    Torrents. The data should be the same from either.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 导航至 [https://luna16.grand-challenge.org/download](https://luna16.grand-challenge.org/download)
    并注册使用电子邮件或使用 Google OAuth 登录。登录���，您应该看到两个指向 Zenodo 数据的下载链接，以及指向 Academic Torrents
    的链接。无论哪个链接，数据应该是相同的。
- en: '*Tip* The luna.grand-challenge.org domain does not have links to the data download
    page as of this writing. If you are having issues finding the download page, double-check
    the domain for luna16., not `luna.`, and reenter the URL if needed.'
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: '*提示* 截至目前，luna.grand-challenge.org 域名没有链接到数据下载页面。如果您在查找下载页面时遇到问题，请仔细检查 luna16.
    的域名，而不是 `luna.`，如果需要，请重新输入网址。'
- en: The data we will be using comes in 10 subsets, aptly named `subset0` through
    `subset9`. Unzip each of them so you have separate subdirectories like code/data-unversioned/
    part2/luna/subset0, and so on. On Linux, you’ll need the `7z` decompression utility
    (Ubuntu provides this via the `p7zip-full` package). Windows users can get an
    extractor from the 7-Zip website (www.7-zip.org). Some decompression utilities
    will not be able to open the archives; make sure you have the full version of
    the extractor if you get an error.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将使用的数据分为10个子集，分别命名为 `subset0` 到 `subset9`。解压缩每个子集，以便您有单独的子目录，如 code/data-unversioned/
    part2/luna/subset0，依此类推。在 Linux 上，您将需要 `7z` 解压缩实用程序（Ubuntu 通过 `p7zip-full` 软件包提供此功能）。Windows
    用户可以从 7-Zip 网站（www.7-zip.org）获取提取器。某些解压缩实用程序可能无法打开存档；如果出现错误，请确保您使用的是提取器的完整版本。
- en: In addition, you need the candidates.csv and annotations.csv files. We’ve included
    these files on the book’s website and in the GitHub repository for convenience,
    so they should already be present in code/data/part2/luna/*.csv. They can also
    be downloaded from the same location as the data subsets.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 另外，您需要 candidates.csv 和 annotations.csv 文件。为了方便起见，我们已经在书的网站和 GitHub 仓库中包含了这些文件，因此它们应该已经存在于
    code/data/part2/luna/*.csv 中。也可以从与数据子集相同的位置下载它们。
- en: '*Note* If you do not have easy access to ~220 GB of free disk space, it’s possible
    to run the examples using only 1 or 2 of the 10 subsets of data. The smaller training
    set will result in the model performing much more poorly, but that’s better than
    not being able to run the examples at all.'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: '*注意* 如果您没有轻松获得约220 GB 的免费磁盘空间，可以仅使用 1 或 2 个数据子集来运行示例。较小的训练集将导致模型表现得更差，但这总比完全无法运行示例要好。'
- en: Once you have the candidates file and at least one subset downloaded, uncompressed,
    and put in the correct location, you should be able to start running the examples
    in this chapter. If you want to jump ahead, you can use the code/p2ch09_explore_data
    .ipynb Jupyter Notebook to get started. Otherwise, we’ll return to the notebook
    in more depth later in the chapter. Hopefully your downloads will finish before
    you start reading the next chapter!
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦您拥有候选文件和至少一个已下载、解压缩并放置在正确位置的子集，您应该能够开始运行本章的示例。如果您想提前开始，可以使用 code/p2ch09_explore_data
    .ipynb Jupyter Notebook 来开始。否则，我们将在本章后面更深入地讨论笔记本。希望您的下载能在您开始阅读下一章之前完成！
- en: 9.5 Conclusion
  id: totrans-114
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 9.5 结论
- en: We’ve made major strides toward finishing our project! You might have the feeling
    that we haven’t accomplished much; after all, we haven’t implemented a single
    line of code yet. But keep in mind that you’ll need to do research and preparation
    as we have here when you tackle projects on your own.
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经取得了完成项目的重大进展！您可能会觉得我们没有取得多少成就；毕竟，我们还没有实现一行代码。但请记住，当您独自处理项目时，您需要像我们在这里做的研究和准备一样。
- en: 'In this chapter, we set out to do two things:'
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们着手完成了两件事：
- en: Understand the larger context around our lung cancer-detection project
  id: totrans-117
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 了解我们的肺癌检测项目周围的更大背景
- en: Sketch out the direction and structure of our project for part 2
  id: totrans-118
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 勾勒出我们第二部分项目的方向和结构
- en: If you still feel that we haven’t made real progress, please recognize that
    mindset as a trap--understanding the space your project is working in is crucial,
    and the design work we’ve done will pay off handsomely as we move forward. We’ll
    see those dividends shortly, once we start implementing our data-loading routines
    in chapter 10.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您仍然觉得我们没有取得实质性进展，请意识到这种心态是一个陷阱--理解项目所处的领域至关重要，我们所做的设计工作将在我们继续前进时大大获益。一旦我们在第10章开始实现数据加载例程，我们将很快看到这些回报。
- en: Since this chapter has been informational only, without any code, we’ll skip
    the exercises for now.
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 由于本章仅提供信息，没有任何代码，我们将暂时跳过练习。
- en: 9.6 Summary
  id: totrans-121
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 9.6 总结
- en: 'Our approach to detecting cancerous nodules will have five rough steps: data
    loading, segmentation, grouping, classification, and nodule analysis and diagnosis.'
  id: totrans-122
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们检测癌性结节的方法将包括五个大致步骤：数据加载、分割、分组、分类以及结节分析和诊断。
- en: Breaking down our project into smaller, semi-independent subprojects makes teaching
    each subproject easier. Other approaches might make more sense for future projects
    with different goals than the ones for this book.
  id: totrans-123
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将我们的项目分解为更小、半独立的子项目，使得教授每个子项目变得更容易。对于未来具有不同目标的项目，可能会采用其他方法，而不同于本书的目标。
- en: A CT scan is a 3D array of intensity data with approximately 32 million voxels,
    which is around a million times larger than the nodules we want to recognize.
    Focusing the model on a crop of the CT scan relevant to the task at hand will
    make it easier to get reasonable results from training.
  id: totrans-124
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: CT 扫描是一个包含大约 3200 万体素的强度数据的 3D 数组，大约比我们想要识别的结节大一百万倍。将模型集中在与手头任务相关的 CT 扫描裁剪部分上，将使训练得到合理结果变得更容易。
- en: Understanding our data will make it easier to write processing routines for
    our data that don’t distort or destroy important aspects of the data. The array
    of CT scan data typically will not have cubic voxels; mapping location information
    in real-world units to array indexes requires conversion. The intensity of a CT
    scan corresponds roughly to mass density but uses unique units.
  id: totrans-125
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 理解我们的数据将使编写处理数据的程序更容易，这些程序不会扭曲或破坏数据的重要方面。CT扫描数据的数组通常不会具有立方体像素；将现实世界单位的位置信息映射到数组索引需要进行转换。CT扫描的强度大致对应于质量密度，但使用独特的单位。
- en: Identifying the key concepts of a project and making sure they are well represented
    in our design can be crucial. Most aspects of our project will revolve around
    nodules, which are small masses in the lungs and can be spotted on a CT along
    with many other structures that have a similar appearance.
  id: totrans-126
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 识别项目的关键概念，并确保它们在我们的设计中得到很好的体现是至关重要的。我们项目的大部分方面将围绕着结节展开，这些结节是肺部的小肿块，在CT上可以被发现，与许多其他具有类似外观的结构一起。
- en: We are using the LUNA Grand Challenge data to train our model. The LUNA data
    contains CT scans, as well as human-annotated outputs for classification and grouping.
    Having high-quality data has a major impact on a project’s success.
  id: totrans-127
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们正在使用LUNA Grand Challenge数据来训练我们的模型。LUNA数据包含CT扫描，以及用于分类和分组的人工注释输出。拥有高质量的数据对项目的成功有重大影响。
- en: '* * *'
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: '* * *'
- en: ^(1.)We presume--we haven’t tried it, much less timed it.
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: ^(1.)我们假设--我们还没有尝试过，更不用说计时了。
- en: ^(2.)The `series_uid` of this sample is `1.3.6.1.4.1.14519.5.2.1.6279.6001.12626457893177825889037
    1755354`, which can be useful if you’d like to look at it in detail later.
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: ^(2.)这个样本的`series_uid`是`1.3.6.1.4.1.14519.5.2.1.6279.6001.12626457893177825889037
    1755354`，如果您以后想要详细查看它，这可能会很有用。
- en: ^(3.)For example, Retina U-Net ([https://arxiv.org/pdf/1811.08661.pdf](https://arxiv.org/pdf/1811.08661.pdf))
    and FishNet ([http://mng.bz/K240](http://mng.bz/K240)).
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: ^(3.)例如，Retina U-Net ([https://arxiv.org/pdf/1811.08661.pdf](https://arxiv.org/pdf/1811.08661.pdf))
    和 FishNet ([http://mng.bz/K240](http://mng.bz/K240))。
- en: '^(4.)Eric J. Olson, “Lung nodules: Can they be cancerous?” Mayo Clinic, [http://mng.bz/yyge](http://mng.bz/yyge).'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: ^(4.)Eric J. Olson，“肺结节：它们可能是癌症吗？”梅奥诊所，[http://mng.bz/yyge](http://mng.bz/yyge)。
- en: ^(5.)Not if we want decent results, at least.
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: ^(5.)至少如果我们想要得到像样的结果的话，是不行的。
- en: '^(6.)According to the National Cancer Institute Dictionary of Cancer Terms:
    [http://mng.bz/jgBP](http://mng.bz/jgBP).'
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: ^(6.)根据国家癌症研究所癌症术语词典：[http://mng.bz/jgBP](http://mng.bz/jgBP)。
- en: ^(7.)The cache space required is per chapter, but once you’re done with a chapter,
    you can delete the cache to free up space.
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: ^(7.)所需的缓存空间是按章节计算的，但一旦完成了一个章节，你可以删除缓存以释放空间。
