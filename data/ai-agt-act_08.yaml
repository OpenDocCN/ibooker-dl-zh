- en: 9 Mastering agent prompts with prompt flow
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 9 使用提示流掌握代理提示
- en: This chapter covers
  id: totrans-1
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 本章涵盖了
- en: Understanding systematic prompt engineering and setting up your first prompt
    flow
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 理解系统化的提示工程并设置你的第一个提示流
- en: Crafting an effective profile/persona prompt
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 构建有效的配置文件/角色提示
- en: 'Evaluating profiles: Rubrics and grounding'
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 评估配置文件：评分标准和扎根
- en: Grounding evaluation of a large language model profile
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 对大型语言模型配置文件进行扎根评估
- en: 'Comparing prompts: Getting the perfect profile'
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 比较提示：获得完美的配置文件
- en: In this chapter, we delve into the Test Changes Systematically prompt engineering
    strategy. If you recall, we covered the grand strategies of the OpenAI prompt
    engineering framework in chapter 2\. These strategies are instrumental in helping
    us build better prompts and, consequently, better agent profiles and personas.
    Understanding this role is key to our prompt engineering journey.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们深入探讨了系统性地测试变化的提示工程策略。如果你还记得，我们在第二章中介绍了OpenAI提示工程框架的大策略。这些策略在帮助我们构建更好的提示、进而构建更好的代理配置文件和角色方面至关重要。理解这一角色对于我们提示工程的旅程至关重要。
- en: Test Changes Systematically is such a core facet of prompt engineering that
    Microsoft developed a tool around this strategy called *prompt flow*, described
    later in this chapter. Before getting to prompt flow, we need to understand why
    we need systemic prompt engineering.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 系统性地测试变化是提示工程的核心要素之一，因此微软开发了一个围绕这一策略的工具，称为*提示流*，将在本章后面进行描述。在了解提示流之前，我们需要理解为什么我们需要系统性的提示工程。
- en: 9.1 Why we need systematic prompt engineering
  id: totrans-9
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 9.1 为什么我们需要系统化的提示工程
- en: Prompt engineering, by its nature, is an iterative process. When building a
    prompt, you’ll often iterate and evaluate. To see this concept in action, consider
    the simple application of prompt engineering to a ChatGPT question.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 提示工程本质上是一个迭代过程。在构建提示时，你通常会进行迭代和评估。为了看到这一概念的实际应用，可以考虑将提示工程简单应用于ChatGPT的问题。
- en: 'You can follow along by opening your browser to ChatGPT ([https://chat.openai.com/](https://chat.openai.com/)),
    entering the following (text) prompt into ChatGPT, and clicking the Send Message
    button (an example of this conversation is shown in figure 9.1, on the left side):'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以通过打开浏览器到ChatGPT ([https://chat.openai.com/](https://chat.openai.com/))，将以下（文本）提示输入到ChatGPT中，然后点击发送消息按钮（如图9.1左侧所示的一个对话示例）：
- en: can you recommend something
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 你能推荐一些东西吗
- en: '![figure](../Images/9-1.png)'
  id: totrans-13
  prefs: []
  type: TYPE_IMG
  zh: '![图](../Images/9-1.png)'
- en: Figure 9.1 The differences in applying prompt engineering and iterating
  id: totrans-14
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图9.1 应用提示工程和迭代的不同
- en: 'We can see that the response from ChatGPT is asking for more information. Go
    ahead and open a new conversation with ChatGPT, and enter the following prompt,
    as shown in figure 9.1, on the right side:'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以看到，ChatGPT的回应是要求更多信息。请继续与ChatGPT开启一个新的对话，并输入以下提示，如图9.1右侧所示：
- en: Can you please recommend a time travel movie set in the medieval period.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 你能推荐一部设定在中世纪时期的时空旅行电影吗？
- en: The results in figure 9.1 show a clear difference between leaving out details
    and being more specific in your request. We just applied the tactic of politely
    Writing Clear Instructions, and ChatGPT provided us with a good recommendation.
    But also notice how ChatGPT itself guides the user into better prompting. The
    refreshed screen shown in figure 9.2 shows the OpenAI prompt engineering strategies.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 图9.1的结果显示了在请求中省略细节和更加具体之间的明显差异。我们刚刚应用了礼貌地撰写清晰指令的策略，ChatGPT为我们提供了一个好的推荐。但也要注意ChatGPT本身如何引导用户进行更好的提示。如图9.2所示的刷新屏幕显示了OpenAI的提示工程策略。
- en: '![figure](../Images/9-2.png)'
  id: totrans-18
  prefs: []
  type: TYPE_IMG
  zh: '![图](../Images/9-2.png)'
- en: Figure 9.2 OpenAI prompt engineering strategies, broken down by agent component
  id: totrans-19
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图9.2 OpenAI提示工程策略，按代理组件分解
- en: We just applied simple iteration to improve our prompt. We can extend this example
    by using a system prompt/message. Figure 9.3 demonstrates the use and role of
    the system prompt in iterative communication. In chapter 2, we used the system
    message/prompt in various examples.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 我们刚刚应用了简单的迭代来改进我们的提示。我们可以通过使用系统提示/消息来扩展这个例子。图9.3展示了系统提示在迭代通信中的应用和作用。在第二章中，我们在各种示例中使用了系统消息/提示。
- en: '![figure](../Images/9-3.png)'
  id: totrans-21
  prefs: []
  type: TYPE_IMG
  zh: '![图](../Images/9-3.png)'
- en: Figure 9.3 The messages to and from an LLM conversation and the iteration of
    messages
  id: totrans-22
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图9.3 LLM对话中的消息以及消息的迭代
- en: 'You can also try this in ChatGPT. This time, enter the following prompt and
    include the word *system* in lowercase, followed by a new line (enter a new line
    in the message window without sending the message by pressing Shift-Enter):'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 你也可以在ChatGPT中尝试这个方法。这次，输入以下提示，并在单词*system*后面加上小写字母，然后换行（在消息窗口中按Shift-Enter键换行，但不发送消息）：
- en: system
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: system
- en: You are an expert on time travel movies.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 你是时间旅行电影的专家。
- en: 'ChatGPT will respond with some pleasant comments, as shown in figure 9.4\.
    Because of this, it’s happy to accept its new role and asks for any follow-up
    questions. Now enter the following generic prompt as we did previously:'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: ChatGPT将回应一些愉快的评论，如图9.4所示。因此，它很高兴接受其新角色，并询问任何后续问题。现在输入以下通用的提示，就像我们之前做的那样：
- en: can you recommend something
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 你能推荐一些东西吗
- en: '![figure](../Images/9-4.png)'
  id: totrans-28
  prefs: []
  type: TYPE_IMG
  zh: '![figure](../Images/9-4.png)'
- en: Figure 9.4 The effect of adding a system prompt to our previous conversation
  id: totrans-29
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图9.4 向我们之前的对话添加系统提示的效果
- en: We’ve just seen the iteration of refining a prompt, the prompt engineering,
    to extract a better response. This was accomplished over three different conversations
    using the ChatGPT UI. While not the most efficient way, it works.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 我们刚刚看到了提示的迭代优化，即提示工程，以提取更好的响应。这是通过使用ChatGPT UI进行的三次不同对话来实现的。虽然这不是最有效的方法，但它有效。
- en: However, we haven’t defined the iterative flow for evaluating the prompt and
    determining when a prompt is effective. Figure 9.5 shows a systemic method of
    prompt engineering using a system of iteration and evaluation.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，我们还没有定义评估提示和确定何时提示有效的迭代流程。图9.5展示了使用迭代和评估的系统方法进行提示工程。
- en: '![figure](../Images/9-5.png)'
  id: totrans-32
  prefs: []
  type: TYPE_IMG
  zh: '![figure](../Images/9-5.png)'
- en: Figure 9.5 The systemic method of prompt engineering
  id: totrans-33
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图9.5 提示工程的系统方法
- en: The system of iterating and evaluating prompts covers the broad Test Changes
    Systemically strategy. Evaluating the performance and effectiveness of prompts
    is still new, but we’ll use techniques from education, such as rubrics and grounding,
    which we’ll explore in a later section of this chapter. However, as spelled out
    in the next section, we need to understand the difference between a persona and
    an agent profile before we do so.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 迭代和评估提示的系统涵盖了广泛的系统化测试策略。评估提示的性能和有效性仍然是新的，但我们将使用教育技术，如评分标准和扎根，这些将在本章后面的部分进行探讨。然而，正如下一节所阐述的，在我们这样做之前，我们需要了解角色和代理配置文件之间的区别。
- en: 9.2 Understanding agent profiles and personas
  id: totrans-35
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 9.2 理解代理配置文件和角色
- en: An *agent profile* is an encapsulation of component prompts or messages that
    describe an agent. It includes the agent’s persona, special instructions, and
    other strategies that can guide the user or other agent consumers.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 一个*代理配置文件*是对描述代理的组件提示或消息的封装。它包括代理的角色、特殊指令和其他可以指导用户或其他代理消费者的策略。
- en: Figure 9.6 shows the main elements of an agent profile. These elements map to
    prompt engineering strategies described in this book. Not all agents will use
    all the elements of a full agent profile.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 图9.6展示了代理配置文件的主要元素。这些元素映射到本书中描述的提示工程策略。并非所有代理都会使用完整代理配置文件的所有元素。
- en: '![figure](../Images/9-6.png)'
  id: totrans-38
  prefs: []
  type: TYPE_IMG
  zh: '![figure](../Images/9-6.png)'
- en: Figure 9.6 The component parts of an agent profile
  id: totrans-39
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图9.6 代理配置文件的部分组件
- en: At a basic level, an *agent profile* is a set of prompts describing the agent.
    It may include other external elements related to actions/tools, knowledge, memory,
    reasoning, evaluation, planning, and feedback. The combination of these elements
    comprises an entire agent prompt profile.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 在基本层面上，一个*代理配置文件*是一组描述代理的提示。它可能包括与动作/工具、知识、记忆、推理、评估、计划和反馈相关的其他外部元素。这些元素的组合构成了一个完整的代理提示配置文件。
- en: Prompts are the heart of an agent’s function. A prompt or set of prompts drives
    each of the agent components in the profile. For actions/tools, these prompts
    are well defined, but as we’ve seen, prompts for memory and knowledge can vary
    significantly by use case.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 提示是代理功能的核心。一个提示或一组提示驱动着配置文件中每个代理组件。对于动作/工具，这些提示定义得很好，但正如我们所看到的，记忆和知识的提示可以根据用例显著变化。
- en: The definition of an AI agent profile is more than just a system prompt. Prompt
    flow can allow us to construct the prompts and code comprising the agent profile
    but also include the ability to evaluate its effectiveness. In the next section,
    we’ll open up prompt flow and start using it.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 人工智能代理配置文件的定义不仅仅是系统提示。提示流程可以让我们构建构成代理配置文件的提示和代码，同时还包括评估其有效性的能力。在下一节中，我们将打开提示流程并开始使用它。
- en: 9.3 Setting up your first prompt flow
  id: totrans-43
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 9.3 设置您的第一个提示流
- en: Prompt flow is a tool developed by Microsoft within its Azure Machine Learning
    Studio platform. The tool was later released as an open source project on GitHub,
    where it has attracted more attention and use. While initially intended as an
    application platform, it has since shown its strength in developing and evaluating
    prompts/ profiles.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 提示流是由微软在其Azure机器学习工作室平台内开发的工具。该工具后来作为开源项目发布在GitHub上，在那里它吸引了更多的关注和使用。虽然最初旨在作为应用平台，但它后来在开发和评估提示/配置文件方面显示出其优势。
- en: Because prompt flow was initially developed to run on Azure as a service, it
    features a robust core architecture. The tool supports multi-threaded batch processing,
    which makes it ideal for evaluating prompts at scale. The following section will
    examine the basics of starting with prompt flow.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 由于提示流最初是为了在Azure上作为服务运行而开发的，它具有强大的核心架构。该工具支持多线程批量处理，这使得它在评估大量提示时非常理想。下一节将探讨使用提示流的入门基础知识。
- en: 9.3.1 Getting started
  id: totrans-46
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 9.3.1 入门
- en: 'There are a few prerequisites to undertake before working through the exercises
    in this book. The relevant prerequisites for this section and chapter are shown
    in the following list; make sure to complete them before attempting the exercises:'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 在尝试本书中的练习之前，有一些先决条件需要完成。本节和章节的相关先决条件如下所示；确保在尝试练习之前完成它们：
- en: '*Visual Studio Code (VS Code)* —Refer to appendix A for installation instructions,
    including additional extensions.'
  id: totrans-48
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Visual Studio Code (VS Code)* — 请参考附录A中的安装说明，包括额外的扩展。'
- en: '*Prompt flow, VS Code extension* —Refer to appendix A for details on installing
    extensions.'
  id: totrans-49
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*提示流，VS Code扩展* — 详细安装扩展的步骤请参考附录A。'
- en: '*Python virtual environment* —Refer to appendix A for details on setting up
    a virtual environment.'
  id: totrans-50
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Python 虚拟环境* — 详细设置虚拟环境的步骤请参考附录A。'
- en: '*Install prompt flow packages* —Within your virtual environment, do a quick
    `pip` `install`, as shown here:'
  id: totrans-51
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*安装提示流包* — 在您的虚拟环境中，执行快速`pip install`，如图所示：'
- en: '[PRE0]'
  id: totrans-52
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: '*LLM (GPT-4 or above)* —You’ll need access to GPT-4 or above through OpenAI
    or Azure OpenAI Studio. Refer to appendix B if you need assistance accessing these
    resources.'
  id: totrans-53
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*LLM（GPT-4或更高版本）* — 您需要通过OpenAI或Azure OpenAI Studio访问GPT-4或更高版本。如需帮助访问这些资源，请参考附录B。'
- en: '*Book’s source code* —Clone the book’s source code to a local folder; refer
    to appendix A if you need help cloning the repository.'
  id: totrans-54
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*书籍的源代码* — 将书籍的源代码克隆到本地文件夹；如需帮助克隆存储库，请参考附录A。'
- en: Open up VS Code to the book’s source code folder, `chapter` `3`. Ensure that
    you have a virtual environment connected and have installed the prompt flow packages
    and extension.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 打开 VS Code 到书籍的源代码文件夹，`第3章`。确保您已连接虚拟环境并安装了提示流包和扩展。
- en: First, you’ll want to create a connection to your LLM resource within the prompt
    flow extension. Open the prompt flow extension within VS Code, and then click
    to open the connections. Then, click the plus sign beside the LLM resource to
    create a new connection, as shown in figure 9.7.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，您需要在提示流扩展内创建与您的LLM资源的连接。在VS Code中打开提示流扩展，然后点击打开连接。然后，点击LLM资源旁边的加号创建一个新的连接，如图9.7所示。
- en: '![figure](../Images/9-7.png)'
  id: totrans-57
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../Images/9-7.png)'
- en: Figure 9.7 Creating a new prompt flow LLM connection
  id: totrans-58
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图9.7 创建新的提示流LLM连接
- en: This will open a YAML file where you’ll need to populate the connection name
    and other information relevant to your connection. Follow the directions, and
    don’t enter API keys into the document, as shown in figure 9.8.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 这将打开一个YAML文件，您需要填写连接名称和其他与您的连接相关的信息。按照指示操作，不要在文档中输入API密钥，如图9.8所示。
- en: '![figure](../Images/9-8.png)'
  id: totrans-60
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../Images/9-8.png)'
- en: Figure 9.8 Setting the connection information for your LLM resource
  id: totrans-61
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图9.8 设置LLM资源连接信息
- en: When the connection information is entered, click the Create Connection link
    at the bottom of the document. This will open a terminal prompt below the document,
    asking you to enter your key. Depending on your terminal configuration, you may
    be unable to paste (Ctrl-V, Cmd-V). Alternatively, you can paste the key by hovering
    the mouse cursor over the terminal and right-clicking on Windows.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 当输入连接信息后，点击文档底部的创建连接链接。这将打开文档下方的终端提示，要求您输入密钥。根据您的终端配置，您可能无法粘贴（Ctrl-V，Cmd-V）。或者，您可以通过将鼠标光标悬停在终端上并右键单击Windows来粘贴密钥。
- en: We’ll now test the connection by first opening the simple flow in the `chapter_09/promptflow/simpleflow`
    folder. Then, open the `flow.dag.yaml` file in VS Code. This is a YAML file, but
    the prompt flow extension provides a visual editor that is accessible by clicking
    the Visual Editor link at the top of the file, as shown in figure 9.9.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在将通过首先打开`chapter_09/promptflow/simpleflow`文件夹中的简单流程来测试连接。然后，在 VS Code 中打开`flow.dag.yaml`文件。这是一个
    YAML 文件，但提示流程扩展提供了一个可以通过点击文件顶部的“可视化编辑器”链接访问的可视化编辑器，如图 9.9 所示。
- en: '![figure](../Images/9-9.png)'
  id: totrans-64
  prefs: []
  type: TYPE_IMG
  zh: '![figure](../Images/9-9.png)'
- en: Figure 9.9 Opening the prompt flow visual editor
  id: totrans-65
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图 9.9 打开提示流程可视化编辑器
- en: After the visual editor window is opened, you’ll see a graph representing the
    flow and the flow blocks. Double-click the recommender block, and set the connection
    name, API type, and model or deployment name, as shown in figure 9.10.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 打开可视化编辑器窗口后，您将看到一个表示流程和流程块的图形。双击推荐器块，并设置连接名称、API 类型以及模型或部署名称，如图 9.10 所示。
- en: '![figure](../Images/9-10.png)'
  id: totrans-67
  prefs: []
  type: TYPE_IMG
  zh: '![figure](../Images/9-10.png)'
- en: Figure 9.10 Setting the LLM connection details
  id: totrans-68
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图 9.10 设置 LLM 连接详细信息
- en: A prompt flow is composed of a set of blocks starting with an `Inputs` block
    and terminating in an `Outputs` block. Within this simple flow, the `recommender`
    block represents the LLM connection and the prompt used to converse with the model.
    The `echo` block for this simple example echoes the input.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 提示流程由一组块组成，从 `Inputs` 块开始，以 `Outputs` 块结束。在这个简单流程中，`recommender` 块代表 LLM 连接和与模型对话所使用的提示。对于这个简单示例，`echo`
    块会回显输入。
- en: 'When creating a connection to an LLM, either in prompt flow or through an API,
    here are the crucial parameters we always need to consider (prompt flow documentation:
    [https://microsoft.github.io/promptflow](https://microsoft.github.io/promptflow)):'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 当在提示流程或通过 API 创建与 LLM 的连接时，以下是我们始终需要考虑的关键参数（提示流程文档：[https://microsoft.github.io/promptflow](https://microsoft.github.io/promptflow)）：
- en: '*Connection* —This is the connection name, but it also represents the service
    you’re connecting to. Prompt flow supports multiple services, including locally
    deployed LLMs.'
  id: totrans-71
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*连接* — 这是连接名称，但也代表了您所连接的服务。提示流程支持多个服务，包括本地部署的 LLM。'
- en: '*API* —This is the API type. The options are `chat` for a chat completion API,
    such as GPT-4, or `completion` for the older completion models, such as the OpenAI
    Davinci.'
  id: totrans-72
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*API* — 这是 API 类型。选项包括用于聊天完成 API 的 `chat`，例如 GPT-4，或用于较老完成模型的 `completion`，例如
    OpenAI Davinci。'
- en: '*Model* —This may be the model or deployment name, depending on your service
    connection. For OpenAI, this will be the model’s name, and for Azure OpenAI, it
    will represent the deployment name.'
  id: totrans-73
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*模型* — 这可能是模型或部署名称，具体取决于您的服务连接。对于 OpenAI，这将是指模型的名称，而对于 Azure OpenAI，它将代表部署名称。'
- en: '*Temperature* —This represents the stochasticity or variability of the model
    response. A value of `1` represents a high variability of responses, while `0`
    indicates a desire for no variability. This is a critical parameter to understand
    and, as we’ll see, will vary by use case.'
  id: totrans-74
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*温度* — 这代表了模型响应的随机性或可变性。`1` 的值表示响应的高度可变性，而 `0` 表示不希望有任何可变性。这是一个关键参数，我们将看到，它将根据用例而变化。'
- en: '*Stop* —This optional setting tells the call to the LLM to stop creating tokens.
    It’s more appropriate for older and open source models.'
  id: totrans-75
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*停止* — 这个可选设置告诉 LLM 调用停止创建标记。它更适合较老和开源模型。'
- en: '*Max tokens* —This limits the number of tokens used in a conversation. Knowledge
    of how many tokens you use is crucial to evaluating how your LLM interactions
    will work when scaled. Counting tokens may not be a concern if you’re exploring
    and conducting research. However, in production systems, tokens represent the
    load on the LLM, and connections using numerous tokens may not scale well.'
  id: totrans-76
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*最大标记数* — 这限制了对话中使用的标记数量。了解您使用了多少标记对于评估您的 LLM 交互在扩展时的表现至关重要。如果您正在探索和进行研究，标记计数可能不是问题。然而，在生产系统中，标记代表了
    LLM 的负载，使用大量标记的连接可能无法很好地扩展。'
- en: '*Advanced parameters* —You can set a few more options to tune your interaction
    with the LLM, but we’ll cover that topic in later sections of the book.'
  id: totrans-77
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*高级参数* — 您可以设置一些更多选项来调整您与 LLM 的交互，但我们将在此书后面的章节中介绍这个主题。'
- en: After configuring the LLM block, scroll up to the Inputs block section, and
    review the primary input shown in the user_input field, as shown in figure 9.11\.
    Leave it as the default, and then click the Play button at the top of the window.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 在配置了 LLM 块之后，向上滚动到输入块部分，并查看用户输入字段中显示的主要输入，如图 9.11 所示。保持默认设置，然后点击窗口顶部的播放按钮。
- en: '![figure](../Images/9-11.png)'
  id: totrans-79
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../Images/9-11.png)'
- en: Figure 9.11 Setting the inputs and starting the flow
  id: totrans-80
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图 9.11 设置输入并启动流
- en: All the blocks in the flow will run, and the results will be shown in the terminal
    window. What you should find interesting is that the output shows recommendations
    for time travel movies. This is because the recommender block already has a simple
    profile set, and we’ll see how that works in the next section.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 流中的所有块都将运行，结果将在终端窗口中显示。您可能会发现有趣的是，输出显示了时间旅行电影的推荐。这是因为推荐块已经设置了一个简单的配置文件，我们将在下一节中看到它是如何工作的。
- en: 9.3.2 Creating profiles with Jinja2 templates
  id: totrans-82
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 9.3.2 使用 Jinja2 模板创建配置文件
- en: The flow responds with time travel movie recommendations because of the prompt
    or profile it uses. By default, prompt flow uses Jinja2 templates to define the
    content of the prompt or what we’ll call a *profile.* For the purposes of this
    book and our exploration of AI agents, we’ll refer to these templates as the profile
    of a flow or agent.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 流的响应是基于它使用的提示或配置文件的时间旅行电影推荐。默认情况下，提示流使用 Jinja2 模板来定义提示的内容或我们称之为 *配置文件* 的内容。为了本书和我们对
    AI 代理的探索，我们将把这些模板称为流的配置文件或代理的配置文件。
- en: While prompt flow doesn’t explicitly refer to itself as an assistant or agent
    engine, it certainly meets the criteria of producing a proxy and general types
    of agents. As you’ll see, prompt flow even supports deployments of flows into
    containers and as services.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然提示流没有明确将自己称为助手或代理引擎，但它确实符合产生代理和通用类型代理的标准。正如您将看到的，提示流甚至支持将流部署到容器中作为服务。
- en: Open VS Code to `chapter_09/promptflow/simpleflow/flow.dag.yaml`, and open the
    file in the visual editor. Then, locate the Prompt field, and click the `recommended`
    `.jinja2` link, as shown in figure 9.12.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 打开 VS Code 到 `chapter_09/promptflow/simpleflow/flow.dag.yaml`，并在可视化编辑器中打开该文件。然后，定位到提示字段，并点击如图
    9.12 所示的 `recommended` `.jinja2` 链接。
- en: '![figure](../Images/9-12.png)'
  id: totrans-86
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../Images/9-12.png)'
- en: Figure 9.12 Opening the prompt Jinja2 template and examining the parts of the
    profile/prompt
  id: totrans-87
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图 9.12 打开提示 Jinja2 模板并检查配置文件/提示的部分
- en: Jinja is a templating engine, and Jinja2 is a particular version of that engine.
    Templates are an excellent way of defining the layout and parts of any form of
    text document. They have been extensively used to produce HTML, JSON, CSS, and
    other document forms. In addition, they support the ability to apply code directly
    into the template. While there is no standard way to construct prompts or agent
    profiles, our preference in this book is to use templating engines such as Jinja.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: Jinja 是一个模板引擎，Jinja2 是该引擎的一个特定版本。模板是定义任何形式文本文档布局和部分的一种极好方式。它们已被广泛用于生成 HTML、JSON、CSS
    和其他文档形式。此外，它们支持将代码直接应用到模板中。虽然没有标准的方式来构建提示或代理配置文件，但本书中我们更倾向于使用模板引擎，如 Jinja。
- en: At this point, change the role within the system prompt of the `recommended.jinja2`
    template. Then, run all blocks of the flow by opening the flow in the visual editor
    and clicking the Play button. The next section will look at other ways of running
    prompt flow for testing or actual deployment.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 在这一点上，更改系统提示中 `recommended.jinja2` 模板的角色。然后，通过在可视化编辑器中打开流并点击播放按钮来运行流的所有块。下一节将探讨其他运行提示流的方法，用于测试或实际部署。
- en: 9.3.3 Deploying a prompt flow API
  id: totrans-90
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 9.3.3 部署提示流 API
- en: Because prompt flow was also designed to be deployed as a service, it supports
    a couple of ways to deploy as an app or API quickly. Prompt flow can be deployed
    as a local web application and API running from the terminal or as a Docker container.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 由于提示流也被设计为可以部署为服务，它支持几种快速部署为应用程序或 API 的方法。提示流可以作为本地 Web 应用程序和 API 部署，从终端运行或作为
    Docker 容器。
- en: Return to the `flow.dag.yaml` file in the visual editor from VS Code. At the
    top of the window beside the Play button are several options we’ll want to investigate
    further. Click the Build button as shown in figure 9.13, and then select to deploy
    as a local app. A new YAML file will be created to configure the app. Leave the
    defaults, and click the Start Local App link.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 返回VS Code中的视觉编辑器中的`flow.dag.yaml`文件。在窗口顶部的播放按钮旁边有几个我们想要进一步调查的选项。如图9.13所示，点击构建按钮，然后选择部署为本地应用程序。将创建一个新的YAML文件来配置应用程序。保留默认设置，并点击启动本地应用程序链接。
- en: '![figure](../Images/9-13.png)'
  id: totrans-93
  prefs: []
  type: TYPE_IMG
  zh: '![图](../Images/9-13.png)'
- en: Figure 9.13 Building and starting the flow as a local app
  id: totrans-94
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图9.13 构建并启动流程作为本地应用程序
- en: This will launch the flow as a local web application, and you’ll see a browser
    tab open, as shown in figure 9.14\. Enter some text into the user_input field,
    which is marked as required with a red asterisk. Click Enter and wait a few seconds
    for the reply.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 这将启动流程作为本地Web应用程序，你将看到一个浏览器标签页打开，如图9.14所示。在用户输入字段中输入一些文本，该字段用红色星号标记为必填项。点击Enter并等待几秒钟以获取回复。
- en: '![figure](../Images/9-14.png)'
  id: totrans-96
  prefs: []
  type: TYPE_IMG
  zh: '![图](../Images/9-14.png)'
- en: Figure 9.14 Running the flow as a local web application
  id: totrans-97
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图9.14 将流程作为本地Web应用程序运行
- en: You should see a reply like the one shown earlier in figure 9.12, where the
    flow or agent replies with a list of time travel movies. This is great—we’ve just
    developed our first agent profile and the equivalent of a proxy agent. However,
    we need to determine how successful or valuable the recommendations are. In the
    next section, we explore how to evaluate prompts and profiles.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 你应该会看到一个像图9.12中早些时候显示的回复，其中流程或代理回复了一个时间旅行电影的列表。这太棒了——我们刚刚开发出了我们的第一个代理配置文件和代理代理的等效物。然而，我们需要确定这些推荐的成功率或价值。在下一节中，我们将探讨如何评估提示和配置文件。
- en: '9.4 Evaluating profiles: Rubrics and grounding'
  id: totrans-99
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 9.4 评估配置文件：评分标准和扎根
- en: A key element of any prompt or agent profile is how well it performs its given
    task. As we see in our recommendation example, prompting an agent profile to give
    a list of recommendations is relatively easy, but knowing whether those recommendations
    are helpful requires us to evaluate the response.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 任何提示或代理配置文件的关键要素是其执行给定任务的表现。正如我们在我们的推荐示例中所看到的，提示代理配置文件给出一个推荐列表相对容易，但要知道这些推荐是否有帮助，我们需要评估响应。
- en: Fortunately, prompt flow has been designed to evaluate prompts/profiles at scale.
    The robust infrastructure allows for the evaluation of LLM interactions to be
    parallelized and managed as workers, allowing hundreds of profile evaluations
    and variations to happen quickly.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 幸运的是，提示流已经被设计成可以大规模评估提示/配置文件。强大的基础设施允许将LLM交互的评估并行化并作为工作者进行管理，这使得数百个配置文件评估和变体可以快速发生。
- en: In the next section, we look at how prompt flow can be configured to run prompt/
    profile variations against each other. We’ll need to understand this before evaluating
    profiles’ performance.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一节中，我们将探讨如何配置提示流以运行提示/配置文件之间的变体。在评估配置文件性能之前，我们需要理解这一点。
- en: Prompt flow provides a mechanism to allow for multiple variations within an
    LLM prompt/profile. This tool is excellent for comparing subtle or significant
    differences between profile variations. When used in performing bulk evaluations,
    it can be invaluable for quickly assessing the performance of a profile.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 提示流提供了一个机制，允许在LLM提示/配置文件内进行多种变体。这个工具在比较配置文件变体之间的细微或显著差异时非常出色。当用于执行批量评估时，它可以快速评估配置文件性能，非常有价值。
- en: Open the `recommender_with_variations/flow.dag.yaml` file in VS Code and the
    flow visual editor, as shown in figure 9.15\. This time, we’re making the profile
    more generalized and allowing for customization at the input level. This allows
    us to expand our recommendations to anything and not just time travel movies.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 在VS Code和流程视觉编辑器中打开`recommender_with_variations/flow.dag.yaml`文件，如图9.15所示。这次，我们使配置文件更加通用，并允许在输入级别进行定制。这使我们能够将我们的推荐扩展到任何事物，而不仅仅是时间旅行电影。
- en: '![figure](../Images/9-15.png)'
  id: totrans-105
  prefs: []
  type: TYPE_IMG
  zh: '![图](../Images/9-15.png)'
- en: Figure 9.15 The recommender, with variations in flow and expanded inputs
  id: totrans-106
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图9.15 推荐系统，具有不同的流程和扩展的输入
- en: The new inputs Subject, Genre, Format, and Custom allow us to define a profile
    that can easily be adjusted to any recommendation. This also means that we must
    prime the inputs based on the recommendation use case. There are multiple ways
    to prime these inputs; two examples of priming inputs are shown in figure 9.16\.
    The figure shows two options, options A and B, for priming inputs. Option A represents
    the classic UI; perhaps there are objects for the user to select the subject or
    genre, for example. Option B places a proxy/chat agent to interact with the user
    better to understand the desired subject, genre, and so on.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 新的输入主题、流派、格式和自定义使我们能够定义一个可以轻松调整到任何推荐的配置文件。这也意味着我们必须根据推荐用例来初始化输入。有几种初始化这些输入的方法；图9.16中展示了两种初始化输入的示例。该图显示了两种初始化输入的选项，选项A和B。选项A代表经典的用户界面；例如，可能有供用户选择主题或流派的物体。选项B放置一个代理/聊天代理以更好地与用户互动，以了解所需的主题、流派等。
- en: '![figure](../Images/9-16.png)'
  id: totrans-108
  prefs: []
  type: TYPE_IMG
  zh: '![图](../Images/9-16.png)'
- en: '**Figure 9.16 The user interaction options for interfacing with the agent profile
    to prime inputs to the agent profile**'
  id: totrans-109
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '**图9.16 与代理配置文件交互的用户交互选项，以向代理配置文件提供初始输入**'
- en: Even considering the power of LLMs, you may still want or need to use option
    A. The benefit of option A is that you can constrain and validate the inputs much
    like you do with any modern UI. Alternatively, the downside of option A is that
    the constrained behavior may limit and restrict future use cases.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 即使考虑到LLM的力量，您可能仍然希望或需要使用选项A。选项A的好处是您可以像使用任何现代用户界面一样约束和验证输入。另一方面，选项A的缺点是受限的行为可能会限制和限制未来的用例。
- en: Option B represents a more fluid and natural way without a traditional UI. It’s
    far more powerful and extensible than option A but also introduces more unknowns
    for evaluation. However, if the proxy agent that option B uses is written well,
    it can assist a lot in gathering better information from the user.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 选项B代表一种没有传统用户界面的更流畅和自然的方式。它比选项A更强大、更可扩展，但也为评估引入了更多未知因素。然而，如果选项B使用的代理代理编写得很好，它可以在收集更好的用户信息方面提供很大帮助。
- en: The option you choose will dictate how you need to evaluate your profiles. If
    you’re okay with a constrained UI, then it’s likely that the inputs will also
    be constrained to a set of discrete values. For now, we’ll assume option B for
    input priming, meaning the input values will be defined by their name.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 您选择的选项将决定您如何评估您的配置文件。如果您对受限的用户界面没有异议，那么输入可能也会被限制为一系列离散值。目前，我们将假设选项B用于输入初始化，这意味着输入值将由其名称定义。
- en: To get back to VS Code and the visual view of the recommender with variants
    flow, click the icon shown earlier in figure 9.15 to open the variants and allow
    editing. Then, click the `recommend.jinja2` and `recommender_variant_1.jinja2`
    links to open the files side by side, as shown in figure 9.17.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 要回到VS Code和具有变体流的推荐器的可视化视图，请点击图9.15中显示的图标以打开变体并允许编辑。然后，点击`recommend.jinja2`和`recommender_variant_1.jinja2`链接以并排打开文件，如图9.17所示。
- en: '![figure](../Images/9-17.png)'
  id: totrans-114
  prefs: []
  type: TYPE_IMG
  zh: '![图](../Images/9-17.png)'
- en: Figure 9.17 Side-by-side comparison of variant profile templates for the recommender
  id: totrans-115
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图9.17推荐器变体配置文件模板的并排比较
- en: Figure 9.17 demonstrates the difference between the variant profiles. One profile
    injects the inputs into the user prompt, and the other injects them into the system
    prompt. However, it’s essential to understand that variations can encompass more
    than profile design, as identified in table 9.1.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 图9.17展示了不同配置文件之间的差异。一个配置文件将输入注入到用户提示中，而另一个则注入到系统提示中。然而，重要的是要理解，变化可以涵盖不仅仅是配置文件设计，正如表9.1中指出的那样。
- en: Table 9.1 LLM variation options in prompt flow
  id: totrans-117
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 表9.1 提示流中LLM变化选项
- en: '| Option | Evaluation option examples | Notes |'
  id: totrans-118
  prefs: []
  type: TYPE_TB
  zh: '| 选项 | 评估选项示例 | 备注 |'
- en: '| --- | --- | --- |'
  id: totrans-119
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- |'
- en: '| Jinja2 prompt template  | Compare system prompt variations, user prompt variations,
    or mixed prompt variations.  | Some endless combinations and techniques can be
    applied here. Prompt engineering is evolving all the time.  |'
  id: totrans-120
  prefs: []
  type: TYPE_TB
  zh: '| Jinja2提示模板 | 比较系统提示变化、用户提示变化或混合提示变化。 | 这里可以应用一些无穷无尽的组合和技术。提示工程一直在不断发展。 |'
- en: '| LLM  | Compare GPT-9.5 to GPT-4\. Compare GPT-4 to GPT-4 Turbo.'
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: '| LLM | 将GPT-9.5与GPT-4进行比较。将GPT-4与GPT-4 Turbo进行比较。'
- en: Compare open source models to commercial models.
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 比较开源模型和商业模型。
- en: '| This is a useful way to evaluate and ground model performance against a prompt.
    It can also help you tune your profile to work with open source and/or cheaper
    models.  |'
  id: totrans-123
  prefs: []
  type: TYPE_TB
  zh: '| 这是一种评估和定位模型性能与提示相对的有效方式。它还可以帮助您调整配置文件以与开源和/或更便宜的模式一起工作。 |'
- en: '| Temperature  | Compare a 0 temperature (no randomness) to a 1 (maximum randomness).  |
    Changes to the temperature can significantly change the responses of some prompts,
    which may improve or degrade performance.  |'
  id: totrans-124
  prefs: []
  type: TYPE_TB
  zh: '| 温度 | 将0温度（无随机性）与1温度（最大随机性）进行比较。 | 温度的变化可以显著改变某些提示的响应，这可能会改善或降低性能。 |'
- en: '| Max tokens  | Compare limited tokens to larger token sizes.  | This can allow
    you to reduce and maximize token usage.  |'
  id: totrans-125
  prefs: []
  type: TYPE_TB
  zh: '| 最大令牌数 | 将有限令牌与较大令牌大小进行比较。 | 这可以允许您减少和最大化令牌的使用。 |'
- en: '| Advanced parameters  | Compare differences to options such as `top_p`, `presence_penalty`,
    `frequency_penalty`, and `logit_bias`.  | We’ll cover the use of these advanced
    parameters in later chapters.  |'
  id: totrans-126
  prefs: []
  type: TYPE_TB
  zh: '| 高级参数 | 将差异与`top_p`、`presence_penalty`、`frequency_penalty`和`logit_bias`等选项进行比较。
    | 我们将在后面的章节中介绍这些高级参数的使用。 |'
- en: '| Function calls  | Compare alternative function calls.  | Function calls will
    be addressed later in this chapter.  |'
  id: totrans-127
  prefs: []
  type: TYPE_TB
  zh: '| 函数调用 | 比较不同的函数调用。 | 函数调用将在本章后面讨论。 |'
- en: For this simple example, we’re just going to use prompt variations by varying
    the input to reflect in either the system or user prompt. Refer to figure 9.17
    for what this looks like. We can then quickly run both variations by clicking
    the Play (Run All) button at the top and choosing both, as shown in figure 9.18.
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个简单的例子中，我们将通过改变输入来使用提示变体，以反映系统或用户提示。参考图9.17了解其外观。然后，我们可以通过点击顶部的播放（运行全部）按钮并选择两者来快速运行这两种变体，如图9.18所示。
- en: '![figure](../Images/9-18.png)'
  id: totrans-129
  prefs: []
  type: TYPE_IMG
  zh: '![图](''../Images/9-18.png'')'
- en: Figure 9.18 Running both prompt variations at the same time
  id: totrans-130
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图9.18 同时运行两个提示变体
- en: In the terminal window, you’ll see the results of both runs. The results will
    likely look similar, so now we must move on to how we evaluate the difference
    between variations in the next section.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 在终端窗口中，您将看到两次运行的结果。结果可能看起来很相似，因此现在我们必须继续到下一节，了解如何评估变体之间的差异。
- en: 9.5 Understanding rubrics and grounding
  id: totrans-132
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 9.5 理解评分标准和定位
- en: Evaluation of prompt/profile performance isn’t something we can typically do
    using a measure of accuracy or correct percentage. Measuring the performance of
    a profile depends on the use case and desired outcome. If that is as simple as
    determining if the response was right or wrong, all the better. However, in most
    cases, evaluation won’t be that simple.
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 提示/配置文件性能的评估通常不能通过准确度或正确百分比来衡量。衡量配置文件性能取决于用例和期望的结果。如果这仅仅是确定响应是否正确或错误，那就更好了。然而，在大多数情况下，评估不会那么简单。
- en: 'In education, the *rubric* concept defines a structured set of criteria and
    standards a student must establish to receive a particular grade. A rubric can
    also be used to define a guide for the performance of a profile or prompt. We
    can follow these steps to define a rubric we can use to evaluate the performance
    of a profile or prompt:'
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 在教育中，*评分标准*概念定义了学生必须建立的一套结构化标准，以获得特定的成绩。评分标准也可以用来定义配置文件或提示的性能指南。我们可以遵循以下步骤来定义我们可以用来评估配置文件或提示性能的评分标准：
- en: '*Identify the purpose and objectives.* Determine the goals you want the profile
    or agent to accomplish. For example, do you want to evaluate the quality of recommendations
    for a given audience or overall quality for a given subject, format, or other
    input?'
  id: totrans-135
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '*确定目的和目标。* 确定您希望配置文件或代理完成的任务。例如，您是想评估特定受众的推荐质量，还是评估特定主题、格式或其他输入的整体质量？'
- en: '*Define criteria.* Develop a set of criteria or dimensions that you’ll use
    to evaluate the profile. These criteria should align with your objectives and
    provide clear guidelines for assessment. Each criterion should be specific and
    measurable. For example, you may want to measure a recommendation by how well
    it fits with the genre and then by subject and format.'
  id: totrans-136
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '*定义标准。* 制定一套您将用来评估配置文件的准则或维度。这些标准应与您的目标一致，并为评估提供明确的指导。每个标准都应该是具体和可衡量的。例如，您可能希望根据推荐与体裁的契合度来衡量推荐，然后根据主题和格式来衡量。'
- en: '*Create a scale*. Establish a rating scale that describes the levels of performance
    for each criterion. Standard scales include numerical scales (e.g., 1–5) or descriptive
    scales (e.g., Excellent, Good, Fair, Poor).'
  id: totrans-137
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '*创建量表。* 建立一个描述每个标准表现水平的评级量表。标准量表包括数值量表（例如，1-5）或描述性量表（例如，优秀、良好、一般、差）。'
- en: '*Provide descriptions.* For each level on the scale, provide clear and concise
    descriptions that indicate what constitutes a strong performance and what represents
    a weaker performance for each criterion.'
  id: totrans-138
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '*提供描述。* 在量表上的每个级别，提供清晰简洁的描述，说明每个标准中良好表现和较差表现的定义。'
- en: '*Apply the rubric.* When assessing a prompt or profile, use the rubric to evaluate
    the prompt’s performance based on the established criteria. Assign scores or ratings
    for each criterion, considering the descriptions for each level.'
  id: totrans-139
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '*应用评分标准。* 在评估提示或个人资料时，使用评分标准根据既定的标准评估提示的表现。为每个标准分配分数或评级，考虑每个级别的描述。'
- en: '*Calculate the total score.* Depending on your rubric, you may calculate a
    total score by summing up the scores for each criterion or using a weighted average
    if some criteria are more important than others.'
  id: totrans-140
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '*计算总分。* 根据你的评分标准，你可能需要通过将每个标准的分数相加来计算总分，或者如果某些标准比其他标准更重要，可以使用加权平均。'
- en: '*Ensure evaluation consistency.* If multiple evaluators are assessing the profile,
    it’s crucial to ensure consistency in grading.'
  id: totrans-141
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '*确保评估一致性。* 如果多个评估者正在评估个人资料，确保评分的一致性至关重要。'
- en: '*Review, revise, and iterate.* Periodically review and revise the rubric to
    ensure it aligns with your assessment goals and objectives. Adjust as needed to
    improve its effectiveness.'
  id: totrans-142
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '*审查、修改和迭代。* 定期审查和修改评分标准，以确保其与评估目标和目标一致。根据需要调整以提高其有效性。'
- en: '*Grounding* is a concept that can be applied to profile and prompt evaluation—it
    defines how well a response is aligned with a given rubric’s specific criteria
    and standards. You can also think of grounding as the baseline expectation of
    a prompt or profile output.'
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: '*依据* 是一个可以应用于个人资料和提示评估的概念——它定义了回答与给定评分标准的具体标准和准则的契合程度。你也可以将依据视为提示或个人资料输出的基本期望。'
- en: 'This list summarizes some other important considerations when using grounding
    with profile evaluation:'
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 此列表总结了使用依据进行个人资料评估时的一些其他重要考虑因素：
- en: Grounding refers to aligning responses with the criteria, objectives, and context
    defined by the rubric and prompt.
  id: totrans-145
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 依据指的是将回答与评分标准、目标和情境对齐。
- en: Grounding involves assessing whether the response directly addresses the rubric
    criteria, stays on topic, and adheres to any provided instructions.
  id: totrans-146
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 依据涉及评估回答是否直接针对评分标准，是否保持主题一致，以及是否遵守任何提供的指示。
- en: Evaluators and evaluations gauge the accuracy, relevance, and adherence to standards
    when assessing grounding.
  id: totrans-147
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 评估者和评估在评估依据时衡量准确性、相关性和对标准的遵守程度。
- en: Grounding ensures that the response output is firmly rooted in the specified
    context, making the assessment process more objective and meaningful.
  id: totrans-148
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 依据确保输出回答牢固地根植于指定的情境，使评估过程更加客观和有意义。
- en: A well-grounded response aligns with all the rubric criteria within the given
    context and objectives. Poorly grounded responses will fail or miss the entire
    criteria, context, and objectives.
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 一个有充分依据的回答与给定情境和目标下的所有评分标准相符。依据不足的回答可能会失败或完全不符合标准、情境和目标。
- en: 'As the concepts of rubrics and grounding may still be abstract, let’s look
    at applying them to our current recommender example. Following is a list that
    follows the process for defining a rubric as applied to our recommender example:'
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 由于评分标准和依据的概念可能仍然比较抽象，让我们看看如何将它们应用于我们当前的推荐示例。以下是一个列表，列出了应用于我们的推荐示例的评分标准定义过程：
- en: '*Identify the purpose and objectives.* The purpose of our profile/prompt is
    to recommend three top items given a subject, format, genre, and custom input.'
  id: totrans-151
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '*确定目的和目标。* 我们的个人资料/提示的目的是在给定主题、格式、体裁和自定义输入的情况下推荐三个顶级项目。'
- en: '*Define criteria.* For simplicity, we’ll evaluate how a particular recommendation
    aligns with the given input criteria, subject, format, and genre. For example,
    if a profile recommends a book when asked for a movie format, we expect a low
    score in the format criteria.'
  id: totrans-152
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '*定义标准。* 为了简单起见，我们将评估特定推荐与给定输入标准、主题、格式和体裁的一致性。例如，如果个人资料在要求电影格式时推荐一本书，我们预计在格式标准上得分较低。'
- en: '*Create a scale.* Again, keeping things simple, we’ll use a scale of 1–5 (1
    is poor, and 5 is excellent).'
  id: totrans-153
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '*创建一个量表。* 再次，保持简单，我们将使用1-5的量表（1是差的，5是优秀的）。'
- en: '*Provide descriptions.* See the general descriptions for the rating scale shown
    in table 9.2\.'
  id: totrans-154
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '*提供描述。* 请参阅表9.2中所示评分尺度的通用描述。'
- en: '*Apply the rubric.* With the rubric assigned at this stage, it’s an excellent
    exercise to evaluate the rubric against recommendations manually.'
  id: totrans-155
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '*应用评分标准。* 在这个阶段分配评分标准后，手动评估评分标准与建议是一个很好的练习。'
- en: '*Calculate the total score.* For our rubric, we’ll average the score for all
    criteria to provide a total score.'
  id: totrans-156
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '*计算总分。* 对于我们的评分标准，我们将对所有标准的评分进行平均，以提供总分。'
- en: '*Ensure evaluation consistency.* The technique we’ll use for evaluation will
    provide very consistent results.'
  id: totrans-157
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '*确保评估一致性。* 我们将使用的评估技术将提供非常一致的结果。'
- en: '*Review, revise, and iterate.* We’ll review, compare, and iterate on our profiles,
    rubrics, and the evaluations themselves.'
  id: totrans-158
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '*审查、修改和迭代。* 我们将审查、比较和迭代我们的个人资料、评分标准和评估本身。'
- en: Table 9.2 Rubric ratings
  id: totrans-159
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 表9.2 评分标准
- en: '| Rating | Description |'
  id: totrans-160
  prefs: []
  type: TYPE_TB
  zh: '| 评分 | 描述 |'
- en: '| --- | --- |'
  id: totrans-161
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| 1  | Poor alignment: this is the opposite of what is expected given the criteria.  |'
  id: totrans-162
  prefs: []
  type: TYPE_TB
  zh: '| 1  | 对齐差：这与标准预期的相反。  |'
- en: '| 2  | Bad alignment: this isn’t a good fit for the given criteria.  |'
  id: totrans-163
  prefs: []
  type: TYPE_TB
  zh: '| 2  | 对齐不良：这与给定的标准不匹配。  |'
- en: '| 3  | Mediocre alignment: it may or may not fit well with the given criteria.  |'
  id: totrans-164
  prefs: []
  type: TYPE_TB
  zh: '| 3  | 一般性对齐：可能与给定的标准相匹配，也可能不匹配。  |'
- en: '| 4  | Good alignment: it may not align 100% with the criteria but is a good
    fit otherwise.  |'
  id: totrans-165
  prefs: []
  type: TYPE_TB
  zh: '| 4  | 良好对齐：可能不完全符合标准，但在其他方面是合适的。  |'
- en: '| 5  | Excellent alignment: this is a good recommendation for the given criteria.  |'
  id: totrans-166
  prefs: []
  type: TYPE_TB
  zh: '| 5  | 优秀对齐：这是符合给定标准的良好建议。  |'
- en: This basic rubric can now be applied to evaluate the responses for our profile.
    You can do this manually, or as you’ll see in the next section, using a second
    LLM profile.
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 现在可以将这个基本的评分标准应用于评估个人资料的回答。你可以手动进行，或者如你将在下一节中看到的，使用第二个LLM个人资料。
- en: 9.6 Grounding evaluation with an LLM profile
  id: totrans-168
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 9.6 使用LLM个人资料进行定位评估
- en: This section will employ another LLM prompt/profile for evaluation and grounding.
    This second LLM prompt will add another block after the recommendations are generated.
    It will process the generated recommendations and evaluate each one, given the
    previous rubric.
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 本节将使用另一个LLM提示/个人资料进行评估和定位。在生成建议之后，这个第二个LLM提示将添加另一个块。它将处理生成的建议，并根据之前的评分标准评估每个建议。
- en: Before GPT-4 and other sophisticated LLMs came along, we would have never considered
    using another LLM prompt to evaluate or ground a profile. You often want to use
    a different model when using LLMs to ground a profile. However, if you’re comparing
    profiles against each other, using the same LLM for evaluation and grounding is
    appropriate.
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: 在GPT-4和其他复杂的LLM出现之前，我们从未考虑过使用另一个LLM提示来评估或定位个人资料。当使用LLM定位个人资料时，你通常希望使用不同的模型。然而，如果你正在比较个人资料，使用相同的LLM进行评估和定位是合适的。
- en: Open the `recommender_with_LLM_evaluation\flow.dag.yaml` file in the prompt
    flow visual editor, scroll down to the `evaluate_recommendation` block, and click
    the `evaluate_recommendation.jinja2` link to open the file, as shown in figure
    9.19\. Each section of the rubric is identified in the figure.
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 在提示流程可视化编辑器中打开`recommender_with_LLM_evaluation/flow.dag.yaml`文件，向下滚动到`evaluate_recommendation`块，并点击`evaluate_recommendation.jinja2`链接以打开文件，如图9.19所示。图中的每个评分标准部分都已标识。
- en: '![figure](../Images/9-19.png)'
  id: totrans-172
  prefs: []
  type: TYPE_IMG
  zh: '![图](../Images/9-19.png)'
- en: Figure 9.19 The evaluation prompt, with each of the parts of the rubric outlined
  id: totrans-173
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图9.19 评估提示，其中评分标准的各个部分都已概述
- en: We have a rubric that is not only well defined but also in the form of a prompt
    that can be used to evaluate recommendations. This allows us to evaluate the effectiveness
    of recommendations for a given profile—automatically. Of course, you can also
    use the rubric to score and evaluate the recommendations manually for a better
    baseline.
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 我们有一个评分标准，不仅定义良好，而且以提示的形式存在，可以用来评估建议。这使我们能够自动评估给定个人资料的推荐效果。当然，你也可以使用评分标准手动评分和评估建议，以获得更好的基线。
- en: Note  Using LLMs to evaluate prompts and profiles provides a strong baseline
    for comparing the performance of a profile. It can also do this without human
    bias in a controlled and repeatable manner. This provides an excellent mechanism
    to establish baseline groundings for any profile or prompt.
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 注意：使用 LLM 评估提示和配置文件为比较配置文件的性能提供了一个强大的基线。它还可以以受控和可重复的方式做到这一点，而不带有人为偏见。这为任何配置文件或提示的基线定位提供了一个极好的机制。
- en: Returning to the `recommender_with_LLM_evaluation` flow visual editor, we can
    run the flow by clicking the Play button and observing the output. You can run
    a single recommendation or run both variations when prompted. The output of a
    single evaluation using the default inputs is shown in the following listing.
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 返回到 `recommender_with_LLM_evaluation` 流程可视化编辑器，我们可以通过点击播放按钮来运行流程并观察输出。您可以选择运行单个推荐或当被提示时运行两种变体。以下列表显示了使用默认输入的单次评估输出。
- en: Listing 9.1 LLM rubric evaluation output
  id: totrans-177
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表 9.1 LLM 评分评估输出
- en: '[PRE1]'
  id: totrans-178
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: We now have a rubric for grounding our recommender, and the evaluation is run
    automatically using a second LLM prompt. In the next section, we look at how to
    perform multiple evaluations simultaneously and then at a total score for everything.
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在有一个评分标准来定位我们的推荐器，并且使用第二个 LLM 提示自动运行评估。在下一节中，我们将探讨如何同时执行多个评估，然后对全部内容进行总评分。
- en: '9.7 Comparing profiles: Getting the perfect profile'
  id: totrans-180
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 9.7 比较配置文件：获取完美的配置文件
- en: With our understanding of rubrics and grounding, we can now move on to evaluating
    and iterating the perfect profile. Before we do that, though, we need to clean
    up the output from the LLM evaluation block. This will require us to parse the
    recommendations into something more Pythonic, which we’ll tackle in the next section.
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: 通过我们对评分标准和定位的理解，我们现在可以继续评估和迭代完美的配置文件。不过，在我们这样做之前，我们需要清理 LLM 评估块的输出。这需要我们将推荐解析成更符合
    Python 的形式，我们将在下一节中解决这个问题。
- en: 9.7.1 Parsing the LLM evaluation output
  id: totrans-182
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 9.7.1 解析 LLM 评估输出
- en: As the raw output from the evaluation block is text, we now want to parse that
    into something more usable. Of course, writing parsing functions is simple, but
    there are better ways to cast responses automagically. We covered better methods
    for returning responses in chapter 5, on agent actions.
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 由于评估块的原始输出是文本，我们现在希望将其解析成更易用的形式。当然，编写解析函数很简单，但还有更好的方法可以自动转换响应。我们在第 5 章中介绍了关于代理动作的返回响应的更好方法。
- en: Open `chapter_09\prompt_flow\recommender_with_parsing\flow.dag.yaml` in VS Code,
    and look at the flow in the visual editor. Locate the `parsing_results` block,
    and click the link to open the Python file in the editor, as shown in figure 9.20.
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 在 VS Code 中打开 `chapter_09\prompt_flow\recommender_with_parsing\flow.dag.yaml`，并在可视化编辑器中查看流程。定位到
    `parsing_results` 块，并点击链接在编辑器中打开 Python 文件，如图 9.20 所示。
- en: '![figure](../Images/9-20.png)'
  id: totrans-185
  prefs: []
  type: TYPE_IMG
  zh: '![图](../Images/9-20.png)'
- en: Figure 9.20 Opening the `parsing_results.py` file in VS Code
  id: totrans-186
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图 9.20 在 VS Code 中打开 `parsing_results.py` 文件
- en: The code for the `parsing_results.py` file is shown in listing 9.2.
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: '`parsing_results.py` 文件的代码在列表 9.2 中显示。'
- en: Listing 9.2 `parsing_results.py`
  id: totrans-188
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表 9.2 `parsing_results.py`
- en: '[PRE2]'
  id: totrans-189
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: '#1 Special decorator to denote the tool block'
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: '#1 特殊装饰器用于表示工具块'
- en: '#2 Splits the input and double new lines'
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: '#2 分割输入和双换行符'
- en: '#3 Creates a dictionary entry and sets the value'
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: '#3 创建字典条目并设置值'
- en: '#4 Loops through each block and parses into key/value dictionary'
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: '#4 遍历每个块并将其解析为键/值字典'
- en: 'We’re converting the recommendations output from listing 9.1, which is just
    a string, into a dictionary. So this code will convert this string into the JSON
    block shown next:'
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 我们正在将列表 9.1 中的推荐输出（仅是一个字符串）转换为字典。因此，此代码将此字符串转换为以下显示的 JSON 块：
- en: '*Before parsing:*'
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: '*解析前：*'
- en: '[PRE3]'
  id: totrans-196
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: '*After parsing:*'
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: '*解析后：*'
- en: '[PRE4]'
  id: totrans-198
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: The output of this `parsing_results` block now gets passed to the output and
    is wrapped in a list of recommendations. We can see what all this looks like by
    running the flow.
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 这个 `parsing_results` 块的输出现在被传递到输出，并封装在一个推荐列表中。我们可以通过运行流程来查看所有这些内容的样子。
- en: Open `flow.dag.yaml` for the flow in the visual editor, and click the Play (Run
    All) button. Be sure to select to use both recommender variants. You’ll see both
    variations run and output to the terminal.
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 在可视化编辑器中打开 `flow.dag.yaml` 文件以查看流程，并点击播放（运行全部）按钮。请确保选择使用两种推荐变体。您将看到两种变体都在运行并将输出到终端。
- en: At this point, we have a full working recommendation and LLM evaluation flow
    that outputs a score for each criterion on each output. However, to do comprehensive
    evaluations of a particular profile, we want to generate multiple recommendations
    with various criteria. We’ll see how to do batch processing of flows in the next
    section.
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: 在这一点上，我们已经有一个完整的、可工作的推荐和 LLM 评估流程，该流程为每个输出标准输出一个分数。然而，为了对特定配置文件进行全面评估，我们希望使用各种标准生成多个推荐。我们将在下一节中看到如何批量处理流程。
- en: 9.7.2 Running batch processing in prompt flow
  id: totrans-202
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 9.7.2 在提示流程中运行批量处理
- en: In our generic recommendation profile, we want to evaluate how various input
    criteria can affect the generated recommendations. Fortunately, prompt flow can
    batch-process any variations we want to test. The limit is only the time and money
    we want to spend.
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们的通用推荐配置文件中，我们希望评估各种输入标准如何影响生成的推荐。幸运的是，提示流程可以批量处理我们想要测试的任何变化。限制仅限于我们愿意花费的时间和金钱。
- en: 'To perform batch processing, we must first create a JSON Lines (JSONL) or JSON
    list document of our input criteria. If you recall, our input criteria looked
    like the following in JSON format:'
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 为了执行批量处理，我们首先需要创建一个包含我们输入标准的 JSON Lines (JSONL) 或 JSON 列表文档。如果您还记得，我们的输入标准在
    JSON 格式下看起来如下：
- en: '[PRE5]'
  id: totrans-205
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'We want to create a list of JSON objects like that just shown, preferably in
    a random manner. Of course, the simple way to do this is to prompt ChatGPT to
    create a JSONL document using the following prompt:'
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: 我们希望创建一个类似于刚才展示的 JSON 对象列表，最好是随机生成的。当然，简单地通过提示 ChatGPT 使用以下提示创建 JSONL 文档是做这件事的简单方法：
- en: 'I am developing a recommendation agent. The agent will recommend anything given
    the following criteria:'
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: 我正在开发一个推荐代理。该代理将根据以下标准推荐任何内容：
- en: '1\. subject - examples: time travel, cooking, vacation'
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 1. 主题 - 示例：时间旅行、烹饪、度假
- en: '2\. format - examples: books, movies, games'
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: 2. 格式 - 示例：书籍、电影、游戏
- en: '3\. genre: documentary, action, romance'
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: 3. 类型：纪录片、动作、浪漫
- en: '4\. custom: don''t include any R rated content'
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: 4. 自定义：不包含任何 R 级内容
- en: Can you please generate a random list of these criteria and output it in the
    format of a JSON Lines file, JSONL. Please include 10 items in the list.
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: 请您生成一个包含这些标准的随机列表，并以 JSON Lines 文件格式输出。请列出 10 项。
- en: 'Try this out by going to ChatGPT and entering the preceding prompt. A previously
    generated file can be found in the flow folder, called `\bulk_recommend.jsonl`.
    The contents of this file have been shown here for reference:'
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以通过访问 ChatGPT 并输入前面的提示来尝试一下。之前生成的文件可以在流程文件夹中找到，文件名为 `\bulk_recommend.jsonl`。此文件的内容在此处展示以供参考：
- en: '[PRE6]'
  id: totrans-214
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: With this bulk file, we can run both variants using the various input criteria
    in the bulk JSONL file. Open the `flow.dag.yaml` file in the visual editor, click
    Batch (the beaker icon) to start the bulk-data loading process, and select the
    file as shown in figure 9.21\. For some operating systems, this may appear as
    `Local` `Data` `File`.
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: 使用这个批量文件，我们可以使用批量 JSONL 文件中的各种输入标准运行两个变体。在可视化编辑器中打开 `flow.dag.yaml` 文件，点击批量（试管图标）以启动批量数据加载过程，并选择如图
    9.21 所示的文件。对于某些操作系统，这可能显示为 `本地` `数据` `文件`。
- en: '![figure](../Images/9-21.png)'
  id: totrans-216
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../Images/9-21.png)'
- en: Figure 9.21 Loading the bulk JSONL file to run the flow on multiple input variations
  id: totrans-217
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图 9.21 将批量 JSONL 文件加载到运行多个输入变体的流程中
- en: After the bulk file is selected, a new YAML document will open with a Run link
    added at the bottom of the file, as shown in figure 9.22\. Click the link to do
    the batch run of inputs.
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
  zh: 在选择批量文件后，将打开一个新的 YAML 文档，文件底部添加了一个运行链接，如图 9.22 所示。点击链接以执行输入的批量运行。
- en: '![figure](../Images/9-22.png)'
  id: totrans-219
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../Images/9-22.png)'
- en: Figure 9.22 Running the batch run of inputs
  id: totrans-220
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图 9.22 运行输入的批量运行
- en: At this point, a few things will happen. The flow visual editor will appear,
    and beside that a log file will open, showing the progress of the run. In the
    terminal window, you’ll see the various worker processes spawning and running.
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: 在这一点上，将发生几件事情。将出现流程可视化编辑器，旁边将打开一个日志文件，显示运行进度。在终端窗口中，您将看到各种工作进程的生成和运行。
- en: Be patient. The batch run, even for 10 items, may take a few minutes or seconds,
    depending on various factors such as hardware, previous calls, and so on. Wait
    for the run to complete, and you’ll see a summary of results in the terminal.
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: 请耐心等待。即使是 10 项，批量运行也可能需要几分钟或几秒钟，这取决于各种因素，如硬件、之前的调用等。等待运行完成，您将在终端中看到结果摘要。
- en: You can also view the run results by opening the prompt flow extension and selecting
    the last run, as shown in figure 9.23\. Then, you dig into each run by clicking
    the table cells. A lot of information is exposed in this dialog, which can help
    you troubleshoot flows and profiles.
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: 您还可以通过打开提示流扩展并选择最后一个运行来查看运行结果，如图9.23所示。然后，通过单击表格单元格深入了解每个运行。在此对话框中公开了大量信息，可以帮助您调试流程和配置文件。
- en: '![figure](../Images/9-23.png)'
  id: totrans-224
  prefs: []
  type: TYPE_IMG
  zh: '![figure](../Images/9-23.png)'
- en: Figure 9.23 An opening run visualization and an examination of a batch run
  id: totrans-225
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图9.23 开启运行可视化以及检查批量运行
- en: A lot of information is captured during a batch run, and you can explore much
    of it through the visualizer. More information can be found by clicking the output
    folder link from the terminal window. This will open another session of VS Code
    with the output folder allowing you to review the run logs and other details.
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: 批量运行期间捕获了大量信息，您可以通过可视化器探索其中大部分。更多信息可以通过从终端窗口单击输出文件夹链接来找到。这将打开另一个VS Code会话，输出文件夹允许您查看运行日志和其他细节。
- en: Now that we’ve completed the batch run for each variant, we can apply grounding
    and evaluate the results of both prompts. The next section will use a new flow
    to perform the profile/prompt evaluation.
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经完成了每个变体的批量运行，我们可以应用地面并评估两个提示的结果。下一节将使用一个新的流程来执行配置文件/提示评估。
- en: 9.7.3 Creating an evaluation flow for grounding
  id: totrans-228
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 9.7.3 为地面创建评估流程
- en: Open `chapter_3\prompt_flow\evaluate_groundings\flow.dag.yaml` in the visual
    editor, as shown in figure 9.24\. There are no LLM blocks in the evaluation flow—just
    Python code blocks that will run the scoring and then aggregate the scores.
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: 在可视化编辑器中打开`chapter_3\prompt_flow\evaluate_groundings\flow.dag.yaml`，如图9.24所示。评估流程中没有LLM块——只有将运行评分然后汇总评分的Python代码块。
- en: '![figure](../Images/9-24.png)'
  id: totrans-230
  prefs: []
  type: TYPE_IMG
  zh: '![figure](../Images/9-24.png)'
- en: Figure 9.24 Looking at the `evaluate_groundings` flow used to ground recommendation
    runs
  id: totrans-231
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图9.24 查看用于地面推荐运行的`evaluate_groundings`流程
- en: We can now look at the code for the `scoring` and `aggregate` blocks, starting
    with the scoring code in listing 9.3\. This scoring code averages the score for
    each criterion into an average score. The output of the function is a list of
    processed recommendations.
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们可以查看`scoring`和`aggregate`块的代码，从列表9.3中的评分代码开始。此评分代码将每个标准的得分平均到一个平均得分。函数的输出是处理过的推荐列表。
- en: Listing 9.3 `line_process.py`
  id: totrans-233
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表9.3 `line_process.py`
- en: '[PRE7]'
  id: totrans-234
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: '#1 A set of three recommendations is input into the function.'
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
  zh: '#1 将一组三个推荐输入到函数中。'
- en: '#2 Loops over each recommendation and criterion'
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
  zh: '#2 遍历每个推荐和标准'
- en: '#3 Title isn’t a criterion, so ignore it.'
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: '#3 标题不是标准，所以忽略它。'
- en: '#4 Totals the score for all criteria and sets the float value to key'
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: '#4 对所有标准的得分进行总计，并将浮点值设置为键'
- en: '#5 Adds the average score as a grounding score of the recommendation'
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
  zh: '#5 将平均得分作为推荐的地面得分'
- en: From the grounded recommendations, we can move on to aggregating the scores
    with the `aggregate` block—the code for the `aggregate` block is shown in the
    following listing.
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
  zh: 从地面推荐中，我们可以继续使用`aggregate`块来汇总得分——`aggregate`块的代码如下所示。
- en: Listing 9.4 `aggregate.py`
  id: totrans-241
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表9.4 `aggregate.py`
- en: '[PRE8]'
  id: totrans-242
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: '#1 The input is a list of lists; flatten to a list of items.'
  id: totrans-243
  prefs: []
  type: TYPE_NORMAL
  zh: '#1 输入是一个列表的列表；将其展平为项目列表。'
- en: '#2 Checks to see if the value is numeric and accumulates scores for each criterion
    key'
  id: totrans-244
  prefs: []
  type: TYPE_NORMAL
  zh: '#2 检查值是否为数值，并为每个标准键累积得分'
- en: '#3 Loops over aggregated criterion scores'
  id: totrans-245
  prefs: []
  type: TYPE_NORMAL
  zh: '#3 遍历汇总的标准得分'
- en: '#4 Logs the criterion as a metric'
  id: totrans-246
  prefs: []
  type: TYPE_NORMAL
  zh: '#4 将标准作为度量记录'
- en: The result of the aggregations will be a summary score for each criterion and
    the average score. Since the evaluation/grounding flow is separate, it can be
    run over any recommendation run we perform. This will allow us to use the batch
    run results for any variation to compare results.
  id: totrans-247
  prefs: []
  type: TYPE_NORMAL
  zh: 汇总的结果将是每个标准的汇总得分和平均得分。由于评估/地面流程是分开的，它可以在我们进行的任何推荐运行上运行。这将允许我们使用任何变化的批量运行结果来比较结果。
- en: We can run the grounding flow by opening `flow.dag.yaml` in the visual editor
    and clicking Batch (beaker icon). Then, when prompted, we select an existing run
    and then select the run we want to evaluate, as shown in figure 9.25\. This will
    open a YAML file with the Run link at the bottom, as we’ve seen before. Click
    the Run link to run the evaluation.
  id: totrans-248
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以通过在可视化编辑器中打开`flow.dag.yaml`并单击批量（水壶图标）来运行地面流。然后，当提示时，我们选择一个现有运行，然后选择我们想要评估的运行，如图9.25所示。这将打开一个包含底部运行链接的YAML文件，就像我们之前看到的那样。单击运行链接以运行评估。
- en: '![figure](../Images/9-25.png)'
  id: totrans-249
  prefs: []
  type: TYPE_IMG
  zh: '![figure](../Images/9-25.png)'
- en: Figure 9.25 Loading a previous run to be grounded and evaluated
  id: totrans-250
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图 9.25 加载先前的运行以进行归一化和评估
- en: After the run is completed, you’ll see a summary of the results in the terminal
    window. You can click the output link to open the folder in VS Code and analyze
    the results, but there is a better way to compare them.
  id: totrans-251
  prefs: []
  type: TYPE_NORMAL
  zh: 运行完成后，你将在终端窗口中看到结果摘要。你可以点击输出链接在 VS Code 中打开文件夹并分析结果，但有一个更好的方法来比较它们。
- en: Open the prompt flow extension, focus on the Batch Run History window, and scroll
    down to the Run against Run section, as shown in figure 9.26\. Select the runs
    you want to compare—likely the ones near the top—so that the checkmark appears.
    Then, right-click the run, and select the Visualize Runs option. The Batch Run
    Visualization window opens, and you’ll see the metrics for each of the runs at
    the top.
  id: totrans-252
  prefs: []
  type: TYPE_NORMAL
  zh: 打开提示流扩展，关注批量运行历史记录窗口，并向下滚动到如图 9.26 所示的运行对比部分。选择你想要比较的运行——可能是靠近顶部的那些——以便出现勾选标记。然后，右键单击运行，并选择可视化运行选项。批量运行可视化窗口打开，你将在顶部看到每个运行的指标。
- en: '![figure](../Images/9-26.png)'
  id: totrans-253
  prefs: []
  type: TYPE_IMG
  zh: '![图](../Images/9-26.png)'
- en: Figure 9.26 Visualizing the metrics for multiple runs and comparing them
  id: totrans-254
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图 9.26 可视化多个运行的指标并进行比较
- en: We can now see a significant difference between profile/prompt variation 0,
    the user prompt, and variation 1, the system prompt. Refer to figure 9.15 if you
    need a refresher on what the prompts/profiles look like. At this point, it should
    be evident that injecting the input parameters into the system prompt provides
    better recommendations.
  id: totrans-255
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在可以清楚地看到配置文件/提示变体 0、用户提示和变体 1、系统提示之间的显著差异。如果你需要刷新提示/配置文件的外观，请参考图 9.15。此时，应该很明显，将输入参数注入系统提示可以提供更好的推荐。
- en: You can now go back and try other profiles or other variant options to see what
    effect this has on your recommendations. The possibilities are virtually endless,
    but hopefully you can see what an excellent tool prompt flow will be for building
    agent profiles and prompts.
  id: totrans-256
  prefs: []
  type: TYPE_NORMAL
  zh: 你现在可以回去尝试其他配置文件或其他变体选项，看看这对你推荐的影响。可能性几乎是无限的，但希望你能看到提示流将是一个多么出色的工具，用于构建代理配置文件和提示。
- en: 9.7.4 Exercises
  id: totrans-257
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 9.7.4 练习
- en: 'Use the following exercises to improve your knowledge of the material:'
  id: totrans-258
  prefs: []
  type: TYPE_NORMAL
  zh: 使用以下练习来提高你对材料的了解：
- en: '*Exercise 1* —Create a New Prompt Variant for Recommender Flow (Intermediate)'
  id: totrans-259
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*练习 1* — 为推荐流程创建新的提示变体（中级）'
- en: '*Objective* —Improve the recommendation results by creating and testing a new
    prompt variant in prompt flow.'
  id: totrans-260
  prefs: []
  type: TYPE_NORMAL
  zh: '*目标* — 通过在提示流中创建和测试新的提示变体来改进推荐结果。'
- en: '*Tasks:*'
  id: totrans-261
  prefs: []
  type: TYPE_NORMAL
  zh: '*任务：*'
- en: Create a new prompt variant for the recommender flow in prompt flow.
  id: totrans-262
  prefs:
  - PREF_UL
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在提示流中为推荐流程创建一个新的提示变体。
- en: Run the flow in batch mode.
  id: totrans-263
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 以批量模式运行流程。
- en: Evaluate the results to determine if they are better or worse compared to the
    original prompt.
  id: totrans-264
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 评估结果，以确定它们与原始提示相比是更好还是更差。
- en: '*Exercise 2* —Add a Custom Field to the Rubric and Evaluate (Intermediate)'
  id: totrans-265
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*练习 2* — 将自定义字段添加到评分标准并进行评估（中级）'
- en: '*Objective* —Enhance the evaluation criteria by incorporating a custom field
    into the rubric and updating the evaluation flow.'
  id: totrans-266
  prefs: []
  type: TYPE_NORMAL
  zh: '*目标* — 通过将自定义字段纳入评分标准和更新评估流程来增强评估标准。'
- en: '*Tasks:*'
  id: totrans-267
  prefs: []
  type: TYPE_NORMAL
  zh: '*任务：*'
- en: Add the custom field as a new criterion to the rubric.
  id: totrans-268
  prefs:
  - PREF_UL
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将自定义字段作为新的标准添加到评分标准中。
- en: Update the evaluation flow to score the new criterion.
  id: totrans-269
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 更新评估流程以评分新标准。
- en: Evaluate the results, and analyze the effect of the new criterion on the evaluation.
  id: totrans-270
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 评估结果，并分析新标准对评估的影响。
- en: '*Exercise 3* —Develop a New Use Case and Evaluation Rubric (Advanced)'
  id: totrans-271
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*练习 3* — 开发新的用例和评估评分标准（高级）'
- en: '*Objective* —Expand the application of prompt engineering by developing a new
    use case and creating an evaluation rubric.'
  id: totrans-272
  prefs: []
  type: TYPE_NORMAL
  zh: '*目标* — 通过开发新的用例和创建评估评分标准来扩展提示工程的应用。'
- en: '*Tasks:*'
  id: totrans-273
  prefs: []
  type: TYPE_NORMAL
  zh: '*任务：*'
- en: Develop a new use case aside from the recommendation.
  id: totrans-274
  prefs:
  - PREF_UL
  - PREF_UL
  type: TYPE_NORMAL
  zh: 除了推荐之外，开发一个新的用例。
- en: Build the prompt for the new use case.
  id: totrans-275
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 构建新用例的提示。
- en: Create a rubric for evaluating the new prompt.
  id: totrans-276
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 为新的提示创建评分标准。
- en: Update or alter the evaluation flow to aggregate and compare the results of
    the new use case with existing ones.
  id: totrans-277
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 更新或修改评估流程以汇总和比较新用例与现有用例的结果。
- en: '*Exercise 4* —Evaluate Other LLMs Using LM Studio (Intermediate)'
  id: totrans-278
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*练习 4* — 使用 LM Studio 评估其他 LLM（中级）'
- en: '*Objective* —Assess the performance of different open source LLMs by hosting
    a local server with LM Studio.'
  id: totrans-279
  prefs: []
  type: TYPE_NORMAL
  zh: '*目标* — 通过使用 LM Studio 托管本地服务器来评估不同开源 LLM 的性能。'
- en: '*Tasks:*'
  id: totrans-280
  prefs: []
  type: TYPE_NORMAL
  zh: '*任务：*'
- en: Use LM Studio to host a local server for evaluating LLMs.
  id: totrans-281
  prefs:
  - PREF_UL
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 LM Studio 来托管本地服务器以评估 LLM。
- en: Evaluate other open source LLMs.
  id: totrans-282
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 评估其他开源LLM。
- en: Consult chapter 2 if assistance is needed for setting up the server and performing
    the evaluations.
  id: totrans-283
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果需要设置服务器和执行评估的帮助，请参考第2章。
- en: '*Exercise 5* —Build and Evaluate Prompts Using Prompt Flow (Intermediate)'
  id: totrans-284
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*练习5* — 使用提示流程构建和评估提示（中级）'
- en: '*Objective* —Apply prompt engineering strategies to build and evaluate new
    prompts or profiles using prompt flow.'
  id: totrans-285
  prefs: []
  type: TYPE_NORMAL
  zh: '*目标* — 使用提示流程应用提示工程策略来构建和评估新的提示或配置文件。'
- en: '*Tasks:*'
  id: totrans-286
  prefs: []
  type: TYPE_NORMAL
  zh: '*任务：*'
- en: Build new prompts or profiles for evaluation using prompt flow.
  id: totrans-287
  prefs:
  - PREF_UL
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用提示流程构建新的提示或配置文件以进行评估。
- en: Apply the Write Clear Instructions prompt engineering strategy from chapter
    2\.
  id: totrans-288
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 应用第2章中的“编写清晰指令”提示工程策略。
- en: Evaluate the prompts and profiles using prompt flow.
  id: totrans-289
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用提示流程评估提示和配置文件。
- en: Refer to chapter 2 for tactics and implementation details if a refresher is
    needed.
  id: totrans-290
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果需要复习策略和实施细节，请参考第2章。
- en: Summary
  id: totrans-291
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 摘要
- en: An agent profile consists of several other component prompts that can drive
    functions such as actions/tools, knowledge, memory, evaluation, reasoning, feedback,
    and planning.
  id: totrans-292
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 代理配置文件由几个其他组件提示组成，可以驱动诸如动作/工具、知识、记忆、评估、推理、反馈和计划等功能。
- en: Prompt flow can be used to evaluate an agent’s component prompts.
  id: totrans-293
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 提示流程可用于评估代理的组件提示。
- en: Systemic prompt engineering is an iterative process evaluating a prompt and
    agent profile.
  id: totrans-294
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 系统性提示工程是一个评估提示和代理配置文件的迭代过程。
- en: The Test Changes Systematically strategy describes iterating and evaluating
    prompts, and system prompt engineering implements this strategy.
  id: totrans-295
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 系统性测试更改策略描述了迭代和评估提示，系统提示工程实现了这一策略。
- en: Agent profiles and prompt engineering have many similarities. We define an agent
    profile as the combination of prompt engineering elements that guide and help
    an agent through its task.
  id: totrans-296
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 代理配置文件和提示工程有许多相似之处。我们定义代理配置文件为引导和帮助代理完成任务的提示工程元素的组合。
- en: Prompt flow is an open source tool from Microsoft that provides several features
    for developing and evaluating profiles and prompts.
  id: totrans-297
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 提示流程是来自微软的开源工具，它为开发和评估配置文件和提示提供了几个功能。
- en: An LLM connection in prompt flow supports additional parameters, including temperature,
    stop token, max tokens, and other advanced parameters.
  id: totrans-298
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 提示流程中的LLM连接支持额外的参数，包括温度、停止令牌、最大令牌和其他高级参数。
- en: LLM blocks support prompt and profile variants, which allow for evaluating changes
    to the prompt/profile or other connection parameters.
  id: totrans-299
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: LLM块支持提示和配置文件变体，这允许评估提示/配置文件或其他连接参数的变化。
- en: A rubric applied to an LLM prompt is the criteria and standards a prompt/profile
    must fulfill to be grounded. Grounding is the scoring and evaluation of a rubric.
  id: totrans-300
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 应用到LLM提示上的评分标准是提示/配置文件必须满足的准则和标准，以实现扎根。扎根是对评分标准的评分和评估。
- en: Prompt flow supports running multiple variations as single runs or batch runs.
  id: totrans-301
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 提示流程支持以单次运行或批量运行的方式运行多个变体。
- en: In prompt flow, an evaluation flow is run after a generative flow to score and
    aggregate the results. The Visualize Runs option can compare the aggregated criteria
    from scoring the rubric across multiple runs.
  id: totrans-302
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在提示流程中，在生成流程之后运行评估流程以评分和汇总结果。可视化运行选项可以比较跨多个运行评分标准汇总的聚合标准。
