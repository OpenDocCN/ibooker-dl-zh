# 前言

## 前言

从这本书的一位审稿人那里得到的一条有用的反馈是，它成为了他们攀登陡峭的 MLOps 学习曲线的“秘籍”。我希望本书的内容能帮助您成为更加了解机器学习工程和数据科学的从业者，同时也是您项目、团队和组织更具生产力的贡献者。

2021 年，主要技术公司公开表示努力“民主化”人工智能（AI），通过使深度学习等技术更容易接触到更广泛的科学家和工程师。遗憾的是，企业采取的民主化方法过分关注核心技术，而不足够关注将 AI 系统交付给最终用户的实践。因此，机器学习（ML）工程师和数据科学家准备充足，能够创建实验性的 AI 原型，但在成功将这些原型交付到生产环境中则做得不够。这一点从各种各样的问题中显而易见：从 AI 项目的失败率不可接受到关于成功交付给最终用户的 AI 系统的道德争议。我相信，要取得成功，民主化 AI 的努力必须超越对核心、启用技术（如 Keras、PyTorch 和 TensorFlow）的狭隘关注。*MLOps* 成为了一个统一的术语，用于将实验性的 ML 代码有效地运行到生产环境中。无服务器 ML 是主导的云原生软件开发模型，用于 ML 和 MLOps，抽象出基础架构，提高了从业者的生产力。

我还鼓励您使用附带本书的 Jupyter 笔记本。笔记本代码中使用的 DC 出租车费项目旨在为您提供成长为从业者所需的练习。祝阅读愉快，编码愉快！

## 致谢

我永远感激我的女儿 Sophia。你是我永恒的幸福和灵感之源。我的妻子 Alla，在我写第一本书时对我有着无限的耐心。你总是在那里支持我，为我加油打气。对我的父亲 Mikhael，没有你，我不会成为现在的我。

我也要感谢 Manning 公司的工作人员，使这本书得以出版：我的开发编辑 Marina Michaels；我的技术开发编辑 Frances Buontempo；我的技术校对 Karsten Strøbaek；我的项目编辑 Deirdre Hiam；我的副本编辑 Michele Mitchell；以及我的校对员 Keri Hales。

特别感谢技术同行审阅者：Conor Redmond，Daniela Zapata，Dianshuang Wu，Dimitris Papadopoulos，Dinesh Ghanta，Dr. Irfan Ullah，Girish Ahankari，Jeff Hajewski，Jesús A. Juárez-Guerrero，Trichy Venkataraman Krishnamurthy，Lucian-Paul Torje，Manish Jain，Mario Solomou，Mathijs Affourtit，Michael Jensen，Michael Wright，Pethuru Raj Chelliah，Philip Kirkbride，Rahul Jain，Richard Vaughan，Sayak Paul，Sergio Govoni，Srinivas Aluvala，Tiklu Ganguly 和 Todd Cook。您的建议帮助我们制作出更好的书籍。

## 关于本书

感谢您购买《规模化 MLOps 工程》。

### 谁应该阅读本书

要从本书中获得最大的价值，你需要具备使用 Python 和 SQL 进行数据分析的现有技能，并且具有一些机器学习经验。我期望，如果你正在阅读本书，你对作为机器学习工程师的专业知识感兴趣，并且计划将基于机器学习的原型部署到生产环境中。

这本书适用于信息技术专业人士或学术界人士，他们在机器学习方面有一定的接触，并且正在开发或有兴趣在生产中推出机器学习系统。附录 A 中提供了本书的机器学习先决条件复习。请记住，如果您对机器学习全新，您可能会发现同时学习机器学习和基于云的机器学习基础设施可能会让人不知所措。

如果你是软件工程师或数据工程师，并计划开始一个机器学习项目，这本书可以帮助你更深入地了解机器学习项目的生命周期。你会发现，尽管机器学习的实践依赖于传统信息技术（即计算、存储和网络），但在实践中与传统信息技术有所不同。前者比你作为软件工程师或数据专业人员所经历的实验性更强，更加迭代，你应该为结果可能较少事先了解而做好准备。在处理数据时，机器学习实践更像是科学过程，包括对数据形成假设，测试替代模型以回答假设问题，并排名和选择表现最佳的模型来部署到你的机器学习平台上。

如果你是一名机器学习工程师或从业者，或者是一名数据科学家，请记住，本书不是要让你成为更好的研究者。本书不旨在教育你关于机器学习科学前沿的知识。本书也不会试图重新教授你机器学习的基础知识，尽管你可能会发现附录 A 中针对信息技术专业人员的材料是一个有用的参考。相反，你应该期望使用本书成为你机器学习团队中更有价值的合作者。本书将帮助你更好地利用你已经掌握的关于数据科学和机器学习的知识，以便你能够为你的项目或组织提供可即用的贡献。例如，你将学会如何实现关于提高机器学习模型准确性的见解，并将其转化为生产就绪的能力。

### 本书的组织结构：路线图

本书分为三个部分。在第一部分，我概述了将机器学习系统投入生产所需的条件，描述了实验性机器学习代码与生产机器学习系统之间的工程差距，并解释了无服务器机器学习如何帮助弥合这一差距。到第一部分结束时，我将教你如何使用公共云（Amazon Web Services）的无服务器特性来开始一个真实的机器学习用例，为该用例准备一个工作机器学习数据集，并确保你已经准备好将机器学习应用于该用例。

+   第一章全面介绍了机器学习系统工程领域以及将系统投入生产所需的条件。

+   第二章向你介绍了华盛顿特区出租车行程数据集，并教你如何在亚马逊 Web Services（AWS）公共云中开始使用该数据集进行机器学习。

+   第三章运用 AWS Athena 交互式查询服务，深入挖掘数据集，发现数据质量问题，然后通过严格和原则性的数据质量保证流程加以解决。

+   第四章演示了如何使用统计量来总结数据集样本并量化它们与整个数据集的相似性。该章还涵盖了如何选择测试、训练和验证数据集的正确大小，并使用云中的分布式处理来准备用于机器学习的数据集样本。

在第二部分，我将教你如何使用 PyTorch 深度学习框架为结构化数据集开发模型，解释如何在云中分发和扩展机器学习模型训练，并展示如何部署经过训练的机器学习模型以满足用户需求的扩展。在这个过程中，你将学会评估和评估替代机器学习模型实现的性能，并选择适合用例的正确模型。

+   第五章介绍了 PyTorch 的基础知识，介绍了核心张量应用程序编程接口（API），并帮助您熟练使用该 API。

+   第六章专注于 PyTorch 的深度学习方面，包括自动微分支持、替代梯度下降算法和支持工具。

+   第七章解释了如何通过教授图形处理单元（GPU）特性来扩展您的 PyTorch 程序，并如何利用这些特性加速您的深度学习代码。

+   第八章介绍了分布式 PyTorch 训练的数据并行方法，并深入介绍了传统参数服务器方法和基于环形的分布式训练方法（例如，Horovod）之间的区别。

在第三部分中，我向您介绍了经过考验的机器学习实践技术，并介绍了特征工程、超参数调整和机器学习流水线组装。通过本书的结尾，您将建立一个机器学习平台，该平台摄取原始数据，为机器学习准备数据，应用特征工程，并训练高性能、超参数调整的机器学习模型。

+   第九章探讨了围绕特征选择和特征工程的用例，使用案例研究来建立对可以选择或设计为 DC 出租车数据集的特征的直觉。

+   第十章教您如何通过采用一个名为 PyTorch Lightning 的框架来消除 DC 出租车 PyTorch 模型实现中的样板工程代码。此外，该章节还介绍了训练、验证和测试增强的深度学习模型所需的步骤。

+   第十一章将您的深度学习模型与一个名为 Optuna 的开源超参数优化框架集成，帮助您基于备选超参数值训练多个模型，然后根据它们的损失和指标性能对训练好的模型进行排序。

+   第十二章将您的深度学习模型实现打包成一个 Docker 容器，以便通过整个机器学习流水线的各个阶段运行它，从开发数据集一直到准备用于生产部署的训练好的模型。

### 关于代码

您可以从我的 Github 仓库访问本书的代码：[github.com/osipov/smlbook](http://github.com/osipov/smlbook)。该仓库中的代码以 Jupyter 笔记本的形式打包，并设计用于在基于 Linux 的 Jupyter 笔记本环境中使用。这意味着在执行代码时您有多种选择。例如，如果您拥有自己的本地 Jupyter 环境，那么使用 Jupyter 本机客户端（JupyterApp: [`github.com/jupyterlab/jupyterlab_app`](https://github.com/jupyterlab/jupyterlab_app)) 或 Conda 分发（[`jupyter.org/install`](https://jupyter.org/install)）就很棒！如果您不使用本地 Jupyter 分发，您可以使用 Google Colab 或 Binder 等云服务从笔记本中运行代码。我的 Github 仓库 README.md 文件包括徽章和超链接，以帮助您在 Google Colab 中启动特定章节的笔记本。

我强烈建议您使用本地 Jupyter 安装，而不是云服务，特别是如果您担心您的 AWS 账户凭证的安全性。代码的一些步骤将要求您使用您的 AWS 凭证来执行诸如创建存储桶、启动 AWS Glue 提取转换加载（ETL）作业等任务。第十二章的代码必须在安装了 Docker 的节点上执行，因此我建议您计划在具有足够容量安装 Docker 的笔记本电脑或台式机上使用本地 Jupyter 安装。有关 Docker 安装要求的更多信息，请参阅附录 B。

### liveBook 讨论论坛

购买 *大规模工程中的 MLOps* 包括免费访问 liveBook，Manning 的在线阅读平台。使用 liveBook 的独家讨论功能，您可以全局附加评论到书籍或特定章节或段落。为自己做笔记，提出和回答技术问题，并从作者和其他用户那里获得帮助都是轻而易举的。

要访问论坛，请转到[`livebook.manning.com/#!/book/mlops-engineering-at-scale/discussion`](https://livebook.manning.com/#!/book/mlops-engineering-at-scale/discussion)。一定要加入论坛并打个招呼！你还可以了解更多关于 Manning 论坛和行为规则的信息，请访问[`livebook.manning.com/#!/discussion`](https://livebook.manning.com/#!/discussion)。

Manning 对我们的读者的承诺是提供一个场所，个人读者和读者与作者之间可以进行有意义的对话。这并不意味着作者有任何具体的参与承诺，他对论坛的贡献仍然是自愿的（且未付酬）。我们建议您尝试向作者提出一些具有挑战性的问题，以免他失去兴趣！只要图书仍在印刷中，论坛和以前的讨论存档将可以从出版商的网站访问。

## 关于作者

| ![250Osipov](img/Osipov.png)  | Carl Osipov 自 2001 年以来一直在信息技术行业工作，专注于大数据分析和多核分布式系统中的机器学习项目，比如面向服务的体系结构和云计算平台。在 IBM 期间，卡尔帮助 IBM 软件集团塑造了其围绕使用 Docker 和其他基于容器的技术进行无服务器云计算的策略，使用了 IBM Cloud 和 Amazon Web Services。在 Google，卡尔向世界顶尖的机器学习专家学习，并帮助管理公司努力通过 Google Cloud 和 TensorFlow 实现人工智能的大众化。卡尔是《专业，贸易和学术期刊》上的 20 多篇文章的作者；美国专利与商标局的六项专利的发明人；以及 IBM 获得的三项企业技术奖的获得者。 |
| --- | --- |

## 关于封面插图

*MLOps 规模工程*封面上的图画标题为“Femme du Thibet”，即一位来自西藏的妇女。这幅插图取自雅克·格拉塞·德·圣索维尔（1757-1810）的《不同国家的服装》系列，该系列于 1797 年在法国出版。每幅插图都是精细绘制和手工上色的。格拉塞·德·圣索维尔的收藏丰富多样，生动地提醒了我们 200 年前世界各地城镇和地区在文化上的巨大差异。人们相互隔离，说着不同的方言和语言。在街上或在乡间地区，可以通过服装轻松地辨别他们居住的地方，以及他们的行业或社会地位。

自那时起，我们的着装方式已经发生了变化，当时地区的多样性已经消失。现在很难区分不同大陆的居民，更不用说不同的城镇，地区或国家。也许我们已经以文化多样性换取了更加多样化的个人生活——当然也换取了更加多样化和快节奏的技术生活。

在难以辨别一本电脑书与另一本之际，Manning 通过以格拉塞·德·圣索维尔的图片为基础的书籍封面，庆祝计算机商业的独创性和主动性，并将两个世纪前地区生活丰富多样性的丰盛多样性重新带回生活。
