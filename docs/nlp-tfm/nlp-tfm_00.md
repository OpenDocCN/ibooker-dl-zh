# 前言

当你阅读这些文字时，一个奇迹正在发生：这页上的涂鸦正在在你的大脑皮层中转化为单词、概念和情感。我的 2021 年 11 月的思想现在已成功侵入你的大脑。如果它们设法引起你的注意并在这个严酷而竞争激烈的环境中存活足够长的时间，它们可能有机会再次通过你与他人分享这些思想而繁殖。由于语言，思想已经变得空气中传播并且高度传染的大脑细菌——而且没有疫苗即将出现。

幸运的是，大多数大脑细菌是无害的，而一些则非常有用。事实上，人类的大脑细菌构成了我们最宝贵的两个财富：知识和文化。就像我们没有健康的肠道细菌就无法正常消化一样，没有健康的大脑细菌，我们也无法正常思考。你的大部分想法实际上并不是你自己的：它们在感染你之前在许多其他大脑中产生、生长和演变。因此，如果我们想要构建智能机器，我们将需要找到一种方法来感染它们。

好消息是，在过去几年中，另一个奇迹已经在发生：深度学习的几项突破为强大的语言模型奠定了基础。由于你正在阅读这本书，你可能已经看到了一些令人惊讶的这些语言模型的演示，比如 GPT-3，它可以根据“一只青蛙遇到了一只鳄鱼”这样的简短提示来写一个完整的故事。虽然它还不是莎士比亚，但有时很难相信这些文本是由人工神经网络写的。事实上，GitHub 的 Copilot 系统正在帮助我写这些文字：你永远不会知道我真正写了多少。

这一革命远不止于文本生成。它涵盖了自然语言处理（NLP）的整个领域，从文本分类到摘要、翻译、问答、聊天机器人、自然语言理解（NLU）等等。无论何处有语言、语音或文本，都有 NLP 的应用。你已经可以向你的手机询问明天的天气，或者与虚拟帮助台助手聊天以解决问题，或者从似乎真正理解你的查询的搜索引擎中获得有意义的结果。但是这项技术是如此新颖，以至于最好的可能还在未来。

像大多数科学进步一样，NLP 领域的这一最新革命也是建立在数百位无名英雄的辛勤工作之上的。但是它的成功有三个关键因素是显而易见的：

+   *Transformer*是一种神经网络架构，它是在 2017 年由一组谷歌研究人员发表的一篇开创性论文[“注意力机制是你所需要的一切”](https://arxiv.org/abs/1706.03762)中提出的。在短短几年内，它席卷了整个领域，击败了通常基于循环神经网络（RNNs）的先前架构。Transformer 架构在捕捉长序列数据中的模式和处理庞大数据集方面表现出色，以至于它的使用现在已经远远超出了 NLP 领域，例如扩展到图像处理任务。

+   在大多数项目中，你可能无法访问一个庞大的数据集来从头开始训练模型。幸运的是，通常可以下载一个在通用数据集上*预训练*的模型：然后你所需要做的就是在自己的（小得多的）数据集上进行微调。自 2010 年代初以来，在图像处理领域，预训练已经成为主流，但在自然语言处理（NLP）领域，它仅限于无上下文的词嵌入（即，个别词的密集向量表示）。例如，“bear”这个词在“teddy bear”和“to bear”中具有相同的预训练嵌入。然后，在 2018 年，几篇论文提出了完整的语言模型，可以在各种 NLP 任务中进行预训练和微调；这彻底改变了游戏规则。

+   *模型中心*，如 Hugging Face 的，也是一个改变游戏规则的存在。在早期，预训练模型随处可见，所以很难找到你需要的东西。墨菲定律保证了 PyTorch 用户只能找到 TensorFlow 模型，反之亦然。而且，当你找到一个模型时，弄清楚如何对其进行微调并不总是容易的。这就是 Hugging Face 的 Transformers 库发挥作用的地方：它是开源的，支持 TensorFlow 和 PyTorch，而且可以轻松地从 Hugging Face Hub 下载最先进的预训练模型，为你的任务配置它，对你的数据集进行微调，并进行评估。该库的使用量正在迅速增长：2021 年第四季度，它被超过五千家组织使用，并且每月使用`pip`安装超过四百万次。此外，该库及其生态系统正在扩展到 NLP 之外：图像处理模型也可用。您还可以从 Hub 下载大量数据集来训练或评估您的模型。

那么，你还能要求什么呢？嗯，就是这本书！它是由 Hugging Face 的开源开发人员撰写的，包括 Transformers 库的创造者！——这一点可以看出：你将在这些页面中找到的信息的广度和深度令人震惊。它涵盖了从 Transformer 架构本身到 Transformers 库及其周围整个生态系统的一切。我特别欣赏这种实践方法：你可以在 Jupyter 笔记本中跟着做，所有的代码示例都直截了当，易于理解。作者在训练非常大的 Transformer 模型方面拥有丰富的经验，并提供了大量的技巧和窍门，以确保一切都能高效运行。最后但同样重要的是，他们的写作风格直接而生动：读起来就像一部小说。

简而言之，我非常喜欢这本书，我相信你也会喜欢。任何对使用最先进的语言处理功能构建产品感兴趣的人都需要阅读它。它充满了所有正确的大脑细菌！

Aurélien Géron

2021 年 11 月，新西兰奥克兰

¹ 对于大脑卫生提示，请参阅 CGP Grey 的[关于模因的优秀视频](https://youtu.be/rE3j_RHkqJc)。
