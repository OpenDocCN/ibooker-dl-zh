# 第二章：入门

在本章中，我们将介绍如何开始在低功耗设备上构建和修改机器学习应用程序所需的知识。所有软件都是免费的，硬件开发套件的价格不到 30 美元，因此最大的挑战可能是开发环境的陌生。为了帮助解决这个问题，在整个章节中，我们推荐了一套我们发现可以很好地配合使用的工具。

# 这本书的目标读者是谁？

要构建一个 TinyML 项目，您需要了解一些机器学习和嵌入式软件开发的知识。这两者都不是常见的技能，很少有人是这两者的专家，因此本书将假设您对这两者都没有背景。唯一的要求是您对在终端中运行命令（或 Windows 上的命令提示符）有一定的熟悉度，并且能够将程序源文件加载到编辑器中，进行修改并保存。即使听起来令人生畏，我们会逐步引导您完成我们讨论的每一步，就像一个好的食谱一样，包括许多情况下的截图（和在线屏幕录像），因此我们希望尽可能地使这本书对广大读者更易接近。

我们将向您展示如何在嵌入式设备上应用机器学习的一些实际应用，例如简单的语音识别、使用运动传感器检测手势以及使用摄像头传感器检测人员。我们希望让您熟悉自己构建这些程序，然后扩展它们以解决您关心的问题。例如，您可能想修改语音识别以检测狗吠声而不是人类讲话，或者识别狗而不是人类，我们会给您一些关于如何自行解决这些修改的想法。我们的目标是为您提供开始构建您关心的令人兴奋的应用程序所需的工具。

# 需要哪些硬件？

您需要一台带有 USB 端口的笔记本电脑或台式电脑。这将是您的主要编程环境，您将在其中编辑和编译在嵌入式设备上运行的程序。您将使用 USB 端口和一个专用适配器将此计算机连接到嵌入式设备，具体取决于您使用的开发硬件。主计算机可以运行 Windows、Linux 或 macOS。对于大多数示例，我们在云中训练我们的机器学习模型，使用[Google Colab](https://oreil.ly/AQYDz)，因此不用担心是否拥有专门配备的计算机。

您还需要一个嵌入式开发板来测试您的程序。要做一些有趣的事情，您需要连接麦克风、加速度计或摄像头，并且您需要一个足够小的电池，可以构建成一个逼真的原型项目。当我们开始写这本书时，这是很困难的，所以我们与芯片制造商 Ambiq 和创客零售商 SparkFun 合作，生产了价值 15 美元的 SparkFun Edge 板。本书的所有示例都可以在此设备上运行。

###### 提示

SparkFun Edge 板的第二次修订版，SparkFun Edge 2，在这本书出版后将发布。本书中的所有项目都保证可以与新板卡配合使用。然而，这里打印的代码和部署说明将略有不同。不用担心，每个项目章节都链接到一个包含部署每个示例到 SparkFun Edge 2 的最新说明的*README.md*。

我们还提供了如何在 Arduino 和 Mbed 开发环境中运行许多项目的说明。我们推荐使用[Arduino Nano 33 BLE Sense](https://oreil.ly/4sER2)板和[Mbed 的 STM32F746G Discovery kit](https://oreil.ly/vKyOM)开发板，尽管所有项目都应该适用于其他设备，只要您能够以所需格式捕获传感器数据。表 2-1 显示了我们在每个项目章节中包含的设备。

表 2-1。每个项目中涉及的设备

| 项目名称 | 章节 | SparkFun Edge | Arduino Nano 33 BLE Sense | STM32F746G Discovery kit |
| --- | --- | --- | --- | --- |
| Hello world | 第五章 | 包括 | 包括 | 包括 |
| 唤醒词检测 | 第七章 | 包括 | 包括 | 包括 |
| 人员检测 | 第九章 | 包括 | 包括 | 不包括 |
| 魔杖 | 第十一章 | 包括 | 包括 | 不包括 |

除了人员检测需要相机模块外，这些项目都不需要任何额外的电子组件。如果您使用的是 Arduino，您将需要[Arducam Mini 2MP Plus](https://oreil.ly/8EacT)。如果您使用的是 SparkFun Edge，您将需要 SparkFun 的[Himax HM01B0 breakout](https://oreil.ly/Kb0lI)。

# 您需要哪些软件？

本书中的所有项目都基于 TensorFlow Lite for Microcontrollers 框架。这是 TensorFlow Lite 框架的一个变体，旨在在仅有几十千字节可用内存的嵌入式设备上运行。所有这些项目都作为库中的示例包含在内，它是开源的，您可以在[GitHub](https://oreil.ly/TQ4CC)上找到它。

###### 注意

由于本书中的代码示例是一个活跃的开源项目的一部分，随着我们添加优化、修复错误和支持其他设备，它们将不断变化和发展。您可能会发现书中打印的代码与 TensorFlow 存储库中最新代码之间存在一些差异。尽管代码可能随着时间的推移而有所变化，但您在这里学到的基本原则将保持不变。

您需要某种编辑器来检查和修改您的代码。如果您不确定应该使用哪种编辑器，微软的免费[VS Code](https://oreil.ly/RNus3) 应用程序是一个很好的起点。它适用于 macOS、Linux 和 Windows，并具有许多方便的功能，如语法高亮和自动完成。如果您已经有喜欢的编辑器，可以使用它，我们不会为任何项目进行大量修改。

您还需要一个输入命令的地方。在 macOS 和 Linux 上，这被称为终端，您可以在应用程序文件夹中找到它。在 Windows 上，它被称为命令提示符，您可以在开始菜单中找到它。

还将有额外的软件，您需要与嵌入式开发板通信，但这将取决于您使用的设备。如果您使用的是 SparkFun Edge 开发板或 Mbed 设备，您需要安装 Python 用于一些构建脚本，然后您可以在 Linux 或 macOS 上使用 GNU Screen，或者在 Windows 上使用[Tera Term](https://oreil.ly/oDOKn)来访问调试日志控制台，显示来自嵌入式设备的文本输出。如果您有 Arduino 开发板，您所需的一切都已安装在 IDE 中，因此您只需要下载主要软件包。

# 我们希望您学到什么？

本书的目标是帮助更多应用程序在这个新领域中出现。目前没有一个“杀手级应用程序”适用于 TinyML，也许永远不会有，但我们从经验中知道，世界上有很多问题可以通过它提供的工具箱来解决。我们希望让您熟悉可能的解决方案。我们希望带领农业、空间探索、医学、消费品等领域的专家了解如何自己解决问题，或者至少了解这些技术可以解决哪些问题。

考虑到这一点，我们希望当您完成这本书时，您将对目前嵌入式系统上使用机器学习的可能性有一个良好的概述，同时也对未来几年可能实现的可能性有一些想法。我们希望您能够构建和修改一些使用时间序列数据（如音频或加速度计输入）以及低功耗视觉的实际示例。我们希望您对整个系统有足够的理解，至少能够有意义地参与与专家讨论新产品设计，并希望能够自己原型早期版本。

由于我们希望看到完整的产品问世，我们从整个系统的角度来看待我们讨论的一切。通常，硬件供应商会关注他们正在销售的特定组件的能耗，但不考虑其他必要部分如何增加所需的功率。例如，如果您有一个只消耗 1 mW 的微控制器，但它所使用的唯一摄像头传感器需要 10 mW 才能运行，那么您用它的任何基于视觉的产品都无法利用处理器的低能耗。这意味着我们不会深入研究不同领域的基本工作原理；相反，我们专注于您需要了解的内容，以便使用和修改涉及的组件。

例如，当您在 TensorFlow 中训练模型时，我们不会详细讨论发生在幕后的细节，比如梯度和反向传播的工作原理。相反，我们向您展示如何从头开始运行训练以创建模型，您可能会遇到的常见错误以及如何处理它们，以及如何定制流程来构建模型以解决您自己的问题与新数据集。
