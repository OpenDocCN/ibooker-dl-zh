# 前置内容

## 前言

作为一名谷歌员工，我的职责之一是教育软件工程师如何使用机器学习。我已经有了创建在线教程、聚会、会议演示、培训研讨会和为私人编码学校和大学研究生课程编写课程的经验，但我总是寻找新的有效教学方法。

在谷歌之前，我在日本 IT 行业担任了 20 年的首席研究科学家——这一切都没有涉及深度学习。今天我所看到的一切，我们 15 年前在创新实验室里就已经在做；区别在于我们需要一个满屋子的科学家和庞大的预算。深度学习带来的变化如此之快，真是令人难以置信。

回到 2000 年代末，我正在使用来自世界各地国家和国际来源的小型结构化数据集和地理空间数据。同事们称我为数据科学家，但没有人知道数据科学家究竟是什么。然后出现了大数据，我不了解大数据工具和框架，突然间我不再是数据科学家。什么？我不得不匆忙学习大数据背后的工具和概念，再次成为数据科学家。

随后出现了在大数据集上的机器学习，如线性/逻辑回归和 CART 分析，而我自从几十年前研究生毕业以来就没有使用过统计学，再次我不是数据科学家。什么？我不得不再次匆忙学习统计学，再次成为数据科学家。然后出现了深度学习，我不了解神经网络的理论和框架，突然间我不再是数据科学家。什么？我再次匆忙学习深度学习理论和其他深度学习框架。再次，我成为数据科学家。

## 致谢

我想感谢所有在 Manning 出版社帮助我完成这个过程的人。Frances Lefkowitz，我的开发编辑；Deirdre Hiam，我的项目编辑；Sharon Wilkey，我的校对编辑；Keri Hales，我的校对员；以及 Aleksandar Dragosavljević，我的审稿编辑。

向所有审稿人表示感谢：Ariel Gamino、Arne Peter Raulf、Barry Siegel、Brian R. Gaines、Christopher Marshall、Curtis Bates、Eros Pedrini、Hilde Van Gysel、Ishan Khurana、Jen Lee、Karthikeyarajan Rajendran、Michael Kareev、Muhammad Sohaib Arif、Nick Vazquez、Ninoslav Cerkez、Oliver Korten、Piyush Mehta、Richard Tobias、Romit Singhai、Sayak Paul、Sergio Govoni、Simone Sguazza、Udendran Mudaliyar、Vishwesh Ravi Shrimali 和 Viton Vitanis，你们的建议帮助这本书变得更好。

向所有分享个人和客户见解的谷歌云 AI 团队表示感谢，你们的见解帮助这本书覆盖了更广泛的受众。

## 关于这本书

### 应该阅读这本书的人

欢迎来到我的最新尝试，*深度学习模式与实践*。这本书是为软件工程师、机器学习工程师以及初级、中级和高级数据科学家所写。尽管你可能认为对于后者来说，最初章节可能有些冗余，但我的独特方法可能会让你获得额外的洞察和受欢迎的复习。本书的结构使得每位读者都能达到“点燃”的点，并能够自我推动进入深度学习。

我主要在计算机视觉的背景下教授设计模式和惯例，因为深度学习的设计模式最初就是在这里演化的。自然语言理解和结构化数据模型的发展落后，并且继续专注于经典方法。但随着它们赶上，这些领域发展了自己的深度学习设计模式，我在本书中也讨论了这些模式和惯例。

尽管我为计算机视觉模型提供了代码，但我强调的是这些方法和创新背后的概念：它们是如何设置的以及为什么这样设置。这些基本概念适用于自然语言处理、结构化数据、信号处理和其他领域，通过概括，你应该能够将概念、方法和技术适应你领域中的问题。我讨论的许多模型和技术都是领域无关的，在本书中，我也讨论了自然语言处理、自然语言理解和结构化数据领域中的关键创新，在适当的地方。

至于一般背景，你应该至少了解 Python 的基础知识。如果你还在为理解什么是可理解性或什么是生成器而感到困惑，或者如果你对奇怪的多元数组切片以及堆上哪些对象是可变的和不可变的还有一些困惑，那都是可以的。对于这本书来说，这些都是可以的。

对于那些想要成为机器学习工程师的软件工程师——那意味着什么？机器学习工程师（MLE）是应用工程师。你不需要知道统计学（真的，你不需要！），你也不需要知道计算理论。如果你在大学微积分课上对导数是什么感到困倦，那没关系，如果有人让你做矩阵乘法，你可以自由地问，“为什么？”

你的任务是学习框架的旋钮和杠杆，并将你的技能和经验应用于解决现实世界的问题。这正是我将帮助你做到的，也是 TF.Keras 中使用的模式设计所关注的。

本书是为处于相当水平的机器学习工程师和数据科学家设计的。对于那些追求数据科学家路线的人，我鼓励你学习补充的与统计学相关的材料。

在我们开始之前，我想解释你将如何学习，所以这个第一部分更多地解释了我的教学哲学和方法。然后我们将回顾一些基础知识，包括术语、从经典或语义 AI 到窄或统计 AI 的演变，以及机器学习的基本步骤概述。最后，我们将从高层次的角度看看这本书的内容：机器学习的现代模型融合方法。

我不使用传统的西方死记硬背的方法，重复，重复，测试正确答案，然后垂直提升。除了我认为这种方法效果较差之外，我还认为它无意中具有歧视性。

相反，我有幸在多元文化和教学方法中教授工程和科学，并发展了一种独特的教学方法，我称之为“横向方法”：我从核心概念开始，然后通过我所说的“抽象”螺旋式扩展。当有问题被问起时，我会在反思他们的想法之前，逐渐开始指向其他学生的想法，指向答案。我不进行测验，学生试图得到 100%。相反，我给学生布置作业，每个学生都会失败。我让学生不断打击问题，挣扎，在这个过程中，他们将会开始发现他们需要学习的潜在原理。例如，我可能会布置一个作业，要求使用标准的 ResNet50 模型训练 CIFAR-10 数据集，并指出相应的 ResNet 论文的作者在 CIFAR-10 上实现了 97%的准确率。每个学生都会失败，模型不会收敛，他们不会超过 70%，等等。

然后，我将学生组成团队一起解决问题。通过相互讨论，他们学会了一起概括。在他们能够理解之前，我会进行跳跃，给学生提出另一个难以解决的问题——然后这个过程再次开始。我从不给学生死记硬背的机会。

以我的例子来说，我可能在黑板上写下四种可能的解决方案，比如 1）图像增强，2）更多的正则化，3）更多的超参数搜索，4）延迟下采样到神经网络深处（这是正确答案）。然后在中途，我会停止学生，让每个团队陈述他们尝试的解决方案以及到目前为止学到了什么。然后我会解释每个解决方案为什么可行/不可行，然后再次改变问题。

当学生进步到更高级的水平时，我从教师角色转变为所谓的师生角色，并参与学习。学生们在教我，也互相教对方，就像我在教他们一样。我观察每个学生，寻找我所说的“点燃”——学生作为学习者自我推动的时刻，那就是学生持续学习的时候。我发现我的教学方法中，整个课堂一起进步，没有学生被落下。

不时地，学校管理员会参加我的某个课程来观察。他们会听到学生们的低语，并想观察它是如何运作的。当然，管理员需要给每件事都起个名字。在一所私立编码学校，管理员将其描述为“每个人都是学习者”。学生们从老师那里学习，老师从学生那里学习，学生们也从彼此那里学习。管理员称之为“让我们共同学习”。

我为自己的教学方法取了一个名字，我称之为“我相信自己”。我告诉我的学生，如果你自己（学生）首先不相信自己，你怎么能相信我（老师）呢？

### 本书是如何组织的：路线图

本书分为三个部分：基础知识、设计模式和用于生产训练和部署的设计模式。

第一部分“深度学习基础知识”为读者提供了对深度学习的复习，包括卷积神经网络简介，以及讨论了今天所有领域——计算机视觉、自然语言处理和结构化数据——的主流概念和术语。

模型设计模式在第二部分“基本设计模式”中呈现。在第五章到第七章中，我介绍了现代设计模式，以及它们如何应用于许多当前和以前最先进的深度学习模型。我涵盖了过程性重用设计模式，这是手工制作模型的主要方法。我教授了研究人员发现的设计方法、改进以及大模型在层中更深入（第五章）、更宽（第六章）以及使用替代或现成连接模式（第七章）的优缺点。

第五章探讨了卷积神经网络的过程性设计模式，以及残差块在自然语言理解中的注意力机制中的身份链接开发。

第六章扩展了卷积神经网络的过程性设计模式，以及研究人员如何探索在层中变宽作为深入的一种替代方案。我展示了这种方法，如 ResNeXt，与深度层相比，在减少对记忆和消失梯度的暴露时实现了比较高的准确性。我还探讨了宽卷积神经网络与宽度和深度以及结构化数据中的 TabNet 模型的发展的相关性。

第七章涵盖了模型设计模式，这些模式探索了其他替代层连接，以在层中更深入或更广泛地增加准确性，减少参数数量，并在模型中间潜在空间中增加信息增益。

第八章探讨了移动卷积神经网络独特的考虑因素和特殊约束。由于这些设备的内存限制，必须在大小和准确性之间进行权衡。我将讲解这些权衡的进展、优缺点，以及移动网络的设计如何与大型模型对应物不同，以适应这些权衡。

第九章介绍了用于无监督学习的自动编码器。作为独立模型，自动编码器的实际应用范围非常有限。但自动编码器的发现对预训练模型的进步做出了贡献。这些模型更好地泛化到分布外的服务——即，在生产部署的模型中，预测请求的分布与模型训练的数据不同。我还探讨了自动编码器在自然语言理解中与嵌入的相似性。

本书第二部分的所有模型都对深度学习的研发做出了开创性的贡献，并且至今仍在使用，或者它们的贡献已被纳入今天的模型中。

第三部分，“与管道协同工作”，探讨了生产管道的设计模式和最佳实践。在第十章中，我们探讨了超参数调整，包括手动和自动调整。我讲解了指定搜索空间的设计决策、优缺点以及最佳实践，以及搜索该搜索空间的模式。

第十一章讨论了迁移学习，并介绍了处理权重迁移和调整相似和远程任务的概念和方法。我还探讨了在从头开始完全训练的模型中，预训练期间权重重用的应用。

第十二章至第十四章从高层次上审视了生产管道。我们在第十二章和第十三章深入探讨了数据端。第十二章介绍了数据分布，是唯一一个详细讨论统计学的章节。自 2017 年以来，统计学领域发生了很大变化，当时人们期望拥有博士级别的统计学知识。如今，这些知识的大部分都隐藏在深度学习框架（如 TensorFlow）中，或者被自动化。理解数据分布和搜索空间仍然是统计学中预期知识的主要领域之一，并且可以显著影响训练成本以及模型在生产部署时的泛化能力。

最后，第十三章和第十四章从数据端转向部署端。我介绍了构建数据端和训练端的概念和最佳实践。

### 关于代码

本书包含许多源代码示例，无论是编号列表还是与普通文本并列。在这两种情况下，源代码都格式化为 `fixed-width` `font like` `this` 以便与普通文本区分。有时代码也会被**加粗**以突出显示与章节中先前步骤不同的代码，例如当新功能添加到现有代码行时。

在许多情况下，原始源代码已被重新格式化；我们添加了换行并重新调整了缩进以适应书籍中的可用页面空间。此外，当代码在文本中描述时，源代码中的注释通常已从列表中删除。代码注释伴随着许多列表，突出显示重要概念。

书中的所有代码示例都是用 Python 编写的，并且是可运行的代码；尽管它们可能缺少导入语句。在许多情况下，代码示例是更大代码组件的一部分，例如一个模型。在这些情况下，整个代码都可在我的 Google Cloud AI 开发者关系公共 GitHub 仓库 ([`github.com/GoogleCloudPlatform/keras-idiomatic-programmer/tree/master/zoo`](https://github.com/GoogleCloudPlatform/keras-idiomatic-programmer/tree/master/zoo)) 中找到。

### liveBook 讨论论坛

购买《深度学习模式与实践》包括免费访问由 Manning 出版公司运行的私人网络论坛，您可以在论坛中就书籍发表评论、提出技术问题，并从作者和其他用户那里获得帮助。要访问论坛，请访问 [`livebook.manning.com/#!/book/deep-learning-patterns-and-practices/discussion`](https://livebook.manning.com/#!/book/deep-learning-patterns-and-practices/discussion)。您还可以在 [`livebook.manning.com/#!/discussion`](https://livebook.manning.com/#!/discussion) 了解更多关于 Manning 论坛和行为准则的信息。

曼宁对读者的承诺是提供一个平台，在这里读者之间以及读者与作者之间可以进行有意义的对话。这并不是对作者参与特定数量活动的承诺，作者对论坛的贡献仍然是自愿的（且未支付报酬）。我们建议您尝试向作者提出一些挑战性的问题，以免他的兴趣转移！只要书籍在印刷中，论坛和先前讨论的存档将可通过出版社的网站访问。

### 其他在线资源

对于框架，我使用 TensorFlow 2.*x*，它已经集成了 Keras 模型 API。我认为这两个的结合是超越其生产价值的教育工具。

材料是多模态的。除了书籍和仓库中的完整代码示例外，还有针对每个章节的演示文稿、研讨会、实验室和预先录制的讲座，这些都可以在我的 Google Cloud AI 开发者关系 YouTube 账号 ([www.youtube.com/channel/UC8OV0VkzHTp8_PUwEdzlBJg](https://www.youtube.com/channel/UC8OV0VkzHTp8_PUwEdzlBJg)) 上找到。

## 关于作者

我坚信我终身积累的经验使我成为教授深度学习概念的理想人选之一。当这本书首次印刷时，我将近 60 岁。我拥有丰富的知识和经验，这些在当今的劳动力市场中得到了体现。1987 年，我获得了人工智能的高级学位。我专攻自然语言处理。当我从大学毕业时，我以为我会写有声读物。嗯，那是人工智能的冬天。

在我的早期职业生涯中，我还采取了其他方向。首先，我成为了主框架计算机政府安全方面的专家。随着我在操作系统内核设计和编码方面的技能越来越熟练，我成为了 UNIX 的内核开发者，是当今重型 UNIX 内核的众多贡献者之一。在那些同样的年份里，我参与了共享软件（在开源之前）并创立了 WINNIX，这是一个与商业 MKS Toolkit 竞争在 DOS 环境中运行 UNIX 外壳和命令的共享软件程序。

此后，我开发了低级目标代码工具。在 20 世纪 90 年代初，我成为了安全级计算和大规模并行计算机的编译器/汇编器的专家。我开发了 MetaC，它为传统操作系统和高度安全和大规模并行计算机的操作系统内核提供了仪器。

在 20 世纪 90 年代末，我改变了职业道路，成为日本夏普公司的研究科学家。在几年之内，我成为了公司在北美的主研科学家。在 20 年的时间里，夏普根据我的研究提交了 200 多项美国专利申请，其中 115 项获得批准。我的专利涵盖了太阳能、远程会议、成像、数字交互式标牌和自动驾驶汽车等领域。此外，在 2014-2015 年间，我被认定为开放数据和数据本体领域的世界级领先专家，并创立了 opengeocode 组织。

在 2017 年 3 月，在我的一个朋友的推动下，我开始了解“这个被称为深度学习的东西是什么？”对我来说这是自然而然的。我有大数据背景，曾担任成像科学家和研究员，拥有人工智能研究生学位，从事自动驾驶汽车的工作——这一切似乎都相得益彰。因此，我做出了这个跳跃。

在 2018 年的夏天，谷歌向我提出担任谷歌云 AI 的员工。我在那年的 10 月接受了这个职位。在谷歌的工作经历非常棒。今天，我与谷歌及其企业客户中的大量 AI 专家合作，教授、指导、咨询，并解决挑战，以在大规模生产规模上使深度学习得以实施。

## 关于封面插图

《深度学习模式与实践》的封面图题为“Indien”，或印度人。这幅插图取自雅克·格拉塞·德·圣索沃尔（1757–1810）的作品集，名为《不同国家的服饰》，于 1784 年在法国出版。每一幅插图都是手工精心绘制和着色的。格拉塞·德·圣索沃尔收藏的丰富多样性生动地提醒我们，200 年前世界的城镇和地区在文化上有多么不同。人们彼此孤立，说着不同的方言和语言。在街道或乡村，仅凭他们的服饰就能轻易识别他们居住的地方以及他们的职业或社会地位。

自那以后，我们的着装方式发生了变化，当时地区间的多样性已经消失。现在很难区分不同大陆、不同城镇、地区或国家的人们。也许我们用文化多样性换取了更加丰富多彩的个人生活——当然，是为了更加多样化和快节奏的技术生活。

在难以区分一本计算机书与另一本计算机书的今天，曼宁通过基于两百年前区域生活的丰富多样性，并由格拉塞·德·圣索沃尔的图画使之重现的书封面，庆祝了计算机行业的创新精神和主动性。
