# 前言

我认为，当人们 50 年后回顾并评估本世纪的头二十年时，深度学习将名列技术创新之首。深度学习的理论基础在 20 世纪 50 年代就已经确立，但直到 2012 年，深度学习的潜力才对非专业人士显现。现在，几乎十年过去了，深度学习已经渗透到我们的生活中，从能够无缝将我们的语音转换为文本的智能音箱，到能够在不断扩大的游戏范围内击败任何人类的系统。本书考察了深度学习世界中一个被忽视的角落：将深度学习应用于结构化、表格数据（即按行和列组织的数据）。

如果传统观点是避免在结构化数据中使用深度学习，而深度学习的标志性应用（如图像识别）处理的是非结构化数据，那么为什么你应该阅读一本关于结构化数据深度学习的书呢？首先，正如我在第一章和第二章中论证的，对于使用深度学习解决结构化数据问题（如深度学习过于复杂或结构化数据集太小）的一些反对意见在今天根本站不住脚。当我们评估哪种机器学习方法适用于结构化数据问题时，我们需要保持开放的心态，并将深度学习视为一种潜在的解决方案。其次，尽管非表格数据支撑着深度学习的许多热门应用领域（如图像识别、语音到文本和机器翻译），但作为消费者、雇员和公民，我们的生活仍然主要由表格数据定义。每一次银行交易、每一次税款支付、每一次保险索赔以及我们日常生活中的数百个其他方面都通过结构化、表格数据流动。无论你是深度学习的初学者还是经验丰富的从业者，当你处理涉及结构化数据的问题时，你都应该在自己的工具箱中拥有深度学习。

通过阅读这本书，你将学习到将深度学习应用于各种结构化数据问题的所需知识。你将完成深度学习在真实世界数据集上的全面应用，从准备数据到训练深度学习模型，再到部署训练好的模型。本书附带代码示例是用 Python 编写的，Python 是机器学习的通用语言，并利用了 Keras/TensorFlow 框架，这是工业界最常用的深度学习平台。

## 致谢

在过去一年半的时间里，我写这本书期间，有很多要感谢的人给予他们的支持和帮助。首先，我要感谢 Manning Publications 的团队，特别是我的编辑 Christina Taylor，他们的精湛指导。我要感谢我在 IBM 的前任主管——特别是 Jessica Rockwood、Michael Kwok 和 Al Martin——给予我写这本书的动力。我要感谢我在 Intact 的当前团队的支持——特别是 Simon Marchessault-Groleau、Dany Simard 和 Nicolas Beaupré。我的朋友们一直给予我持续的鼓励。我特别感谢 Dr. Laurence Mussio 和 Flavia Mussio，他们都是我写作的无私和热情的支持者。Jamie Roberts、Luc Chamberland、Alan Hall、Peter Moroney、Fred Gandolfi 和 Alina Zhang 都给予了鼓励。最后，我要感谢我的家人——Steve 和 Carol、John 和 Debby、Nina——他们的爱。（“感谢上帝，我们是一个文学家庭。”）

致所有审稿人：Aditya Kaushik、Atul Saurav、Gary Bake、Gregory Matuszek、Guy Langston、Hao Liu、Ike Okonkwo、Irfan Ullah、Ishan Khurana、Jared Wadsworth、Jason Rendel、Jeff Hajewski、Jesús Manuel López Becerra、Joe Justesen、Juan Rufes、Julien Pohie、Kostas Passadis、Kunal Ghosh、Malgorzata Rodacka、Matthias Busch、Michael Jensen、Monica Guimaraes、Nicole Koenigstein、Rajkumar Palani、Raushan Jha、Sayak Paul、Sean T Booker、Stefano Ongarello、Tony Holdroyd、Vlad Navitski，你们的建议帮助使这本书变得更好。

## 关于这本书

这本书将带你经历将深度学习应用于表格化、结构化数据集的完整旅程。通过解决一个扩展的、现实世界的例子，你将学习如何清理一个混乱的数据集，并使用流行的 Keras 框架来训练深度学习模型。然后，你将学习如何通过网页或 Facebook Messenger 中的聊天机器人使你的训练好的深度学习模型对全世界可用。最后，你将学习如何扩展和改进你的深度学习模型，以及如何将本书中展示的方法应用于涉及结构化数据的其他问题。

## 适合阅读这本书的人

为了最大限度地利用这本书，你应该熟悉在 Jupyter Notebooks 环境中进行 Python 编码。你还应该熟悉一些非深度学习机器学习方法，如逻辑回归和支持向量机，并熟悉机器学习的标准词汇。最后，如果你经常处理以行和列组织的数据，你会发现将这本书中的概念应用于你的工作将更容易。

## 这本书的组织结构：路线图

这本书由九个章节和一个附录组成：

+   第一章快速回顾了深度学习的高级概念，并总结了为什么（以及为什么不）你想将深度学习应用于结构化数据。它还解释了我所说的*结构化数据*是什么。

+   第二章解释了可用于本书代码示例的开发环境。它还介绍了用于表格、结构化数据的 Python 库（Pandas），并描述了本书其余部分使用的重大示例：预测轻轨交通系统的延误。这个示例是电车延误预测问题。最后，第二章通过一个简单的深度学习模型训练示例快速预览了后续章节的细节。

+   第三章探讨了主要示例的数据集，并描述了如何处理数据集中的一组问题。它还考察了训练深度学习模型所需数据量的多少问题。

+   第四章涵盖了如何解决数据集中的额外问题，以及处理在所有清理工作完成后仍留在数据中的不良值。它还展示了如何准备非数值数据以训练深度学习模型。第四章以端到端代码示例的总结结束。

+   第五章描述了为电车延误预测问题准备和构建深度学习模型的过程。它解释了数据泄露（使用在您想用模型进行预测时不可用的数据进行模型训练）的问题以及如何避免它。然后章节详细介绍了构成深度学习模型的代码细节，并展示了检查模型结构的选项。

+   第六章解释了从选择输入数据集的子集以训练和测试模型，到进行第一次训练运行，再到通过一系列实验迭代以提高训练模型性能的端到端模型训练过程。

+   第七章通过进行三个更深入的实验，扩展了第六章中引入的模型训练技术。第一个实验证明，第四章中的一项清理步骤（删除包含无效值的记录）提高了模型的性能。第二个实验展示了将学习向量（嵌入）与分类列关联的性能优势。最后，第三个实验比较了深度学习模型与流行非深度学习方法 XGBoost 的性能。

+   第八章提供了如何使您训练的深度学习模型对外界有用的详细信息。首先，它描述了如何进行一个简单的模型网络部署。然后，它描述了如何使用 Rasa 开源聊天机器人框架在 Facebook Messenger 中部署训练好的模型。

+   第九章首先总结了本书所涵盖的内容。然后它描述了可能提高模型性能的额外数据源，包括位置和天气数据。接下来，它描述了如何将本书附带的代码适应于解决表格结构数据中的全新问题。本章最后列出了更多关于结构化数据深度学习的书籍、课程和在线资源。

+   附录描述了如何使用免费的 Colab 环境运行本书附带的代码示例。

我建议您按顺序阅读这本书，因为每一章都是基于前一章的内容构建的。如果您执行了本书附带的代码示例——特别是电车延误预测问题的代码——您将能从本书中获得最大收益。最后，我强烈建议您练习第六章和第七章中描述的实验，并探索第九章中描述的额外增强功能。

## 关于代码

这本书附带大量的代码示例。除了第 3-8 章中关于电车延误预测问题的扩展代码示例外，第二章（用于演示 Pandas 库以及 Pandas 与 SQL 之间的关系）和第五章（用于演示 Keras 顺序和功能 API）还有额外的独立代码示例。

第二章描述了您运行代码示例的选项，附录中进一步详细说明了其中一个选项，即 Google 的 Colab。无论您选择哪种环境，您都需要安装 Python（至少版本 3.7）以及以下关键库：

+   Pandas

+   Scikit-learn

+   Keras/TensorFlow 2.x

当您运行代码片段时，您可能需要使用 pip 安装额外的库。

主电车延误预测示例的部署部分有一些额外的要求：

+   Flask 库用于 Web 部署

+   Rasa 聊天机器人框架和 ngrok 用于 Facebook Messenger 部署

源代码以`fixed-width` `font` `like` `this`的格式进行格式化，以将其与普通文本区分开来。有时代码也会以`bold`显示，以突出显示与章节中先前步骤相比已更改的代码，例如当新功能添加到现有代码行时。

在许多情况下，原始源代码已被重新格式化；我们添加了换行并重新整理了缩进，以适应书籍中的可用页面空间。在极少数情况下，即使这样也不够，列表中包括行续接标记（➥）。此外，当代码在文本中描述时，源代码中的注释通常也会从列表中删除。代码注释伴随着许多列表，突出显示重要概念。

您可以在 GitHub 仓库[`mng.bz/v95x`](http://mng.bz/v95x)中找到这本书的所有代码示例。

## liveBook 讨论论坛

购买《结构化数据深度学习》包括免费访问由曼宁出版社运营的私人网络论坛，您可以在论坛上对书籍发表评论、提出技术问题，并从作者和其他用户那里获得帮助。要访问论坛，请访问[`livebook.manning.com/#!/book/deep-learning-with-structured-data/discussion`](https://livebook.manning.com/#!/book/deep-learning-with-structured-data/discussion)。您还可以在[`livebook.manning.com/#!/discussion`](https://livebook.manning.com/#!/discussion)了解更多关于曼宁论坛和行为准则的信息。

曼宁对读者的承诺是提供一个平台，让读者之间以及读者与作者之间可以进行有意义的对话。这并不是对作者参与特定数量活动的承诺，作者对论坛的贡献仍然是自愿的（且未支付报酬）。我们建议您尝试向作者提出一些挑战性的问题，以免他的兴趣转移！只要书籍仍在印刷中，论坛和先前讨论的存档将可通过出版社的网站访问。

## 关于作者

马克·瑞安是加拿大多伦多 Intact 保险公司的数据科学经理。马克热衷于分享机器学习的益处，包括提供机器学习训练营，让参与者亲身体验机器学习的世界。除了深度学习及其在结构化、表格数据中解锁额外价值的能力外，他的兴趣还包括聊天机器人和自动驾驶汽车的可能性。他拥有滑铁卢大学的数学学士学位和多伦多大学的计算机科学硕士学位。

## 关于封面插图

《结构化数据深度学习》封面上的插图标题为“Homme de Navarre”，或“来自纳瓦拉的男子”，这是西班牙北部一个多元化的地区。这幅插图取自雅克·格拉塞·德·圣索沃尔（1757-1810）的作品集，名为《不同国家的服饰》，于 1797 年在法国出版。每一幅插图都是手工精细绘制和着色的。格拉塞·德·圣索沃尔收藏中的丰富多样性生动地提醒我们，200 年前世界的城镇和地区在文化上有多么不同。他们彼此孤立，说着不同的方言和语言。在街道或乡村，仅凭他们的服饰就能轻易识别他们居住的地方以及他们的职业或社会地位。

自那时以来，我们的着装方式已经改变，而当时区域间的多样性已经逐渐消失。现在很难区分不同大陆的居民，更不用说不同的城镇、地区或国家了。也许我们用文化多样性换取了更加丰富多彩的个人生活——当然，是为了更加多样化和快节奏的技术生活。

在难以区分一本计算机书与另一本计算机书的年代，曼宁通过基于两百年前丰富多样的地区生活所设计的书封面，庆祝了计算机行业的创新精神和主动性，这些画面由格拉塞特·德·圣索沃尔重新赋予生命。
